/*! For license information please see module.js.LICENSE.txt */
define(["@grafana/data","react","@grafana/runtime","@grafana/ui","@emotion/css","lodash","prismjs","rxjs","react-dom","redux","react-redux"],((e,t,r,n,i,a,o,s,l,u,c)=>(()=>{var d,p={5358:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3545),i=r(1177),a=r(3305),o=r(5556),s=r(2650),l=r(7388);function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var c=u(s);function d(e){return"function"==typeof e}var p,f=((p=function(e){var t;t=this,Error.call(t),t.stack=(new Error).stack,this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}).prototype=Object.create(Error.prototype),p.prototype.constructor=p,p);function m(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var h=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,r,n,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var s=o.__values(a),l=s.next();!l.done;l=s.next())l.value.remove(this)}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else a.remove(this);var u=this.initialTeardown;if(d(u))try{u()}catch(e){i=e instanceof f?e.errors:[e]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var p=o.__values(c),m=p.next();!m.done;m=p.next()){var h=m.value;try{g(h)}catch(e){i=null!=i?i:[],e instanceof f?i=o.__spreadArray(o.__spreadArray([],o.__read(i)),o.__read(e.errors)):i.push(e)}}}catch(e){r={error:e}}finally{try{m&&!m.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}}if(i)throw new f(i)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)g(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&m(t,e)},e.prototype.remove=function(t){var r=this._finalizers;r&&m(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function g(e){d(e)?e():e.unsubscribe()}h.EMPTY;var y=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return setTimeout.apply(void 0,o.__spreadArray([e,t],o.__read(r)))};function v(){}var b=function(e){function t(t){var r,n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,((r=t)instanceof h||r&&"closed"in r&&d(r.remove)&&d(r.add)&&d(r.unsubscribe))&&t.add(n)):n.destination=S,n}return o.__extends(t,e),t.create=function(e,t,r){return new w(e,t,r)},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(h);Function.prototype.bind;var O=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){_(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){_(e)}else _(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){_(e)}},e}(),w=function(e){function t(t,r,n){var i,a=e.call(this)||this;return i=d(t)||!t?{next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:t,a.destination=new O(i),a}return o.__extends(t,e),t}(b);function _(e){var t;t=e,y((function(){throw t}))}var S={closed:!0,next:v,error:function(e){throw e},complete:v},E=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t)||this;return s.onFinalize=a,s.shouldUnsubscribe=o,s._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,s._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return o.__extends(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(b);function x(e,t){return r=function(r,n){var i=0;r.subscribe(new E(n,(function(r){n.next(e.call(t,r,i++))}),void 0,void 0,void 0))},function(e){if(function(e){return d(null==e?void 0:e.lift)}(e))return e.lift((function(e){try{return r(e,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")};var r}var T=Object.defineProperty,P=Object.defineProperties,k=Object.getOwnPropertyDescriptors,I=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,q=(e,t,r)=>t in e?T(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,R=(e,t)=>{for(var r in t||(t={}))C.call(t,r)&&q(e,r,t[r]);if(I)for(var r of I(t))A.call(t,r)&&q(e,r,t[r]);return e},D=(e,t)=>P(e,k(t)),N=Object.defineProperty,L=Object.defineProperties,j=Object.getOwnPropertyDescriptors,M=Object.getOwnPropertySymbols,F=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable,Q=(e,t,r)=>t in e?N(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,$=(e,t)=>{for(var r in t||(t={}))F.call(t,r)&&Q(e,r,t[r]);if(M)for(var r of M(t))B.call(t,r)&&Q(e,r,t[r]);return e},V=(e,t)=>L(e,j(t));const X=["started","submitted","running"],G=(e="")=>X.includes(e);class U extends n.DataSourceWithBackend{constructor(e,t=!1){super(e),this.runningQueries={},this.requestCounter=100,this.cancel=e=>{this.storeQuery(e,{shouldCancel:!0})},this.asyncQueryDataSupport=t}query(e){if(this.asyncQueryDataSupport){const t=this.filterQuery?e.targets.filter(this.filterQuery):e.targets;if(!t.length)return i.of({data:[]});const r=[];for(let n of t)n.hide||r.push(this.doSingle(n,e));return i.merge(...r)}return super.query(e)}storeQuery(e,t){const r=JSON.stringify(e),n=this.runningQueries[r]||{};this.runningQueries[r]=$($({},n),t)}getQuery(e){const t=JSON.stringify(e);return this.runningQueries[t]||{}}removeQuery(e){const t=JSON.stringify(e);delete this.runningQueries[t]}doSingle(e,t){let r,o,s=[];return l=V($({},t),{targets:[e],requestId:"aws_ts_"+this.requestCounter++}),u={getNextQuery:t=>{var n,i;if(null==(n=t.data)?void 0:n.length){const n=null==(i=t.data[0].meta)?void 0:i.custom;if((e=>!("object"!=typeof e||!(null==e?void 0:e.hasOwnProperty("queryID"))||!(null==e?void 0:e.hasOwnProperty("status"))))(n)&&G(n.status))return r=n.queryID,o=n.status,this.storeQuery(e,{queryID:r}),V($({},e),{queryID:r})}this.removeQuery(e)},query:e=>{const{range:t,targets:r,requestId:i,intervalMs:a,maxDataPoints:s}=e,[l]=r,u=$($({},l),this.asyncQueryDataSupport?{meta:{queryFlow:"async"}}:{}),c={queries:[$(V($({},u),{intervalMs:a,maxDataPoints:s,datasource:null==this?void 0:this.getRef(),datasourceId:this.id}),this.applyTemplateVariables(u,e.scopedVars))],range:t,from:t.from.valueOf().toString(),to:t.to.valueOf().toString()};let d={};G(o)&&(d={"X-Cache-Skip":!0});const p={method:"POST",url:"/api/ds/query",data:c,requestId:i,headers:d};return n.getBackendSrv().fetch(p).pipe(x((e=>({data:n.toDataQueryResponse(e).data}))))},process:e=>{for(const t of e)t.fields.length>0&&s.push(t);return s},shouldCancel:()=>{const{shouldCancel:t}=this.getQuery(e);return!!t},onCancel:()=>{r&&(this.removeQuery(e),this.postResource("cancel",{queryId:r}).catch((e=>{e.isHandled=!0,console.error(`error cancelling query ID: ${r}`,e)})))}},new i.Observable((e=>{let t,r,n=a.LoadingState.Loading,i=1,o=1,s=!1;const c={next:r=>{n=r.state;let o=!1;if(n!==a.LoadingState.Error){t=u.getNextQuery(r);const e=u.shouldCancel();t&&e&&(s=e,t=void 0),o=!0}const c=u.process(r.data);o&&(t?(n=c.length&&c[0].length?a.LoadingState.Streaming:a.LoadingState.Loading,i=2*i>10?10:2*i):(n=a.LoadingState.Done,i=0)),e.next(D(R({},r),{data:c,state:n,key:l.requestId}))},error:t=>{e.error(t)},complete:()=>{if(r&&(r.unsubscribe(),r=void 0),t){const e=t;setTimeout((()=>{r=u.query(D(R({},l),{requestId:`${l.requestId}.${++o}`,targets:[e]})).subscribe(c),t=void 0}),1e3*i)}else e.complete()}};return r=u.query(l).subscribe(c),function(){c.complete(),(t||s)&&u.onCancel(),t=void 0}}));var l,u}}t.DatasourceWithAsyncBackend=U,t.RunQueryButtons=e=>{const{state:t}=e,[r,n]=s.useState(!1),[i,o]=s.useState(!1),[u,d]=s.useState(t),[p,f]=s.useState(e.query);s.useEffect((()=>{t&&u!==t&&t!==a.LoadingState.Loading&&(n(!1),o(!1)),d(t)}),[t,u]);const m=e.onCancelQuery?()=>{var t;null==(t=e.onCancelQuery)||t.call(e,p),o(!0)}:void 0;return c.default.createElement(c.default.Fragment,null,c.default.createElement(l.Button,{variant:e.enableRun?"primary":"secondary",size:"sm",onClick:()=>{n(!0),f(e.query),e.onRunQuery()},icon:r&&!i?"fa fa-spinner":void 0,disabled:t===a.LoadingState.Loading||!e.enableRun},"Run query"),m&&c.default.createElement(l.Button,{variant:r&&!i?"primary":"secondary",size:"sm",disabled:!r||i,icon:i?"fa fa-spinner":void 0,onClick:m},"Stop query"))}},5569:(e,t,r)=>{"use strict";var n=r(2650),i=r(7388),a=r(3305),o=r(3545);r(5980),r(1988),r(5358);function s(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=s(n);const u=["af-south-1","ap-east-1","ap-northeast-1","ap-northeast-2","ap-northeast-3","ap-south-1","ap-southeast-1","ap-southeast-2","ca-central-1","cn-north-1","cn-northwest-1","eu-central-1","eu-north-1","eu-west-1","eu-west-2","eu-west-3","me-south-1","sa-east-1","us-east-1","us-east-2","us-gov-east-1","us-gov-west-1","us-iso-east-1","us-isob-east-1","us-west-1","us-west-2"];var c=(e=>(e.Keys="keys",e.Credentials="credentials",e.Default="default",e.EC2IAMRole="ec2_iam_role",e.ARN="arn",e.GrafanaAssumeRole="grafana_assume_role",e))(c||{});const d=[{label:"Workspace IAM Role",value:c.EC2IAMRole},{label:"Grafana Assume Role",value:c.GrafanaAssumeRole},{label:"AWS SDK Default",value:c.Default},{label:"Access & secret key",value:c.Keys},{label:"Credentials file",value:c.Credentials}];var p=function(){function e(e){var t=this;this._insertTag=function(e){var r;r=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,r),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var r=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{r.insertRule(e,r.cssRules.length)}catch(e){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}(),f="-ms-",m="-moz-",h="-webkit-",g="comm",y="rule",v="decl",b="@keyframes",O=Math.abs,w=String.fromCharCode,_=Object.assign;function S(e){return e.trim()}function E(e,t,r){return e.replace(t,r)}function x(e,t){return e.indexOf(t)}function T(e,t){return 0|e.charCodeAt(t)}function P(e,t,r){return e.slice(t,r)}function k(e){return e.length}function I(e){return e.length}function C(e,t){return t.push(e),e}var A=1,q=1,R=0,D=0,N=0,L="";function j(e,t,r,n,i,a,o){return{value:e,root:t,parent:r,type:n,props:i,children:a,line:A,column:q,length:o,return:""}}function M(e,t){return _(j("",null,null,"",null,null,0),e,{length:-e.length},t)}function F(){return N=D>0?T(L,--D):0,q--,10===N&&(q=1,A--),N}function B(){return N=D<R?T(L,D++):0,q++,10===N&&(q=1,A++),N}function Q(){return T(L,D)}function $(){return D}function V(e,t){return P(L,e,t)}function X(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function G(e){return A=q=1,R=k(L=e),D=0,[]}function U(e){return L="",e}function z(e){return S(V(D-1,H(91===e?e+2:40===e?e+1:e)))}function W(e){for(;(N=Q())&&N<33;)B();return X(e)>2||X(N)>3?"":" "}function K(e,t){for(;--t&&B()&&!(N<48||N>102||N>57&&N<65||N>70&&N<97););return V(e,$()+(t<6&&32==Q()&&32==B()))}function H(e){for(;B();)switch(N){case e:return D;case 34:case 39:34!==e&&39!==e&&H(N);break;case 40:41===e&&H(e);break;case 92:B()}return D}function Y(e,t){for(;B()&&e+N!==57&&(e+N!==84||47!==Q()););return"/*"+V(t,D-1)+"*"+w(47===e?e:B())}function Z(e){for(;!X(Q());)B();return V(e,D)}function J(e){return U(ee("",null,null,null,[""],e=G(e),0,[0],e))}function ee(e,t,r,n,i,a,o,s,l){for(var u=0,c=0,d=o,p=0,f=0,m=0,h=1,g=1,y=1,v=0,b="",O=i,_=a,S=n,P=b;g;)switch(m=v,v=B()){case 40:if(108!=m&&58==T(P,d-1)){-1!=x(P+=E(z(v),"&","&\f"),"&\f")&&(y=-1);break}case 34:case 39:case 91:P+=z(v);break;case 9:case 10:case 13:case 32:P+=W(m);break;case 92:P+=K($()-1,7);continue;case 47:switch(Q()){case 42:case 47:C(re(Y(B(),$()),t,r),l);break;default:P+="/"}break;case 123*h:s[u++]=k(P)*y;case 125*h:case 59:case 0:switch(v){case 0:case 125:g=0;case 59+c:f>0&&k(P)-d&&C(f>32?ne(P+";",n,r,d-1):ne(E(P," ","")+";",n,r,d-2),l);break;case 59:P+=";";default:if(C(S=te(P,t,r,u,c,i,s,b,O=[],_=[],d),a),123===v)if(0===c)ee(P,t,S,S,O,a,d,s,_);else switch(99===p&&110===T(P,3)?100:p){case 100:case 109:case 115:ee(e,S,S,n&&C(te(e,S,S,0,0,i,s,b,i,O=[],d),_),i,_,d,s,n?O:_);break;default:ee(P,S,S,S,[""],_,0,s,_)}}u=c=f=0,h=y=1,b=P="",d=o;break;case 58:d=1+k(P),f=m;default:if(h<1)if(123==v)--h;else if(125==v&&0==h++&&125==F())continue;switch(P+=w(v),v*h){case 38:y=c>0?1:(P+="\f",-1);break;case 44:s[u++]=(k(P)-1)*y,y=1;break;case 64:45===Q()&&(P+=z(B())),p=Q(),c=d=k(b=P+=Z($())),v++;break;case 45:45===m&&2==k(P)&&(h=0)}}return a}function te(e,t,r,n,i,a,o,s,l,u,c){for(var d=i-1,p=0===i?a:[""],f=I(p),m=0,h=0,g=0;m<n;++m)for(var v=0,b=P(e,d+1,d=O(h=o[m])),w=e;v<f;++v)(w=S(h>0?p[v]+" "+b:E(b,/&\f/g,p[v])))&&(l[g++]=w);return j(e,t,r,0===i?y:s,l,u,c)}function re(e,t,r){return j(e,t,r,g,w(N),P(e,2,-2),0)}function ne(e,t,r,n){return j(e,t,r,v,P(e,0,n),P(e,n+1,-1),n)}function ie(e,t){for(var r="",n=I(e),i=0;i<n;i++)r+=t(e[i],i,e,t)||"";return r}function ae(e,t,r,n){switch(e.type){case"@import":case v:return e.return=e.return||e.value;case g:return"";case b:return e.return=e.value+"{"+ie(e.children,n)+"}";case y:e.value=e.props.join(",")}return k(r=ie(e.children,n))?e.return=e.value+"{"+r+"}":""}function oe(e){var t=I(e);return function(r,n,i,a){for(var o="",s=0;s<t;s++)o+=e[s](r,n,i,a)||"";return o}}function se(e){var t=Object.create(null);return function(r){return void 0===t[r]&&(t[r]=e(r)),t[r]}}var le=function(e,t,r){for(var n=0,i=0;n=i,i=Q(),38===n&&12===i&&(t[r]=1),!X(i);)B();return V(e,D)},ue=new WeakMap,ce=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,r=e.parent,n=e.column===r.column&&e.line===r.line;"rule"!==r.type;)if(!(r=r.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||ue.get(r))&&!n){ue.set(e,!0);for(var i=[],a=function(e,t){return U(function(e,t){var r=-1,n=44;do{switch(X(n)){case 0:38===n&&12===Q()&&(t[r]=1),e[r]+=le(D-1,t,r);break;case 2:e[r]+=z(n);break;case 4:if(44===n){e[++r]=58===Q()?"&\f":"",t[r]=e[r].length;break}default:e[r]+=w(n)}}while(n=B());return e}(G(e),t))}(t,i),o=r.props,s=0,l=0;s<a.length;s++)for(var u=0;u<o.length;u++,l++)e.props[l]=i[s]?a[s].replace(/&\f/g,o[u]):o[u]+" "+a[s]}}},de=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function pe(e,t){switch(function(e,t){return 45^T(e,0)?(((t<<2^T(e,0))<<2^T(e,1))<<2^T(e,2))<<2^T(e,3):0}(e,t)){case 5103:return h+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return h+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return h+e+m+e+f+e+e;case 6828:case 4268:return h+e+f+e+e;case 6165:return h+e+f+"flex-"+e+e;case 5187:return h+e+E(e,/(\w+).+(:[^]+)/,h+"box-$1$2"+f+"flex-$1$2")+e;case 5443:return h+e+f+"flex-item-"+E(e,/flex-|-self/,"")+e;case 4675:return h+e+f+"flex-line-pack"+E(e,/align-content|flex-|-self/,"")+e;case 5548:return h+e+f+E(e,"shrink","negative")+e;case 5292:return h+e+f+E(e,"basis","preferred-size")+e;case 6060:return h+"box-"+E(e,"-grow","")+h+e+f+E(e,"grow","positive")+e;case 4554:return h+E(e,/([^-])(transform)/g,"$1"+h+"$2")+e;case 6187:return E(E(E(e,/(zoom-|grab)/,h+"$1"),/(image-set)/,h+"$1"),e,"")+e;case 5495:case 3959:return E(e,/(image-set\([^]*)/,h+"$1$`$1");case 4968:return E(E(e,/(.+:)(flex-)?(.*)/,h+"box-pack:$3"+f+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+h+e+e;case 4095:case 3583:case 4068:case 2532:return E(e,/(.+)-inline(.+)/,h+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(k(e)-1-t>6)switch(T(e,t+1)){case 109:if(45!==T(e,t+4))break;case 102:return E(e,/(.+:)(.+)-([^]+)/,"$1"+h+"$2-$3$1"+m+(108==T(e,t+3)?"$3":"$2-$3"))+e;case 115:return~x(e,"stretch")?pe(E(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==T(e,t+1))break;case 6444:switch(T(e,k(e)-3-(~x(e,"!important")&&10))){case 107:return E(e,":",":"+h)+e;case 101:return E(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+h+(45===T(e,14)?"inline-":"")+"box$3$1"+h+"$2$3$1"+f+"$2box$3")+e}break;case 5936:switch(T(e,t+11)){case 114:return h+e+f+E(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return h+e+f+E(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return h+e+f+E(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return h+e+f+e+e}return e}var fe,me,he="undefined"!=typeof document,ge=he?void 0:(fe=function(){return se((function(){var e={};return function(t){return e[t]}}))},me=new WeakMap,function(e){if(me.has(e))return me.get(e);var t=fe();return me.set(e,t),t}),ye=[function(e,t,r,n){if(e.length>-1&&!e.return)switch(e.type){case v:e.return=pe(e.value,e.length);break;case b:return ie([M(e,{value:E(e.value,"@","@"+h)})],n);case y:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=/(::plac\w+|:read-\w+)/.exec(e))?e[0]:e}(t)){case":read-only":case":read-write":return ie([M(e,{props:[E(t,/:(read-\w+)/,":-moz-$1")]})],n);case"::placeholder":return ie([M(e,{props:[E(t,/:(plac\w+)/,":"+h+"input-$1")]}),M(e,{props:[E(t,/:(plac\w+)/,":-moz-$1")]}),M(e,{props:[E(t,/:(plac\w+)/,f+"input-$1")]})],n)}return""}))}}],ve=function(e){var t=e.key;if(he&&"css"===t){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var n,i,a=e.stylisPlugins||ye,o={},s=[];he&&(n=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),r=1;r<t.length;r++)o[t[r]]=!0;s.push(e)})));var l,u=[ce,de];if(he){var c,d=[ae,(l=function(e){c.insert(e)},function(e){e.root||(e=e.return)&&l(e)})],f=oe(u.concat(a,d));i=function(e,t,r,n){c=r,ie(J(e?e+"{"+t.styles+"}":t.styles),f),n&&(y.inserted[t.name]=!0)}}else{var m=[ae],h=oe(u.concat(a,m)),g=ge(a)(t);i=function(e,t,r,n){var i=t.name,a=function(e,t){var r=t.name;return void 0===g[r]&&(g[r]=ie(J(e?e+"{"+t.styles+"}":t.styles),h)),g[r]}(e,t);return void 0===y.compat?(n&&(y.inserted[i]=!0),a):n?void(y.inserted[i]=a):a}}var y={key:t,sheet:new p({key:t,container:n,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:i};return y.sheet.hydrate(s),y},be={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Oe=/[A-Z]|^ms/g,we=/_EMO_([^_]+?)_([^]*?)_EMO_/g,_e=function(e){return 45===e.charCodeAt(1)},Se=function(e){return null!=e&&"boolean"!=typeof e},Ee=se((function(e){return _e(e)?e:e.replace(Oe,"-$&").toLowerCase()})),xe=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(we,(function(e,t,r){return Pe={name:t,styles:r,next:Pe},t}))}return 1===be[e]||_e(e)||"number"!=typeof t||0===t?t:t+"px"};function Te(e,t,r){if(null==r)return"";if(void 0!==r.__emotion_styles)return r;switch(typeof r){case"boolean":return"";case"object":if(1===r.anim)return Pe={name:r.name,styles:r.styles,next:Pe},r.name;if(void 0!==r.styles){var n=r.next;if(void 0!==n)for(;void 0!==n;)Pe={name:n.name,styles:n.styles,next:Pe},n=n.next;return r.styles+";"}return function(e,t,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=Te(e,t,r[i])+";";else for(var a in r){var o=r[a];if("object"!=typeof o)null!=t&&void 0!==t[o]?n+=a+"{"+t[o]+"}":Se(o)&&(n+=Ee(a)+":"+xe(a,o)+";");else if(!Array.isArray(o)||"string"!=typeof o[0]||null!=t&&void 0!==t[o[0]]){var s=Te(e,t,o);switch(a){case"animation":case"animationName":n+=Ee(a)+":"+s+";";break;default:n+=a+"{"+s+"}"}}else for(var l=0;l<o.length;l++)Se(o[l])&&(n+=Ee(a)+":"+xe(a,o[l])+";")}return n}(e,t,r);case"function":if(void 0!==e){var i=Pe,a=r(e);return Pe=i,Te(e,t,a)}}if(null==t)return r;var o=t[r];return void 0!==o?o:r}var Pe,ke=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Ie=function(e,t,r){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var n=!0,i="";Pe=void 0;var a=e[0];null==a||void 0===a.raw?(n=!1,i+=Te(r,t,a)):i+=a[0];for(var o=1;o<e.length;o++)i+=Te(r,t,e[o]),n&&(i+=a[o]);ke.lastIndex=0;for(var s,l="";null!==(s=ke.exec(i));)l+="-"+s[1];var u=function(e){for(var t,r=0,n=0,i=e.length;i>=4;++n,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))+(59797*(t>>>16)<<16),r=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&r)+(59797*(r>>>16)<<16);switch(i){case 3:r^=(255&e.charCodeAt(n+2))<<16;case 2:r^=(255&e.charCodeAt(n+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(n)))+(59797*(r>>>16)<<16)}return(((r=1540483477*(65535&(r^=r>>>13))+(59797*(r>>>16)<<16))^r>>>15)>>>0).toString(36)}(i)+l;return{name:u,styles:i,next:Pe}},Ce="undefined"!=typeof document;function Ae(e,t,r){var n="";return r.split(" ").forEach((function(r){void 0!==e[r]?t.push(e[r]+";"):n+=r+" "})),n}function qe(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function Re(e,t,r){var n=[],i=Ae(e,n,r);return n.length<2?r:i+t(n)}var De=function e(t){for(var r="",n=0;n<t.length;n++){var i=t[n];if(null!=i){var a=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))a=e(i);else for(var o in a="",i)i[o]&&o&&(a&&(a+=" "),a+=o);break;default:a=i}a&&(r&&(r+=" "),r+=a)}}return r},Ne=function(e){var t=ve({key:"css"});t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var r=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=Ie(r,t.registered,void 0);return function(e,t,r){!function(e,t,r){var n=e.key+"-"+t.name;(!1===r||!1===Ce&&void 0!==e.compat)&&void 0===e.registered[n]&&(e.registered[n]=t.styles)}(e,t,r);var n=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var i="",a=t;do{var o=e.insert(t===a?"."+n:"",a,e.sheet,!0);Ce||void 0===o||(i+=o),a=a.next}while(void 0!==a);if(!Ce&&0!==i.length);}}(t,i,!1),t.key+"-"+i.name};return{css:r,cx:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Re(t.registered,r,De(n))},injectGlobal:function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=Ie(r,t.registered);qe(t,i)},keyframes:function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=Ie(r,t.registered),a="animation-"+i.name;return qe(t,{name:i.name,styles:"@keyframes "+a+"{"+i.styles+"}"}),a},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:Ae.bind(null,t.registered),merge:Re.bind(null,t.registered,r)}}(),Le=Ne.css,je=Object.defineProperty,Me=Object.defineProperties,Fe=Object.getOwnPropertyDescriptors,Be=Object.getOwnPropertySymbols,Qe=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable,Ve=(e,t,r)=>t in e?je(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Xe=(e,t)=>{for(var r in t||(t={}))Qe.call(t,r)&&Ve(e,r,t[r]);if(Be)for(var r of Be(t))$e.call(t,r)&&Ve(e,r,t[r]);return e},Ge=(e,t)=>Me(e,Fe(t));const Ue=28,ze=["cloudwatch"],We=e=>({value:e,label:e}),Ke=e=>"string"==typeof e&&d.some((t=>t.value===e)),He=e=>{var t,r,s,p,f,m,h,g;const[y,v]=n.useState(!1),[b,O]=n.useState((e.standardRegions||u).map(We)),{loadRegions:w,onOptionsChange:_,skipHeader:S=!1,skipEndpoint:E=!1}=e,{labelWidth:x=Ue,options:T,inExperimentalAuthComponent:P}=e;let k=T.jsonData.profile;void 0===k&&(k=T.database);const I=o.config.featureToggles.awsDatasourcesTempCredentials&&ze.includes(T.type),C=null==(t=o.config.awsAssumeRoleEnabled)||t,A=n.useMemo((()=>o.config.awsAllowedAuthProviders.filter((e=>e!==c.GrafanaAssumeRole||I)).filter(Ke)),[I]),q=d.find((e=>e.value===T.jsonData.authType));n.useEffect((()=>{!q&&A.length&&_(Ge(Xe({},T),{jsonData:Ge(Xe({},T.jsonData),{authType:A[0]})}))}),[q,T,_,A]),n.useEffect((()=>{w&&w().then((e=>O(e.map(We))))}),[w]);const R=P?"width-20":"width-30",D=i.useStyles2(Ye);return l.default.createElement(i.FieldSet,{label:S?"":"Connection Details","data-testid":"connection-config"},l.default.createElement(i.InlineField,{label:"Authentication Provider",labelWidth:x,tooltip:"Specify which AWS credentials chain to use."},l.default.createElement(i.Select,{"aria-label":"Authentication Provider",className:R,value:q,options:d.filter((e=>A.includes(e.value))),defaultValue:T.jsonData.authType,onChange:t=>{a.onUpdateDatasourceJsonDataOptionSelect(e,"authType")(t)},menuShouldPortal:!0})),"credentials"===T.jsonData.authType&&l.default.createElement(i.InlineField,{label:"Credentials Profile Name",labelWidth:x,tooltip:"Credentials profile name, as specified in ~/.aws/credentials, leave blank for default."},l.default.createElement(i.Input,{"aria-label":"Credentials Profile Name",className:R,placeholder:"default",value:k,onChange:a.onUpdateDatasourceJsonDataOption(e,"profile")})),"keys"===T.jsonData.authType&&l.default.createElement(l.default.Fragment,null,l.default.createElement(i.InlineField,{label:"Access Key ID",labelWidth:x},(null==(r=e.options.secureJsonFields)?void 0:r.accessKey)?l.default.createElement(i.ButtonGroup,{className:R},l.default.createElement(i.Input,{disabled:!0,placeholder:"Configured"}),l.default.createElement(i.ToolbarButton,{icon:"edit",tooltip:"Edit Access Key ID",type:"button",onClick:a.onUpdateDatasourceResetOption(e,"accessKey")})):l.default.createElement(i.Input,{"aria-label":"Access Key ID",className:R,value:null!=(p=null==(s=T.secureJsonData)?void 0:s.accessKey)?p:"",onChange:a.onUpdateDatasourceSecureJsonDataOption(e,"accessKey")})),l.default.createElement(i.InlineField,{label:"Secret Access Key",labelWidth:x},(null==(f=e.options.secureJsonFields)?void 0:f.secretKey)?l.default.createElement(i.ButtonGroup,{className:R},l.default.createElement(i.Input,{disabled:!0,placeholder:"Configured"}),l.default.createElement(i.ToolbarButton,{icon:"edit",type:"button",tooltip:"Edit Secret Access Key",onClick:a.onUpdateDatasourceResetOption(e,"secretKey")})):l.default.createElement(i.Input,{"aria-label":"Secret Access Key",className:R,value:null!=(h=null==(m=T.secureJsonData)?void 0:m.secretKey)?h:"",onChange:a.onUpdateDatasourceSecureJsonDataOption(e,"secretKey")}))),T.jsonData.authType===c.GrafanaAssumeRole&&l.default.createElement("div",{className:D.assumeRoleInstructions},l.default.createElement(i.Collapse,{label:"How to create an IAM role for grafana to assume:",collapsible:!0,isOpen:y,onToggle:()=>v(!y)},l.default.createElement("ol",null,l.default.createElement("li",null,l.default.createElement("p",null,"1. Create a new IAM role in the AWS console, and select ",l.default.createElement("code",null,"Another AWS account")," as the"," ",l.default.createElement("code",null,"Trusted entity"),".")),l.default.createElement("li",null,l.default.createElement("p",null,"2. Enter the account ID of the Grafana account that has permission to assume this role:",l.default.createElement("code",null," 008923505280 ")," and check the ",l.default.createElement("code",null,"Require external ID")," box.")),l.default.createElement("li",null,l.default.createElement("p",null,"3. Enter the following external ID:"," ",l.default.createElement("code",null,e.externalId||"External Id is currently unavailable")," and click ",l.default.createElement("code",null,"Next"),".")),l.default.createElement("li",null,l.default.createElement("p",null,"4. Add any required permissions you would like Grafana to be able to access on your behalf. For more details on our permissions please"," ",l.default.createElement("a",{href:"https://grafana.com/docs/grafana/latest/datasources/aws-cloudwatch/",target:"_blank",rel:"noreferrer"},"read through our documentation"),".")),l.default.createElement("li",null,l.default.createElement("p",null,"5. Give the role a name and description, and click ",l.default.createElement("code",null,"Create role"),".")),l.default.createElement("li",null,l.default.createElement("p",null,"6. Copy the ARN of the role you just created and paste it into the ",l.default.createElement("code",null,"Assume Role ARN")," field below."))))),C&&l.default.createElement(l.default.Fragment,null,l.default.createElement(i.InlineField,{label:"Assume Role ARN",labelWidth:x,tooltip:"Optionally, specify the ARN of a role to assume. Specifying a role here will ensure that the selected authentication provider is used to assume the specified role rather than using the credentials directly. Leave blank if you don't need to assume a role at all"},l.default.createElement(i.Input,{"aria-label":"Assume Role ARN",className:R,placeholder:"arn:aws:iam:*",value:T.jsonData.assumeRoleArn||"",onChange:a.onUpdateDatasourceJsonDataOption(e,"assumeRoleArn")})),T.jsonData.authType!==c.GrafanaAssumeRole&&l.default.createElement(i.InlineField,{label:"External ID",labelWidth:x,tooltip:"If you are assuming a role in another account, that has been created with an external ID, specify the external ID here."},l.default.createElement(i.Input,{"aria-label":"External ID",className:R,placeholder:"External ID",value:T.jsonData.externalId||"",onChange:a.onUpdateDatasourceJsonDataOption(e,"externalId")}))),!E&&T.jsonData.authType!==c.GrafanaAssumeRole&&l.default.createElement(i.InlineField,{label:"Endpoint",labelWidth:x,tooltip:"Optionally, specify a custom endpoint for the service"},l.default.createElement(i.Input,{"aria-label":"Endpoint",className:R,placeholder:null!=(g=e.defaultEndpoint)?g:"https://{service}.{region}.amazonaws.com",value:T.jsonData.endpoint||"",onChange:a.onUpdateDatasourceJsonDataOption(e,"endpoint")})),l.default.createElement(i.InlineField,{label:"Default Region",labelWidth:x,tooltip:"Specify the region, such as for US West (Oregon) use ` us-west-2 ` as the region."},l.default.createElement(i.Select,{"aria-label":"Default Region",className:R,value:b.find((e=>e.value===T.jsonData.defaultRegion)),options:b,defaultValue:T.jsonData.defaultRegion,allowCustomValue:!0,onChange:a.onUpdateDatasourceJsonDataOptionSelect(e,"defaultRegion"),formatCreateLabel:e=>`Use region: ${e}`,menuShouldPortal:!0})),e.children)};function Ye(){return{assumeRoleInstructions:Le({maxWidth:"715px"})}}var Ze=Object.defineProperty,Je=Object.defineProperties,et=Object.getOwnPropertyDescriptors,tt=Object.getOwnPropertySymbols,rt=Object.prototype.hasOwnProperty,nt=Object.prototype.propertyIsEnumerable,it=(e,t,r)=>t in e?Ze(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,at=(e,t)=>{for(var r in t||(t={}))rt.call(t,r)&&it(e,r,t[r]);if(tt)for(var r of tt(t))nt.call(t,r)&&it(e,r,t[r]);return e},ot=(e,t)=>Je(e,et(t));Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;t.IW=e=>{var t,r,n,i;const{onOptionsChange:a,options:o}=e,s={onOptionsChange:e=>{var t,r,n,i;const s=ot(at({},o),{jsonData:ot(at({},o.jsonData),{sigV4AuthType:e.jsonData.authType,sigV4Profile:e.jsonData.profile,sigV4AssumeRoleArn:e.jsonData.assumeRoleArn,sigV4ExternalId:e.jsonData.externalId,sigV4Region:e.jsonData.defaultRegion,sigV4Endpoint:e.jsonData.endpoint}),secureJsonFields:{sigV4AccessKey:null==(t=e.secureJsonFields)?void 0:t.accessKey,sigV4SecretKey:null==(r=e.secureJsonFields)?void 0:r.secretKey},secureJsonData:{sigV4AccessKey:null==(n=e.secureJsonData)?void 0:n.accessKey,sigV4SecretKey:null==(i=e.secureJsonData)?void 0:i.secretKey}});a(s)},options:ot(at({},o),{jsonData:ot(at({},o.jsonData),{authType:o.jsonData.sigV4AuthType,profile:o.jsonData.sigV4Profile,assumeRoleArn:o.jsonData.sigV4AssumeRoleArn,externalId:o.jsonData.sigV4ExternalId,defaultRegion:o.jsonData.sigV4Region,endpoint:o.jsonData.sigV4Endpoint}),secureJsonFields:{accessKey:null==(t=o.secureJsonFields)?void 0:t.sigV4AccessKey,secretKey:null==(r=o.secureJsonFields)?void 0:r.sigV4SecretKey},secureJsonData:{accessKey:null==(n=o.secureJsonData)?void 0:n.sigV4AccessKey,secretKey:null==(i=o.secureJsonData)?void 0:i.sigV4SecretKey}}),inExperimentalAuthComponent:e.inExperimentalAuthComponent};return l.default.createElement(l.default.Fragment,null,l.default.createElement("div",{className:"gf-form"},l.default.createElement("h6",null,"SigV4 Auth Details")),l.default.createElement(He,ot(at({},s),{skipHeader:!0,skipEndpoint:!0})))}},853:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var n,i,a,o,s,l,u,c,d,p,f=r(7388),m=r(2650),h=(n=m)&&"object"==typeof n&&"default"in n?n.default:n,g=r(3305),y=r(3545),v=r(7644),b=function(){return(b=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function O(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function w(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function s(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))}function _(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function S(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function E(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o}function x(e,t,r){if(r||2===arguments.length)for(var n,i=0,a=t.length;i<a;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function T(e,r){var n,i,a,o=null==e?void 0:e.getPreviousNonWhiteSpaceToken(),s=null==e?void 0:e.getPreviousKeyword(),l=null===(a=null==e?void 0:e.getPreviousNonWhiteSpaceToken())||void 0===a?void 0:a.is(t.TokenType.Operator,"/"),u=r.list(),c=[];try{for(var d=S(u),p=d.next();!p.done;p=d.next()){var f=p.value;f.resolve(e,null!=s?s:null,null!=o?o:null,Boolean(l))&&c.push(f.id)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}return 0===c.length?[t.StatementPosition.Unknown]:c}(i=t.OperatorType||(t.OperatorType={}))[i.Comparison=0]="Comparison",i[i.Logical=1]="Logical",(a=t.MacroType||(t.MacroType={}))[a.Value=0]="Value",a[a.Filter=1]="Filter",a[a.Group=2]="Group",a[a.Column=3]="Column",a[a.Table=4]="Table",(o=t.TokenType||(t.TokenType={})).Parenthesis="delimiter.parenthesis.sql",o.Whitespace="white.sql",o.Keyword="keyword.sql",o.Delimiter="delimiter.sql",o.Operator="operator.sql",o.Identifier="identifier.sql",o.IdentifierQuote="identifier.quote.sql",o.Type="type.sql",o.Function="predefined.sql",o.Number="number.sql",o.String="string.sql",o.Variable="variable.sql",(s=t.StatementPosition||(t.StatementPosition={})).Unknown="unknown",s.SelectKeyword="selectKeyword",s.WithKeyword="withKeyword",s.AfterSelectKeyword="afterSelectKeyword",s.AfterSelectArguments="afterSelectArguments",s.AfterSelectFuncFirstArgument="afterSelectFuncFirstArgument",s.SelectAlias="selectAlias",s.AfterFromKeyword="afterFromKeyword",s.AfterTable="afterTable",s.SchemaFuncFirstArgument="schemaFuncFirstArgument",s.SchemaFuncExtraArgument="schemaFuncExtraArgument",s.FromKeyword="fromKeyword",s.AfterFrom="afterFrom",s.WhereKeyword="whereKeyword",s.WhereComparisonOperator="whereComparisonOperator",s.WhereValue="whereValue",s.AfterWhereFunctionArgument="afterWhereFunctionArgument",s.AfterGroupByFunctionArgument="afterGroupByFunctionArgument",s.AfterWhereValue="afterWhereValue",s.AfterGroupByKeywords="afterGroupByKeywords",s.AfterGroupBy="afterGroupBy",s.AfterOrderByKeywords="afterOrderByKeywords",s.AfterOrderByFunction="afterOrderByFunction",s.AfterOrderByDirection="afterOrderByDirection",s.AfterIsOperator="afterIsOperator",s.AfterIsNotOperator="afterIsNotOperator",s.AfterSchema="afterSchema",(l=t.SuggestionKind||(t.SuggestionKind={})).Schemas="schemas",l.Tables="tables",l.Columns="columns",l.SelectKeyword="selectKeyword",l.WithKeyword="withKeyword",l.FunctionsWithArguments="functionsWithArguments",l.FromKeyword="fromKeyword",l.WhereKeyword="whereKeyword",l.GroupByKeywords="groupByKeywords",l.OrderByKeywords="orderByKeywords",l.FunctionsWithoutArguments="functionsWithoutArguments",l.LimitKeyword="limitKeyword",l.SortOrderDirectionKeyword="sortOrderDirectionKeyword",l.ComparisonOperators="comparisonOperators",l.LogicalOperators="logicalOperators",l.SelectMacro="selectMacro",l.TableMacro="tableMacro",l.FilterMacro="filterMacro",l.GroupMacro="groupMacro",l.BoolValues="boolValues",l.NullValue="nullValue",l.NotKeyword="notKeyword",l.TemplateVariables="templateVariables",l.StarWildCard="starWildCard",(u=t.CompletionItemPriority||(t.CompletionItemPriority={})).High="a",u.MediumHigh="d",u.Medium="g",u.MediumLow="k",u.Low="q",(c=t.CompletionItemKind||(t.CompletionItemKind={}))[c.Method=0]="Method",c[c.Function=1]="Function",c[c.Constructor=2]="Constructor",c[c.Field=3]="Field",c[c.Variable=4]="Variable",c[c.Class=5]="Class",c[c.Struct=6]="Struct",c[c.Interface=7]="Interface",c[c.Module=8]="Module",c[c.Property=9]="Property",c[c.Event=10]="Event",c[c.Operator=11]="Operator",c[c.Unit=12]="Unit",c[c.Value=13]="Value",c[c.Constant=14]="Constant",c[c.Enum=15]="Enum",c[c.EnumMember=16]="EnumMember",c[c.Keyword=17]="Keyword",c[c.Text=18]="Text",c[c.Color=19]="Color",c[c.File=20]="File",c[c.Reference=21]="Reference",c[c.Customcolor=22]="Customcolor",c[c.Folder=23]="Folder",c[c.TypeParameter=24]="TypeParameter",c[c.User=25]="User",c[c.Issue=26]="Issue",c[c.Snippet=27]="Snippet",(d=t.CompletionItemInsertTextRule||(t.CompletionItemInsertTextRule={}))[d.KeepWhitespace=1]="KeepWhitespace",d[d.InsertAsSnippet=4]="InsertAsSnippet",(p=t.EditorMode||(t.EditorMode={})).Builder="builder",p.Code="code";var P=function(e,r,n,i,a){return w(void 0,void 0,void 0,(function(){var o,s,l,u,c,d,p,f,m,h,g;return _(this,(function(y){switch(y.label){case 0:o=[],s=(null==r?void 0:r.isWhiteSpace())||(null==r?void 0:r.isParenthesis())||(null==r?void 0:r.isIdentifier())&&r.value.endsWith("."),l=s||!(null==r?void 0:r.range)?e.Range.fromPositions(i.position):null==r?void 0:r.range,y.label=1;case 1:y.trys.push([1,6,7,8]),u=S(x([],E(new Set(n)),!1)),c=u.next(),y.label=2;case 2:return c.done?[3,5]:(d=c.value,(p=a.getIfExists(d))?[4,p.suggestions(b(b({},i),{range:l}),e)]:[3,4]);case 3:f=y.sent(),o=x(x([],E(o),!1),E(f.map((function(e){return function(e,r,n){return void 0===n&&(n={}),b({label:e,insertText:e,kind:t.CompletionItemKind.Field,sortText:t.CompletionItemPriority.Medium,range:r},n)}(e.label,l,b({kind:e.kind},e))}))),!1),y.label=4;case 4:return c=u.next(),[3,2];case 5:return[3,8];case 6:return m=y.sent(),h={error:m},[3,8];case 7:try{c&&!c.done&&(g=u.return)&&g.call(u)}finally{if(h)throw h.error}return[7];case 8:return[2,Promise.resolve(o)]}}))}))},k=function(){return[{id:t.StatementPosition.SelectKeyword,name:t.StatementPosition.SelectKeyword,kind:[t.SuggestionKind.SelectKeyword]},{id:t.StatementPosition.WithKeyword,name:t.StatementPosition.WithKeyword,kind:[t.SuggestionKind.WithKeyword]},{id:t.StatementPosition.AfterSelectKeyword,name:t.StatementPosition.AfterSelectKeyword,kind:[t.SuggestionKind.StarWildCard,t.SuggestionKind.FunctionsWithArguments,t.SuggestionKind.Columns,t.SuggestionKind.SelectMacro]},{id:t.StatementPosition.AfterSelectFuncFirstArgument,name:t.StatementPosition.AfterSelectFuncFirstArgument,kind:[t.SuggestionKind.Columns]},{id:t.StatementPosition.AfterGroupByFunctionArgument,name:t.StatementPosition.AfterGroupByFunctionArgument,kind:[t.SuggestionKind.Columns]},{id:t.StatementPosition.AfterWhereFunctionArgument,name:t.StatementPosition.AfterWhereFunctionArgument,kind:[t.SuggestionKind.Columns]},{id:t.StatementPosition.AfterSelectArguments,name:t.StatementPosition.AfterSelectArguments,kind:[t.SuggestionKind.Columns]},{id:t.StatementPosition.AfterFromKeyword,name:t.StatementPosition.AfterFromKeyword,kind:[t.SuggestionKind.Schemas,t.SuggestionKind.Tables,t.SuggestionKind.TableMacro]},{id:t.StatementPosition.AfterSchema,name:t.StatementPosition.AfterSchema,kind:[t.SuggestionKind.Tables,t.SuggestionKind.TableMacro]},{id:t.StatementPosition.SelectAlias,name:t.StatementPosition.SelectAlias,kind:[t.SuggestionKind.Columns,t.SuggestionKind.FunctionsWithArguments]},{id:t.StatementPosition.FromKeyword,name:t.StatementPosition.FromKeyword,kind:[t.SuggestionKind.FromKeyword]},{id:t.StatementPosition.AfterFrom,name:t.StatementPosition.AfterFrom,kind:[t.SuggestionKind.WhereKeyword,t.SuggestionKind.GroupByKeywords,t.SuggestionKind.OrderByKeywords,t.SuggestionKind.LimitKeyword]},{id:t.StatementPosition.AfterTable,name:t.StatementPosition.AfterTable,kind:[t.SuggestionKind.WhereKeyword,t.SuggestionKind.GroupByKeywords,t.SuggestionKind.OrderByKeywords,t.SuggestionKind.LimitKeyword]},{id:t.StatementPosition.WhereKeyword,name:t.StatementPosition.WhereKeyword,kind:[t.SuggestionKind.Columns,t.SuggestionKind.FilterMacro,t.SuggestionKind.TemplateVariables]},{id:t.StatementPosition.WhereComparisonOperator,name:t.StatementPosition.WhereComparisonOperator,kind:[t.SuggestionKind.ComparisonOperators]},{id:t.StatementPosition.WhereValue,name:t.StatementPosition.WhereValue,kind:[t.SuggestionKind.FilterMacro,t.SuggestionKind.TemplateVariables]},{id:t.StatementPosition.AfterWhereValue,name:t.StatementPosition.AfterWhereValue,kind:[t.SuggestionKind.LogicalOperators,t.SuggestionKind.GroupByKeywords,t.SuggestionKind.OrderByKeywords,t.SuggestionKind.LimitKeyword,t.SuggestionKind.Columns,t.SuggestionKind.TemplateVariables]},{id:t.StatementPosition.AfterGroupByKeywords,name:t.StatementPosition.AfterGroupByKeywords,kind:[t.SuggestionKind.GroupMacro,t.SuggestionKind.Columns]},{id:t.StatementPosition.AfterGroupBy,name:t.StatementPosition.AfterGroupBy,kind:[t.SuggestionKind.OrderByKeywords,t.SuggestionKind.LimitKeyword]},{id:t.StatementPosition.AfterOrderByKeywords,name:t.StatementPosition.AfterOrderByKeywords,kind:[t.SuggestionKind.Columns]},{id:t.StatementPosition.AfterOrderByFunction,name:t.StatementPosition.AfterOrderByFunction,kind:[t.SuggestionKind.SortOrderDirectionKeyword,t.SuggestionKind.LimitKeyword]},{id:t.StatementPosition.AfterOrderByDirection,name:t.StatementPosition.AfterOrderByDirection,kind:[t.SuggestionKind.LimitKeyword]},{id:t.StatementPosition.AfterIsOperator,name:t.StatementPosition.AfterOrderByDirection,kind:[t.SuggestionKind.NotKeyword,t.SuggestionKind.NullValue,t.SuggestionKind.BoolValues]},{id:t.StatementPosition.AfterIsNotOperator,name:t.StatementPosition.AfterOrderByDirection,kind:[t.SuggestionKind.NullValue,t.SuggestionKind.BoolValues]}]},I=function(){function e(e,t,r,n,i){this.type=e,this.value=t,this.range=r,this.previous=n,this.next=i}return e.prototype.isKeyword=function(){return this.type===t.TokenType.Keyword},e.prototype.isWhiteSpace=function(){return this.type===t.TokenType.Whitespace},e.prototype.isParenthesis=function(){return this.type===t.TokenType.Parenthesis},e.prototype.isIdentifier=function(){return this.type===t.TokenType.Identifier},e.prototype.isString=function(){return this.type===t.TokenType.String},e.prototype.isNumber=function(){return this.type===t.TokenType.Number},e.prototype.isDoubleQuotedString=function(){return this.type===t.TokenType.Type},e.prototype.isVariable=function(){return this.type===t.TokenType.Variable},e.prototype.isFunction=function(){return this.type===t.TokenType.Function},e.prototype.isOperator=function(){return this.type===t.TokenType.Operator},e.prototype.isTemplateVariable=function(){return this.type===t.TokenType.Variable},e.prototype.is=function(e,t){var r=this.type===e;return void 0!==t?r&&C(e,this,t):r},e.prototype.getPreviousNonWhiteSpaceToken=function(){for(var e=this.previous;null!=e;){if(!e.isWhiteSpace())return e;e=e.previous}return null},e.prototype.getPreviousOfType=function(e,t){for(var r=this.previous;null!=r;){var n=r.type===e;if(void 0!==t?n&&C(e,r,t):n)return r;r=r.previous}return null},e.prototype.getPreviousUntil=function(e,t,r){for(var n=[],i=this.previous;null!=i;)if(t.some((function(e){return e===(null==i?void 0:i.type)})))i=i.previous;else{var a=i.type===e;if(void 0!==r?a&&C(e,i,r):a)return n;i.isWhiteSpace()||n.push(i),i=i.previous}return n},e.prototype.getNextUntil=function(e,t,r){for(var n=[],i=this.next;null!=i;)if(t.some((function(e){return e===(null==i?void 0:i.type)})))i=i.next;else{var a=i.type===e;if(void 0!==r?a&&C(e,i,r):a)return n;i.isWhiteSpace()||n.push(i),i=i.next}return n},e.prototype.getPreviousKeyword=function(){for(var e=this.previous;null!=e;){if(e.isKeyword())return e;e=e.previous}return null},e.prototype.getNextNonWhiteSpaceToken=function(){for(var e=this.next;null!=e;){if(!e.isWhiteSpace())return e;e=e.next}return null},e.prototype.getNextOfType=function(e,t){for(var r=this.next;null!=r;){var n=r.type===e;if(void 0!==t?n&&C(e,r,t):n)return r;r=r.next}return null},e}();function C(e,r,n){return e===t.TokenType.Keyword||e===t.TokenType.Operator?r.value.toLowerCase()===n.toString().toLowerCase():r.value===n}function A(e,r,n,i){var a;void 0===i&&(i="sql");for(var o=null,s=null,l=e.editor.tokenize(null!==(a=r.getValue())&&void 0!==a?a:"",i),u=0;u<l.length;u++){var c=l[u];if(!c.length&&s){var d={offset:0,type:t.TokenType.Whitespace,language:i,_tokenBrand:void 0};c.push(d)}for(var p=0;p<c.length;p++){d=c[p];var f=c.length>p+1?c[p+1].offset+1:r.getLineLength(u+1)+1,m={startLineNumber:u+1,startColumn:0===d.offset?0:d.offset+1,endLineNumber:u+1,endColumn:f},h=r.getValueInRange(m),g=new I(d.type,h,m,s,null);e.Range.containsPosition(m,n)&&(o=g),s&&(s.next=g),s=g}}return o}var q,R="select",D="from",N="by",L="desc",j="asc",M=["=","!="],F=x([],E(M),!1),B={comments:{lineComment:"--",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}]},Q={defaultToken:"",tokenPostfix:".sql",ignoreCase:!0,brackets:[{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"}],keywords:["ABORT","ABSOLUTE","ACTION","ADA","ADD","AFTER","ALL","ALLOCATE","ALTER","ALWAYS","ANALYZE","AND","ANY","ARE","AS","ASC","ASSERTION","AT","ATTACH","AUTHORIZATION","AUTOINCREMENT","AVG","BACKUP","BEFORE","BEGIN","BETWEEN","BIT","BIT_LENGTH","BOTH","BREAK","BROWSE","BULK","BY","CASCADE","CASCADED","CASE","CAST","CATALOG","CHAR","CHARACTER","CHARACTER_LENGTH","CHAR_LENGTH","CHECK","CHECKPOINT","CLOSE","CLUSTERED","COALESCE","COLLATE","COLLATION","COLUMN","COMMIT","COMPUTE","CONFLICT","CONNECT","CONNECTION","CONSTRAINT","CONSTRAINTS","CONTAINS","CONTAINSTABLE","CONTINUE","CONVERT","CORRESPONDING","COUNT","CREATE","CROSS","CURRENT","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DATE","DAY","DBCC","DEALLOCATE","DEC","DECIMAL","DECLARE","DEFAULT","DEFERRABLE","DEFERRED","DELETE","DENY","DESC","DESCRIBE","DESCRIPTOR","DETACH","DIAGNOSTICS","DISCONNECT","DISK","DISTINCT","DISTRIBUTED","DO","DOMAIN","DOUBLE","DROP","DUMP","EACH","ELSE","END","END-EXEC","ERRLVL","ESCAPE","EXCEPT","EXCEPTION","EXCLUDE","EXCLUSIVE","EXEC","EXECUTE","EXISTS","EXIT","EXPLAIN","EXTERNAL","EXTRACT","FAIL","FALSE","FETCH","FILE","FILLFACTOR","FILTER","FIRST","FLOAT","FOLLOWING","FOR","FOREIGN","FORTRAN","FOUND","FREETEXT","FREETEXTTABLE","FROM","FULL","FUNCTION","GENERATED","GET","GLOB","GLOBAL","GO","GOTO","GRANT","GROUP","GROUPS","HAVING","HOLDLOCK","HOUR","IDENTITY","IDENTITYCOL","IDENTITY_INSERT","IF","IGNORE","IMMEDIATE","IN","INCLUDE","INDEX","INDEXED","INDICATOR","INITIALLY","INNER","INPUT","INSENSITIVE","INSERT","INSTEAD","INT","INTEGER","INTERSECT","INTERVAL","INTO","IS","ISNULL","ISOLATION","JOIN","KEY","KILL","LANGUAGE","LAST","LEADING","LEFT","LEVEL","LIKE","LIMIT","LINENO","LOAD","LOCAL","LOWER","MATCH","MATERIALIZED","MAX","MERGE","MIN","MINUTE","MODULE","MONTH","NAMES","NATIONAL","NATURAL","NCHAR","NEXT","NO","NOCHECK","NONCLUSTERED","NONE","NOT","NOTHING","NOTNULL","NULL","NULLIF","NULLS","NUMERIC","OCTET_LENGTH","OF","OFF","OFFSET","OFFSETS","ON","ONLY","OPEN","OPENDATASOURCE","OPENQUERY","OPENROWSET","OPENXML","OPTION","OR","ORDER","OTHERS","OUTER","OUTPUT","OVER","OVERLAPS","PAD","PARTIAL","PARTITION","PASCAL","PERCENT","PIVOT","PLAN","POSITION","PRAGMA","PRECEDING","PRECISION","PREPARE","PRESERVE","PRIMARY","PRINT","PRIOR","PRIVILEGES","PROC","PROCEDURE","PUBLIC","QUERY","RAISE","RAISERROR","RANGE","READ","READTEXT","REAL","RECONFIGURE","RECURSIVE","REFERENCES","REGEXP","REINDEX","RELATIVE","RELEASE","RENAME","REPLACE","REPLICATION","RESTORE","RESTRICT","RETURN","RETURNING","REVERT","REVOKE","RIGHT","ROLLBACK","ROW","ROWCOUNT","ROWGUIDCOL","ROWS","RULE","SAVE","SAVEPOINT","SCHEMA","SCROLL","SECOND","SECTION","SECURITYAUDIT","SELECT","SEMANTICKEYPHRASETABLE","SEMANTICSIMILARITYDETAILSTABLE","SEMANTICSIMILARITYTABLE","SESSION","SESSION_USER","SET","SETUSER","SHUTDOWN","SIZE","SMALLINT","SOME","SPACE","SQL","SQLCA","SQLCODE","SQLERROR","SQLSTATE","SQLWARNING","STATISTICS","SUBSTRING","SUM","SYSTEM_USER","TABLE","TABLESAMPLE","TEMP","TEMPORARY","TEXTSIZE","THEN","TIES","TIME","TIMESTAMP","TIMEZONE_HOUR","TIMEZONE_MINUTE","TO","TOP","TRAILING","TRAN","TRANSACTION","TRANSLATE","TRANSLATION","TRIGGER","TRIM","TRUE","TRUNCATE","TRY_CONVERT","TSEQUAL","UNBOUNDED","UNION","UNIQUE","UNKNOWN","UNPIVOT","UPDATE","UPDATETEXT","UPPER","USAGE","USE","USER","USING","VACUUM","VALUE","VALUES","VARCHAR","VARYING","VIEW","VIRTUAL","WAITFOR","WHEN","WHENEVER","WHERE","WHILE","WINDOW","WITH","WITHIN GROUP","WITHOUT","WORK","WRITE","WRITETEXT","YEAR","ZONE"],operators:["EXCEPT","INTERSECT","UNION","APPLY","CROSS","FULL","INNER","JOIN","LEFT","OUTER","RIGHT","CONTAINS","FREETEXT","IS","NULL","PIVOT","UNPIVOT","MATCHED"],logicalOperators:["ALL","AND","ANY","BETWEEN","EXISTS","IN","LIKE","NOT","OR","SOME"],comparisonOperators:["<>",">","<",">=","<=","=","!=","&","~","^","%"],builtinFunctions:["AVG","CHECKSUM_AGG","COUNT","COUNT_BIG","GROUPING","GROUPING_ID","MAX","MIN","SUM","STDEV","STDEVP","VAR","VARP","CUME_DIST","FIRST_VALUE","LAG","LAST_VALUE","LEAD","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","COLLATE","COLLATIONPROPERTY","TERTIARY_WEIGHTS","FEDERATION_FILTERING_VALUE","CAST","CONVERT","PARSE","TRY_CAST","TRY_CONVERT","TRY_PARSE","ASYMKEY_ID","ASYMKEYPROPERTY","CERTPROPERTY","CERT_ID","CRYPT_GEN_RANDOM","DECRYPTBYASYMKEY","DECRYPTBYCERT","DECRYPTBYKEY","DECRYPTBYKEYAUTOASYMKEY","DECRYPTBYKEYAUTOCERT","DECRYPTBYPASSPHRASE","ENCRYPTBYASYMKEY","ENCRYPTBYCERT","ENCRYPTBYKEY","ENCRYPTBYPASSPHRASE","HASHBYTES","IS_OBJECTSIGNED","KEY_GUID","KEY_ID","KEY_NAME","SIGNBYASYMKEY","SIGNBYCERT","SYMKEYPROPERTY","VERIFYSIGNEDBYCERT","VERIFYSIGNEDBYASYMKEY","CURSOR_STATUS","DATALENGTH","IDENT_CURRENT","IDENT_INCR","IDENT_SEED","IDENTITY","SQL_VARIANT_PROPERTY","CURRENT_TIMESTAMP","DATEADD","DATEDIFF","DATEFROMPARTS","DATENAME","DATEPART","DATETIME2FROMPARTS","DATETIMEFROMPARTS","DATETIMEOFFSETFROMPARTS","DAY","EOMONTH","GETDATE","GETUTCDATE","ISDATE","MONTH","SMALLDATETIMEFROMPARTS","SWITCHOFFSET","SYSDATETIME","SYSDATETIMEOFFSET","SYSUTCDATETIME","TIMEFROMPARTS","TODATETIMEOFFSET","YEAR","CHOOSE","COALESCE","IIF","NULLIF","ABS","ACOS","ASIN","ATAN","ATN2","CEILING","COS","COT","DEGREES","EXP","FLOOR","LOG","LOG10","PI","POWER","RADIANS","RAND","ROUND","SIGN","SIN","SQRT","SQUARE","TAN","APP_NAME","APPLOCK_MODE","APPLOCK_TEST","ASSEMBLYPROPERTY","COL_LENGTH","COL_NAME","COLUMNPROPERTY","DATABASE_PRINCIPAL_ID","DATABASEPROPERTYEX","DB_ID","DB_NAME","FILE_ID","FILE_IDEX","FILE_NAME","FILEGROUP_ID","FILEGROUP_NAME","FILEGROUPPROPERTY","FILEPROPERTY","FULLTEXTCATALOGPROPERTY","FULLTEXTSERVICEPROPERTY","INDEX_COL","INDEXKEY_PROPERTY","INDEXPROPERTY","OBJECT_DEFINITION","OBJECT_ID","OBJECT_NAME","OBJECT_SCHEMA_NAME","OBJECTPROPERTY","OBJECTPROPERTYEX","ORIGINAL_DB_NAME","PARSENAME","SCHEMA_ID","SCHEMA_NAME","SCOPE_IDENTITY","SERVERPROPERTY","STATS_DATE","TYPE_ID","TYPE_NAME","TYPEPROPERTY","DENSE_RANK","NTILE","RANK","ROW_NUMBER","PUBLISHINGSERVERNAME","OPENDATASOURCE","OPENQUERY","OPENROWSET","OPENXML","CERTENCODED","CERTPRIVATEKEY","CURRENT_USER","HAS_DBACCESS","HAS_PERMS_BY_NAME","IS_MEMBER","IS_ROLEMEMBER","IS_SRVROLEMEMBER","LOGINPROPERTY","ORIGINAL_LOGIN","PERMISSIONS","PWDENCRYPT","PWDCOMPARE","SESSION_USER","SESSIONPROPERTY","SUSER_ID","SUSER_NAME","SUSER_SID","SUSER_SNAME","SYSTEM_USER","USER","USER_ID","USER_NAME","ASCII","CHAR","CHARINDEX","CONCAT","DIFFERENCE","FORMAT","LEFT","LEN","LOWER","LTRIM","NCHAR","PATINDEX","QUOTENAME","REPLACE","REPLICATE","REVERSE","RIGHT","RTRIM","SOUNDEX","SPACE","STR","STUFF","SUBSTRING","UNICODE","UPPER","BINARY_CHECKSUM","CHECKSUM","CONNECTIONPROPERTY","CONTEXT_INFO","CURRENT_REQUEST_ID","ERROR_LINE","ERROR_NUMBER","ERROR_MESSAGE","ERROR_PROCEDURE","ERROR_SEVERITY","ERROR_STATE","FORMATMESSAGE","GETANSINULL","GET_FILESTREAM_TRANSACTION_CONTEXT","HOST_ID","HOST_NAME","ISNULL","ISNUMERIC","MIN_ACTIVE_ROWVERSION","NEWID","NEWSEQUENTIALID","ROWCOUNT_BIG","XACT_STATE","TEXTPTR","TEXTVALID","COLUMNS_UPDATED","EVENTDATA","TRIGGER_NESTLEVEL","UPDATE","CHANGETABLE","CHANGE_TRACKING_CONTEXT","CHANGE_TRACKING_CURRENT_VERSION","CHANGE_TRACKING_IS_COLUMN_IN_MASK","CHANGE_TRACKING_MIN_VALID_VERSION","CONTAINSTABLE","FREETEXTTABLE","SEMANTICKEYPHRASETABLE","SEMANTICSIMILARITYDETAILSTABLE","SEMANTICSIMILARITYTABLE","FILETABLEROOTPATH","GETFILENAMESPACEPATH","GETPATHLOCATOR","PATHNAME","GET_TRANSMISSION_STATUS"],builtinVariables:["@@DATEFIRST","@@DBTS","@@LANGID","@@LANGUAGE","@@LOCK_TIMEOUT","@@MAX_CONNECTIONS","@@MAX_PRECISION","@@NESTLEVEL","@@OPTIONS","@@REMSERVER","@@SERVERNAME","@@SERVICENAME","@@SPID","@@TEXTSIZE","@@VERSION","@@CURSOR_ROWS","@@FETCH_STATUS","@@DATEFIRST","@@PROCID","@@ERROR","@@IDENTITY","@@ROWCOUNT","@@TRANCOUNT","@@CONNECTIONS","@@CPU_BUSY","@@IDLE","@@IO_BUSY","@@PACKET_ERRORS","@@PACK_RECEIVED","@@PACK_SENT","@@TIMETICKS","@@TOTAL_ERRORS","@@TOTAL_READ","@@TOTAL_WRITE"],pseudoColumns:["$ACTION","$IDENTITY","$ROWGUID","$PARTITION"],tokenizer:{root:[{include:"@templateVariables"},{include:"@macros"},{include:"@comments"},{include:"@whitespace"},{include:"@pseudoColumns"},{include:"@numbers"},{include:"@strings"},{include:"@complexIdentifiers"},{include:"@scopes"},{include:"@schemaTable"},[/[;,.]/,"delimiter"],[/[()]/,"@brackets"],[/[\w@#$|<|>|=|!|%|&|+|\|-|*|/|~|^]+/,{cases:{"@operators":"operator","@comparisonOperators":"operator","@logicalOperators":"operator","@builtinVariables":"predefined","@builtinFunctions":"predefined","@keywords":"keyword","@default":"identifier"}}]],templateVariables:[[/\$[a-zA-Z0-9]+/,"variable"]],macros:[[/\$__[a-zA-Z0-9-_]+/,"type"]],schemaTable:[[/(\w+)\./,"identifier"],[/(\w+\.\w+)/,"identifier"]],whitespace:[[/\s+/,"white"]],comments:[[/--+.*/,"comment"],[/\/\*/,{token:"comment.quote",next:"@comment"}]],comment:[[/[^*/]+/,"comment"],[/\*\//,{token:"comment.quote",next:"@pop"}],[/./,"comment"]],pseudoColumns:[[/[$][A-Za-z_][\w@#$]*/,{cases:{"@pseudoColumns":"predefined","@default":"identifier"}}]],numbers:[[/0[xX][0-9a-fA-F]*/,"number"],[/[$][+-]*\d*(\.\d*)?/,"number"],[/((\d+(\.\d*)?)|(\.\d+))([eE][\-+]?\d+)?/,"number"]],strings:[[/N'/,{token:"string",next:"@string"}],[/'/,{token:"string",next:"@string"}]],string:[[/[^']+/,"string"],[/''/,"string"],[/'/,{token:"string",next:"@pop"}]],complexIdentifiers:[[/\[/,{token:"identifier.quote",next:"@bracketedIdentifier"}],[/"/,{token:"identifier.quote",next:"@quotedIdentifier"}]],bracketedIdentifier:[[/[^\]]+/,"identifier"],[/]]/,"identifier"],[/]/,{token:"identifier.quote",next:"@pop"}]],quotedIdentifier:[[/[^"]+/,"identifier"],[/""/,"identifier"],[/"/,{token:"identifier.quote",next:"@pop"}]],scopes:[[/BEGIN\s+(DISTRIBUTED\s+)?TRAN(SACTION)?\b/i,"keyword"],[/BEGIN\s+TRY\b/i,{token:"keyword.try"}],[/END\s+TRY\b/i,{token:"keyword.try"}],[/BEGIN\s+CATCH\b/i,{token:"keyword.catch"}],[/END\s+CATCH\b/i,{token:"keyword.catch"}],[/(BEGIN|CASE)\b/i,{token:"keyword.block"}],[/END\b/i,{token:"keyword.block"}],[/WHEN\b/i,{token:"keyword.choice"}],[/THEN\b/i,{token:"keyword.choice"}]]}},$=Object.freeze({__proto__:null,SELECT:R,FROM:D,WHERE:"where",GROUP:"group",ORDER:"order",BY:N,DESC:L,ASC:j,LIMIT:"limit",WITH:"with",AS:"as",SCHEMA:"schema",AND:"AND",OR:"OR",LOGICAL_OPERATORS:["AND","OR"],EQUALS:"=",NOT_EQUALS:"!=",COMPARISON_OPERATORS:M,STD_OPERATORS:F,conf:B,language:Q}),V=function(e){var r,n=function(e){var r=function(e){var r;return null!==(r=null==e?void 0:e.getPreviousOfType(t.TokenType.Keyword,R))&&void 0!==r?r:null}(e);return null==r?void 0:r.getNextOfType(t.TokenType.Keyword,D)}(e),i=null==n?void 0:n.getNextNonWhiteSpaceToken();return(null==i?void 0:i.isVariable())||(null==i?void 0:i.isKeyword())&&(null===(r=i.next)||void 0===r?void 0:r.is(t.TokenType.Parenthesis,"("))?null:i},X=function(e){var t=null==e?void 0:e.value.split(".");return 1===(null==t?void 0:t.length)?{table:t[0]}:2===(null==t?void 0:t.length)?{schema:t[0],table:t[1]}:null},G={id:"editor.action.triggerSuggest",title:""},U=new Uint8Array(16);function z(){if(!q&&!(q="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return q(U)}for(var W=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,K=[],H=0;H<256;++H)K.push((H+256).toString(16).substr(1));function Y(e,t,r){var n=(e=e||{}).random||(e.rng||z)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=n[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(K[e[t+0]]+K[e[t+1]]+K[e[t+2]]+K[e[t+3]]+"-"+K[e[t+4]]+K[e[t+5]]+"-"+K[e[t+6]]+K[e[t+7]]+"-"+K[e[t+8]]+K[e[t+9]]+"-"+K[e[t+10]]+K[e[t+11]]+K[e[t+12]]+K[e[t+13]]+K[e[t+14]]+K[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&W.test(e)}(r))throw TypeError("Stringified UUID is invalid");return r}(n)}function Z(e){return{label:e.name,insertText:"".concat("\\"+e.text).concat(J(e.args)," "),insertTextRules:t.CompletionItemInsertTextRule.InsertAsSnippet,kind:t.CompletionItemKind.Snippet,documentation:e.description,command:G}}function J(e){return e?"(".concat(e.map((function(e,t){return"${".concat(t,":").concat(e,"}")})).join(", ")).concat(")"):"()"}function ee(){return[{id:t.StatementPosition.SelectKeyword,name:t.StatementPosition.SelectKeyword,resolve:function(e,r,n,i){return Boolean(null===e||e.isWhiteSpace()&&null===e.previous||e.is(t.TokenType.Keyword,R)||e.is(t.TokenType.Keyword,R)&&null===e.previous||i||e.isIdentifier()&&(i||null===(null==e?void 0:e.previous))||e.isIdentifier()&&R.startsWith(e.value.toLowerCase()))}},{id:t.StatementPosition.WithKeyword,name:t.StatementPosition.WithKeyword,resolve:function(e,r,n,i){return Boolean(null===e||e.isWhiteSpace()&&null===e.previous||e.is(t.TokenType.Keyword,"with")&&null===e.previous||e.isIdentifier()&&"with".toLowerCase().startsWith(e.value.toLowerCase()))}},{id:t.StatementPosition.AfterSelectKeyword,name:t.StatementPosition.AfterSelectKeyword,resolve:function(e,t,r,n){return Boolean((null==r?void 0:r.value.toLowerCase())===R)}},{id:t.StatementPosition.AfterSelectArguments,name:t.StatementPosition.AfterSelectArguments,resolve:function(e,t,r,n){return Boolean((null==t?void 0:t.value.toLowerCase())===R&&","===(null==r?void 0:r.value))}},{id:t.StatementPosition.AfterSelectFuncFirstArgument,name:t.StatementPosition.AfterSelectFuncFirstArgument,resolve:function(e,r,n,i){return Boolean(((null==r?void 0:r.value.toLowerCase())===R||"as"===(null==r?void 0:r.value.toLowerCase()))&&((null==n?void 0:n.is(t.TokenType.Parenthesis,"("))||(null==e?void 0:e.is(t.TokenType.Parenthesis,"()"))))}},{id:t.StatementPosition.AfterWhereFunctionArgument,name:t.StatementPosition.AfterWhereFunctionArgument,resolve:function(e,r,n,i){return Boolean((null==r?void 0:r.is(t.TokenType.Keyword,"where"))&&((null==n?void 0:n.is(t.TokenType.Parenthesis,"("))||(null==e?void 0:e.is(t.TokenType.Parenthesis,"()"))))}},{id:t.StatementPosition.AfterGroupBy,name:t.StatementPosition.AfterGroupBy,resolve:function(e,r,n,i){var a;return Boolean((null==r?void 0:r.is(t.TokenType.Keyword,N))&&(null===(a=null==r?void 0:r.getPreviousKeyword())||void 0===a?void 0:a.is(t.TokenType.Keyword,"group"))&&((null==n?void 0:n.isIdentifier())||(null==n?void 0:n.isDoubleQuotedString())||(null==n?void 0:n.is(t.TokenType.Parenthesis,")"))||(null==n?void 0:n.is(t.TokenType.Parenthesis,"()"))))}},{id:t.StatementPosition.SelectAlias,name:t.StatementPosition.SelectAlias,resolve:function(e,t,r,n){return","===(null==r?void 0:r.value)&&"as"===(null==t?void 0:t.value.toLowerCase())}},{id:t.StatementPosition.FromKeyword,name:t.StatementPosition.FromKeyword,resolve:function(e,t,r,n){return Boolean((null==t?void 0:t.value.toLowerCase())===R&&","!==(null==r?void 0:r.value)||((null==e?void 0:e.isKeyword())||(null==e?void 0:e.isIdentifier()))&&D.toLowerCase().startsWith(e.value.toLowerCase()))}},{id:t.StatementPosition.AfterFromKeyword,name:t.StatementPosition.AfterFromKeyword,resolve:function(e,t,r,n){return Boolean(!(null==e?void 0:e.value.includes("."))&&(null==r?void 0:r.value.toLowerCase())===D)}},{id:t.StatementPosition.AfterSchema,name:t.StatementPosition.AfterSchema,resolve:function(e,t,r,n){return(null==e?void 0:e.isWhiteSpace())&&(null==e?void 0:e.next)&&(r=null==(e=null==e?void 0:e.previous)?void 0:e.getPreviousNonWhiteSpaceToken()),Boolean((null==e?void 0:e.isIdentifier())&&(null==e?void 0:e.value.endsWith("."))&&(null==r?void 0:r.value.toLowerCase())===D)}},{id:t.StatementPosition.AfterFrom,name:t.StatementPosition.AfterFrom,resolve:function(e,t,r,n){return Boolean((null==t?void 0:t.value.toLowerCase())===D&&(null==r?void 0:r.isDoubleQuotedString())||(null==t?void 0:t.value.toLowerCase())===D&&(null==r?void 0:r.isIdentifier())||(null==t?void 0:t.value.toLowerCase())===D&&(null==r?void 0:r.isVariable()))}},{id:t.StatementPosition.AfterTable,name:t.StatementPosition.AfterTable,resolve:function(e,t,r,n){return Boolean((null==t?void 0:t.value.toLowerCase())===D&&((null==r?void 0:r.isVariable())||""!==(null==r?void 0:r.value)&&(null==r?void 0:r.value.toLowerCase())!==D))}},{id:t.StatementPosition.WhereKeyword,name:t.StatementPosition.WhereKeyword,resolve:function(e,r,n,i){return Boolean("where"===(null==r?void 0:r.value.toLowerCase())&&((null==n?void 0:n.isKeyword())||(null==n?void 0:n.is(t.TokenType.Parenthesis,"("))||(null==n?void 0:n.is(t.TokenType.Operator,"AND"))))}},{id:t.StatementPosition.WhereComparisonOperator,name:t.StatementPosition.WhereComparisonOperator,resolve:function(e,r,n,i){return Boolean("where"===(null==r?void 0:r.value.toLowerCase())&&!(null==n?void 0:n.getPreviousNonWhiteSpaceToken().isOperator())&&!e.is(t.TokenType.Delimiter,".")&&!e.isParenthesis()&&((null==n?void 0:n.isIdentifier())||(null==n?void 0:n.isDoubleQuotedString())))}},{id:t.StatementPosition.WhereValue,name:t.StatementPosition.WhereValue,resolve:function(e,t,r,n){return Boolean("where"===(null==t?void 0:t.value.toLowerCase())&&(null==r?void 0:r.isOperator()))}},{id:t.StatementPosition.AfterWhereValue,name:t.StatementPosition.AfterWhereValue,resolve:function(e,r,n,i){var a,o,s;return Boolean("where"===(null==r?void 0:r.value.toLowerCase())&&(n.is(t.TokenType.Operator,"and")||n.is(t.TokenType.Operator,"or")||(null==n?void 0:n.isString())||(null==n?void 0:n.isNumber())||(null==n?void 0:n.is(t.TokenType.Parenthesis,")"))||(null==n?void 0:n.is(t.TokenType.Parenthesis,"()"))||(null==n?void 0:n.isTemplateVariable())||(null==n?void 0:n.is(t.TokenType.IdentifierQuote))&&(null===(a=n.getPreviousNonWhiteSpaceToken())||void 0===a?void 0:a.is(t.TokenType.Identifier))&&(null===(s=null===(o=null==n?void 0:n.getPreviousNonWhiteSpaceToken())||void 0===o?void 0:o.getPreviousNonWhiteSpaceToken())||void 0===s?void 0:s.is(t.TokenType.IdentifierQuote))))}},{id:t.StatementPosition.AfterGroupByKeywords,name:t.StatementPosition.AfterGroupByKeywords,resolve:function(e,r,n,i){var a;return Boolean((null==r?void 0:r.is(t.TokenType.Keyword,N))&&(null===(a=null==r?void 0:r.getPreviousKeyword())||void 0===a?void 0:a.is(t.TokenType.Keyword,"group"))&&((null==n?void 0:n.is(t.TokenType.Keyword,N))||(null==n?void 0:n.is(t.TokenType.Delimiter,","))))}},{id:t.StatementPosition.AfterGroupByFunctionArgument,name:t.StatementPosition.AfterGroupByFunctionArgument,resolve:function(e,r,n,i){var a;return Boolean((null==r?void 0:r.is(t.TokenType.Keyword,N))&&(null===(a=null==r?void 0:r.getPreviousKeyword())||void 0===a?void 0:a.is(t.TokenType.Keyword,"group"))&&((null==n?void 0:n.is(t.TokenType.Parenthesis,"("))||(null==e?void 0:e.is(t.TokenType.Parenthesis,"()"))))}},{id:t.StatementPosition.AfterOrderByKeywords,name:t.StatementPosition.AfterOrderByKeywords,resolve:function(e,r,n,i){var a;return Boolean((null==n?void 0:n.is(t.TokenType.Keyword,N))&&(null===(a=null==n?void 0:n.getPreviousKeyword())||void 0===a?void 0:a.is(t.TokenType.Keyword,"order")))}},{id:t.StatementPosition.AfterOrderByFunction,name:t.StatementPosition.AfterOrderByFunction,resolve:function(e,r,n,i){var a,o;return Boolean((null==r?void 0:r.is(t.TokenType.Keyword,N))&&(null===(a=null==r?void 0:r.getPreviousKeyword())||void 0===a?void 0:a.is(t.TokenType.Keyword,"order"))&&(null==n?void 0:n.is(t.TokenType.Parenthesis))&&(null===(o=null==n?void 0:n.getPreviousNonWhiteSpaceToken())||void 0===o?void 0:o.is(t.TokenType.Function)))}},{id:t.StatementPosition.AfterOrderByDirection,name:t.StatementPosition.AfterOrderByDirection,resolve:function(e,r,n,i){return Boolean((null==r?void 0:r.is(t.TokenType.Keyword,L))||(null==r?void 0:r.is(t.TokenType.Keyword,j)))}},{id:t.StatementPosition.AfterIsOperator,name:t.StatementPosition.AfterIsOperator,resolve:function(e,r,n,i){return Boolean(null==n?void 0:n.is(t.TokenType.Operator,"IS"))}},{id:t.StatementPosition.AfterIsNotOperator,name:t.StatementPosition.AfterIsNotOperator,resolve:function(e,r,n,i){var a;return Boolean((null==n?void 0:n.is(t.TokenType.Operator,"NOT"))&&(null===(a=n.getPreviousNonWhiteSpaceToken())||void 0===a?void 0:a.is(t.TokenType.Operator,"IS")))}}]}var te={logger:function(){}},re=function(){};f.attachDebugger&&f.createLogger&&(te=f.createLogger("SQLEditor"),re=te.logger,f.attachDebugger("sqleditor",void 0,te));var ne=[{id:"$__timeFilter(dateColumn)",name:"$__timeFilter(dateColumn)",text:"$__timeFilter",args:["column"],type:t.MacroType.Filter,description:"Will be replaced by a time range filter using the specified column name. For example, dateColumn BETWEEN FROM_UNIXTIME(1494410783) AND FROM_UNIXTIME(1494410983)"},{id:"$__timeFrom()",name:"$__timeFrom()",text:"$__timeFrom",args:[],type:t.MacroType.Filter,description:"Will be replaced by the start of the currently active time selection. For example, FROM_UNIXTIME(1494410783)"},{id:"$__timeTo()",name:"$__timeTo()",text:"$__timeTo",args:[],type:t.MacroType.Filter,description:"Will be replaced by the end of the currently active time selection. For example, FROM_UNIXTIME(1494410983)"},{id:"$__timeGroup(dateColumn, '5m')",name:"$__timeGroup(dateColumn, '5m')",text:"$__timeGroup",args:["column","'5m'"],type:t.MacroType.Value,description:"Will be replaced by an expression usable in GROUP BY clause. For example, *cast(cast(UNIX_TIMESTAMP(dateColumn)/(300) as signed)*300 as signed),*"},{id:"$__table",name:"$__table",text:"$__table",args:[],type:t.MacroType.Table,description:"Will be replaced by the query table."},{id:"$__column",name:"$__column",text:"$__column",args:[],type:t.MacroType.Column,description:"Will be replaced by the query column."}];function ie(e,r){var n,i,a,o={triggerCharacters:["."," ","$",",","(","'"]};(null==r?void 0:r.builtinFunctions.length)&&(o.supportedFunctions=function(){return r.builtinFunctions.map((function(e){return{id:e,name:e}}))});var s=[];return(null===(n=null==r?void 0:r.comparisonOperators)||void 0===n?void 0:n.length)&&s.push.apply(s,x([],E(r.comparisonOperators.map((function(e){return{id:e.toLocaleLowerCase(),operator:e,type:t.OperatorType.Comparison}}))),!1)),r.logicalOperators=null!==(i=r.logicalOperators)&&void 0!==i?i:r.operators,(null===(a=null==r?void 0:r.logicalOperators)||void 0===a?void 0:a.length)&&s.push.apply(s,x([],E(r.logicalOperators.map((function(e){return{id:e.toLocaleLowerCase(),operator:e,type:t.OperatorType.Logical}}))),!1)),o.supportedOperators=function(){return s},o.supportedMacros=function(){return ne},o}var ae={id:"standardSql",extensions:[".sql"],aliases:["sql"],mimetypes:[],loader:function(){return Promise.resolve().then((function(){return $}))},completionProvider:ie},oe=new Map,se=new Map,le=function(e,r,n){return w(void 0,void 0,void 0,(function(){var i,a,o,s,l,u,c,d;return _(this,(function(p){switch(p.label){case 0:return[4,(i=function(e,t){if("sql"!==(null==t?void 0:t.id)&&!t.loader){re("Loading language '".concat(null==t?void 0:t.id,"' from Monaco registry"),!1);var r=e.languages.getLanguages().find((function(e){return e.id===(null==t?void 0:t.id)}));if(!r)throw Error("Unknown Monaco language ".concat(null==t?void 0:t.id));return b(b({completionProvider:ie},r),t)}return b(b({},ae),t)}(e,r)).loader(e)];case 1:return a=p.sent(),o=a.language,s=a.conf,e.languages.register({id:n}),e.languages.setMonarchTokensProvider(n,b({},o)),e.languages.setLanguageConfiguration(n,b({},s)),i.formatter&&e.languages.registerDocumentFormattingEditProvider(n,{provideDocumentFormattingEdits:function(e){var t=r.formatter(e.getValue());return[{range:e.getFullModelRange(),text:t}]}}),i.completionProvider&&(l=i.completionProvider(e,o),function(e,r,n){var i,a,o,s,l,u,c,d,p,f,m,h=this;oe.has(e)||function(e){oe.has(e)||oe.set(e,{functions:new g.Registry,operators:new g.Registry,suggestionKinds:new g.Registry(k),positionResolvers:new g.Registry(ee),macros:new g.Registry}),oe.get(e)}(e);var v,O,T,P=oe.get(e);se.has(r)||se.set(r,new g.Registry((v=P.functions,O=P.operators,T=P.macros,function(){return[{id:t.SuggestionKind.SelectKeyword,name:t.SuggestionKind.SelectKeyword,suggestions:function(e,r){return Promise.resolve([{label:"SELECT <column>",insertText:"SELECT $0",insertTextRules:t.CompletionItemInsertTextRule.InsertAsSnippet,kind:t.CompletionItemKind.Snippet,command:G,sortText:t.CompletionItemPriority.Medium},{label:"SELECT <column> FROM <table>",insertText:"SELECT $2 FROM $1",insertTextRules:t.CompletionItemInsertTextRule.InsertAsSnippet,kind:t.CompletionItemKind.Snippet,command:G,sortText:t.CompletionItemPriority.Medium}])}},{id:t.SuggestionKind.TemplateVariables,name:t.SuggestionKind.TemplateVariables,suggestions:function(e,r){var n=y.getTemplateSrv();return n?Promise.resolve(n.getVariables().map((function(e){var r="$".concat(e.name),i=n.replace(r);return{label:r,detail:"(Template Variable) ".concat(i),kind:t.CompletionItemKind.Snippet,documentation:"(Template Variable) ".concat(i),insertText:"\\$".concat(e.name," "),insertTextRules:t.CompletionItemInsertTextRule.InsertAsSnippet,command:G,sortText:t.CompletionItemPriority.Low}}))):Promise.resolve([])}},{id:t.SuggestionKind.SelectMacro,name:t.SuggestionKind.SelectMacro,suggestions:function(e,r){return Promise.resolve(x([],E(T.list().filter((function(e){return e.type===t.MacroType.Value||e.type===t.MacroType.Column})).map(Z)),!1))}},{id:t.SuggestionKind.TableMacro,name:t.SuggestionKind.TableMacro,suggestions:function(e,r){return Promise.resolve(x([],E(T.list().filter((function(e){return e.type===t.MacroType.Table})).map(Z)),!1))}},{id:t.SuggestionKind.GroupMacro,name:t.SuggestionKind.GroupMacro,suggestions:function(e,r){return Promise.resolve(x([],E(T.list().filter((function(e){return e.type===t.MacroType.Group})).map(Z)),!1))}},{id:t.SuggestionKind.FilterMacro,name:t.SuggestionKind.FilterMacro,suggestions:function(e,r){return Promise.resolve(x([],E(T.list().filter((function(e){return e.type===t.MacroType.Filter})).map(Z)),!1))}},{id:t.SuggestionKind.WithKeyword,name:t.SuggestionKind.WithKeyword,suggestions:function(e,r){return Promise.resolve([{label:"WITH <alias> AS ( ... )",insertText:"WITH $1  AS ( $2 )",insertTextRules:t.CompletionItemInsertTextRule.InsertAsSnippet,kind:t.CompletionItemKind.Snippet,command:G,sortText:t.CompletionItemPriority.Medium}])}},{id:t.SuggestionKind.StarWildCard,name:t.SuggestionKind.StarWildCard,suggestions:function(e,r){return Promise.resolve([{label:"*",insertText:"* $0",insertTextRules:t.CompletionItemInsertTextRule.InsertAsSnippet,kind:t.CompletionItemKind.Field,command:G,sortText:t.CompletionItemPriority.High}])}},{id:t.SuggestionKind.FunctionsWithArguments,name:t.SuggestionKind.FunctionsWithArguments,suggestions:function(e,r){return Promise.resolve(x([],E(v.list().map((function(e){return{label:e.name,insertText:"".concat(e.name,"($0)"),documentation:e.description,insertTextRules:t.CompletionItemInsertTextRule.InsertAsSnippet,kind:t.CompletionItemKind.Function,command:G,sortText:t.CompletionItemPriority.MediumLow}}))),!1))}},{id:t.SuggestionKind.FunctionsWithoutArguments,name:t.SuggestionKind.FunctionsWithoutArguments,suggestions:function(e,r){return Promise.resolve(x([],E(v.list().map((function(e){return{label:e.name,insertText:"".concat(e.name,"()"),documentation:e.description,insertTextRules:t.CompletionItemInsertTextRule.InsertAsSnippet,kind:t.CompletionItemKind.Function,command:G,sortText:t.CompletionItemPriority.MediumHigh}}))),!1))}},{id:t.SuggestionKind.FromKeyword,name:t.SuggestionKind.FromKeyword,suggestions:function(e,r){return Promise.resolve([{label:"FROM",insertText:"FROM $0",command:G,insertTextRules:t.CompletionItemInsertTextRule.InsertAsSnippet,kind:t.CompletionItemKind.Keyword}])}},{id:t.SuggestionKind.Schemas,name:t.SuggestionKind.Schemas,suggestions:function(e,t){return Promise.resolve([])}},{id:t.SuggestionKind.Tables,name:t.SuggestionKind.Tables,suggestions:function(e,t){return Promise.resolve([])}},{id:t.SuggestionKind.Columns,name:t.SuggestionKind.Columns,suggestions:function(e,t){return Promise.resolve([])}},{id:t.SuggestionKind.LogicalOperators,name:t.SuggestionKind.LogicalOperators,suggestions:function(e,r){return Promise.resolve(O.list().filter((function(e){return e.type===t.OperatorType.Logical})).map((function(e){return{label:e.operator,insertText:"".concat(e.operator," "),documentation:e.description,command:G,sortText:t.CompletionItemPriority.MediumHigh,kind:t.CompletionItemKind.Operator}})))}},{id:t.SuggestionKind.WhereKeyword,name:t.SuggestionKind.WhereKeyword,suggestions:function(e,r){return Promise.resolve([{label:"WHERE",insertText:"WHERE ",command:G,sortText:t.CompletionItemPriority.MediumHigh,kind:t.CompletionItemKind.Keyword}])}},{id:t.SuggestionKind.ComparisonOperators,name:t.SuggestionKind.ComparisonOperators,suggestions:function(e,r){return Promise.resolve(x(x([],E(O.list().filter((function(e){return e.type===t.OperatorType.Comparison})).map((function(e){return{label:e.operator,insertText:"".concat(e.operator," "),documentation:e.description,command:G,sortText:t.CompletionItemPriority.MediumHigh,kind:t.CompletionItemKind.Operator}}))),!1),[{label:"IN (...)",insertText:"IN ( $0 )",command:G,sortText:t.CompletionItemPriority.Medium,kind:t.CompletionItemKind.Operator,insertTextRules:t.CompletionItemInsertTextRule.InsertAsSnippet},{label:"NOT IN (...)",insertText:"NOT IN ( $0 )",command:G,sortText:t.CompletionItemPriority.Medium,kind:t.CompletionItemKind.Operator,insertTextRules:t.CompletionItemInsertTextRule.InsertAsSnippet},{label:"IS",insertText:"IS",command:G,sortText:t.CompletionItemPriority.Medium,kind:t.CompletionItemKind.Operator},{label:"IS NOT",insertText:"IS NOT",command:G,sortText:t.CompletionItemPriority.Medium,kind:t.CompletionItemKind.Operator}],!1))}},{id:t.SuggestionKind.GroupByKeywords,name:t.SuggestionKind.GroupByKeywords,suggestions:function(e,r){return Promise.resolve([{label:"GROUP BY",insertText:"GROUP BY ",command:G,sortText:t.CompletionItemPriority.MediumHigh,kind:t.CompletionItemKind.Keyword}])}},{id:t.SuggestionKind.OrderByKeywords,name:t.SuggestionKind.OrderByKeywords,suggestions:function(e,r){return Promise.resolve([{label:"ORDER BY",insertText:"ORDER BY ",command:G,sortText:t.CompletionItemPriority.Medium,kind:t.CompletionItemKind.Keyword},{label:"ORDER BY(ascending)",insertText:"ORDER BY $1 ASC ",command:G,sortText:t.CompletionItemPriority.MediumLow,kind:t.CompletionItemKind.Snippet,insertTextRules:t.CompletionItemInsertTextRule.InsertAsSnippet},{label:"ORDER BY(descending)",insertText:"ORDER BY $1 DESC",command:G,sortText:t.CompletionItemPriority.MediumLow,kind:t.CompletionItemKind.Snippet,insertTextRules:t.CompletionItemInsertTextRule.InsertAsSnippet}])}},{id:t.SuggestionKind.LimitKeyword,name:t.SuggestionKind.LimitKeyword,suggestions:function(e,r){return Promise.resolve([{label:"LIMIT",insertText:"LIMIT ",command:G,sortText:t.CompletionItemPriority.MediumLow,kind:t.CompletionItemKind.Keyword}])}},{id:t.SuggestionKind.SortOrderDirectionKeyword,name:t.SuggestionKind.SortOrderDirectionKeyword,suggestions:function(e,r){return Promise.resolve([j,L].map((function(e){return{label:e,insertText:"".concat(e," "),command:G,kind:t.CompletionItemKind.Keyword}})))}},{id:t.SuggestionKind.NotKeyword,name:t.SuggestionKind.NotKeyword,suggestions:function(){return Promise.resolve([{label:"NOT",insertText:"NOT",command:G,kind:t.CompletionItemKind.Keyword,sortText:t.CompletionItemPriority.High}])}},{id:t.SuggestionKind.BoolValues,name:t.SuggestionKind.BoolValues,suggestions:function(){return Promise.resolve(["TRUE","FALSE"].map((function(e){return{label:e,insertText:"".concat(e),command:G,kind:t.CompletionItemKind.Keyword,sortText:t.CompletionItemPriority.Medium}})))}},{id:t.SuggestionKind.NullValue,name:t.SuggestionKind.NullValue,suggestions:function(){return Promise.resolve(["NULL"].map((function(e){return{label:e,insertText:"".concat(e),command:G,kind:t.CompletionItemKind.Keyword,sortText:t.CompletionItemPriority.Low}})))}}]})));var I=se.get(r);if(n.supportedFunctions)try{for(var C=S(n.supportedFunctions()),A=C.next();!A.done;A=C.next()){var q=A.value;P.functions.getIfExists(q.id)||P.functions.register(q)}}catch(e){i={error:e}}finally{try{A&&!A.done&&(a=C.return)&&a.call(C)}finally{if(i)throw i.error}}if(n.supportedOperators)try{for(var R=S(n.supportedOperators()),D=R.next();!D.done;D=R.next()){var N=D.value;P.operators.getIfExists(N.id)||P.operators.register(b(b({},N),{name:N.id}))}}catch(e){o={error:e}}finally{try{D&&!D.done&&(s=R.return)&&s.call(R)}finally{if(o)throw o.error}}if(n.supportedMacros)try{for(var M=S(n.supportedMacros()),F=M.next();!F.done;F=M.next()){var B=F.value;P.macros.getIfExists(B.id)||P.macros.register(b(b({},B),{name:B.id}))}}catch(e){l={error:e}}finally{try{F&&!F.done&&(u=M.return)&&u.call(M)}finally{if(l)throw l.error}}if(n.customStatementPlacement){var Q=function(e){var t=P.positionResolvers.getIfExists(e.id);if(t){var r=t.resolve;t.resolve=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.resolve.apply(e,x([],E(t),!1));return e.overrideDefault?i:r.apply(void 0,x([],E(t),!1))||i}}else P.positionResolvers.register(b(b({},e),{id:e.id,name:e.id})),P.suggestionKinds.register({id:e.id,name:e.id,kind:[]})};try{for(var $=S(n.customStatementPlacement()),U=$.next();!U.done;U=$.next())Q(U.value)}catch(e){c={error:e}}finally{try{U&&!U.done&&(d=$.return)&&d.call($)}finally{if(c)throw c.error}}}if(n.customSuggestionKinds){var z=function(e){if(null===(m=e.applyTo)||void 0===m||m.forEach((function(t){var r=P.suggestionKinds.getIfExists(t);r&&-1===r.kind.indexOf(e.id)&&r.kind.push(e.id)})),e.overrideDefault){var t=I.get(e.id);if(void 0!==t)return t.suggestions=e.suggestionsResolver,"continue"}I.register({id:e.id,name:e.id,suggestions:e.suggestionsResolver})};try{for(var W=S(n.customSuggestionKinds()),K=W.next();!K.done;K=W.next())z(K.value)}catch(e){p={error:e}}finally{try{K&&!K.done&&(f=W.return)&&f.call(W)}finally{if(p)throw p.error}}}if(n.schemas){var H=(J=I.get(t.SuggestionKind.Schemas)).suggestions;J.suggestions=function(e,r){return w(h,void 0,void 0,(function(){var i,a,o;return _(this,(function(s){switch(s.label){case 0:return[4,H(e,r)];case 1:return i=s.sent(),[4,n.schemas.resolve()];case 2:return a=s.sent(),o=a.map((function(e){var r;return{label:e.name,insertText:"".concat(null!==(r=e.completion)&&void 0!==r?r:e.name,"."),command:G,kind:t.CompletionItemKind.Module,sortText:t.CompletionItemPriority.High}})),[2,x(x([],E(i),!1),E(o),!1)]}}))}))}}if(n.tables){var Y=(J=I.get(t.SuggestionKind.Tables)).suggestions;J.suggestions=function(e,r){return w(h,void 0,void 0,(function(){var i,a,o,s,l,u,c;return _(this,(function(d){switch(d.label){case 0:return[4,Y(e,r)];case 1:return i=d.sent(),a=V(e.currentToken),o=null!==(c=null===(u=n.tables)||void 0===u?void 0:u.parseName)&&void 0!==c?c:X,s=o(a),[4,n.tables.resolve(s)];case 2:return l=d.sent().map((function(e){var r;return{label:e.name,insertText:"".concat(null!==(r=e.completion)&&void 0!==r?r:e.name).concat(e.completion===e.name?" $0":""),insertTextRules:t.CompletionItemInsertTextRule.InsertAsSnippet,command:G,kind:t.CompletionItemKind.Field,sortText:t.CompletionItemPriority.MediumHigh}})),[2,x(x([],E(i),!1),E(l),!1)]}}))}))}}if(n.columns){var J,te=(J=I.get(t.SuggestionKind.Columns)).suggestions;J.suggestions=function(e,r){return w(h,void 0,void 0,(function(){var i,a,o,s,l,u,c,d,p;return _(this,(function(f){switch(f.label){case 0:return[4,te(e,r)];case 1:return i=f.sent(),a=V(e.currentToken),s=null!==(d=null===(c=n.tables)||void 0===c?void 0:c.parseName)&&void 0!==d?d:X,a&&a.value&&(o=s(a)),l=[],o?[4,null===(p=n.columns)||void 0===p?void 0:p.resolve(o)]:[3,3];case 2:u=f.sent(),l=u?u.map((function(e){var r;return{label:e.name,insertText:null!==(r=e.completion)&&void 0!==r?r:e.name,kind:t.CompletionItemKind.Field,sortText:t.CompletionItemPriority.High,detail:e.type,documentation:e.description}})):[],f.label=3;case 3:return[2,x(x([],E(i),!1),E(l),!1)]}}))}))}}}(r.id,n,l),u=oe.get(r.id),c=se.get(n),d=function(t,r,i,a){return w(void 0,void 0,void 0,(function(){var i,a,o,s;return _(this,(function(l){switch(l.label){case 0:return i=A(e,t,r,n),a=T(i,u.positionResolvers),o=function(e,t){for(var r=[],n=0;n<e.length;n++){var i=t.getIfExists(e[n]);i&&(r=r.concat(i.kind))}return r}(a,u.suggestionKinds),re("Statement position",!1,a),re("Suggestion kinds",!1,o),s={position:r,currentToken:i,statementPosition:a,kind:o,range:e.Range.fromPositions(r)},[4,P(e,i,o,s,c)];case 1:return[2,{suggestions:l.sent()}]}}))}))},e.languages.registerCompletionItemProvider(n,b(b({},l),{provideCompletionItems:d}))),[2]}}))}))},ue={testData:Object.freeze({__proto__:null,singleLineFullQuery:{query:'SELECT column1, FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1 DESC LIMIT 10',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"identifier.sql",language:"sql"},{offset:14,type:"delimiter.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"keyword.sql",language:"sql"},{offset:20,type:"white.sql",language:"sql"},{offset:21,type:"identifier.sql",language:"sql"},{offset:27,type:"white.sql",language:"sql"},{offset:28,type:"keyword.sql",language:"sql"},{offset:33,type:"white.sql",language:"sql"},{offset:34,type:"identifier.sql",language:"sql"},{offset:41,type:"white.sql",language:"sql"},{offset:42,type:"operator.sql",language:"sql"},{offset:43,type:"white.sql",language:"sql"},{offset:44,type:"identifier.quote.sql",language:"sql"},{offset:45,type:"identifier.sql",language:"sql"},{offset:51,type:"identifier.quote.sql",language:"sql"},{offset:52,type:"white.sql",language:"sql"},{offset:53,type:"keyword.sql",language:"sql"},{offset:58,type:"white.sql",language:"sql"},{offset:59,type:"keyword.sql",language:"sql"},{offset:61,type:"white.sql",language:"sql"},{offset:62,type:"identifier.sql",language:"sql"},{offset:69,type:"white.sql",language:"sql"},{offset:70,type:"keyword.sql",language:"sql"},{offset:75,type:"white.sql",language:"sql"},{offset:76,type:"keyword.sql",language:"sql"},{offset:78,type:"white.sql",language:"sql"},{offset:79,type:"identifier.sql",language:"sql"},{offset:86,type:"white.sql",language:"sql"},{offset:87,type:"keyword.sql",language:"sql"},{offset:91,type:"white.sql",language:"sql"},{offset:92,type:"keyword.sql",language:"sql"},{offset:97,type:"white.sql",language:"sql"},{offset:98,type:"number.sql",language:"sql"},{offset:100,type:"delimiter.sql",language:"sql"}]]},singleLineFullQueryWithAggregation:{query:'SELECT count(column1), FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1 DESC LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:27,type:"white.sql",language:"sql"},{offset:28,type:"identifier.sql",language:"sql"},{offset:34,type:"white.sql",language:"sql"},{offset:35,type:"keyword.sql",language:"sql"},{offset:40,type:"white.sql",language:"sql"},{offset:41,type:"identifier.sql",language:"sql"},{offset:48,type:"white.sql",language:"sql"},{offset:49,type:"operator.sql",language:"sql"},{offset:50,type:"white.sql",language:"sql"},{offset:51,type:"identifier.quote.sql",language:"sql"},{offset:52,type:"identifier.sql",language:"sql"},{offset:58,type:"identifier.quote.sql",language:"sql"},{offset:59,type:"white.sql",language:"sql"},{offset:60,type:"keyword.sql",language:"sql"},{offset:65,type:"white.sql",language:"sql"},{offset:66,type:"keyword.sql",language:"sql"},{offset:68,type:"white.sql",language:"sql"},{offset:69,type:"identifier.sql",language:"sql"},{offset:76,type:"white.sql",language:"sql"},{offset:77,type:"keyword.sql",language:"sql"},{offset:82,type:"white.sql",language:"sql"},{offset:83,type:"keyword.sql",language:"sql"},{offset:85,type:"white.sql",language:"sql"},{offset:86,type:"identifier.sql",language:"sql"},{offset:93,type:"white.sql",language:"sql"},{offset:94,type:"keyword.sql",language:"sql"},{offset:98,type:"white.sql",language:"sql"},{offset:99,type:"keyword.sql",language:"sql"},{offset:104,type:"white.sql",language:"sql"},{offset:105,type:"number.sql",language:"sql"},{offset:107,type:"delimiter.sql",language:"sql"}]]},multiLineFullQuery:{query:'SELECT column1,  \n  FROM table1 \n  \n  WHERE column1 = "value1" \n  GROUP BY column1 ORDER BY column1 DESC \n  LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"identifier.sql",language:"sql"},{offset:14,type:"delimiter.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:4,type:"white.sql",language:"sql"},{offset:5,type:"identifier.sql",language:"sql"},{offset:11,type:"white.sql",language:"sql"}],[{offset:0,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"identifier.sql",language:"sql"},{offset:13,type:"white.sql",language:"sql"},{offset:14,type:"operator.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"identifier.quote.sql",language:"sql"},{offset:17,type:"identifier.sql",language:"sql"},{offset:23,type:"identifier.quote.sql",language:"sql"},{offset:24,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"keyword.sql",language:"sql"},{offset:8,type:"white.sql",language:"sql"},{offset:9,type:"identifier.sql",language:"sql"},{offset:16,type:"white.sql",language:"sql"},{offset:17,type:"keyword.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:25,type:"white.sql",language:"sql"},{offset:26,type:"identifier.sql",language:"sql"},{offset:33,type:"white.sql",language:"sql"},{offset:34,type:"keyword.sql",language:"sql"},{offset:38,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"number.sql",language:"sql"},{offset:8,type:"delimiter.sql",language:"sql"}]]},multiLineFullQueryWithAggregation:{query:'SELECT count(column1),  \n  FROM table1 \n  \n  WHERE column1 = "value1" \n  GROUP BY column1 ORDER BY column1 DESC \n  LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:4,type:"white.sql",language:"sql"},{offset:5,type:"identifier.sql",language:"sql"},{offset:11,type:"white.sql",language:"sql"}],[{offset:0,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"identifier.sql",language:"sql"},{offset:13,type:"white.sql",language:"sql"},{offset:14,type:"operator.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"identifier.quote.sql",language:"sql"},{offset:17,type:"identifier.sql",language:"sql"},{offset:23,type:"identifier.quote.sql",language:"sql"},{offset:24,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"keyword.sql",language:"sql"},{offset:8,type:"white.sql",language:"sql"},{offset:9,type:"identifier.sql",language:"sql"},{offset:16,type:"white.sql",language:"sql"},{offset:17,type:"keyword.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:25,type:"white.sql",language:"sql"},{offset:26,type:"identifier.sql",language:"sql"},{offset:33,type:"white.sql",language:"sql"},{offset:34,type:"keyword.sql",language:"sql"},{offset:38,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"number.sql",language:"sql"},{offset:8,type:"delimiter.sql",language:"sql"}]]},singleLineEmptyQuery:{query:"",tokens:[]},singleLineTwoQueries:{query:'SELECT column1, FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1 DESC LIMIT 10; SELECT column2, FROM table2 WHERE column2 = "value2" GROUP BY column1 ORDER BY column2 DESC LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"identifier.sql",language:"sql"},{offset:14,type:"delimiter.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"keyword.sql",language:"sql"},{offset:20,type:"white.sql",language:"sql"},{offset:21,type:"identifier.sql",language:"sql"},{offset:27,type:"white.sql",language:"sql"},{offset:28,type:"keyword.sql",language:"sql"},{offset:33,type:"white.sql",language:"sql"},{offset:34,type:"identifier.sql",language:"sql"},{offset:41,type:"white.sql",language:"sql"},{offset:42,type:"operator.sql",language:"sql"},{offset:43,type:"white.sql",language:"sql"},{offset:44,type:"identifier.quote.sql",language:"sql"},{offset:45,type:"identifier.sql",language:"sql"},{offset:51,type:"identifier.quote.sql",language:"sql"},{offset:52,type:"white.sql",language:"sql"},{offset:53,type:"keyword.sql",language:"sql"},{offset:58,type:"white.sql",language:"sql"},{offset:59,type:"keyword.sql",language:"sql"},{offset:61,type:"white.sql",language:"sql"},{offset:62,type:"identifier.sql",language:"sql"},{offset:69,type:"white.sql",language:"sql"},{offset:70,type:"keyword.sql",language:"sql"},{offset:75,type:"white.sql",language:"sql"},{offset:76,type:"keyword.sql",language:"sql"},{offset:78,type:"white.sql",language:"sql"},{offset:79,type:"identifier.sql",language:"sql"},{offset:86,type:"white.sql",language:"sql"},{offset:87,type:"keyword.sql",language:"sql"},{offset:91,type:"white.sql",language:"sql"},{offset:92,type:"keyword.sql",language:"sql"},{offset:97,type:"white.sql",language:"sql"},{offset:98,type:"number.sql",language:"sql"},{offset:100,type:"delimiter.sql",language:"sql"},{offset:101,type:"white.sql",language:"sql"},{offset:102,type:"keyword.sql",language:"sql"},{offset:108,type:"white.sql",language:"sql"},{offset:109,type:"identifier.sql",language:"sql"},{offset:116,type:"delimiter.sql",language:"sql"},{offset:117,type:"white.sql",language:"sql"},{offset:118,type:"keyword.sql",language:"sql"},{offset:122,type:"white.sql",language:"sql"},{offset:123,type:"identifier.sql",language:"sql"},{offset:129,type:"white.sql",language:"sql"},{offset:130,type:"keyword.sql",language:"sql"},{offset:135,type:"white.sql",language:"sql"},{offset:136,type:"identifier.sql",language:"sql"},{offset:143,type:"white.sql",language:"sql"},{offset:144,type:"operator.sql",language:"sql"},{offset:145,type:"white.sql",language:"sql"},{offset:146,type:"identifier.quote.sql",language:"sql"},{offset:147,type:"identifier.sql",language:"sql"},{offset:153,type:"identifier.quote.sql",language:"sql"},{offset:154,type:"white.sql",language:"sql"},{offset:155,type:"keyword.sql",language:"sql"},{offset:160,type:"white.sql",language:"sql"},{offset:161,type:"keyword.sql",language:"sql"},{offset:163,type:"white.sql",language:"sql"},{offset:164,type:"identifier.sql",language:"sql"},{offset:171,type:"white.sql",language:"sql"},{offset:172,type:"keyword.sql",language:"sql"},{offset:177,type:"white.sql",language:"sql"},{offset:178,type:"keyword.sql",language:"sql"},{offset:180,type:"white.sql",language:"sql"},{offset:181,type:"identifier.sql",language:"sql"},{offset:188,type:"white.sql",language:"sql"},{offset:189,type:"keyword.sql",language:"sql"},{offset:193,type:"white.sql",language:"sql"},{offset:194,type:"keyword.sql",language:"sql"},{offset:199,type:"white.sql",language:"sql"},{offset:200,type:"number.sql",language:"sql"},{offset:202,type:"delimiter.sql",language:"sql"}]]},singleLineTwoQueriesWithAggregation:{query:'SELECT count(column1), FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1 DESC LIMIT 10; SELECT count(column2), FROM table2 WHERE column2 = "value2" GROUP BY column1 ORDER BY column2 DESC LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:27,type:"white.sql",language:"sql"},{offset:28,type:"identifier.sql",language:"sql"},{offset:34,type:"white.sql",language:"sql"},{offset:35,type:"keyword.sql",language:"sql"},{offset:40,type:"white.sql",language:"sql"},{offset:41,type:"identifier.sql",language:"sql"},{offset:48,type:"white.sql",language:"sql"},{offset:49,type:"operator.sql",language:"sql"},{offset:50,type:"white.sql",language:"sql"},{offset:51,type:"identifier.quote.sql",language:"sql"},{offset:52,type:"identifier.sql",language:"sql"},{offset:58,type:"identifier.quote.sql",language:"sql"},{offset:59,type:"white.sql",language:"sql"},{offset:60,type:"keyword.sql",language:"sql"},{offset:65,type:"white.sql",language:"sql"},{offset:66,type:"keyword.sql",language:"sql"},{offset:68,type:"white.sql",language:"sql"},{offset:69,type:"identifier.sql",language:"sql"},{offset:76,type:"white.sql",language:"sql"},{offset:77,type:"keyword.sql",language:"sql"},{offset:82,type:"white.sql",language:"sql"},{offset:83,type:"keyword.sql",language:"sql"},{offset:85,type:"white.sql",language:"sql"},{offset:86,type:"identifier.sql",language:"sql"},{offset:93,type:"white.sql",language:"sql"},{offset:94,type:"keyword.sql",language:"sql"},{offset:98,type:"white.sql",language:"sql"},{offset:99,type:"keyword.sql",language:"sql"},{offset:104,type:"white.sql",language:"sql"},{offset:105,type:"number.sql",language:"sql"},{offset:107,type:"delimiter.sql",language:"sql"},{offset:108,type:"white.sql",language:"sql"},{offset:109,type:"keyword.sql",language:"sql"},{offset:115,type:"white.sql",language:"sql"},{offset:116,type:"predefined.sql",language:"sql"},{offset:121,type:"delimiter.parenthesis.sql",language:"sql"},{offset:122,type:"identifier.sql",language:"sql"},{offset:129,type:"delimiter.parenthesis.sql",language:"sql"},{offset:130,type:"delimiter.sql",language:"sql"},{offset:131,type:"white.sql",language:"sql"},{offset:132,type:"keyword.sql",language:"sql"},{offset:136,type:"white.sql",language:"sql"},{offset:137,type:"identifier.sql",language:"sql"},{offset:143,type:"white.sql",language:"sql"},{offset:144,type:"keyword.sql",language:"sql"},{offset:149,type:"white.sql",language:"sql"},{offset:150,type:"identifier.sql",language:"sql"},{offset:157,type:"white.sql",language:"sql"},{offset:158,type:"operator.sql",language:"sql"},{offset:159,type:"white.sql",language:"sql"},{offset:160,type:"identifier.quote.sql",language:"sql"},{offset:161,type:"identifier.sql",language:"sql"},{offset:167,type:"identifier.quote.sql",language:"sql"},{offset:168,type:"white.sql",language:"sql"},{offset:169,type:"keyword.sql",language:"sql"},{offset:174,type:"white.sql",language:"sql"},{offset:175,type:"keyword.sql",language:"sql"},{offset:177,type:"white.sql",language:"sql"},{offset:178,type:"identifier.sql",language:"sql"},{offset:185,type:"white.sql",language:"sql"},{offset:186,type:"keyword.sql",language:"sql"},{offset:191,type:"white.sql",language:"sql"},{offset:192,type:"keyword.sql",language:"sql"},{offset:194,type:"white.sql",language:"sql"},{offset:195,type:"identifier.sql",language:"sql"},{offset:202,type:"white.sql",language:"sql"},{offset:203,type:"keyword.sql",language:"sql"},{offset:207,type:"white.sql",language:"sql"},{offset:208,type:"keyword.sql",language:"sql"},{offset:213,type:"white.sql",language:"sql"},{offset:214,type:"number.sql",language:"sql"},{offset:216,type:"delimiter.sql",language:"sql"}]]},singleLineMultipleColumns:{query:'SELECT count(column1), column2 FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1, avg(column2) DESC LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"identifier.sql",language:"sql"},{offset:30,type:"white.sql",language:"sql"},{offset:31,type:"keyword.sql",language:"sql"},{offset:35,type:"white.sql",language:"sql"},{offset:36,type:"identifier.sql",language:"sql"},{offset:42,type:"white.sql",language:"sql"},{offset:43,type:"keyword.sql",language:"sql"},{offset:48,type:"white.sql",language:"sql"},{offset:49,type:"identifier.sql",language:"sql"},{offset:56,type:"white.sql",language:"sql"},{offset:57,type:"operator.sql",language:"sql"},{offset:58,type:"white.sql",language:"sql"},{offset:59,type:"identifier.quote.sql",language:"sql"},{offset:60,type:"identifier.sql",language:"sql"},{offset:66,type:"identifier.quote.sql",language:"sql"},{offset:67,type:"white.sql",language:"sql"},{offset:68,type:"keyword.sql",language:"sql"},{offset:73,type:"white.sql",language:"sql"},{offset:74,type:"keyword.sql",language:"sql"},{offset:76,type:"white.sql",language:"sql"},{offset:77,type:"identifier.sql",language:"sql"},{offset:84,type:"white.sql",language:"sql"},{offset:85,type:"keyword.sql",language:"sql"},{offset:90,type:"white.sql",language:"sql"},{offset:91,type:"keyword.sql",language:"sql"},{offset:93,type:"white.sql",language:"sql"},{offset:94,type:"identifier.sql",language:"sql"},{offset:101,type:"delimiter.sql",language:"sql"},{offset:102,type:"white.sql",language:"sql"},{offset:103,type:"predefined.sql",language:"sql"},{offset:106,type:"delimiter.parenthesis.sql",language:"sql"},{offset:107,type:"identifier.sql",language:"sql"},{offset:114,type:"delimiter.parenthesis.sql",language:"sql"},{offset:115,type:"white.sql",language:"sql"},{offset:116,type:"keyword.sql",language:"sql"},{offset:120,type:"white.sql",language:"sql"},{offset:121,type:"keyword.sql",language:"sql"},{offset:126,type:"white.sql",language:"sql"},{offset:127,type:"number.sql",language:"sql"},{offset:129,type:"delimiter.sql",language:"sql"}]]},multiLineMultipleColumns:{query:'SELECT count(column1), column2 \n  FROM table1 \n  \n  WHERE column1 = "value1" \n  GROUP BY column1 ORDER BY column1, avg(column2) DESC \n  LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"identifier.sql",language:"sql"},{offset:30,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:4,type:"white.sql",language:"sql"},{offset:5,type:"identifier.sql",language:"sql"},{offset:11,type:"white.sql",language:"sql"}],[{offset:0,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"identifier.sql",language:"sql"},{offset:13,type:"white.sql",language:"sql"},{offset:14,type:"operator.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"identifier.quote.sql",language:"sql"},{offset:17,type:"identifier.sql",language:"sql"},{offset:23,type:"identifier.quote.sql",language:"sql"},{offset:24,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"keyword.sql",language:"sql"},{offset:8,type:"white.sql",language:"sql"},{offset:9,type:"identifier.sql",language:"sql"},{offset:16,type:"white.sql",language:"sql"},{offset:17,type:"keyword.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:25,type:"white.sql",language:"sql"},{offset:26,type:"identifier.sql",language:"sql"},{offset:33,type:"delimiter.sql",language:"sql"},{offset:34,type:"white.sql",language:"sql"},{offset:35,type:"predefined.sql",language:"sql"},{offset:38,type:"delimiter.parenthesis.sql",language:"sql"},{offset:39,type:"identifier.sql",language:"sql"},{offset:46,type:"delimiter.parenthesis.sql",language:"sql"},{offset:47,type:"white.sql",language:"sql"},{offset:48,type:"keyword.sql",language:"sql"},{offset:52,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"number.sql",language:"sql"},{offset:8,type:"delimiter.sql",language:"sql"}]]}}),testStatementPosition:function(e,t,r){describe("".concat(e),(function(){var n,i;beforeEach((function(){var e=new Map;t.forEach((function(t){return e.set(t.query.query,t.query.tokens)})),n=function(e){return{editor:{tokenize:function(t,r){return e.get(t)}},Range:{containsPosition:function(e,t){return t.lineNumber>=e.startLineNumber&&t.lineNumber<=e.endLineNumber&&t.column>=e.startColumn&&t.column<=e.endColumn}},languages:{CompletionItemKind:{Snippet:2,Function:1,Keyword:3},CompletionItemInsertTextRule:{InsertAsSnippet:2}}}}(e),i=new g.Registry((function(){return r().map((function(e){return{id:e.id,name:e.name||e.id,resolve:e.resolve}}))}))})),t.forEach((function(t){test("".concat(t.query.query),(function(){!function(e,t,r,n,i){var a,o=T(A(n,(a=e,{getValue:function(e,t){return a},getValueInRange:function(e,t){return a.split("\n")[e.startLineNumber-1].trim().slice(0===e.startColumn?0:e.startColumn-1,e.endColumn-1)},getLineLength:function(e){return a.split("\n")[e-1].trim().length}}),t),i);expect(o).toContain(r)}(t.query.query,{lineNumber:t.position.line,column:t.position.column},e,n,i)}))}))}))}},ce=function(e){return{button:v.css({paddingLeft:e.spacing(1.5),paddingRight:e.spacing(1.5)})}},de=function(e){var t=e.children,r=O(e,["children"]),n=f.useStyles2(m.useCallback((function(e){return pe(e,r)}),[r]));return h.createElement("div",{className:n.root},t)},pe=function(e,t){var r,n,i;return{root:v.css({display:"flex",flexDirection:null!==(r=t.direction)&&void 0!==r?r:"row",flexWrap:null===(n=t.wrap)||void 0===n||n?"wrap":void 0,alignItems:t.alignItems,gap:e.spacing(null!==(i=t.gap)&&void 0!==i?i:2),flexGrow:t.flexGrow})}},fe=function(e){return{root:v.css({display:"flex",flexWrap:"wrap",alignItems:"center",gap:e.spacing(3),minHeight:e.spacing(4)})}},me=function(e){var t=f.useStyles2(m.useCallback((function(t){return he(t,e)}),[e]));return h.createElement("span",{className:v.cx(t.wrapper)})};me.defaultProps={v:0,h:0,layout:"block"};var he=function(e,t){var r,n;return{wrapper:v.css([{paddingRight:e.spacing(null!==(r=t.h)&&void 0!==r?r:0),paddingBottom:e.spacing(null!==(n=t.v)&&void 0!==n?n:0)},"inline"===t.layout&&{display:"inline-block"},"block"===t.layout&&{display:"block"}])}},ge=function(e){return{root:v.css({padding:e.spacing(1),backgroundColor:e.colors.background.secondary,borderRadius:e.shape.borderRadius(1)})}},ye=h.forwardRef((function(e,t){var r=e.items,n=e.renderItem,i=e.onChange;return h.createElement(de,null,r.map((function(e,t){return h.createElement("div",{key:t},n(e,(function(e){return function(e,t){var n=x([],E(r),!1);n[e]=t,i(n)}(t,e)}),(function(){return e=t,(n=x([],E(r),!1)).splice(e,1),void i(n);var e,n})))})),h.createElement(f.Button,{ref:t,onClick:function(){var e=x(x([],E(r),!1),[{}],!1);i(e)},variant:"secondary",size:"md",icon:"plus","aria-label":"Add",type:"button"}))})),ve=function(e){var t=e.children,r=f.useStyles2(Oe);return h.createElement(f.SelectContainer,b({},e,{className:v.cx(e.className,r.container)}),t)},be=function(e){var t=e.className,r=e.children,n=f.useStyles2(Oe);return h.createElement("div",{className:v.cx(t,n.valueContainer)},r)},Oe=function(e){return{root:v.css({display:"flex",fontSize:12,alignItems:"center"}),label:v.css({color:e.colors.text.secondary,whiteSpace:"nowrap"}),container:v.css({background:"none",borderColor:"transparent"}),valueContainer:v.css({display:"flex",alignItems:"center",flex:"initial",color:e.colors.text.secondary,fontSize:12})}},we=["","base","hovered","invalid","focused"],_e=function(){return{root:v.css({display:"flex","> *":{"&:not(:first-child)":{marginLeft:-1},"&:first-child":{borderTopRightRadius:0,borderBottomRightRadius:0},"&:last-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:first-child):not(:last-child)":{borderRadius:0},position:"relative",zIndex:we.indexOf("base"),"&:hover":{zIndex:we.indexOf("hovered")},"&:focus-within":{zIndex:we.indexOf("focused")}}}),invalidChild:v.css({zIndex:we.indexOf("invalid")})}};t.AccessoryButton=function(e){var t=e.className,r=O(e,["className"]),n=f.useStyles2(ce);return h.createElement(f.Button,b({},r,{className:v.cx(t,n.button)}))},t.EditorField=function(e){var t=e.label,r=e.optional,n=e.tooltip,i=e.tooltipInteractive,a=e.children,o=e.width,s=O(e,["label","optional","tooltip","tooltipInteractive","children","width"]),l=f.useStyles2(m.useCallback((function(e){return function(e,t){return{root:v.css({minWidth:e.spacing(null!=t?t:0)}),label:v.css({fontSize:12,fontWeight:e.typography.fontWeightMedium}),optional:v.css({fontStyle:"italic",color:e.colors.text.secondary}),field:v.css({marginBottom:0}),icon:v.css({color:e.colors.text.secondary,marginLeft:e.spacing(1),":hover":{color:e.colors.text.primary}})}}(e,o)}),[o])),u=(null==s?void 0:s.htmlFor)||(null===f.ReactUtils||void 0===f.ReactUtils?void 0:f.ReactUtils.getChildId(a)),c=h.createElement(h.Fragment,null,h.createElement("label",{className:l.label,htmlFor:u},t,r&&h.createElement("span",{className:l.optional}," - optional"),n&&h.createElement(f.Tooltip,{placement:"top",content:n,theme:"info",interactive:i},h.createElement(f.Icon,{tabIndex:0,name:"info-circle",size:"sm",className:l.icon}))),h.createElement(me,{v:.5}));return h.createElement("div",{className:l.root},h.createElement(f.Field,b({className:l.field,label:c},s),a))},t.EditorFieldGroup=function(e){var t=e.children;return h.createElement(de,{gap:1},t)},t.EditorHeader=function(e){var t=e.children,r=f.useStyles2(fe);return h.createElement("div",{className:r.root},t)},t.EditorList=ye,t.EditorRow=function(e){var t=e.children,r=f.useStyles2(ge);return h.createElement("div",{className:r.root},h.createElement(de,{gap:2},t))},t.EditorRows=function(e){var t=e.children;return h.createElement(de,{gap:.5,direction:"column"},t)},t.EditorSwitch=function(e){var t={switch:v.css({display:"flex",alignItems:"center",minHeight:30})};return h.createElement("div",{className:t.switch},h.createElement(f.Switch,b({},e)))},t.FlexItem=function(e){var t=e.grow,r=e.shrink;return h.createElement("div",{style:{display:"block",flexGrow:t,flexShrink:r}})},t.InlineSelect=function(e){var t=e.label,r=O(e,["label"]),n=f.useStyles2(Oe),i=E(m.useState((function(){return Math.random().toString(16).slice(2)})),1)[0],a={SelectContainer:ve,ValueContainer:be,SingleValue:be};return h.createElement("div",{className:n.root},t&&h.createElement("label",{className:n.label,htmlFor:i},t,":"," "),h.createElement(f.Select,b({openMenuOnFocus:!0,inputId:i},r,{components:a})))},t.InputGroup=function(e){var t=e.children,r=f.useStyles2(_e),n=m.Children.map(t,(function(e){return m.isValidElement(e)&&e.props.invalid?m.cloneElement(e,{className:v.cx(e.props.className,r.invalidChild)}):e}));return h.createElement("div",{className:r.root},n)},t.LinkedToken=I,t.SQLEditor=function(e){var t=e.children,r=e.onBlur,n=e.onChange,i=e.query,a=e.language,o=void 0===a?{id:"sql"}:a,s=e.width,l=e.height,u=m.useRef(null),c=m.useRef(),d=m.useMemo((function(){var e=Y(),t="".concat(o.id,"-").concat(e);return c.current=t,t}),[o.id]);m.useEffect((function(){return function(){se.delete(c.current),re("Removing instance cache ".concat(c.current),!1,se)}}),[]);var p=m.useCallback((function(){u.current&&u.current.getAction("editor.action.formatDocument").run()}),[]);return h.createElement("div",{style:{width:s}},h.createElement(f.CodeEditor,{height:l||"240px",width:s?"".concat(s-2,"px"):void 0,language:d,value:i,onBlur:function(e){n&&n(e,!1),r&&r()},showMiniMap:!1,showLineNumbers:!0,onEditorDidMount:function(e,t){u.current=e,e.onDidChangeModelContent((function(t){var r=e.getValue();n&&n(r,!1)})),e.addCommand(t.KeyMod.CtrlCmd|t.KeyCode.Enter,(function(){var t=e.getValue();n&&n(t,!0)})),e.onKeyUp((function(t){84===t.keyCode&&e.trigger(G.id,G.id,{})})),le(t,o,d)}}),t&&t({formatQuery:p}))},t.SQLEditorTestUtils=ue,t.Space=me,t.Stack=de,t.getStandardSQLCompletionProvider=ie,t.grafanaStandardSQLLanguage=Q,t.grafanaStandardSQLLanguageConf=B},1988:(e,t,r)=>{"use strict";e.exports=r(853)},7504:e=>{"use strict";e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=void 0,i=void 0,a=void 0,o=[];return function(){var l=function(e){return"function"==typeof e?e():e}(t),u=(new Date).getTime(),c=!n||u-n>l;n=u;for(var d=arguments.length,p=Array(d),f=0;f<d;f++)p[f]=arguments[f];if(c&&r.leading)return r.accumulate?Promise.resolve(e.call(this,[p])).then((function(e){return e[0]})):Promise.resolve(e.call.apply(e,[this].concat(p)));if(i?clearTimeout(a):i=function(){var e={};return e.promise=new Promise((function(t,r){e.resolve=t,e.reject=r})),e}(),o.push(p),a=setTimeout(s.bind(this),l),r.accumulate){var m=o.length-1;return i.promise.then((function(e){return e[m]}))}return i.promise};function s(){var t=i;clearTimeout(a),Promise.resolve(r.accumulate?e.call(this,o):e.apply(this,o[o.length-1])).then(t.resolve,t.reject),o=[],i=null}}},6407:function(e){e.exports=function(){var e=[],t=[],r={},n={},i={};function a(e){return"string"==typeof e?new RegExp("^"+e+"$","i"):e}function o(e,t){return e===t?t:e===e.toLowerCase()?t.toLowerCase():e===e.toUpperCase()?t.toUpperCase():e[0]===e[0].toUpperCase()?t.charAt(0).toUpperCase()+t.substr(1).toLowerCase():t.toLowerCase()}function s(e,t){return e.replace(t[0],(function(r,n){var i,a,s=(i=t[1],a=arguments,i.replace(/\$(\d{1,2})/g,(function(e,t){return a[t]||""})));return o(""===r?e[n-1]:r,s)}))}function l(e,t,n){if(!e.length||r.hasOwnProperty(e))return t;for(var i=n.length;i--;){var a=n[i];if(a[0].test(t))return s(t,a)}return t}function u(e,t,r){return function(n){var i=n.toLowerCase();return t.hasOwnProperty(i)?o(n,i):e.hasOwnProperty(i)?o(n,e[i]):l(i,n,r)}}function c(e,t,r,n){return function(n){var i=n.toLowerCase();return!!t.hasOwnProperty(i)||!e.hasOwnProperty(i)&&l(i,i,r)===i}}function d(e,t,r){return(r?t+" ":"")+(1===t?d.singular(e):d.plural(e))}return d.plural=u(i,n,e),d.isPlural=c(i,n,e),d.singular=u(n,i,t),d.isSingular=c(n,i,t),d.addPluralRule=function(t,r){e.push([a(t),r])},d.addSingularRule=function(e,r){t.push([a(e),r])},d.addUncountableRule=function(e){"string"!=typeof e?(d.addPluralRule(e,"$0"),d.addSingularRule(e,"$0")):r[e.toLowerCase()]=!0},d.addIrregularRule=function(e,t){t=t.toLowerCase(),e=e.toLowerCase(),i[e]=t,n[t]=e},[["I","we"],["me","us"],["he","they"],["she","they"],["them","them"],["myself","ourselves"],["yourself","yourselves"],["itself","themselves"],["herself","themselves"],["himself","themselves"],["themself","themselves"],["is","are"],["was","were"],["has","have"],["this","these"],["that","those"],["echo","echoes"],["dingo","dingoes"],["volcano","volcanoes"],["tornado","tornadoes"],["torpedo","torpedoes"],["genus","genera"],["viscus","viscera"],["stigma","stigmata"],["stoma","stomata"],["dogma","dogmata"],["lemma","lemmata"],["schema","schemata"],["anathema","anathemata"],["ox","oxen"],["axe","axes"],["die","dice"],["yes","yeses"],["foot","feet"],["eave","eaves"],["goose","geese"],["tooth","teeth"],["quiz","quizzes"],["human","humans"],["proof","proofs"],["carve","carves"],["valve","valves"],["looey","looies"],["thief","thieves"],["groove","grooves"],["pickaxe","pickaxes"],["passerby","passersby"]].forEach((function(e){return d.addIrregularRule(e[0],e[1])})),[[/s?$/i,"s"],[/[^\u0000-\u007F]$/i,"$0"],[/([^aeiou]ese)$/i,"$1"],[/(ax|test)is$/i,"$1es"],[/(alias|[^aou]us|t[lm]as|gas|ris)$/i,"$1es"],[/(e[mn]u)s?$/i,"$1s"],[/([^l]ias|[aeiou]las|[ejzr]as|[iu]am)$/i,"$1"],[/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1i"],[/(alumn|alg|vertebr)(?:a|ae)$/i,"$1ae"],[/(seraph|cherub)(?:im)?$/i,"$1im"],[/(her|at|gr)o$/i,"$1oes"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i,"$1a"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)(?:a|on)$/i,"$1a"],[/sis$/i,"ses"],[/(?:(kni|wi|li)fe|(ar|l|ea|eo|oa|hoo)f)$/i,"$1$2ves"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/([^ch][ieo][ln])ey$/i,"$1ies"],[/(x|ch|ss|sh|zz)$/i,"$1es"],[/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i,"$1ices"],[/\b((?:tit)?m|l)(?:ice|ouse)$/i,"$1ice"],[/(pe)(?:rson|ople)$/i,"$1ople"],[/(child)(?:ren)?$/i,"$1ren"],[/eaux$/i,"$0"],[/m[ae]n$/i,"men"],["thou","you"]].forEach((function(e){return d.addPluralRule(e[0],e[1])})),[[/s$/i,""],[/(ss)$/i,"$1"],[/(wi|kni|(?:after|half|high|low|mid|non|night|[^\w]|^)li)ves$/i,"$1fe"],[/(ar|(?:wo|[ae])l|[eo][ao])ves$/i,"$1f"],[/ies$/i,"y"],[/\b([pl]|zomb|(?:neck|cross)?t|coll|faer|food|gen|goon|group|lass|talk|goal|cut)ies$/i,"$1ie"],[/\b(mon|smil)ies$/i,"$1ey"],[/\b((?:tit)?m|l)ice$/i,"$1ouse"],[/(seraph|cherub)im$/i,"$1"],[/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|t[lm]as|gas|(?:her|at|gr)o|[aeiou]ris)(?:es)?$/i,"$1"],[/(analy|diagno|parenthe|progno|synop|the|empha|cri|ne)(?:sis|ses)$/i,"$1sis"],[/(movie|twelve|abuse|e[mn]u)s$/i,"$1"],[/(test)(?:is|es)$/i,"$1is"],[/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1us"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|quor)a$/i,"$1um"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)a$/i,"$1on"],[/(alumn|alg|vertebr)ae$/i,"$1a"],[/(cod|mur|sil|vert|ind)ices$/i,"$1ex"],[/(matr|append)ices$/i,"$1ix"],[/(pe)(rson|ople)$/i,"$1rson"],[/(child)ren$/i,"$1"],[/(eau)x?$/i,"$1"],[/men$/i,"man"]].forEach((function(e){return d.addSingularRule(e[0],e[1])})),["adulthood","advice","agenda","aid","aircraft","alcohol","ammo","analytics","anime","athletics","audio","bison","blood","bream","buffalo","butter","carp","cash","chassis","chess","clothing","cod","commerce","cooperation","corps","debris","diabetes","digestion","elk","energy","equipment","excretion","expertise","firmware","flounder","fun","gallows","garbage","graffiti","hardware","headquarters","health","herpes","highjinks","homework","housework","information","jeans","justice","kudos","labour","literature","machinery","mackerel","mail","media","mews","moose","music","mud","manga","news","only","personnel","pike","plankton","pliers","police","pollution","premises","rain","research","rice","salmon","scissors","series","sewage","shambles","shrimp","software","species","staff","swine","tennis","traffic","transportation","trout","tuna","wealth","welfare","whiting","wildebeest","wildlife","you",/pok[eé]mon$/i,/[^aeiou]ese$/i,/deer$/i,/fish$/i,/measles$/i,/o[iu]s$/i,/pox$/i,/sheep$/i].forEach(d.addUncountableRule),d}()},4335:e=>{var t="undefined"!=typeof Element,r="function"==typeof Map,n="function"==typeof Set,i="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function a(e,o){if(e===o)return!0;if(e&&o&&"object"==typeof e&&"object"==typeof o){if(e.constructor!==o.constructor)return!1;var s,l,u,c;if(Array.isArray(e)){if((s=e.length)!=o.length)return!1;for(l=s;0!=l--;)if(!a(e[l],o[l]))return!1;return!0}if(r&&e instanceof Map&&o instanceof Map){if(e.size!==o.size)return!1;for(c=e.entries();!(l=c.next()).done;)if(!o.has(l.value[0]))return!1;for(c=e.entries();!(l=c.next()).done;)if(!a(l.value[1],o.get(l.value[0])))return!1;return!0}if(n&&e instanceof Set&&o instanceof Set){if(e.size!==o.size)return!1;for(c=e.entries();!(l=c.next()).done;)if(!o.has(l.value[0]))return!1;return!0}if(i&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(o)){if((s=e.length)!=o.length)return!1;for(l=s;0!=l--;)if(e[l]!==o[l])return!1;return!0}if(e.constructor===RegExp)return e.source===o.source&&e.flags===o.flags;if(e.valueOf!==Object.prototype.valueOf&&"function"==typeof e.valueOf&&"function"==typeof o.valueOf)return e.valueOf()===o.valueOf();if(e.toString!==Object.prototype.toString&&"function"==typeof e.toString&&"function"==typeof o.toString)return e.toString()===o.toString();if((s=(u=Object.keys(e)).length)!==Object.keys(o).length)return!1;for(l=s;0!=l--;)if(!Object.prototype.hasOwnProperty.call(o,u[l]))return!1;if(t&&e instanceof Element)return!1;for(l=s;0!=l--;)if(("_owner"!==u[l]&&"__v"!==u[l]&&"__o"!==u[l]||!e.$$typeof)&&!a(e[u[l]],o[u[l]]))return!1;return!0}return e!=e&&o!=o}e.exports=function(e,t){try{return a(e,t)}catch(e){if((e.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw e}}},5464:(e,t,r)=>{e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=(n=r(2))&&n.__esModule?n:{default:n};t.default=i.default,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function i(e){return e&&e.__esModule?e:{default:e}}t.default=u;var a=r(3),o=i(r(4)),s=r(14),l=i(r(15));function u(e){var t=e.activeClassName,r=void 0===t?"":t,i=e.activeIndex,o=void 0===i?-1:i,u=e.activeStyle,c=e.autoEscape,d=e.caseSensitive,p=void 0!==d&&d,f=e.className,m=e.findChunks,h=e.highlightClassName,g=void 0===h?"":h,y=e.highlightStyle,v=void 0===y?{}:y,b=e.highlightTag,O=void 0===b?"mark":b,w=e.sanitize,_=e.searchWords,S=e.textToHighlight,E=e.unhighlightTag,x=void 0===E?"span":E,T=e.unhighlightClassName,P=void 0===T?"":T,k=e.unhighlightStyle,I=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(e,["activeClassName","activeIndex","activeStyle","autoEscape","caseSensitive","className","findChunks","highlightClassName","highlightStyle","highlightTag","sanitize","searchWords","textToHighlight","unhighlightTag","unhighlightClassName","unhighlightStyle"]),C=(0,a.findAll)({autoEscape:c,caseSensitive:p,findChunks:m,sanitize:w,searchWords:_,textToHighlight:S}),A=O,q=-1,R="",D=void 0,N=(0,l.default)((function(e){var t={};for(var r in e)t[r.toLowerCase()]=e[r];return t}));return(0,s.createElement)("span",n({className:f},I,{children:C.map((function(e,t){var n=S.substr(e.start,e.end-e.start);if(e.highlight){q++;var i;i="object"==typeof g?p?g[n]:(g=N(g))[n.toLowerCase()]:g;var a=q===+o;R=i+" "+(a?r:""),D=!0===a&&null!=u?Object.assign({},v,u):v;var l={children:n,className:R,key:t,style:D};return"string"!=typeof A&&(l.highlightIndex=q),(0,s.createElement)(A,l)}return(0,s.createElement)(x,{children:n,className:P,key:t,style:k})}))}))}u.propTypes={activeClassName:o.default.string,activeIndex:o.default.number,activeStyle:o.default.object,autoEscape:o.default.bool,className:o.default.string,findChunks:o.default.func,highlightClassName:o.default.oneOfType([o.default.object,o.default.string]),highlightStyle:o.default.object,highlightTag:o.default.oneOfType([o.default.node,o.default.func,o.default.string]),sanitize:o.default.func,searchWords:o.default.arrayOf(o.default.oneOfType([o.default.string,o.default.instanceOf(RegExp)])).isRequired,textToHighlight:o.default.string.isRequired,unhighlightTag:o.default.oneOfType([o.default.node,o.default.func,o.default.string]),unhighlightClassName:o.default.string,unhighlightStyle:o.default.object},e.exports=t.default},function(e,t){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);Object.defineProperty(t,"combineChunks",{enumerable:!0,get:function(){return n.combineChunks}}),Object.defineProperty(t,"fillInChunks",{enumerable:!0,get:function(){return n.fillInChunks}}),Object.defineProperty(t,"findAll",{enumerable:!0,get:function(){return n.findAll}}),Object.defineProperty(t,"findChunks",{enumerable:!0,get:function(){return n.findChunks}})},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findAll=function(e){var t=e.autoEscape,a=e.caseSensitive,o=void 0!==a&&a,s=e.findChunks,l=void 0===s?n:s,u=e.sanitize,c=e.searchWords,d=e.textToHighlight;return i({chunksToHighlight:r({chunks:l({autoEscape:t,caseSensitive:o,sanitize:u,searchWords:c,textToHighlight:d})}),totalLength:d?d.length:0})};var r=t.combineChunks=function(e){var t=e.chunks;return t.sort((function(e,t){return e.start-t.start})).reduce((function(e,t){if(0===e.length)return[t];var r=e.pop();if(t.start<=r.end){var n=Math.max(r.end,t.end);e.push({start:r.start,end:n})}else e.push(r,t);return e}),[])},n=function(e){var t=e.autoEscape,r=e.caseSensitive,n=e.sanitize,i=void 0===n?a:n,o=e.searchWords,s=e.textToHighlight;return s=i(s),o.filter((function(e){return e})).reduce((function(e,n){n=i(n),t&&(n=n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"));for(var a=new RegExp(n,r?"g":"gi"),o=void 0;o=a.exec(s);){var l=o.index,u=a.lastIndex;u>l&&e.push({start:l,end:u}),o.index==a.lastIndex&&a.lastIndex++}return e}),[])};t.findChunks=n;var i=t.fillInChunks=function(e){var t=e.chunksToHighlight,r=e.totalLength,n=[],i=function(e,t,r){t-e>0&&n.push({start:e,end:t,highlight:r})};if(0===t.length)i(0,r,!1);else{var a=0;t.forEach((function(e){i(a,e.start,!1),i(e.start,e.end,!0),a=e.end})),i(a,r,!1)}return n};function a(e){return e}}])},function(e,t,r){(function(t){if("production"!==t.env.NODE_ENV){var n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;e.exports=r(6)((function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}),!0)}else e.exports=r(13)()}).call(t,r(5))},function(e,t){var r,n,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var l,u=[],c=!1,d=-1;function p(){c&&l&&(c=!1,l.length?u=l.concat(u):d=-1,u.length&&f())}function f(){if(!c){var e=s(p);c=!0;for(var t=u.length;t;){for(l=u,u=[];++d<t;)l&&l[d].run();d=-1,t=u.length}l=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function h(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new m(e,t)),1!==u.length||c||s(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){(function(t){"use strict";var n=r(7),i=r(8),a=r(9),o=r(10),s=r(11),l=r(12);e.exports=function(e,r){var u="function"==typeof Symbol&&Symbol.iterator,c="<<anonymous>>",d={array:m("array"),bool:m("boolean"),func:m("function"),number:m("number"),object:m("object"),string:m("string"),symbol:m("symbol"),any:f(n.thatReturnsNull),arrayOf:function(e){return f((function(t,r,n,i,a){if("function"!=typeof e)return new p("Property `"+a+"` of component `"+n+"` has invalid PropType notation inside arrayOf.");var o=t[r];if(!Array.isArray(o))return new p("Invalid "+i+" `"+a+"` of type `"+g(o)+"` supplied to `"+n+"`, expected an array.");for(var l=0;l<o.length;l++){var u=e(o,l,n,i,a+"["+l+"]",s);if(u instanceof Error)return u}return null}))},element:f((function(t,r,n,i,a){var o=t[r];return e(o)?null:new p("Invalid "+i+" `"+a+"` of type `"+g(o)+"` supplied to `"+n+"`, expected a single ReactElement.")})),instanceOf:function(e){return f((function(t,r,n,i,a){if(!(t[r]instanceof e)){var o=e.name||c;return new p("Invalid "+i+" `"+a+"` of type `"+((s=t[r]).constructor&&s.constructor.name?s.constructor.name:c)+"` supplied to `"+n+"`, expected instance of `"+o+"`.")}var s;return null}))},node:f((function(e,t,r,n,i){return h(e[t])?null:new p("Invalid "+n+" `"+i+"` supplied to `"+r+"`, expected a ReactNode.")})),objectOf:function(e){return f((function(t,r,n,i,a){if("function"!=typeof e)return new p("Property `"+a+"` of component `"+n+"` has invalid PropType notation inside objectOf.");var o=t[r],l=g(o);if("object"!==l)return new p("Invalid "+i+" `"+a+"` of type `"+l+"` supplied to `"+n+"`, expected an object.");for(var u in o)if(o.hasOwnProperty(u)){var c=e(o,u,n,i,a+"."+u,s);if(c instanceof Error)return c}return null}))},oneOf:function(e){return Array.isArray(e)?f((function(t,r,n,i,a){for(var o=t[r],s=0;s<e.length;s++)if(l=o,u=e[s],l===u?0!==l||1/l==1/u:l!=l&&u!=u)return null;var l,u;return new p("Invalid "+i+" `"+a+"` of value `"+o+"` supplied to `"+n+"`, expected one of "+JSON.stringify(e)+".")})):("production"!==t.env.NODE_ENV&&a(!1,"Invalid argument supplied to oneOf, expected an instance of array."),n.thatReturnsNull)},oneOfType:function(e){if(!Array.isArray(e))return"production"!==t.env.NODE_ENV&&a(!1,"Invalid argument supplied to oneOfType, expected an instance of array."),n.thatReturnsNull;for(var r=0;r<e.length;r++){var i=e[r];if("function"!=typeof i)return a(!1,"Invalid argument supplied to oneOfType. Expected an array of check functions, but received %s at index %s.",v(i),r),n.thatReturnsNull}return f((function(t,r,n,i,a){for(var o=0;o<e.length;o++)if(null==(0,e[o])(t,r,n,i,a,s))return null;return new p("Invalid "+i+" `"+a+"` supplied to `"+n+"`.")}))},shape:function(e){return f((function(t,r,n,i,a){var o=t[r],l=g(o);if("object"!==l)return new p("Invalid "+i+" `"+a+"` of type `"+l+"` supplied to `"+n+"`, expected `object`.");for(var u in e){var c=e[u];if(c){var d=c(o,u,n,i,a+"."+u,s);if(d)return d}}return null}))},exact:function(e){return f((function(t,r,n,i,a){var l=t[r],u=g(l);if("object"!==u)return new p("Invalid "+i+" `"+a+"` of type `"+u+"` supplied to `"+n+"`, expected `object`.");var c=o({},t[r],e);for(var d in c){var f=e[d];if(!f)return new p("Invalid "+i+" `"+a+"` key `"+d+"` supplied to `"+n+"`.\nBad object: "+JSON.stringify(t[r],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var m=f(l,d,n,i,a+"."+d,s);if(m)return m}return null}))}};function p(e){this.message=e,this.stack=""}function f(e){if("production"!==t.env.NODE_ENV)var n={},o=0;function l(l,u,d,f,m,h,g){if(f=f||c,h=h||d,g!==s)if(r)i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");else if("production"!==t.env.NODE_ENV&&"undefined"!=typeof console){var y=f+":"+d;!n[y]&&o<3&&(a(!1,"You are manually calling a React.PropTypes validation function for the `%s` prop on `%s`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details.",h,f),n[y]=!0,o++)}return null==u[d]?l?null===u[d]?new p("The "+m+" `"+h+"` is marked as required in `"+f+"`, but its value is `null`."):new p("The "+m+" `"+h+"` is marked as required in `"+f+"`, but its value is `undefined`."):null:e(u,d,f,m,h)}var u=l.bind(null,!1);return u.isRequired=l.bind(null,!0),u}function m(e){return f((function(t,r,n,i,a,o){var s=t[r];return g(s)!==e?new p("Invalid "+i+" `"+a+"` of type `"+y(s)+"` supplied to `"+n+"`, expected `"+e+"`."):null}))}function h(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(h);if(null===t||e(t))return!0;var r=function(e){var t=e&&(u&&e[u]||e["@@iterator"]);if("function"==typeof t)return t}(t);if(!r)return!1;var n,i=r.call(t);if(r!==t.entries){for(;!(n=i.next()).done;)if(!h(n.value))return!1}else for(;!(n=i.next()).done;){var a=n.value;if(a&&!h(a[1]))return!1}return!0;default:return!1}}function g(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||"Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol}(t,e)?"symbol":t}function y(e){if(null==e)return""+e;var t=g(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function v(e){var t=y(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}return p.prototype=Error.prototype,d.checkPropTypes=l,d.PropTypes=d,d}}).call(t,r(5))},function(e,t){"use strict";function r(e){return function(){return e}}var n=function(){};n.thatReturns=r,n.thatReturnsFalse=r(!1),n.thatReturnsTrue=r(!0),n.thatReturnsNull=r(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(e){return e},e.exports=n},function(e,t,r){(function(t){"use strict";var r=function(e){};"production"!==t.env.NODE_ENV&&(r=function(e){if(void 0===e)throw new Error("invariant requires an error message argument")}),e.exports=function(e,t,n,i,a,o,s,l){if(r(t),!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,i,a,o,s,l],d=0;(u=new Error(t.replace(/%s/g,(function(){return c[d++]})))).name="Invariant Violation"}throw u.framesToPop=1,u}}}).call(t,r(5))},function(e,t,r){(function(t){"use strict";var n=r(7);if("production"!==t.env.NODE_ENV){var i=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=0,a="Warning: "+e.replace(/%s/g,(function(){return r[i++]}));"undefined"!=typeof console&&console.error(a);try{throw new Error(a)}catch(e){}};n=function(e,t){if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(0!==t.indexOf("Failed Composite propType: ")&&!e){for(var r=arguments.length,n=Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];i.apply(void 0,[t].concat(n))}}}e.exports=n}).call(t,r(5))},function(e,t){"use strict";var r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var a,o,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),l=1;l<arguments.length;l++){for(var u in a=Object(arguments[l]))n.call(a,u)&&(s[u]=a[u]);if(r){o=r(a);for(var c=0;c<o.length;c++)i.call(a,o[c])&&(s[o[c]]=a[o[c]])}}return s}},function(e,t){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){(function(t){"use strict";if("production"!==t.env.NODE_ENV)var n=r(8),i=r(9),a=r(11),o={};e.exports=function(e,r,s,l,u){if("production"!==t.env.NODE_ENV)for(var c in e)if(e.hasOwnProperty(c)){var d;try{n("function"==typeof e[c],"%s: %s type `%s` is invalid; it must be a function, usually from the `prop-types` package, but received `%s`.",l||"React class",s,c,typeof e[c]),d=e[c](r,c,l,s,null,a)}catch(e){d=e}if(i(!d||d instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",l||"React class",s,c,typeof d),d instanceof Error&&!(d.message in o)){o[d.message]=!0;var p=u?u():"";i(!1,"Failed %s type: %s%s",s,d.message,null!=p?p:"")}}}}).call(t,r(5))},function(e,t,r){"use strict";var n=r(7),i=r(8),a=r(11);e.exports=function(){function e(e,t,r,n,o,s){s!==a&&i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return r.checkPropTypes=n,r.PropTypes=r,r}},function(e,t){e.exports=r(2650)},function(e,t){"use strict";var r=function(e,t){return e===t};e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,n=void 0,i=[],a=void 0,o=!1,s=function(e,r){return t(e,i[r])};return function(){for(var t=arguments.length,r=Array(t),l=0;l<t;l++)r[l]=arguments[l];return o&&n===this&&r.length===i.length&&r.every(s)?a:(o=!0,n=this,i=r,a=e.apply(this,r))}}}])},7644:e=>{"use strict";e.exports=i},3305:t=>{"use strict";t.exports=e},3545:e=>{"use strict";e.exports=r},7388:e=>{"use strict";e.exports=n},5980:e=>{"use strict";e.exports=a},3342:e=>{"use strict";e.exports=o},2650:e=>{"use strict";e.exports=t},2729:e=>{"use strict";e.exports=l},3929:e=>{"use strict";e.exports=c},3129:e=>{"use strict";e.exports=u},1177:e=>{"use strict";e.exports=s},5556:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>D,__assign:()=>a,__asyncDelegator:()=>x,__asyncGenerator:()=>E,__asyncValues:()=>T,__await:()=>S,__awaiter:()=>m,__classPrivateFieldGet:()=>A,__classPrivateFieldIn:()=>R,__classPrivateFieldSet:()=>q,__createBinding:()=>g,__decorate:()=>s,__disposeResources:()=>L,__esDecorate:()=>u,__exportStar:()=>y,__extends:()=>i,__generator:()=>h,__importDefault:()=>C,__importStar:()=>I,__makeTemplateObject:()=>P,__metadata:()=>f,__param:()=>l,__propKey:()=>d,__read:()=>b,__rest:()=>o,__runInitializers:()=>c,__setFunctionName:()=>p,__spread:()=>O,__spreadArray:()=>_,__spreadArrays:()=>w,__values:()=>v,default:()=>j});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function s(e,t,r,n){var i,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,r,o):i(t,r))||o);return a>3&&o&&Object.defineProperty(t,r,o),o}function l(e,t){return function(r,n){t(r,n,e)}}function u(e,t,r,n,i,a){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,l=n.kind,u="getter"===l?"get":"setter"===l?"set":"value",c=!t&&e?n.static?e:e.prototype:null,d=t||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),p=!1,f=r.length-1;f>=0;f--){var m={};for(var h in n)m[h]="access"===h?{}:n[h];for(var h in n.access)m.access[h]=n.access[h];m.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(e||null))};var g=(0,r[f])("accessor"===l?{get:d.get,set:d.set}:d[u],m);if("accessor"===l){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(s=o(g.get))&&(d.get=s),(s=o(g.set))&&(d.set=s),(s=o(g.init))&&i.unshift(s)}else(s=o(g))&&("field"===l?i.unshift(s):d[u]=s)}c&&Object.defineProperty(c,n.name,d),p=!0}function c(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function m(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function s(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))}function h(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}var g=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function y(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o}function O(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n}function _(e,t,r){if(r||2===arguments.length)for(var n,i=0,a=t.length;i<a;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function E(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),a=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=i[e](t)).value instanceof S?Promise.resolve(r.value.v).then(l,u):c(a[0][2],r)}catch(e){c(a[0][3],e)}var r}function l(e){s("next",e)}function u(e){s("throw",e)}function c(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function x(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:S(e[n](t)),done:!1}:i?i(t):t}:i}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=v(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,i,(t=e[r](t)).done,t.value)}))}}}function P(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var k=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function I(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&g(t,e,r);return k(t,e),t}function C(e){return e&&e.__esModule?e:{default:e}}function A(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function q(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r}function R(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function D(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if("function"!=typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var N="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function L(e){function t(t){e.error=e.hasError?new N(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var n=e.stack.pop();try{var i=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(i).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const j={__extends:i,__assign:a,__rest:o,__decorate:s,__param:l,__metadata:f,__awaiter:m,__generator:h,__createBinding:g,__exportStar:y,__values:v,__read:b,__spread:O,__spreadArrays:w,__spreadArray:_,__await:S,__asyncGenerator:E,__asyncDelegator:x,__asyncValues:T,__makeTemplateObject:P,__importStar:I,__importDefault:C,__classPrivateFieldGet:A,__classPrivateFieldSet:q,__classPrivateFieldIn:R,__addDisposableResource:D,__disposeResources:L}}},f={};function m(e){var t=f[e];if(void 0!==t)return t.exports;var r=f[e]={id:e,exports:{}};return p[e].call(r.exports,r,r.exports,m),r.exports}m.m=p,m.amdO={},m.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return m.d(t,{a:t}),t},m.d=(e,t)=>{for(var r in t)m.o(t,r)&&!m.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},m.f={},m.e=e=>Promise.all(Object.keys(m.f).reduce(((t,r)=>(m.f[r](e,t),t)),[])),m.u=e=>e+".js",m.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),m.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d={},m.l=(e,t,r,n)=>{if(d[e])d[e].push(t);else{var i,a;if(void 0!==r)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var l=o[s];if(l.getAttribute("src")==e){i=l;break}}i||(a=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,m.nc&&i.setAttribute("nonce",m.nc),i.src=e),d[e]=[t];var u=(t,r)=>{i.onerror=i.onload=null,clearTimeout(c);var n=d[e];if(delete d[e],i.parentNode&&i.parentNode.removeChild(i),n&&n.forEach((e=>e(r))),t)return t(r)},c=setTimeout(u.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=u.bind(null,i.onerror),i.onload=u.bind(null,i.onload),a&&document.head.appendChild(i)}},m.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},m.p="/public/plugins/victoriametrics-datasource/",(()=>{m.b=document.baseURI||self.location.href;var e={1261:0};m.f.j=(t,r)=>{var n=m.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var i=new Promise(((r,i)=>n=e[t]=[r,i]));r.push(n[2]=i);var a=m.p+m.u(t),o=new Error;m.l(a,(r=>{if(m.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var i=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",o.name="ChunkLoadError",o.type=i,o.request=a,n[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,i,[a,o,s]=r,l=0;if(a.some((t=>0!==e[t]))){for(n in o)m.o(o,n)&&(m.m[n]=o[n]);s&&s(m)}for(t&&t(r);l<a.length;l++)i=a[l],m.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunk=self.webpackChunk||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),m.nc=void 0;var h={};return(()=>{"use strict";m.r(h),m.d(h,{plugin:()=>_b});var e,t=m(3305),r=m(2650),n=m.n(r),i=m(3545),a=m(7388);function o(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e){e.Success="success",e.Error="error"}(e||(e={}));const l=({datasource:e,query:t,onChange:i})=>{const[l,u]=(0,r.useState)(!1),c=(d=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function s(e){o(a,n,i,s,l,"next",e)}function l(e){o(a,n,i,s,l,"throw",e)}s(void 0)}))}}((function*(){u(!0);try{const a=yield e.prettifyRequest(t.expr),{data:o,status:l}=a;"success"===(null==o?void 0:o.status)?i((r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){s(e,t,r[t])}))}return e}({},t),n=null!=(n={expr:o.query})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))})),r)):console.error(`Error requesting /prettify-query, status: ${l}`)}catch(e){console.error(e)}var r,n;u(!1)})),function(){return d.apply(this,arguments)});var d;return n().createElement(a.IconButton,{key:"run",name:l?"fa fa-spinner":"brackets-curly",tooltip:"Prettify query",disabled:l,onClick:c})},u=(0,r.memo)(l);var c=m(7644);function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const p=e=>{var{className:t}=e,r=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["className"]);const i=(0,a.useTheme2)(),o=f(i);return n().createElement(a.Button,(s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){d(e,t,r[t])}))}return e}({},r),l=null!=(l={className:(0,c.cx)(t,o.button)})?l:{},Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(l)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(l)).forEach((function(e){Object.defineProperty(s,e,Object.getOwnPropertyDescriptor(l,e))})),s));var s,l},f=(0,a.stylesFactory)((e=>({button:(0,c.css)({paddingLeft:e.spacing(1.5),paddingRight:e.spacing(1.5)})})));const g=e=>{var{children:t}=e,i=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["children"]);const o=(0,a.useStyles2)((0,r.useCallback)((e=>y(e,i)),[i]));return n().createElement("div",{className:o.root},t)},y=(e,t)=>{var r,n,i;return{root:(0,c.css)({display:"flex",flexDirection:null!==(r=t.direction)&&void 0!==r?r:"row",flexWrap:null===(n=t.wrap)||void 0===n||n?"wrap":void 0,alignItems:t.alignItems,gap:e.spacing(null!==(i=t.gap)&&void 0!==i?i:2),flexGrow:t.flexGrow})}},v=({children:e})=>n().createElement(g,{gap:1},e),b=({children:e})=>{const t=(0,a.useTheme2)(),r=O(t);return n().createElement("div",{className:r.root},e)},O=(0,a.stylesFactory)((e=>({root:(0,c.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:e.spacing(1),minHeight:e.spacing(4)})}))),w=e=>{const t=(0,a.useTheme2)(),r=_(t,e);return n().createElement("span",{className:(0,c.cx)(r.wrapper)})};w.defaultProps={v:0,h:0,layout:"block"};const _=(0,a.stylesFactory)(((e,t)=>{var r,n;return{wrapper:(0,c.css)([{paddingRight:e.spacing(null!==(r=t.h)&&void 0!==r?r:0),paddingBottom:e.spacing(null!==(n=t.v)&&void 0!==n?n:0)},"inline"===t.layout&&{display:"inline-block"},"block"===t.layout&&{display:"block"}])}}));function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const E=e=>{const{label:t,optional:r,tooltip:i,children:o,width:s}=e,l=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["label","optional","tooltip","children","width"]),u=(0,a.useTheme2)(),c=x(u,s),d=(null==l?void 0:l.htmlFor)||(null===a.ReactUtils||void 0===a.ReactUtils?void 0:a.ReactUtils.getChildId(o)),p=n().createElement(n().Fragment,null,n().createElement("label",{className:c.label,htmlFor:d},t,r&&n().createElement("span",{className:c.optional}," - optional"),i&&n().createElement(a.Tooltip,{placement:"top",content:i,theme:"info"},n().createElement(a.Icon,{name:"info-circle",size:"sm",className:c.icon}))),n().createElement(w,{v:.5}));return n().createElement("div",{className:c.root},n().createElement(a.Field,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){S(e,t,r[t])}))}return e}({className:c.field,label:p},l),o))},x=(0,a.stylesFactory)(((e,t)=>({root:(0,c.css)({minWidth:e.spacing(null!=t?t:0)}),label:(0,c.css)({fontSize:12,fontWeight:e.typography.fontWeightMedium}),optional:(0,c.css)({fontStyle:"italic",color:e.colors.text.secondary}),field:(0,c.css)({marginBottom:0}),icon:(0,c.css)({color:e.colors.text.secondary,marginLeft:e.spacing(1),":hover":{color:e.colors.text.primary}})}))),T=({children:e})=>{const t=(0,a.useStyles2)(P);return n().createElement("div",{className:t.root},n().createElement(g,{gap:2},e))},P=e=>({root:(0,c.css)({padding:e.spacing(1),backgroundColor:e.colors.background.secondary,borderRadius:e.shape.borderRadius(1)})});function k({items:e,renderItem:t,onChange:r}){return n().createElement(g,null,e.map(((i,a)=>n().createElement("div",{key:a},t(i,(t=>((t,n)=>{const i=[...e];i[t]=n,r(i)})(a,t)),(()=>(t=>{const n=[...e];n.splice(t,1),r(n)})(a)))))),n().createElement(a.Button,{onClick:()=>{const t=[...e,{}];r(t)},variant:"secondary",size:"md",icon:"plus","aria-label":"Add",type:"button"}))}const I=({children:e})=>n().createElement(g,{gap:.5,direction:"column"},e),C=e=>{const t=A();return n().createElement("div",{className:t.switch},n().createElement(a.Switch,e))},A=()=>({switch:(0,c.css)({display:"flex",alignItems:"center",minHeight:30})}),q=({grow:e,shrink:t})=>n().createElement("div",{style:{display:"block",flexGrow:e,flexShrink:t}});function R(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){R(e,t,r[t])}))}return e}function N(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function L(e){var{label:t}=e,i=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["label"]);const o=(0,a.useTheme2)(),[s]=(0,r.useState)((()=>Math.random().toString(16).slice(2))),l=F(o),u={SelectContainer:j,ValueContainer:M,SingleValue:M};return n().createElement("div",{className:l.root},t&&n().createElement("label",{className:l.label,htmlFor:s},t,":"," "),n().createElement(a.Select,N(D({openMenuOnFocus:!0,inputId:s},i),{components:u})))}const j=e=>{const{children:t}=e,r=(0,a.useTheme2)(),i=F(r);return n().createElement(a.SelectContainer,N(D({},e),{className:(0,c.cx)(e.className,i.container)}),t)},M=e=>{const{className:t,children:r}=e,i=(0,a.useTheme2)(),o=F(i);return n().createElement("div",{className:(0,c.cx)(t,o.valueContainer)},r)},F=(0,a.stylesFactory)((e=>({root:(0,c.css)({display:"flex",fontSize:12,alignItems:"center"}),label:(0,c.css)({color:e.colors.text.secondary,whiteSpace:"nowrap"}),container:(0,c.css)({background:"none",borderColor:"transparent"}),valueContainer:(0,c.css)({display:"flex",alignItems:"center",flex:"initial",color:e.colors.text.secondary,fontSize:12})}))),B=({children:e})=>{const t=(0,a.useStyles2)(Q);return n().createElement("div",{className:t.root},e)},Q=()=>({root:(0,c.css)({display:"flex","> *":{"&:not(:first-child)":{marginLeft:-1},"&:first-child":{borderTopRightRadius:0,borderBottomRightRadius:0},"&:last-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:first-child):not(:last-child)":{borderRadius:0},position:"relative",zIndex:1,"&:hover":{zIndex:2},"&:focus-within":{zIndex:2}}})});var $=m(5980);const V=e=>{const t=Math.floor(e%1e3),r=Math.floor(e/1e3%60),n=Math.floor(e/1e3/60%60),i=Math.floor(e/1e3/3600%24),a=Math.floor(e/864e5),o=["d","h","m","s","ms"],s=[a,i,n,r,t].map(((e,t)=>e?`${e}${o[t]}`:""));return s.filter((e=>e)).join(" ")};function X(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function G(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){G(e,t,r[t])}))}return e}const z=(e="#")=>`${e.replace(/\/$/,"")}/vmui/`,W=[{title:"Last 5 minutes",duration:"5m"},{title:"Last 15 minutes",duration:"15m"},{title:"Last 30 minutes",duration:"30m"},{title:"Last 1 hour",duration:"1h"},{title:"Last 3 hours",duration:"3h"},{title:"Last 6 hours",duration:"6h"},{title:"Last 12 hours",duration:"12h"},{title:"Last 24 hours",duration:"24h"},{title:"Last 2 days",duration:"2d"},{title:"Last 7 days",duration:"7d"},{title:"Last 30 days",duration:"30d"},{title:"Last 90 days",duration:"90d"},{title:"Last 180 days",duration:"180d"},{title:"Last 1 year",duration:"1y"},{title:"Yesterday",duration:"1d"},{title:"Today",duration:"1d"}].map((e=>U({id:e.title.replace(/\s/g,"_").toLocaleLowerCase()},e))),K=({panelData:e,query:o,datasource:s,dashboardUID:l})=>{const[u,c]=(0,r.useState)("");return(0,r.useEffect)((()=>{const r=(n=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){X(a,n,i,o,s,"next",e)}function s(e){X(a,n,i,o,s,"throw",e)}o(void 0)}))}}((function*(){if(!(null==e?void 0:e.request))return;const r=(0,i.getBackendSrv)(),n=yield r.get(`/api/datasources/${s.id}`);let a="none";const{request:{range:u,interval:d,scopedVars:p,rangeRaw:f}}=e;if("string"==typeof(null==f?void 0:f.from)){var m;const e=f.from.replace("now-","");a=(null===(m=W.find((t=>t.duration===e)))||void 0===m?void 0:m.id)||"none"}const h=s.getPrometheusTime(u.from,!1),g=s.getPrometheusTime(u.to,!0),y=Math.ceil(g-h),v=u.to.utc().format("YYYY-MM-DD HH:mm"),b=U({},p,s.getRateIntervalScopedVariable(t.rangeUtil.intervalToSeconds(d),t.rangeUtil.intervalToSeconds(s.interval))),O={interval:d,dashboardUID:l,scopedVars:b},w={};if(s.customQueryParameters)for(const[e,t]of s.customQueryParameters)w[e]=t;const _=s.createQuery(o,O,h,g),S=(T=U({},w),P=null!=(P={"g0.expr":_.expr,"g0.range_input":V(1e3*y),"g0.end_input":v,"g0.step_input":_.step?V(1e3*_.step):"","g0.relative_time":a,"g0.tab":0})?P:{},Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(P)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(P)).forEach((function(e){Object.defineProperty(T,e,Object.getOwnPropertyDescriptor(P,e))})),T),E=(0,$.map)(S,((e,t)=>t+"="+encodeURIComponent(e))).join("&"),x=n.jsonData.vmuiUrl||z(n.url);var T,P;c(`${x}?${E}`)})),function(){return n.apply(this,arguments)});var n;r()}),[l,s,e,o]),n().createElement("a",{href:t.textUtil.sanitizeUrl(u),target:"_blank",rel:"noopener noreferrer",style:{display:"flex",alignItems:"center",justifyContent:"center"}},n().createElement(a.IconButton,{key:"vmui",name:"external-link-alt",tooltip:"Run in vmui"}))},H=(0,r.memo)(K),Y=({onClose:e,onAccept:t})=>n().createElement(a.Alert,{title:"Please save dashboard before using WITH templates",severity:"error",elevated:!0},n().createElement("div",null,"This dashboard is not saved yet. Please save it before using WITH templates.",n().createElement("p",null,"Otherwise, the templates will not be saved")),n().createElement(a.HorizontalGroup,{justify:"flex-end",spacing:"xs"},n().createElement(a.Button,{fill:"text",onClick:e},"Cancel"),n().createElement(a.Button,{variant:"destructive",fill:"text",onClick:t},"Proceed with WITH templates"))),Z="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,J=new Set,ee="object"==typeof process&&process?process:{},te=(e,t,r,n)=>{"function"==typeof ee.emitWarning?ee.emitWarning(e,t,r,n):console.error(`[${r}] ${t}: ${e}`)};let re=globalThis.AbortController,ne=globalThis.AbortSignal;if(void 0===re){ne=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(e,t){this._onabort.push(t)}},re=class{constructor(){t()}signal=new ne;abort(e){if(!this.signal.aborted){this.signal.reason=e,this.signal.aborted=!0;for(const t of this.signal._onabort)t(e);this.signal.onabort?.(e)}}};let e="1"!==ee.env?.LRU_CACHE_IGNORE_AC_WARNING;const t=()=>{e&&(e=!1,te("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",t))}}Symbol("type");const ie=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),ae=e=>ie(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?oe:null:null;class oe extends Array{constructor(e){super(e),this.fill(0)}}class se{heap;length;static#e=!1;static create(e){const t=ae(e);if(!t)return[];se.#e=!0;const r=new se(e,t);return se.#e=!1,r}constructor(e,t){if(!se.#e)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class le{#t;#r;#n;#i;#a;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#o;#s;#l;#u;#c;#d;#p;#f;#m;#h;#g;#y;#v;#b;#O;#w;#_;static unsafeExposeInternals(e){return{starts:e.#v,ttls:e.#b,sizes:e.#y,keyMap:e.#l,keyList:e.#u,valList:e.#c,next:e.#d,prev:e.#p,get head(){return e.#f},get tail(){return e.#m},free:e.#h,isBackgroundFetch:t=>e.#S(t),backgroundFetch:(t,r,n,i)=>e.#E(t,r,n,i),moveToTail:t=>e.#x(t),indexes:t=>e.#T(t),rindexes:t=>e.#P(t),isStale:t=>e.#k(t)}}get max(){return this.#t}get maxSize(){return this.#r}get calculatedSize(){return this.#s}get size(){return this.#o}get fetchMethod(){return this.#a}get dispose(){return this.#n}get disposeAfter(){return this.#i}constructor(e){const{max:t=0,ttl:r,ttlResolution:n=1,ttlAutopurge:i,updateAgeOnGet:a,updateAgeOnHas:o,allowStale:s,dispose:l,disposeAfter:u,noDisposeOnSet:c,noUpdateTTL:d,maxSize:p=0,maxEntrySize:f=0,sizeCalculation:m,fetchMethod:h,noDeleteOnFetchRejection:g,noDeleteOnStaleGet:y,allowStaleOnFetchRejection:v,allowStaleOnFetchAbort:b,ignoreFetchAbort:O}=e;if(0!==t&&!ie(t))throw new TypeError("max option must be a nonnegative integer");const w=t?ae(t):Array;if(!w)throw new Error("invalid max value: "+t);if(this.#t=t,this.#r=p,this.maxEntrySize=f||this.#r,this.sizeCalculation=m,this.sizeCalculation){if(!this.#r&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(void 0!==h&&"function"!=typeof h)throw new TypeError("fetchMethod must be a function if specified");if(this.#a=h,this.#w=!!h,this.#l=new Map,this.#u=new Array(t).fill(void 0),this.#c=new Array(t).fill(void 0),this.#d=new w(t),this.#p=new w(t),this.#f=0,this.#m=0,this.#h=se.create(t),this.#o=0,this.#s=0,"function"==typeof l&&(this.#n=l),"function"==typeof u?(this.#i=u,this.#g=[]):(this.#i=void 0,this.#g=void 0),this.#O=!!this.#n,this.#_=!!this.#i,this.noDisposeOnSet=!!c,this.noUpdateTTL=!!d,this.noDeleteOnFetchRejection=!!g,this.allowStaleOnFetchRejection=!!v,this.allowStaleOnFetchAbort=!!b,this.ignoreFetchAbort=!!O,0!==this.maxEntrySize){if(0!==this.#r&&!ie(this.#r))throw new TypeError("maxSize must be a positive integer if specified");if(!ie(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#I()}if(this.allowStale=!!s,this.noDeleteOnStaleGet=!!y,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!o,this.ttlResolution=ie(n)||0===n?n:1,this.ttlAutopurge=!!i,this.ttl=r||0,this.ttl){if(!ie(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#C()}if(0===this.#t&&0===this.ttl&&0===this.#r)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#t&&!this.#r){const e="LRU_CACHE_UNBOUNDED";(e=>!J.has(e))(e)&&(J.add(e),te("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",e,le))}}getRemainingTTL(e){return this.#l.has(e)?1/0:0}#C(){const e=new oe(this.#t),t=new oe(this.#t);this.#b=e,this.#v=t,this.#A=(r,n,i=Z.now())=>{if(t[r]=0!==n?i:0,e[r]=n,0!==n&&this.ttlAutopurge){const e=setTimeout((()=>{this.#k(r)&&this.delete(this.#u[r])}),n+1);e.unref&&e.unref()}},this.#q=r=>{t[r]=0!==e[r]?Z.now():0},this.#R=(i,a)=>{if(e[a]){const o=e[a],s=t[a];i.ttl=o,i.start=s,i.now=r||n();const l=i.now-s;i.remainingTTL=o-l}};let r=0;const n=()=>{const e=Z.now();if(this.ttlResolution>0){r=e;const t=setTimeout((()=>r=0),this.ttlResolution);t.unref&&t.unref()}return e};this.getRemainingTTL=i=>{const a=this.#l.get(i);if(void 0===a)return 0;const o=e[a],s=t[a];return 0===o||0===s?1/0:o-((r||n())-s)},this.#k=i=>0!==e[i]&&0!==t[i]&&(r||n())-t[i]>e[i]}#q=()=>{};#R=()=>{};#A=()=>{};#k=()=>!1;#I(){const e=new oe(this.#t);this.#s=0,this.#y=e,this.#D=t=>{this.#s-=e[t],e[t]=0},this.#N=(e,t,r,n)=>{if(this.#S(t))return 0;if(!ie(r)){if(!n)throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");if("function"!=typeof n)throw new TypeError("sizeCalculation must be a function");if(r=n(t,e),!ie(r))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return r},this.#L=(t,r,n)=>{if(e[t]=r,this.#r){const r=this.#r-e[t];for(;this.#s>r;)this.#j(!0)}this.#s+=e[t],n&&(n.entrySize=r,n.totalCalculatedSize=this.#s)}}#D=e=>{};#L=(e,t,r)=>{};#N=(e,t,r,n)=>{if(r||n)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#T({allowStale:e=this.allowStale}={}){if(this.#o)for(let t=this.#m;this.#M(t)&&(!e&&this.#k(t)||(yield t),t!==this.#f);)t=this.#p[t]}*#P({allowStale:e=this.allowStale}={}){if(this.#o)for(let t=this.#f;this.#M(t)&&(!e&&this.#k(t)||(yield t),t!==this.#m);)t=this.#d[t]}#M(e){return void 0!==e&&this.#l.get(this.#u[e])===e}*entries(){for(const e of this.#T())void 0===this.#c[e]||void 0===this.#u[e]||this.#S(this.#c[e])||(yield[this.#u[e],this.#c[e]])}*rentries(){for(const e of this.#P())void 0===this.#c[e]||void 0===this.#u[e]||this.#S(this.#c[e])||(yield[this.#u[e],this.#c[e]])}*keys(){for(const e of this.#T()){const t=this.#u[e];void 0===t||this.#S(this.#c[e])||(yield t)}}*rkeys(){for(const e of this.#P()){const t=this.#u[e];void 0===t||this.#S(this.#c[e])||(yield t)}}*values(){for(const e of this.#T())void 0===this.#c[e]||this.#S(this.#c[e])||(yield this.#c[e])}*rvalues(){for(const e of this.#P())void 0===this.#c[e]||this.#S(this.#c[e])||(yield this.#c[e])}[Symbol.iterator](){return this.entries()}find(e,t={}){for(const r of this.#T()){const n=this.#c[r],i=this.#S(n)?n.__staleWhileFetching:n;if(void 0!==i&&e(i,this.#u[r],this))return this.get(this.#u[r],t)}}forEach(e,t=this){for(const r of this.#T()){const n=this.#c[r],i=this.#S(n)?n.__staleWhileFetching:n;void 0!==i&&e.call(t,i,this.#u[r],this)}}rforEach(e,t=this){for(const r of this.#P()){const n=this.#c[r],i=this.#S(n)?n.__staleWhileFetching:n;void 0!==i&&e.call(t,i,this.#u[r],this)}}purgeStale(){let e=!1;for(const t of this.#P({allowStale:!0}))this.#k(t)&&(this.delete(this.#u[t]),e=!0);return e}dump(){const e=[];for(const t of this.#T({allowStale:!0})){const r=this.#u[t],n=this.#c[t],i=this.#S(n)?n.__staleWhileFetching:n;if(void 0===i||void 0===r)continue;const a={value:i};if(this.#b&&this.#v){a.ttl=this.#b[t];const e=Z.now()-this.#v[t];a.start=Math.floor(Date.now()-e)}this.#y&&(a.size=this.#y[t]),e.unshift([r,a])}return e}load(e){this.clear();for(const[t,r]of e){if(r.start){const e=Date.now()-r.start;r.start=Z.now()-e}this.set(t,r.value,r)}}set(e,t,r={}){if(void 0===t)return this.delete(e),this;const{ttl:n=this.ttl,start:i,noDisposeOnSet:a=this.noDisposeOnSet,sizeCalculation:o=this.sizeCalculation,status:s}=r;let{noUpdateTTL:l=this.noUpdateTTL}=r;const u=this.#N(e,t,r.size||0,o);if(this.maxEntrySize&&u>this.maxEntrySize)return s&&(s.set="miss",s.maxEntrySizeExceeded=!0),this.delete(e),this;let c=0===this.#o?void 0:this.#l.get(e);if(void 0===c)c=0===this.#o?this.#m:0!==this.#h.length?this.#h.pop():this.#o===this.#t?this.#j(!1):this.#o,this.#u[c]=e,this.#c[c]=t,this.#l.set(e,c),this.#d[this.#m]=c,this.#p[c]=this.#m,this.#m=c,this.#o++,this.#L(c,u,s),s&&(s.set="add"),l=!1;else{this.#x(c);const r=this.#c[c];if(t!==r){if(this.#w&&this.#S(r)){r.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:t}=r;void 0===t||a||(this.#O&&this.#n?.(t,e,"set"),this.#_&&this.#g?.push([t,e,"set"]))}else a||(this.#O&&this.#n?.(r,e,"set"),this.#_&&this.#g?.push([r,e,"set"]));if(this.#D(c),this.#L(c,u,s),this.#c[c]=t,s){s.set="replace";const e=r&&this.#S(r)?r.__staleWhileFetching:r;void 0!==e&&(s.oldValue=e)}}else s&&(s.set="update")}if(0===n||this.#b||this.#C(),this.#b&&(l||this.#A(c,n,i),s&&this.#R(s,c)),!a&&this.#_&&this.#g){const e=this.#g;let t;for(;t=e?.shift();)this.#i?.(...t)}return this}pop(){try{for(;this.#o;){const e=this.#c[this.#f];if(this.#j(!0),this.#S(e)){if(e.__staleWhileFetching)return e.__staleWhileFetching}else if(void 0!==e)return e}}finally{if(this.#_&&this.#g){const e=this.#g;let t;for(;t=e?.shift();)this.#i?.(...t)}}}#j(e){const t=this.#f,r=this.#u[t],n=this.#c[t];return this.#w&&this.#S(n)?n.__abortController.abort(new Error("evicted")):(this.#O||this.#_)&&(this.#O&&this.#n?.(n,r,"evict"),this.#_&&this.#g?.push([n,r,"evict"])),this.#D(t),e&&(this.#u[t]=void 0,this.#c[t]=void 0,this.#h.push(t)),1===this.#o?(this.#f=this.#m=0,this.#h.length=0):this.#f=this.#d[t],this.#l.delete(r),this.#o--,t}has(e,t={}){const{updateAgeOnHas:r=this.updateAgeOnHas,status:n}=t,i=this.#l.get(e);if(void 0!==i){const e=this.#c[i];if(this.#S(e)&&void 0===e.__staleWhileFetching)return!1;if(!this.#k(i))return r&&this.#q(i),n&&(n.has="hit",this.#R(n,i)),!0;n&&(n.has="stale",this.#R(n,i))}else n&&(n.has="miss");return!1}peek(e,t={}){const{allowStale:r=this.allowStale}=t,n=this.#l.get(e);if(void 0!==n&&(r||!this.#k(n))){const e=this.#c[n];return this.#S(e)?e.__staleWhileFetching:e}}#E(e,t,r,n){const i=void 0===t?void 0:this.#c[t];if(this.#S(i))return i;const a=new re,{signal:o}=r;o?.addEventListener("abort",(()=>a.abort(o.reason)),{signal:a.signal});const s={signal:a.signal,options:r,context:n},l=(n,i=!1)=>{const{aborted:o}=a.signal,l=r.ignoreFetchAbort&&void 0!==n;if(r.status&&(o&&!i?(r.status.fetchAborted=!0,r.status.fetchError=a.signal.reason,l&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),o&&!l&&!i)return u(a.signal.reason);const d=c;return this.#c[t]===c&&(void 0===n?d.__staleWhileFetching?this.#c[t]=d.__staleWhileFetching:this.delete(e):(r.status&&(r.status.fetchUpdated=!0),this.set(e,n,s.options))),n},u=n=>{const{aborted:i}=a.signal,o=i&&r.allowStaleOnFetchAbort,s=o||r.allowStaleOnFetchRejection,l=s||r.noDeleteOnFetchRejection,u=c;if(this.#c[t]===c&&(l&&void 0!==u.__staleWhileFetching?o||(this.#c[t]=u.__staleWhileFetching):this.delete(e)),s)return r.status&&void 0!==u.__staleWhileFetching&&(r.status.returnedStale=!0),u.__staleWhileFetching;if(u.__returned===u)throw n};r.status&&(r.status.fetchDispatched=!0);const c=new Promise(((t,n)=>{const o=this.#a?.(e,i,s);o&&o instanceof Promise&&o.then((e=>t(void 0===e?void 0:e)),n),a.signal.addEventListener("abort",(()=>{r.ignoreFetchAbort&&!r.allowStaleOnFetchAbort||(t(void 0),r.allowStaleOnFetchAbort&&(t=e=>l(e,!0)))}))})).then(l,(e=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=e),u(e)))),d=Object.assign(c,{__abortController:a,__staleWhileFetching:i,__returned:void 0});return void 0===t?(this.set(e,d,{...s.options,status:void 0}),t=this.#l.get(e)):this.#c[t]=d,d}#S(e){if(!this.#w)return!1;const t=e;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof re}async fetch(e,t={}){const{allowStale:r=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,ttl:a=this.ttl,noDisposeOnSet:o=this.noDisposeOnSet,size:s=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:c=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:d=this.allowStaleOnFetchRejection,ignoreFetchAbort:p=this.ignoreFetchAbort,allowStaleOnFetchAbort:f=this.allowStaleOnFetchAbort,context:m,forceRefresh:h=!1,status:g,signal:y}=t;if(!this.#w)return g&&(g.fetch="get"),this.get(e,{allowStale:r,updateAgeOnGet:n,noDeleteOnStaleGet:i,status:g});const v={allowStale:r,updateAgeOnGet:n,noDeleteOnStaleGet:i,ttl:a,noDisposeOnSet:o,size:s,sizeCalculation:l,noUpdateTTL:u,noDeleteOnFetchRejection:c,allowStaleOnFetchRejection:d,allowStaleOnFetchAbort:f,ignoreFetchAbort:p,status:g,signal:y};let b=this.#l.get(e);if(void 0===b){g&&(g.fetch="miss");const t=this.#E(e,b,v,m);return t.__returned=t}{const t=this.#c[b];if(this.#S(t)){const e=r&&void 0!==t.__staleWhileFetching;return g&&(g.fetch="inflight",e&&(g.returnedStale=!0)),e?t.__staleWhileFetching:t.__returned=t}const i=this.#k(b);if(!h&&!i)return g&&(g.fetch="hit"),this.#x(b),n&&this.#q(b),g&&this.#R(g,b),t;const a=this.#E(e,b,v,m),o=void 0!==a.__staleWhileFetching&&r;return g&&(g.fetch=i?"stale":"refresh",o&&i&&(g.returnedStale=!0)),o?a.__staleWhileFetching:a.__returned=a}}get(e,t={}){const{allowStale:r=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,status:a}=t,o=this.#l.get(e);if(void 0!==o){const t=this.#c[o],s=this.#S(t);return a&&this.#R(a,o),this.#k(o)?(a&&(a.get="stale"),s?(a&&r&&void 0!==t.__staleWhileFetching&&(a.returnedStale=!0),r?t.__staleWhileFetching:void 0):(i||this.delete(e),a&&r&&(a.returnedStale=!0),r?t:void 0)):(a&&(a.get="hit"),s?t.__staleWhileFetching:(this.#x(o),n&&this.#q(o),t))}a&&(a.get="miss")}#F(e,t){this.#p[t]=e,this.#d[e]=t}#x(e){e!==this.#m&&(e===this.#f?this.#f=this.#d[e]:this.#F(this.#p[e],this.#d[e]),this.#F(this.#m,e),this.#m=e)}delete(e){let t=!1;if(0!==this.#o){const r=this.#l.get(e);if(void 0!==r)if(t=!0,1===this.#o)this.clear();else{this.#D(r);const t=this.#c[r];this.#S(t)?t.__abortController.abort(new Error("deleted")):(this.#O||this.#_)&&(this.#O&&this.#n?.(t,e,"delete"),this.#_&&this.#g?.push([t,e,"delete"])),this.#l.delete(e),this.#u[r]=void 0,this.#c[r]=void 0,r===this.#m?this.#m=this.#p[r]:r===this.#f?this.#f=this.#d[r]:(this.#d[this.#p[r]]=this.#d[r],this.#p[this.#d[r]]=this.#p[r]),this.#o--,this.#h.push(r)}}if(this.#_&&this.#g?.length){const e=this.#g;let t;for(;t=e?.shift();)this.#i?.(...t)}return t}clear(){for(const e of this.#P({allowStale:!0})){const t=this.#c[e];if(this.#S(t))t.__abortController.abort(new Error("deleted"));else{const r=this.#u[e];this.#O&&this.#n?.(t,r,"delete"),this.#_&&this.#g?.push([t,r,"delete"])}}if(this.#l.clear(),this.#c.fill(void 0),this.#u.fill(void 0),this.#b&&this.#v&&(this.#b.fill(0),this.#v.fill(0)),this.#y&&this.#y.fill(0),this.#f=0,this.#m=0,this.#h.length=0,this.#s=0,this.#o=0,this.#_&&this.#g){const e=this.#g;let t;for(;t=e?.shift();)this.#i?.(...t)}}}var ue=m(3342),ce=m.n(ue);const de=1024;let pe=0;class fe{constructor(e,t){this.from=e,this.to=t}}class me{constructor(e={}){this.id=pe++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof e&&(e=ye.match(e)),t=>{let r=e(t);return void 0===r?null:[this,r]}}}me.closedBy=new me({deserialize:e=>e.split(" ")}),me.openedBy=new me({deserialize:e=>e.split(" ")}),me.group=new me({deserialize:e=>e.split(" ")}),me.isolate=new me({deserialize:e=>{if(e&&"rtl"!=e&&"ltr"!=e&&"auto"!=e)throw new RangeError("Invalid value for isolate: "+e);return e||"auto"}}),me.contextHash=new me({perNode:!0}),me.lookAhead=new me({perNode:!0}),me.mounted=new me({perNode:!0});class he{constructor(e,t,r){this.tree=e,this.overlay=t,this.parser=r}static get(e){return e&&e.props&&e.props[me.mounted.id]}}const ge=Object.create(null);class ye{constructor(e,t,r,n=0){this.name=e,this.props=t,this.id=r,this.flags=n}static define(e){let t=e.props&&e.props.length?Object.create(null):ge,r=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(null==e.name?8:0),n=new ye(e.name||"",t,e.id,r);if(e.props)for(let r of e.props)if(Array.isArray(r)||(r=r(n)),r){if(r[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[r[0].id]=r[1]}return n}prop(e){return this.props[e.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(e){if("string"==typeof e){if(this.name==e)return!0;let t=this.prop(me.group);return!!t&&t.indexOf(e)>-1}return this.id==e}static match(e){let t=Object.create(null);for(let r in e)for(let n of r.split(" "))t[n]=e[r];return e=>{for(let r=e.prop(me.group),n=-1;n<(r?r.length:0);n++){let i=t[n<0?e.name:r[n]];if(i)return i}}}}ye.none=new ye("",Object.create(null),0,8);class ve{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let r of this.types){let n=null;for(let t of e){let e=t(r);e&&(n||(n=Object.assign({},r.props)),n[e[0].id]=e[1])}t.push(n?new ye(r.name,n,r.id,r.flags):r)}return new ve(t)}}const be=new WeakMap,Oe=new WeakMap;var we;!function(e){e[e.ExcludeBuffers=1]="ExcludeBuffers",e[e.IncludeAnonymous=2]="IncludeAnonymous",e[e.IgnoreMounts=4]="IgnoreMounts",e[e.IgnoreOverlays=8]="IgnoreOverlays"}(we||(we={}));class _e{constructor(e,t,r,n,i){if(this.type=e,this.children=t,this.positions=r,this.length=n,this.props=null,i&&i.length){this.props=Object.create(null);for(let[e,t]of i)this.props["number"==typeof e?e:e.id]=t}}toString(){let e=he.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let e of this.children){let r=e.toString();r&&(t&&(t+=","),t+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new Ne(this.topNode,e)}cursorAt(e,t=0,r=0){let n=be.get(this)||this.topNode,i=new Ne(n);return i.moveTo(e,t),be.set(this,i._tree),i}get topNode(){return new ke(this,0,0,null)}resolve(e,t=0){let r=Te(be.get(this)||this.topNode,e,t,!1);return be.set(this,r),r}resolveInner(e,t=0){let r=Te(Oe.get(this)||this.topNode,e,t,!0);return Oe.set(this,r),r}resolveStack(e,t=0){return function(e,t,r){let n=e.resolveInner(t,r),i=null;for(let e=n instanceof ke?n:n.context.parent;e;e=e.parent)if(e.index<0){let a=e.parent;(i||(i=[n])).push(a.resolve(t,r)),e=a}else{let a=he.get(e.tree);if(a&&a.overlay&&a.overlay[0].from<=t&&a.overlay[a.overlay.length-1].to>=t){let o=new ke(a.tree,a.overlay[0].from+e.from,-1,e);(i||(i=[n])).push(Te(o,t,r,!1))}}return i?Re(i):n}(this,e,t)}iterate(e){let{enter:t,leave:r,from:n=0,to:i=this.length}=e,a=e.mode||0,o=(a&we.IncludeAnonymous)>0;for(let e=this.cursor(a|we.IncludeAnonymous);;){let a=!1;if(e.from<=i&&e.to>=n&&(!o&&e.type.isAnonymous||!1!==t(e))){if(e.firstChild())continue;a=!0}for(;a&&r&&(o||!e.type.isAnonymous)&&r(e),!e.nextSibling();){if(!e.parent())return;a=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Fe(ye.none,this.children,this.positions,0,this.children.length,0,this.length,((e,t,r)=>new _e(this.type,e,t,r,this.propValues)),e.makeTree||((e,t,r)=>new _e(ye.none,e,t,r)))}static build(e){return function(e){var t;let{buffer:r,nodeSet:n,maxBufferLength:i=de,reused:a=[],minRepeatType:o=n.types.length}=e,s=Array.isArray(r)?new Se(r,r.length):r,l=n.types,u=0,c=0;function d(e,t,r,g,y,v){let{id:b,start:O,end:w,size:_}=s,S=c;for(;_<0;){if(s.next(),-1==_){let t=a[b];return r.push(t),void g.push(O-e)}if(-3==_)return void(u=b);if(-4==_)return void(c=b);throw new RangeError(`Unrecognized record size: ${_}`)}let E,x,T=l[b],P=O-e;if(w-O<=i&&(x=function(e,t){let r=s.fork(),n=0,a=0,l=0,u=r.end-i,c={size:0,start:0,skip:0};e:for(let i=r.pos-e;r.pos>i;){let e=r.size;if(r.id==t&&e>=0){c.size=n,c.start=a,c.skip=l,l+=4,n+=4,r.next();continue}let s=r.pos-e;if(e<0||s<i||r.start<u)break;let d=r.id>=o?4:0,p=r.start;for(r.next();r.pos>s;){if(r.size<0){if(-3!=r.size)break e;d+=4}else r.id>=o&&(d+=4);r.next()}a=p,n+=e,l+=d}return(t<0||n==e)&&(c.size=n,c.start=a,c.skip=l),c.size>4?c:void 0}(s.pos-t,y))){let t=new Uint16Array(x.size-x.skip),r=s.pos-x.size,i=t.length;for(;s.pos>r;)i=h(x.start,t,i);E=new Ee(t,w-x.start,n),P=x.start-e}else{let e=s.pos-_;s.next();let t=[],r=[],n=b>=o?b:-1,a=0,l=w;for(;s.pos>e;)n>=0&&s.id==n&&s.size>=0?(s.end<=l-i&&(f(t,r,O,a,s.end,l,n,S),a=t.length,l=s.end),s.next()):v>2500?p(O,e,t,r):d(O,e,t,r,n,v+1);if(n>=0&&a>0&&a<t.length&&f(t,r,O,a,O,l,n,S),t.reverse(),r.reverse(),n>-1&&a>0){let e=function(e){return(t,r,n)=>{let i,a,o=0,s=t.length-1;if(s>=0&&(i=t[s])instanceof _e){if(!s&&i.type==e&&i.length==n)return i;(a=i.prop(me.lookAhead))&&(o=r[s]+i.length+a)}return m(e,t,r,n,o)}}(T);E=Fe(T,t,r,0,t.length,0,w-O,e,e)}else E=m(T,t,r,w-O,S-w)}r.push(E),g.push(P)}function p(e,t,r,a){let o=[],l=0,u=-1;for(;s.pos>t;){let{id:e,start:t,end:r,size:n}=s;if(n>4)s.next();else{if(u>-1&&t<u)break;u<0&&(u=r-i),o.push(e,t,r),l++,s.next()}}if(l){let t=new Uint16Array(4*l),i=o[o.length-2];for(let e=o.length-3,r=0;e>=0;e-=3)t[r++]=o[e],t[r++]=o[e+1]-i,t[r++]=o[e+2]-i,t[r++]=r;r.push(new Ee(t,o[2]-i,n)),a.push(i-e)}}function f(e,t,r,i,a,o,s,l){let u=[],c=[];for(;e.length>i;)u.push(e.pop()),c.push(t.pop()+r-a);e.push(m(n.types[s],u,c,o-a,l-o)),t.push(a-r)}function m(e,t,r,n,i=0,a){if(u){let e=[me.contextHash,u];a=a?[e].concat(a):[e]}if(i>25){let e=[me.lookAhead,i];a=a?[e].concat(a):[e]}return new _e(e,t,r,n,a)}function h(e,t,r){let{id:n,start:i,end:a,size:l}=s;if(s.next(),l>=0&&n<o){let o=r;if(l>4){let n=s.pos-(l-4);for(;s.pos>n;)r=h(e,t,r)}t[--r]=o,t[--r]=a-e,t[--r]=i-e,t[--r]=n}else-3==l?u=n:-4==l&&(c=n);return r}let g=[],y=[];for(;s.pos>0;)d(e.start||0,e.bufferStart||0,g,y,-1,0);let v=null!==(t=e.length)&&void 0!==t?t:g.length?y[0]+g[0].length:0;return new _e(l[e.topID],g.reverse(),y.reverse(),v)}(e)}}_e.empty=new _e(ye.none,[],[],0);class Se{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Se(this.buffer,this.index)}}class Ee{constructor(e,t,r){this.buffer=e,this.length=t,this.set=r}get type(){return ye.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],r=this.buffer[e+3],n=this.set.types[t],i=n.name;if(/\W/.test(i)&&!n.isError&&(i=JSON.stringify(i)),r==(e+=4))return i;let a=[];for(;e<r;)a.push(this.childString(e)),e=this.buffer[e+3];return i+"("+a.join(",")+")"}findChild(e,t,r,n,i){let{buffer:a}=this,o=-1;for(let s=e;s!=t&&!(xe(i,n,a[s+1],a[s+2])&&(o=s,r>0));s=a[s+3]);return o}slice(e,t,r){let n=this.buffer,i=new Uint16Array(t-e),a=0;for(let o=e,s=0;o<t;){i[s++]=n[o++],i[s++]=n[o++]-r;let t=i[s++]=n[o++]-r;i[s++]=n[o++]-e,a=Math.max(a,t)}return new Ee(i,a,this.set)}}function xe(e,t,r,n){switch(e){case-2:return r<t;case-1:return n>=t&&r<t;case 0:return r<t&&n>t;case 1:return r<=t&&n>t;case 2:return n>t;case 4:return!0}}function Te(e,t,r,n){for(var i;e.from==e.to||(r<1?e.from>=t:e.from>t)||(r>-1?e.to<=t:e.to<t);){let t=!n&&e instanceof ke&&e.index<0?null:e.parent;if(!t)return e;e=t}let a=n?0:we.IgnoreOverlays;if(n)for(let n=e,o=n.parent;o;n=o,o=n.parent)n instanceof ke&&n.index<0&&(null===(i=o.enter(t,r,a))||void 0===i?void 0:i.from)!=n.from&&(e=o);for(;;){let n=e.enter(t,r,a);if(!n)return e;e=n}}class Pe{cursor(e=0){return new Ne(this,e)}getChild(e,t=null,r=null){let n=Ie(this,e,t,r);return n.length?n[0]:null}getChildren(e,t=null,r=null){return Ie(this,e,t,r)}resolve(e,t=0){return Te(this,e,t,!1)}resolveInner(e,t=0){return Te(this,e,t,!0)}matchContext(e){return Ce(this,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),r=this;for(;t;){let e=t.lastChild;if(!e||e.to!=t.to)break;e.type.isError&&e.from==e.to?(r=t,t=e.prevSibling):t=e}return r}get node(){return this}get next(){return this.parent}}class ke extends Pe{constructor(e,t,r,n){super(),this._tree=e,this.from=t,this.index=r,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,r,n,i=0){for(let a=this;;){for(let{children:o,positions:s}=a._tree,l=t>0?o.length:-1;e!=l;e+=t){let l=o[e],u=s[e]+a.from;if(xe(n,r,u,u+l.length))if(l instanceof Ee){if(i&we.ExcludeBuffers)continue;let o=l.findChild(0,l.buffer.length,t,r-u,n);if(o>-1)return new qe(new Ae(a,l,e,u),null,o)}else if(i&we.IncludeAnonymous||!l.type.isAnonymous||Le(l)){let o;if(!(i&we.IgnoreMounts)&&(o=he.get(l))&&!o.overlay)return new ke(o.tree,u,e,a);let s=new ke(l,u,e,a);return i&we.IncludeAnonymous||!s.type.isAnonymous?s:s.nextChild(t<0?l.children.length-1:0,t,r,n)}}if(i&we.IncludeAnonymous||!a.type.isAnonymous)return null;if(e=a.index>=0?a.index+t:t<0?-1:a._parent._tree.children.length,a=a._parent,!a)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,r=0){let n;if(!(r&we.IgnoreOverlays)&&(n=he.get(this._tree))&&n.overlay){let r=e-this.from;for(let{from:e,to:i}of n.overlay)if((t>0?e<=r:e<r)&&(t<0?i>=r:i>r))return new ke(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Ie(e,t,r,n){let i=e.cursor(),a=[];if(!i.firstChild())return a;if(null!=r)for(let e=!1;!e;)if(e=i.type.is(r),!i.nextSibling())return a;for(;;){if(null!=n&&i.type.is(n))return a;if(i.type.is(t)&&a.push(i.node),!i.nextSibling())return null==n?a:[]}}function Ce(e,t,r=t.length-1){for(let n=e.parent;r>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(t[r]&&t[r]!=n.name)return!1;r--}}return!0}class Ae{constructor(e,t,r,n){this.parent=e,this.buffer=t,this.index=r,this.start=n}}class qe extends Pe{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,r){super(),this.context=e,this._parent=t,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}child(e,t,r){let{buffer:n}=this.context,i=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.context.start,r);return i<0?null:new qe(this.context,this,i)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,r=0){if(r&we.ExcludeBuffers)return null;let{buffer:n}=this.context,i=n.findChild(this.index+4,n.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return i<0?null:new qe(this.context,this,i)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new qe(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new qe(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:r}=this.context,n=this.index+4,i=r.buffer[this.index+3];if(i>n){let a=r.buffer[this.index+1];e.push(r.slice(n,i,a)),t.push(0)}return new _e(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Re(e){if(!e.length)return null;let t=0,r=e[0];for(let n=1;n<e.length;n++){let i=e[n];(i.from>r.from||i.to<r.to)&&(r=i,t=n)}let n=r instanceof ke&&r.index<0?null:r.parent,i=e.slice();return n?i[t]=n:i.splice(t,1),new De(i,r)}class De{constructor(e,t){this.heads=e,this.node=t}get next(){return Re(this.heads)}}class Ne{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof ke)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let t=e._parent;t;t=t._parent)this.stack.unshift(t.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return!!e&&(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0)}yieldBuf(e,t){this.index=e;let{start:r,buffer:n}=this.buffer;return this.type=t||n.set.types[n.buffer[e]],this.from=r+n.buffer[e+1],this.to=r+n.buffer[e+2],!0}yield(e){return!!e&&(e instanceof ke?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,r){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,r,this.mode));let{buffer:n}=this.buffer,i=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.buffer.start,r);return!(i<0)&&(this.stack.push(this.index),this.yieldBuf(i))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,r=this.mode){return this.buffer?!(r&we.ExcludeBuffers)&&this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&we.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&we.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode));let{buffer:t}=this.buffer,r=this.stack.length-1;if(e<0){let e=r<0?0:this.stack[r]+4;if(this.index!=e)return this.yieldBuf(t.findChild(e,this.index,-1,0,4))}else{let e=t.buffer[this.index+3];if(e<(r<0?t.buffer.length:t.buffer[this.stack[r]+3]))return this.yieldBuf(e)}return r<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,r,{buffer:n}=this;if(n){if(e>0){if(this.index<n.buffer.buffer.length)return!1}else for(let e=0;e<this.index;e++)if(n.buffer.buffer[e+3]<this.index)return!1;({index:t,parent:r}=n)}else({index:t,_parent:r}=this._tree);for(;r;({index:t,_parent:r}=r))if(t>-1)for(let n=t+e,i=e<0?-1:r._tree.children.length;n!=i;n+=e){let e=r._tree.children[n];if(this.mode&we.IncludeAnonymous||e instanceof Ee||!e.type.isAnonymous||Le(e))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,r=0;if(e&&e.context==this.buffer)e:for(let n=this.index,i=this.stack.length;i>=0;){for(let a=e;a;a=a._parent)if(a.index==n){if(n==this.index)return a;t=a,r=i+1;break e}n=this.stack[--i]}for(let e=r;e<this.stack.length;e++)t=new qe(this.buffer,t,this.stack[e]);return this.bufferNode=new qe(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let r=0;;){let n=!1;if(this.type.isAnonymous||!1!==e(this)){if(this.firstChild()){r++;continue}this.type.isAnonymous||(n=!0)}for(;n&&t&&t(this),n=this.type.isAnonymous,!this.nextSibling();){if(!r)return;this.parent(),r--,n=!0}}}matchContext(e){if(!this.buffer)return Ce(this.node,e);let{buffer:t}=this.buffer,{types:r}=t.set;for(let n=e.length-1,i=this.stack.length-1;n>=0;i--){if(i<0)return Ce(this.node,e,n);let a=r[t.buffer[this.stack[i]]];if(!a.isAnonymous){if(e[n]&&e[n]!=a.name)return!1;n--}}return!0}}function Le(e){return e.children.some((e=>e instanceof Ee||!e.type.isAnonymous||Le(e)))}const je=new WeakMap;function Me(e,t){if(!e.isAnonymous||t instanceof Ee||t.type!=e)return 1;let r=je.get(t);if(null==r){r=1;for(let n of t.children){if(n.type!=e||!(n instanceof _e)){r=1;break}r+=Me(e,n)}je.set(t,r)}return r}function Fe(e,t,r,n,i,a,o,s,l){let u=0;for(let r=n;r<i;r++)u+=Me(e,t[r]);let c=Math.ceil(1.5*u/8),d=[],p=[];return function t(r,n,i,o,s){for(let u=i;u<o;){let i=u,f=n[u],m=Me(e,r[u]);for(u++;u<o;u++){let t=Me(e,r[u]);if(m+t>=c)break;m+=t}if(u==i+1){if(m>c){let e=r[i];t(e.children,e.positions,0,e.children.length,n[i]+s);continue}d.push(r[i])}else{let t=n[u-1]+r[u-1].length-f;d.push(Fe(e,r,n,i,u,f,t,null,l))}p.push(f+s-a)}}(t,r,n,i,0),(s||l)(d,p,o)}class Be{startParse(e,t,r){return"string"==typeof e&&(e=new Qe(e)),r=r?r.length?r.map((e=>new fe(e.from,e.to))):[new fe(0,0)]:[new fe(0,e.length)],this.createParse(e,t||[],r)}parse(e,t,r){let n=this.startParse(e,t,r);for(;;){let e=n.advance();if(e)return e}}}class Qe{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new me({perNode:!0});class $e{constructor(e,t,r,n,i,a,o,s,l,u=0,c){this.p=e,this.stack=t,this.state=r,this.reducePos=n,this.pos=i,this.score=a,this.buffer=o,this.bufferBase=s,this.curContext=l,this.lookAhead=u,this.parent=c}toString(){return`[${this.stack.filter(((e,t)=>t%3==0)).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,r=0){let n=e.parser.context;return new $e(e,[],t,r,r,0,[],0,n?new Ve(n,n.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let r=e>>19,n=65535&e,{parser:i}=this.p,a=i.dynamicPrecedence(n);if(a&&(this.score+=a),0==r)return this.pushState(i.getGoto(this.state,n,!0),this.reducePos),n<i.minRepeatTerm&&this.storeNode(n,this.reducePos,this.reducePos,4,!0),void this.reduceContext(n,this.reducePos);let o=this.stack.length-3*(r-1)-(262144&e?6:0),s=o?this.stack[o-2]:this.p.ranges[0].from,l=this.reducePos-s;l>=2e3&&!(null===(t=this.p.parser.nodeSet.types[n])||void 0===t?void 0:t.isAnonymous)&&(s==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=l):this.p.lastBigReductionSize<l&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=s,this.p.lastBigReductionSize=l));let u=o?this.stack[o-1]:0,c=this.bufferBase+this.buffer.length-u;if(n<i.minRepeatTerm||131072&e){let e=i.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(n,s,e,c+4,!0)}if(262144&e)this.state=this.stack[o];else{let e=this.stack[o-3];this.state=i.getGoto(e,n,!0)}for(;this.stack.length>o;)this.stack.pop();this.reduceContext(n,s)}storeNode(e,t,r,n=4,i=!1){if(0==e&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let e=this,n=this.buffer.length;if(0==n&&e.parent&&(n=e.bufferBase-e.parent.bufferBase,e=e.parent),n>0&&0==e.buffer[n-4]&&e.buffer[n-1]>-1){if(t==r)return;if(e.buffer[n-2]>=t)return void(e.buffer[n-2]=r)}}if(i&&this.pos!=r){let i=this.buffer.length;if(i>0&&0!=this.buffer[i-4])for(;i>0&&this.buffer[i-2]>r;)this.buffer[i]=this.buffer[i-4],this.buffer[i+1]=this.buffer[i-3],this.buffer[i+2]=this.buffer[i-2],this.buffer[i+3]=this.buffer[i-1],i-=4,n>4&&(n-=4);this.buffer[i]=e,this.buffer[i+1]=t,this.buffer[i+2]=r,this.buffer[i+3]=n}else this.buffer.push(e,t,r,n)}shift(e,t,r,n){if(131072&e)this.pushState(65535&e,this.pos);else if(0==(262144&e)){let i=e,{parser:a}=this.p;(n>this.pos||t<=a.maxNode)&&(this.pos=n,a.stateFlag(i,1)||(this.reducePos=n)),this.pushState(i,r),this.shiftContext(t,r),t<=a.maxNode&&this.buffer.push(t,r,n,4)}else this.pos=n,this.shiftContext(t,r),t<=this.p.parser.maxNode&&this.buffer.push(t,r,n,4)}apply(e,t,r,n){65536&e?this.reduce(e):this.shift(e,t,r,n)}useNode(e,t){let r=this.p.reused.length-1;(r<0||this.p.reused[r]!=e)&&(this.p.reused.push(e),r++);let n=this.pos;this.reducePos=this.pos=n+e.length,this.pushState(t,n),this.buffer.push(r,n,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let r=e.buffer.slice(t),n=e.bufferBase+t;for(;e&&n==e.bufferBase;)e=e.parent;return new $e(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,r,n,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let r=e<=this.p.parser.maxNode;r&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,r?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new Xe(this);;){let r=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(0==r)return!1;if(0==(65536&r))return!0;t.reduce(r)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let r=[];for(let n,i=0;i<t.length;i+=2)(n=t[i+1])!=this.state&&this.p.parser.hasAction(n,e)&&r.push(t[i],n);if(this.stack.length<120)for(let e=0;r.length<8&&e<t.length;e+=2){let n=t[e+1];r.some(((e,t)=>1&t&&e==n))||r.push(t[e],n)}t=r}let r=[];for(let e=0;e<t.length&&r.length<4;e+=2){let n=t[e+1];if(n==this.state)continue;let i=this.split();i.pushState(n,this.pos),i.storeNode(0,i.pos,i.pos,4,!0),i.shiftContext(t[e],this.pos),i.reducePos=this.pos,i.score-=200,r.push(i)}return r}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if(0==(65536&t))return!1;if(!e.validAction(this.state,t)){let r=t>>19,n=65535&t,i=this.stack.length-3*r;if(i<0||e.getGoto(this.stack[i],n,!1)<0){let e=this.findForcedReduction();if(null==e)return!1;t=e}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],r=(n,i)=>{if(!t.includes(n))return t.push(n),e.allActions(n,(t=>{if(393216&t);else if(65536&t){let r=(t>>19)-i;if(r>1){let n=65535&t,i=this.stack.length-3*r;if(i>=0&&e.getGoto(this.stack[i],n,!1)>=0)return r<<19|65536|n}}else{let e=r(t,i+1);if(null!=e)return e}}))};return r(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:e}=this.p;return 65535==e.data[e.stateSlot(this.state,1)]&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||-3!=this.buffer[e])&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||-4!=this.buffer[e])&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new Ve(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class Ve{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class Xe{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=65535&e,r=e>>19;0==r?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(r-1);let n=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=n}}class Ge{constructor(e,t,r){this.stack=e,this.pos=t,this.index=r,this.buffer=e.buffer,0==this.index&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new Ge(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;null!=e&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new Ge(this.stack,this.pos,this.index)}}function Ue(e,t=Uint16Array){if("string"!=typeof e)return e;let r=null;for(let n=0,i=0;n<e.length;){let a=0;for(;;){let t=e.charCodeAt(n++),r=!1;if(126==t){a=65535;break}t>=92&&t--,t>=34&&t--;let i=t-32;if(i>=46&&(i-=46,r=!0),a+=i,r)break;a*=46}r?r[i++]=a:r=new t(a)}return r}class ze{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const We=new ze;class Ke{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=We,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let r=this.range,n=this.rangeIndex,i=this.pos+e;for(;i<r.from;){if(!n)return null;let e=this.ranges[--n];i-=r.from-e.to,r=e}for(;t<0?i>r.to:i>=r.to;){if(n==this.ranges.length-1)return null;let e=this.ranges[++n];i+=e.from-r.to,r=e}return i}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t,r,n=this.chunkOff+e;if(n>=0&&n<this.chunk.length)t=this.pos+e,r=this.chunk.charCodeAt(n);else{let n=this.resolveOffset(e,1);if(null==n)return-1;if(t=n,t>=this.chunk2Pos&&t<this.chunk2Pos+this.chunk2.length)r=this.chunk2.charCodeAt(t-this.chunk2Pos);else{let e=this.rangeIndex,n=this.range;for(;n.to<=t;)n=this.ranges[++e];this.chunk2=this.input.chunk(this.chunk2Pos=t),t+this.chunk2.length>n.to&&(this.chunk2=this.chunk2.slice(0,n.to-t)),r=this.chunk2.charCodeAt(0)}}return t>=this.token.lookAhead&&(this.token.lookAhead=t+1),r}acceptToken(e,t=0){let r=t?this.resolveOffset(t,-1):this.pos;if(null==r||r<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=r}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=We,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let r="";for(let n of this.ranges){if(n.from>=t)break;n.to>e&&(r+=this.input.read(Math.max(n.from,e),Math.min(n.to,t)))}return r}}class He{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:r}=t.p;!function(e,t,r,n,i,a){let o=0,s=1<<n,{dialect:l}=r.p.parser;e:for(;0!=(s&e[o]);){let r=e[o+1];for(let n=o+3;n<r;n+=2)if((e[n+1]&s)>0){let r=e[n];if(l.allows(r)&&(-1==t.token.value||t.token.value==r||Ze(r,t.token.value,i,a))){t.acceptToken(r);break}}let n=t.next,u=0,c=e[o+2];if(!(t.next<0&&c>u&&65535==e[r+3*c-3])){for(;u<c;){let i=u+c>>1,a=r+i+(i<<1),s=e[a],l=e[a+1]||65536;if(n<s)c=i;else{if(!(n>=l)){o=e[a+2],t.advance();continue e}u=i+1}}break}o=e[r+3*c-1]}}(this.data,e,t,this.id,r.data,r.tokenPrecTable)}}function Ye(e,t,r){for(let n,i=t;65535!=(n=e[i]);i++)if(n==r)return i-t;return-1}function Ze(e,t,r,n){let i=Ye(r,n,t);return i<0||Ye(r,n,e)<i}He.prototype.contextual=He.prototype.fallback=He.prototype.extend=!1,He.prototype.fallback=He.prototype.extend=!1;const Je="undefined"!=typeof process&&process.env&&/\bparse\b/.test(process.env.LOG);let et=null;function tt(e,t,r){let n=e.cursor(we.IncludeAnonymous);for(n.moveTo(t);;)if(!(r<0?n.childBefore(t):n.childAfter(t)))for(;;){if((r<0?n.to<t:n.from>t)&&!n.type.isError)return r<0?Math.max(0,Math.min(n.to-1,t-25)):Math.min(e.length,Math.max(n.from+1,t+25));if(r<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return r<0?0:e.length}}class rt{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?tt(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?tt(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let r=this.trees[t],n=this.index[t];if(n==r.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let i=r.children[n],a=this.start[t]+r.positions[n];if(a>e)return this.nextStart=a,null;if(i instanceof _e){if(a==e){if(a<this.safeFrom)return null;let e=a+i.length;if(e<=this.safeTo){let t=i.prop(me.lookAhead);if(!t||e+t<this.fragment.to)return i}}this.index[t]++,a+i.length>=Math.max(this.safeFrom,e)&&(this.trees.push(i),this.start.push(a),this.index.push(0))}else this.index[t]++,this.nextStart=a+i.length}}}class nt{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map((e=>new ze))}getActions(e){let t=0,r=null,{parser:n}=e.p,{tokenizers:i}=n,a=n.stateSlot(e.state,3),o=e.curContext?e.curContext.hash:0,s=0;for(let n=0;n<i.length;n++){if(0==(1<<n&a))continue;let l=i[n],u=this.tokens[n];if((!r||l.fallback)&&((l.contextual||u.start!=e.pos||u.mask!=a||u.context!=o)&&(this.updateCachedToken(u,l,e),u.mask=a,u.context=o),u.lookAhead>u.end+25&&(s=Math.max(u.lookAhead,s)),0!=u.value)){let n=t;if(u.extended>-1&&(t=this.addActions(e,u.extended,u.end,t)),t=this.addActions(e,u.value,u.end,t),!l.extend&&(r=u,t>n))break}}for(;this.actions.length>t;)this.actions.pop();return s&&e.setLookAhead(s),r||e.pos!=this.stream.end||(r=new ze,r.value=e.p.parser.eofTerm,r.start=r.end=e.pos,t=this.addActions(e,r.value,r.end,t)),this.mainToken=r,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new ze,{pos:r,p:n}=e;return t.start=r,t.end=Math.min(r+1,n.stream.end),t.value=r==n.stream.end?n.parser.eofTerm:0,t}updateCachedToken(e,t,r){let n=this.stream.clipPos(r.pos);if(t.token(this.stream.reset(n,e),r),e.value>-1){let{parser:t}=r.p;for(let n=0;n<t.specialized.length;n++)if(t.specialized[n]==e.value){let i=t.specializers[n](this.stream.read(e.start,e.end),r);if(i>=0&&r.p.parser.dialect.allows(i>>1)){0==(1&i)?e.value=i>>1:e.extended=i>>1;break}}}else e.value=0,e.end=this.stream.clipPos(n+1)}putAction(e,t,r,n){for(let t=0;t<n;t+=3)if(this.actions[t]==e)return n;return this.actions[n++]=e,this.actions[n++]=t,this.actions[n++]=r,n}addActions(e,t,r,n){let{state:i}=e,{parser:a}=e.p,{data:o}=a;for(let e=0;e<2;e++)for(let s=a.stateSlot(i,e?2:1);;s+=3){if(65535==o[s]){if(1!=o[s+1]){0==n&&2==o[s+1]&&(n=this.putAction(lt(o,s+2),t,r,n));break}s=lt(o,s+2)}o[s]==t&&(n=this.putAction(lt(o,s+1),t,r,n))}return n}}class it{constructor(e,t,r,n){this.parser=e,this.input=t,this.ranges=n,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new Ke(t,n),this.tokens=new nt(e,this.stream),this.topTerm=e.top[1];let{from:i}=n[0];this.stacks=[$e.start(this,e.top[0],i)],this.fragments=r.length&&this.stream.end-i>4*e.bufferLength?new rt(r,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e,t,r=this.stacks,n=this.minStackPos,i=this.stacks=[];if(this.bigReductionCount>300&&1==r.length){let[e]=r;for(;e.forceReduce()&&e.stack.length&&e.stack[e.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let a=0;a<r.length;a++){let o=r[a];for(;;){if(this.tokens.mainToken=null,o.pos>n)i.push(o);else{if(this.advanceStack(o,i,r))continue;{e||(e=[],t=[]),e.push(o);let r=this.tokens.getMainToken(o);t.push(r.value,r.end)}}break}}if(!i.length){let t=e&&function(e){let t=null;for(let r of e){let e=r.p.stoppedAt;(r.pos==r.p.stream.end||null!=e&&r.pos>e)&&r.p.parser.stateFlag(r.state,2)&&(!t||t.score<r.score)&&(t=r)}return t}(e);if(t)return Je&&console.log("Finish with "+this.stackID(t)),this.stackToTree(t);if(this.parser.strict)throw Je&&e&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+n);this.recovering||(this.recovering=5)}if(this.recovering&&e){let r=null!=this.stoppedAt&&e[0].pos>this.stoppedAt?e[0]:this.runRecovery(e,t,i);if(r)return Je&&console.log("Force-finish "+this.stackID(r)),this.stackToTree(r.forceAll())}if(this.recovering){let e=1==this.recovering?1:3*this.recovering;if(i.length>e)for(i.sort(((e,t)=>t.score-e.score));i.length>e;)i.pop();i.some((e=>e.reducePos>n))&&this.recovering--}else if(i.length>1){e:for(let e=0;e<i.length-1;e++){let t=i[e];for(let r=e+1;r<i.length;r++){let n=i[r];if(t.sameState(n)||t.buffer.length>500&&n.buffer.length>500){if(!((t.score-n.score||t.buffer.length-n.buffer.length)>0)){i.splice(e--,1);continue e}i.splice(r--,1)}}}i.length>12&&i.splice(12,i.length-12)}this.minStackPos=i[0].pos;for(let e=1;e<i.length;e++)i[e].pos<this.minStackPos&&(this.minStackPos=i[e].pos);return null}stopAt(e){if(null!=this.stoppedAt&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,r){let n=e.pos,{parser:i}=this,a=Je?this.stackID(e)+" -> ":"";if(null!=this.stoppedAt&&n>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let t=e.curContext&&e.curContext.tracker.strict,r=t?e.curContext.hash:0;for(let o=this.fragments.nodeAt(n);o;){let n=this.parser.nodeSet.types[o.type.id]==o.type?i.getGoto(e.state,o.type.id):-1;if(n>-1&&o.length&&(!t||(o.prop(me.contextHash)||0)==r))return e.useNode(o,n),Je&&console.log(a+this.stackID(e)+` (via reuse of ${i.getName(o.type.id)})`),!0;if(!(o instanceof _e)||0==o.children.length||o.positions[0]>0)break;let s=o.children[0];if(!(s instanceof _e&&0==o.positions[0]))break;o=s}}let o=i.stateSlot(e.state,4);if(o>0)return e.reduce(o),Je&&console.log(a+this.stackID(e)+` (via always-reduce ${i.getName(65535&o)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let s=this.tokens.getActions(e);for(let o=0;o<s.length;){let l=s[o++],u=s[o++],c=s[o++],d=o==s.length||!r,p=d?e:e.split(),f=this.tokens.mainToken;if(p.apply(l,u,f?f.start:p.pos,c),Je&&console.log(a+this.stackID(p)+` (via ${0==(65536&l)?"shift":`reduce of ${i.getName(65535&l)}`} for ${i.getName(u)} @ ${n}${p==e?"":", split"})`),d)return!0;p.pos>n?t.push(p):r.push(p)}return!1}advanceFully(e,t){let r=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>r)return at(e,t),!0}}runRecovery(e,t,r){let n=null,i=!1;for(let a=0;a<e.length;a++){let o=e[a],s=t[a<<1],l=t[1+(a<<1)],u=Je?this.stackID(o)+" -> ":"";if(o.deadEnd){if(i)continue;if(i=!0,o.restart(),Je&&console.log(u+this.stackID(o)+" (restarted)"),this.advanceFully(o,r))continue}let c=o.split(),d=u;for(let e=0;c.forceReduce()&&e<10&&(Je&&console.log(d+this.stackID(c)+" (via force-reduce)"),!this.advanceFully(c,r));e++)Je&&(d=this.stackID(c)+" -> ");for(let e of o.recoverByInsert(s))Je&&console.log(u+this.stackID(e)+" (via recover-insert)"),this.advanceFully(e,r);this.stream.end>o.pos?(l==o.pos&&(l++,s=0),o.recoverByDelete(s,l),Je&&console.log(u+this.stackID(o)+` (via recover-delete ${this.parser.getName(s)})`),at(o,r)):(!n||n.score<o.score)&&(n=o)}return n}stackToTree(e){return e.close(),_e.build({buffer:Ge.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(et||(et=new WeakMap)).get(e);return t||et.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function at(e,t){for(let r=0;r<t.length;r++){let n=t[r];if(n.pos==e.pos&&n.sameState(e))return void(t[r].score<e.score&&(t[r]=e))}t.push(e)}class ot{constructor(e,t,r){this.source=e,this.flags=t,this.disabled=r}allows(e){return!this.disabled||0==this.disabled[e]}}class st extends Be{constructor(e){if(super(),this.wrappers=[],14!=e.version)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let r=0;r<e.repeatNodeCount;r++)t.push("");let r=Object.keys(e.topRules).map((t=>e.topRules[t][1])),n=[];for(let e=0;e<t.length;e++)n.push([]);function i(e,t,r){n[e].push([t,t.deserialize(String(r))])}if(e.nodeProps)for(let t of e.nodeProps){let e=t[0];"string"==typeof e&&(e=me[e]);for(let r=1;r<t.length;){let n=t[r++];if(n>=0)i(n,e,t[r++]);else{let a=t[r+-n];for(let o=-n;o>0;o--)i(t[r++],e,a);r++}}}this.nodeSet=new ve(t.map(((t,i)=>ye.define({name:i>=this.minRepeatTerm?void 0:t,id:i,props:n[i],top:r.indexOf(i)>-1,error:0==i,skipped:e.skippedNodes&&e.skippedNodes.indexOf(i)>-1})))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=de;let a=Ue(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let e=0;e<this.specializerSpecs.length;e++)this.specialized[e]=this.specializerSpecs[e].term;this.specializers=this.specializerSpecs.map(ut),this.states=Ue(e.states,Uint32Array),this.data=Ue(e.stateData),this.goto=Ue(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map((e=>"number"==typeof e?new He(a,e):e)),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,r){let n=new it(this,e,t,r);for(let i of this.wrappers)n=i(n,e,t,r);return n}getGoto(e,t,r=!1){let n=this.goto;if(t>=n[0])return-1;for(let i=n[t+1];;){let t=n[i++],a=1&t,o=n[i++];if(a&&r)return o;for(let r=i+(t>>1);i<r;i++)if(n[i]==e)return o;if(a)return-1}}hasAction(e,t){let r=this.data;for(let n=0;n<2;n++)for(let i,a=this.stateSlot(e,n?2:1);;a+=3){if(65535==(i=r[a])){if(1!=r[a+1]){if(2==r[a+1])return lt(r,a+2);break}i=r[a=lt(r,a+2)]}if(i==t||0==i)return lt(r,a+1)}return 0}stateSlot(e,t){return this.states[6*e+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,(e=>e==t||null))}allActions(e,t){let r=this.stateSlot(e,4),n=r?t(r):void 0;for(let r=this.stateSlot(e,1);null==n;r+=3){if(65535==this.data[r]){if(1!=this.data[r+1])break;r=lt(this.data,r+2)}n=t(lt(this.data,r+1))}return n}nextStates(e){let t=[];for(let r=this.stateSlot(e,1);;r+=3){if(65535==this.data[r]){if(1!=this.data[r+1])break;r=lt(this.data,r+2)}if(0==(1&this.data[r+2])){let e=this.data[r+1];t.some(((t,r)=>1&r&&t==e))||t.push(this.data[r],e)}}return t}configure(e){let t=Object.assign(Object.create(st.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let r=this.topRules[e.top];if(!r)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=r}return e.tokenizers&&(t.tokenizers=this.tokenizers.map((t=>{let r=e.tokenizers.find((e=>e.from==t));return r?r.to:t}))),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map(((r,n)=>{let i=e.specializers.find((e=>e.from==r.external));if(!i)return r;let a=Object.assign(Object.assign({},r),{external:i.to});return t.specializers[n]=ut(a),a}))),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),null!=e.strict&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),null!=e.bufferLength&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return null==t?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),r=t.map((()=>!1));if(e)for(let n of e.split(" ")){let e=t.indexOf(n);e>=0&&(r[e]=!0)}let n=null;for(let e=0;e<t.length;e++)if(!r[e])for(let r,i=this.dialects[t[e]];65535!=(r=this.data[i++]);)(n||(n=new Uint8Array(this.maxTerm+1)))[r]=1;return new ot(e,r,n)}static deserialize(e){return new st(e)}}function lt(e,t){return e[t]|e[t+1]<<16}function ut(e){if(e.external){let t=e.extend?1:0;return(r,n)=>e.external(r,n)<<1|t}return e.get}let ct=0;class dt{constructor(e,t,r){this.set=e,this.base=t,this.modified=r,this.id=ct++}static define(e){if(null==e?void 0:e.base)throw new Error("Can not derive from a modified tag");let t=new dt([],null,[]);if(t.set.push(t),e)for(let r of e.set)t.set.push(r);return t}static defineModifier(){let e=new ft;return t=>t.modified.indexOf(e)>-1?t:ft.get(t.base||t,t.modified.concat(e).sort(((e,t)=>e.id-t.id)))}}let pt=0;class ft{constructor(){this.instances=[],this.id=pt++}static get(e,t){if(!t.length)return e;let r=t[0].instances.find((r=>r.base==e&&function(e,t){return e.length==t.length&&e.every(((e,r)=>e==t[r]))}(t,r.modified)));if(r)return r;let n=[],i=new dt(n,e,t);for(let e of t)e.instances.push(i);let a=function(e){let t=[[]];for(let r=0;r<e.length;r++)for(let n=0,i=t.length;n<i;n++)t.push(t[n].concat(e[r]));return t.sort(((e,t)=>t.length-e.length))}(t);for(let t of e.set)if(!t.modified.length)for(let e of a)n.push(ft.get(t,e));return i}}const mt=new me;class ht{constructor(e,t,r,n){this.tags=e,this.mode=t,this.context=r,this.next=n}get opaque(){return 0==this.mode}get inherit(){return 1==this.mode}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}ht.empty=new ht([],2,null);const gt=dt.define,yt=gt(),vt=gt(),bt=gt(vt),Ot=gt(vt),wt=gt(),_t=gt(wt),St=gt(wt),Et=gt(),xt=gt(Et),Tt=gt(),Pt=gt(),kt=gt(),It=gt(kt),Ct=gt(),At={comment:yt,lineComment:gt(yt),blockComment:gt(yt),docComment:gt(yt),name:vt,variableName:gt(vt),typeName:bt,tagName:gt(bt),propertyName:Ot,attributeName:gt(Ot),className:gt(vt),labelName:gt(vt),namespace:gt(vt),macroName:gt(vt),literal:wt,string:_t,docString:gt(_t),character:gt(_t),attributeValue:gt(_t),number:St,integer:gt(St),float:gt(St),bool:gt(wt),regexp:gt(wt),escape:gt(wt),color:gt(wt),url:gt(wt),keyword:Tt,self:gt(Tt),null:gt(Tt),atom:gt(Tt),unit:gt(Tt),modifier:gt(Tt),operatorKeyword:gt(Tt),controlKeyword:gt(Tt),definitionKeyword:gt(Tt),moduleKeyword:gt(Tt),operator:Pt,derefOperator:gt(Pt),arithmeticOperator:gt(Pt),logicOperator:gt(Pt),bitwiseOperator:gt(Pt),compareOperator:gt(Pt),updateOperator:gt(Pt),definitionOperator:gt(Pt),typeOperator:gt(Pt),controlOperator:gt(Pt),punctuation:kt,separator:gt(kt),bracket:It,angleBracket:gt(It),squareBracket:gt(It),paren:gt(It),brace:gt(It),content:Et,heading:xt,heading1:gt(xt),heading2:gt(xt),heading3:gt(xt),heading4:gt(xt),heading5:gt(xt),heading6:gt(xt),contentSeparator:gt(Et),list:gt(Et),quote:gt(Et),emphasis:gt(Et),strong:gt(Et),link:gt(Et),monospace:gt(Et),strikethrough:gt(Et),inserted:gt(),deleted:gt(),changed:gt(),invalid:gt(),meta:Ct,documentMeta:gt(Ct),annotation:gt(Ct),processingInstruction:gt(Ct),definition:dt.defineModifier(),constant:dt.defineModifier(),function:dt.defineModifier(),standard:dt.defineModifier(),local:dt.defineModifier(),special:dt.defineModifier()},qt=(function(e,t){let r=Object.create(null);for(let t of e)if(Array.isArray(t.tag))for(let e of t.tag)r[e.id]=t.class;else r[t.tag.id]=t.class;let{scope:n,all:i=null}={}}([{tag:At.link,class:"tok-link"},{tag:At.heading,class:"tok-heading"},{tag:At.emphasis,class:"tok-emphasis"},{tag:At.strong,class:"tok-strong"},{tag:At.keyword,class:"tok-keyword"},{tag:At.atom,class:"tok-atom"},{tag:At.bool,class:"tok-bool"},{tag:At.url,class:"tok-url"},{tag:At.labelName,class:"tok-labelName"},{tag:At.inserted,class:"tok-inserted"},{tag:At.deleted,class:"tok-deleted"},{tag:At.literal,class:"tok-literal"},{tag:At.string,class:"tok-string"},{tag:At.number,class:"tok-number"},{tag:[At.regexp,At.escape,At.special(At.string)],class:"tok-string2"},{tag:At.variableName,class:"tok-variableName"},{tag:At.local(At.variableName),class:"tok-variableName tok-local"},{tag:At.definition(At.variableName),class:"tok-variableName tok-definition"},{tag:At.special(At.variableName),class:"tok-variableName2"},{tag:At.definition(At.propertyName),class:"tok-propertyName tok-definition"},{tag:At.typeName,class:"tok-typeName"},{tag:At.namespace,class:"tok-namespace"},{tag:At.className,class:"tok-className"},{tag:At.macroName,class:"tok-macroName"},{tag:At.propertyName,class:"tok-propertyName"},{tag:At.operator,class:"tok-operator"},{tag:At.comment,class:"tok-comment"},{tag:At.meta,class:"tok-meta"},{tag:At.invalid,class:"tok-invalid"},{tag:At.punctuation,class:"tok-punctuation"}]),{inf:261,nan:262,bool:1,ignoring:2,on:3,group_left:4,group_right:5,offset:6}),Rt=e=>qt[e.toLowerCase()]||-1,Dt={avg:8,atan2:7,bottomk:9,count:10,count_values:11,group:12,max:13,min:14,quantile:15,stddev:16,stdvar:17,sum:18,topk:19,by:20,without:21,and:22,or:23,unless:24,start:25,end:26},Nt=e=>Dt[e.toLowerCase()]||-1,Lt=function(e){let t=Object.create(null);for(let r in e){let n=e[r];Array.isArray(n)||(n=[n]);for(let e of r.split(" "))if(e){let r=[],i=2,a=e;for(let t=0;;){if("..."==a&&t>0&&t+3==e.length){i=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!n)throw new RangeError("Invalid path: "+e);if(r.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),t+=n[0].length,t==e.length)break;let o=e[t++];if(t==e.length&&"!"==o){i=0;break}if("/"!=o)throw new RangeError("Invalid path: "+e);a=e.slice(t)}let o=r.length-1,s=r[o];if(!s)throw new RangeError("Invalid path: "+e);let l=new ht(n,i,o>0?r.slice(0,o):null);t[s]=l.sort(t[s])}}return mt.add(t)}({LineComment:At.comment,LabelName:At.labelName,StringLiteral:At.string,NumberLiteral:At.number,Duration:At.number,[["Abs","Absent","AbsentOverTime","Acos","Acosh","Asin","Asinh","Atan","Atanh","AvgOverTime","Ceil","Changes","Clamp","ClampMax","ClampMin","Cos","Cosh","CountOverTime","DaysInMonth","DayOfMonth","DayOfWeek","DayOfYear","Deg","Delta","Deriv","Exp","Floor","HistogramQuantile","HoltWinters","Hour","Idelta","Increase","Irate","LabelReplace","LabelJoin","LastOverTime","Ln","Log10","Log2","MaxOverTime","MinOverTime","Minute","Month","Pi","PredictLinear","PresentOverTime","QuantileOverTime","Rad","Rate","Resets","Round","Scalar","Sgn","Sin","Sinh","Sort","SortDesc","Sqrt","StddevOverTime","StdvarOverTime","SumOverTime","Tan","Tanh","Time","Timestamp","Vector","Year"].join(" ")]:At.function(At.variableName),[["Avg","Bottomk","Count","Count_values","Group","Max","Min","Quantile","Stddev","Stdvar","Sum","Topk"].join(" ")]:At.operatorKeyword,[["By","Without","Bool","On","Ignoring","GroupLeft","GroupRight","Offset","Start","End"].join(" ")]:At.modifier,[["And","Unless","Or"].join(" ")]:At.logicOperator,[["Sub","Add","Mul","Mod","Div","Atan2","Eql","Neq","Lte","Lss","Gte","Gtr","EqlRegex","EqlSingle","NeqRegex","Pow","At"].join(" ")]:At.operator,UnaryOp:At.arithmeticOperator,"( )":At.paren,"[ ]":At.squareBracket,"{ }":At.brace,"⚠":At.invalid}),jt={__proto__:null,absent_over_time:537,absent:539,abs:541,acos:543,acosh:545,asin:547,asinh:549,atan:551,atanh:553,avg_over_time:555,ceil:557,changes:559,clamp:561,clamp_max:563,clamp_min:565,cos:567,cosh:569,count_over_time:571,days_in_month:573,day_of_month:575,day_of_week:577,day_of_year:579,deg:581,delta:583,deriv:585,exp:587,floor:589,histogram_quantile:591,holt_winters:593,hour:595,idelta:597,increase:599,irate:601,label_replace:603,label_join:605,last_over_time:607,ln:609,log10:611,log2:613,max_over_time:615,min_over_time:617,minute:619,month:621,pi:623,predict_linear:625,present_over_time:627,quantile_over_time:629,rad:631,rate:633,resets:635,round:637,scalar:639,sgn:641,sin:643,sinh:645,sort:647,sort_desc:649,sqrt:651,stddev_over_time:653,stdvar_over_time:655,sum_over_time:657,tan:659,tanh:661,timestamp:663,time:665,vector:667,year:669,ascent_over_time:671,changes_prometheus:673,decreases_over_time:675,default_rollup:677,delta_prometheus:679,deriv_fast:681,descent_over_time:683,distinct_over_time:685,first_over_time:687,geomean_over_time:689,histogram_over_time:691,ideriv:693,increase_prometheus:695,increase_pure:697,increases_over_time:699,integrate:701,lag:703,lifetime:705,mad_over_time:707,median_over_time:709,mode_over_time:711,range_over_time:713,rate_over_sum:715,rollup:717,rollup_candlestick:719,rollup_delta:721,rollup_deriv:723,rollup_increase:725,rollup_rate:727,rollup_scrape_interval:729,scrape_interval:731,stale_samples_over_time:733,sum2_over_time:735,timestamp_with_name:737,tfirst_over_time:739,tlast_change_over_time:741,tlast_over_time:743,tmax_over_time:745,tmin_over_time:747,zscore_over_time:749,histogram_avg:751,histogram_stddev:753,histogram_stdvar:755,prometheus_buckets:757,interpolate:759,keep_last_value:761,keep_next_value:763,range_avg:765,range_first:767,range_last:769,range_linear_regression:771,range_mad:773,range_max:775,range_median:777,range_min:779,range_stddev:781,range_stdvar:783,range_sum:785,range_zscore:787,remove_resets:789,running_avg:791,running_max:793,running_min:795,running_sum:797,distinct:799,geomean:801,histogram:803,bottomk_avg:805,bottomk_last:807,bottomk_max:809,bottomk_median:811,bottomk_min:813,topk_avg:815,topk_last:817,topk_max:819,topk_median:821,topk_min:823,any:825,limitk:827,mad:829,median:831,mode:833,share:835,sum2:837,zscore:839,label_del:841,label_keep:843,label_lowercase:845,label_uppercase:847,sort_by_label:849,sort_by_label_desc:851,sort_by_label_numeric:853,sort_by_label_numeric_desc:855,now:857,step:859,count_eq_over_time:861,count_gt_over_time:863,count_le_over_time:865,count_ne_over_time:867,duration_over_time:869,share_gt_over_time:871,share_le_over_time:873,share_eq_over_time:875,bitmap_and:877,bitmap_or:879,bitmap_xor:881,rand:883,rand_exponential:885,rand_normal:887,timezone_offset:889,label_set:891,label_copy:893,label_move:895,label_map:897},Mt=st.deserialize({version:14,states:"E[OYQPOOO.dQPOOOOQO'#C{'#C{O.iQPO'#CzQ.tQQOOOOQO'#De'#DeO.oQPO'#DdOOQO'#Hf'#HfO0RQPO'#HlOYQPO'#HhOYQPO'#HkOOQO'#Hn'#HnO=fQSO'#HoO=nQQO'#HmOOQO'#Hm'#HmOOQO'#Cy'#CyOOQO'#Df'#DfOOQO'#Dh'#DhOOQO'#Di'#DiOOQO'#Dj'#DjOOQO'#Dk'#DkOOQO'#Dl'#DlOOQO'#Dm'#DmOOQO'#Dn'#DnOOQO'#Do'#DoOOQO'#Dp'#DpOOQO'#Dq'#DqOOQO'#Dr'#DrOOQO'#Ds'#DsOOQO'#Dt'#DtOOQO'#Du'#DuOOQO'#Dv'#DvOOQO'#Dw'#DwOOQO'#Dx'#DxOOQO'#Dy'#DyOOQO'#Dz'#DzOOQO'#D{'#D{OOQO'#D|'#D|OOQO'#D}'#D}OOQO'#EO'#EOOOQO'#EP'#EPOOQO'#EQ'#EQOOQO'#ER'#EROOQO'#ES'#ESOOQO'#ET'#ETOOQO'#EU'#EUOOQO'#EV'#EVOOQO'#EW'#EWOOQO'#EX'#EXOOQO'#EY'#EYOOQO'#EZ'#EZOOQO'#E['#E[OOQO'#E]'#E]OOQO'#E^'#E^OOQO'#E_'#E_OOQO'#E`'#E`OOQO'#Ea'#EaOOQO'#Eb'#EbOOQO'#Ec'#EcOOQO'#Ed'#EdOOQO'#Ee'#EeOOQO'#Ef'#EfOOQO'#Eg'#EgOOQO'#Eh'#EhOOQO'#Ei'#EiOOQO'#Ej'#EjOOQO'#Ek'#EkOOQO'#El'#ElOOQO'#Em'#EmOOQO'#En'#EnOOQO'#Eo'#EoOOQO'#Ep'#EpOOQO'#Eq'#EqOOQO'#Er'#ErOOQO'#Es'#EsOOQO'#Et'#EtOOQO'#Eu'#EuOOQO'#Ev'#EvOOQO'#Ew'#EwOOQO'#Ex'#ExOOQO'#Ey'#EyOOQO'#Ez'#EzOOQO'#E{'#E{OOQO'#E|'#E|OOQO'#E}'#E}OOQO'#FO'#FOOOQO'#FP'#FPOOQO'#FQ'#FQOOQO'#FR'#FROOQO'#FS'#FSOOQO'#FT'#FTOOQO'#FU'#FUOOQO'#FV'#FVOOQO'#FW'#FWOOQO'#FX'#FXOOQO'#FY'#FYOOQO'#FZ'#FZOOQO'#F['#F[OOQO'#F]'#F]OOQO'#F^'#F^OOQO'#F_'#F_OOQO'#F`'#F`OOQO'#Fa'#FaOOQO'#Fb'#FbOOQO'#Fc'#FcOOQO'#Fd'#FdOOQO'#Fe'#FeOOQO'#Ff'#FfOOQO'#Fg'#FgOOQO'#Fh'#FhOOQO'#Fi'#FiOOQO'#Fj'#FjOOQO'#Fk'#FkOOQO'#Fl'#FlOOQO'#Fm'#FmOOQO'#Fn'#FnOOQO'#Fo'#FoOOQO'#Fp'#FpOOQO'#Fq'#FqOOQO'#Fr'#FrOOQO'#Fs'#FsOOQO'#Ft'#FtOOQO'#Fu'#FuOOQO'#Fv'#FvOOQO'#Fw'#FwOOQO'#Fx'#FxOOQO'#Fy'#FyOOQO'#Fz'#FzOOQO'#F{'#F{OOQO'#F|'#F|OOQO'#F}'#F}OOQO'#GO'#GOOOQO'#GP'#GPOOQO'#GQ'#GQOOQO'#GR'#GROOQO'#GS'#GSOOQO'#GT'#GTOOQO'#GU'#GUOOQO'#GV'#GVOOQO'#GW'#GWOOQO'#GX'#GXOOQO'#GY'#GYOOQO'#GZ'#GZOOQO'#G['#G[OOQO'#G]'#G]OOQO'#G^'#G^OOQO'#G_'#G_OOQO'#G`'#G`OOQO'#Ga'#GaOOQO'#Gb'#GbOOQO'#Gc'#GcOOQO'#Gd'#GdOOQO'#Ge'#GeOOQO'#Gf'#GfOOQO'#Gg'#GgOOQO'#Gh'#GhOOQO'#Gi'#GiOOQO'#Gj'#GjOOQO'#Gk'#GkOOQO'#Gl'#GlOOQO'#Gm'#GmOOQO'#Gn'#GnOOQO'#Go'#GoOOQO'#Gp'#GpOOQO'#Gq'#GqOOQO'#Gr'#GrOOQO'#Gs'#GsOOQO'#Gt'#GtOOQO'#Gu'#GuOOQO'#Gv'#GvOOQO'#Gw'#GwOOQO'#Gx'#GxOOQO'#Gy'#GyOOQO'#Gz'#GzOOQO'#G{'#G{OOQO'#G|'#G|OOQO'#G}'#G}OOQO'#HO'#HOOOQO'#HP'#HPOOQO'#HQ'#HQOOQO'#HR'#HROOQO'#HS'#HSOOQO'#HT'#HTOOQO'#HU'#HUOOQO'#HV'#HVOOQO'#HW'#HWOOQO'#HX'#HXOOQO'#HY'#HYOOQO'#HZ'#HZOOQO'#H['#H[OOQO'#H]'#H]OOQO'#H^'#H^OOQO'#H_'#H_OOQO'#H`'#H`OOQO'#Ha'#HaOOQO'#Hb'#HbOOQO'#Hc'#HcQOQPOOO?XQPO'#C|O?^QPO'#DRO.oQPO,59fO?eQQO,59fOARQPO,59oOARQPO,59oOARQPO,59oOARQPO,59oOARQPO,59oONfQQO,5>OONkQQO,5>RONsQPO,5>bOOQO,5:O,5:OOOQO,5>Q,5>QO! [QQO,5>SO! cQQO,5>VO!!yQPO'#HqO!#XQPO,5>ZOOQO'#Hp'#HpOOQO,5>Z,5>ZOOQO,5>X,5>XO!#aQSO'#C}OOQO,59h,59hO!#iQPO,59mO!#qQQO'#DSOOQO,59m,59mOOQO1G/Q1G/QO?XQPO'#DWO!1VQPO'#DVO!1aQPO'#DVOYQPO1G/ZOYQPO1G/ZOYQPO1G/ZOYQPO1G/ZOYQPO1G/ZO!1kQSO1G3jOOQO1G3m1G3mO!1sQQO1G3mO!1xQPO'#HfOOQO'#Hx'#HxOOQO1G3|1G3|O!2TQPO1G3|OOQO1G3n1G3nOOQO'#Hr'#HrO!2YQPO,5>]O!2_QSO1G3uOOQO1G3u1G3uOOQO'#DP'#DPO!2gQPO,59iOOQO'#DO'#DOOOQO,59i,59iOYQPO,59nOOQO1G/X1G/XOOQO,59r,59rO!?vQPO,59qO!?}QPO,59qO!AfQQO7+$uO!AvQQO7+$uO!C[QQO7+$uO!CrQQO7+$uO!EZQQO7+$uOOQO7+)U7+)UO!EtQQO7+)[OOQO7+)X7+)XO!E|QPO7+)hOOQO1G3w1G3wOOQO1G3v1G3vOOQO7+)a7+)aO!FRQSO1G/TOOQO1G/T1G/TO!FZQQO1G/YOOQO1G/]1G/]O!FeQPO1G/]OOQO<<Lv<<LvO#%oQPO<<LvOOQO<<MS<<MSOOQO1G/U1G/UOOQO7+$o7+$oOOQO7+$w7+$wOOQOANBbANBb",stateData:"#%t~O&rOSkOS~OWQOXQOYQOZQO[QO]QO^QO_QO`QOaQObQOcQO!ZZO&]_O&oVO&pVO&sXO&v`O&waO&xbO&ycO&zdO&{eO&|fO&}gO'OhO'PiO'QjO'RkO'SlO'TmO'UnO'VoO'WpO'XqO'YrO'ZsO'[tO']uO'^vO'_wO'`xO'ayO'bzO'c{O'd|O'e}O'f!OO'g!PO'h!QO'i!RO'j!SO'k!TO'l!UO'm!VO'n!WO'o!XO'p!YO'q!ZO'r![O's!]O't!^O'u!_O'v!`O'w!aO'x!bO'y!cO'z!dO'{!eO'|!fO'}!gO(O!hO(P!iO(Q!jO(R!kO(S!lO(T!mO(U!nO(V!oO(W!pO(X!qO(Y!rO(Z!sO([!tO(]!uO(^!vO(_!wO(`!xO(a!yO(b!zO(c!{O(d!|O(e!}O(f#OO(g#PO(h#QO(i#RO(j#SO(k#TO(l#UO(m#VO(n#WO(o#XO(p#YO(q#ZO(r#[O(s#]O(t#^O(u#_O(v#`O(w#aO(x#bO(y#cO(z#dO({#eO(|#fO(}#gO)O#hO)P#iO)Q#jO)R#kO)S#lO)T#mO)U#nO)V#oO)W#pO)X#qO)Y#rO)Z#sO)[#tO)]#uO)^#vO)_#wO)`#xO)a#yO)b#zO)c#{O)d#|O)e#}O)f$OO)g$PO)h$QO)i$RO)j$SO)k$TO)l$UO)m$VO)n$WO)o$XO)p$YO)q$ZO)r$[O)s$]O)t$^O)u$_O)v$`O)w$aO)x$bO)y$cO)z$dO){$eO)|$fO)}$gO*O$hO*P$iO*Q$jO*R$kO*S$lO*T$mO*U$nO*V$oO*W$pO*X$qO*Y$rO*Z$sO*[$tO*]$uO*^$vO*_$wO*`$xO*a$yO*b$zO*c${O*d$|O*e$}O*f%OO*g%PO*h%QO*i%RO*j%SO*k%TO*l%UO*m%VO*n%WO*o%XO*p%YO*q%ZO*r%[O*uWO*vWO*wVO*y[O~O!ZZO~Od%^Oe%^O&s%_O~OU%hOV%bOf%eOg%fOh%eOx%bO{%bO|%bO}%bO!O%cO!P%cO!Q%dO!R%dO!S%dO!T%dO!U%dO!V%dO&k%iO*s%gO~O&o%kO&p%kO*w%kOW&`XX&`XY&`XZ&`X[&`X]&`X^&`X_&`X`&`Xa&`Xb&`Xc&`X!Z&`X&]&`X&o&`X&p&`X&s&`X&v&`X&w&`X&x&`X&y&`X&z&`X&{&`X&|&`X&}&`X'O&`X'P&`X'Q&`X'R&`X'S&`X'T&`X'U&`X'V&`X'W&`X'X&`X'Y&`X'Z&`X'[&`X']&`X'^&`X'_&`X'`&`X'a&`X'b&`X'c&`X'd&`X'e&`X'f&`X'g&`X'h&`X'i&`X'j&`X'k&`X'l&`X'm&`X'n&`X'o&`X'p&`X'q&`X'r&`X's&`X't&`X'u&`X'v&`X'w&`X'x&`X'y&`X'z&`X'{&`X'|&`X'}&`X(O&`X(P&`X(Q&`X(R&`X(S&`X(T&`X(U&`X(V&`X(W&`X(X&`X(Y&`X(Z&`X([&`X(]&`X(^&`X(_&`X(`&`X(a&`X(b&`X(c&`X(d&`X(e&`X(f&`X(g&`X(h&`X(i&`X(j&`X(k&`X(l&`X(m&`X(n&`X(o&`X(p&`X(q&`X(r&`X(s&`X(t&`X(u&`X(v&`X(w&`X(x&`X(y&`X(z&`X({&`X(|&`X(}&`X)O&`X)P&`X)Q&`X)R&`X)S&`X)T&`X)U&`X)V&`X)W&`X)X&`X)Y&`X)Z&`X)[&`X)]&`X)^&`X)_&`X)`&`X)a&`X)b&`X)c&`X)d&`X)e&`X)f&`X)g&`X)h&`X)i&`X)j&`X)k&`X)l&`X)m&`X)n&`X)o&`X)p&`X)q&`X)r&`X)s&`X)t&`X)u&`X)v&`X)w&`X)x&`X)y&`X)z&`X){&`X)|&`X)}&`X*O&`X*P&`X*Q&`X*R&`X*S&`X*T&`X*U&`X*V&`X*W&`X*X&`X*Y&`X*Z&`X*[&`X*]&`X*^&`X*_&`X*`&`X*a&`X*b&`X*c&`X*d&`X*e&`X*f&`X*g&`X*h&`X*i&`X*j&`X*k&`X*l&`X*m&`X*n&`X*o&`X*p&`X*q&`X*r&`X*u&`X*v&`X*w&`X*y&`X~Ot%nO*z%qO~O*y[OU&aXV&aXf&aXg&aXh&aXx&aX{&aX|&aX}&aX!O&aX!P&aX!Q&aX!R&aX!S&aX!T&aX!U&aX!V&aX&k&aX&n&aX*s&aX&u&aX&t&aX~O&s%sO~O&u%wO~PYOd%^Oe%^OUnaVnafnagnahnaxna{na|na}na!Ona!Pna!Qna!Rna!Sna!Tna!Una!Vna&kna&nna*sna&una&tna~OP%{OQ%yOR%yOWyPXyPYyPZyP[yP]yP^yP_yP`yPayPbyPcyP!ZyP&]yP&oyP&pyP&syP&vyP&wyP&xyP&yyP&zyP&{yP&|yP&}yP'OyP'PyP'QyP'RyP'SyP'TyP'UyP'VyP'WyP'XyP'YyP'ZyP'[yP']yP'^yP'_yP'`yP'ayP'byP'cyP'dyP'eyP'fyP'gyP'hyP'iyP'jyP'kyP'lyP'myP'nyP'oyP'pyP'qyP'ryP'syP'tyP'uyP'vyP'wyP'xyP'yyP'zyP'{yP'|yP'}yP(OyP(PyP(QyP(RyP(SyP(TyP(UyP(VyP(WyP(XyP(YyP(ZyP([yP(]yP(^yP(_yP(`yP(ayP(byP(cyP(dyP(eyP(fyP(gyP(hyP(iyP(jyP(kyP(lyP(myP(nyP(oyP(pyP(qyP(ryP(syP(tyP(uyP(vyP(wyP(xyP(yyP(zyP({yP(|yP(}yP)OyP)PyP)QyP)RyP)SyP)TyP)UyP)VyP)WyP)XyP)YyP)ZyP)[yP)]yP)^yP)_yP)`yP)ayP)byP)cyP)dyP)eyP)fyP)gyP)hyP)iyP)jyP)kyP)lyP)myP)nyP)oyP)pyP)qyP)ryP)syP)tyP)uyP)vyP)wyP)xyP)yyP)zyP){yP)|yP)}yP*OyP*PyP*QyP*RyP*SyP*TyP*UyP*VyP*WyP*XyP*YyP*ZyP*[yP*]yP*^yP*_yP*`yP*ayP*byP*cyP*dyP*eyP*fyP*gyP*hyP*iyP*jyP*kyP*lyP*myP*nyP*oyP*pyP*qyP*ryP*uyP*vyP*wyP*yyP~O&X&RO~O!P&TO&X&SO~Oi&VOj&VO&oVO&pVO*u&UO*v&UO*wVO~O&u&YO~P.tOx%bOU&_aV&_af&_ag&_ah&_a{&_a|&_a}&_a!O&_a!P&_a!Q&_a!R&_a!S&_a!T&_a!U&_a!V&_a&k&_a&n&_a*s&_a&u&_a&t&_a~O!V&ZO&g&ZO&h&ZO&i&ZO~O&t&]O*z&^O~Ot&_O&u&bO~O&t&cO&u&dO~O&tvX&uvX~P.tOWyXXyXYyXZyX[yX]yX^yX_yX`yXayXbyXcyX!ZyX&]yX&oyX&pyX&syX&vyX&wyX&xyX&yyX&zyX&{yX&|yX&}yX'OyX'PyX'QyX'RyX'SyX'TyX'UyX'VyX'WyX'XyX'YyX'ZyX'[yX']yX'^yX'_yX'`yX'ayX'byX'cyX'dyX'eyX'fyX'gyX'hyX'iyX'jyX'kyX'lyX'myX'nyX'oyX'pyX'qyX'ryX'syX'tyX'uyX'vyX'wyX'xyX'yyX'zyX'{yX'|yX'}yX(OyX(PyX(QyX(RyX(SyX(TyX(UyX(VyX(WyX(XyX(YyX(ZyX([yX(]yX(^yX(_yX(`yX(ayX(byX(cyX(dyX(eyX(fyX(gyX(hyX(iyX(jyX(kyX(lyX(myX(nyX(oyX(pyX(qyX(ryX(syX(tyX(uyX(vyX(wyX(xyX(yyX(zyX({yX(|yX(}yX)OyX)PyX)QyX)RyX)SyX)TyX)UyX)VyX)WyX)XyX)YyX)ZyX)[yX)]yX)^yX)_yX)`yX)ayX)byX)cyX)dyX)eyX)fyX)gyX)hyX)iyX)jyX)kyX)lyX)myX)nyX)oyX)pyX)qyX)ryX)syX)tyX)uyX)vyX)wyX)xyX)yyX)zyX){yX)|yX)}yX*OyX*PyX*QyX*RyX*SyX*TyX*UyX*VyX*WyX*XyX*YyX*ZyX*[yX*]yX*^yX*_yX*`yX*ayX*byX*cyX*dyX*eyX*fyX*gyX*hyX*iyX*jyX*kyX*lyX*myX*nyX*oyX*pyX*qyX*ryX*uyX*vyX*wyX*yyX~OS&fOT&fO~P!#{OQ%yOR%yO~P!#{O*t&mO*x&nO~O&X&oO~O&o%kO&p%kO*w%kO~O&s&pO~O&]&qO~Ot%nO*z&sO~O&t&tO&u&uO~OWyaXyaYyaZya[ya]ya^ya_ya`yaayabyacya!Zya&]ya&oya&pya&vya&wya&xya&yya&zya&{ya&|ya&}ya'Oya'Pya'Qya'Rya'Sya'Tya'Uya'Vya'Wya'Xya'Yya'Zya'[ya']ya'^ya'_ya'`ya'aya'bya'cya'dya'eya'fya'gya'hya'iya'jya'kya'lya'mya'nya'oya'pya'qya'rya'sya'tya'uya'vya'wya'xya'yya'zya'{ya'|ya'}ya(Oya(Pya(Qya(Rya(Sya(Tya(Uya(Vya(Wya(Xya(Yya(Zya([ya(]ya(^ya(_ya(`ya(aya(bya(cya(dya(eya(fya(gya(hya(iya(jya(kya(lya(mya(nya(oya(pya(qya(rya(sya(tya(uya(vya(wya(xya(yya(zya({ya(|ya(}ya)Oya)Pya)Qya)Rya)Sya)Tya)Uya)Vya)Wya)Xya)Yya)Zya)[ya)]ya)^ya)_ya)`ya)aya)bya)cya)dya)eya)fya)gya)hya)iya)jya)kya)lya)mya)nya)oya)pya)qya)rya)sya)tya)uya)vya)wya)xya)yya)zya){ya)|ya)}ya*Oya*Pya*Qya*Rya*Sya*Tya*Uya*Vya*Wya*Xya*Yya*Zya*[ya*]ya*^ya*_ya*`ya*aya*bya*cya*dya*eya*fya*gya*hya*iya*jya*kya*lya*mya*nya*oya*pya*qya*rya*uya*vya*wya*yya~O&s%sO~P!2oOS&xOT&xO&sya~P!2oOx%bOUwqfwqgwqhwq!Owq!Pwq!Qwq!Rwq!Swq!Twq!Uwq!Vwq&kwq&nwq*swq&uwq&twq~OVwq{wq|wq}wq~P!@[OV%bO{%bO|%bO}%bO~P!@[OV%bOx%bO{%bO|%bO}%bO!O%cO!P%cOUwqfwqgwqhwq&kwq&nwq*swq&uwq&twq~O!Qwq!Rwq!Swq!Twq!Uwq!Vwq~P!BWO!Q%dO!R%dO!S%dO!T%dO!U%dO!V%dO~P!BWOV%bOf%eOh%eOx%bO{%bO|%bO}%bO!O%cO!P%cO!Q%dO!R%dO!S%dO!T%dO!U%dO!V%dO~OUwqgwq&kwq&nwq*swq&uwq&twq~P!DYO&X&zO*t&yO~O&u&{O~Ot&_O&u&}O~O&tvi&uvi~P.tO&s%sOWyiXyiYyiZyi[yi]yi^yi_yi`yiayibyicyi!Zyi&]yi&oyi&pyi&vyi&wyi&xyi&yyi&zyi&{yi&|yi&}yi'Oyi'Pyi'Qyi'Ryi'Syi'Tyi'Uyi'Vyi'Wyi'Xyi'Yyi'Zyi'[yi']yi'^yi'_yi'`yi'ayi'byi'cyi'dyi'eyi'fyi'gyi'hyi'iyi'jyi'kyi'lyi'myi'nyi'oyi'pyi'qyi'ryi'syi'tyi'uyi'vyi'wyi'xyi'yyi'zyi'{yi'|yi'}yi(Oyi(Pyi(Qyi(Ryi(Syi(Tyi(Uyi(Vyi(Wyi(Xyi(Yyi(Zyi([yi(]yi(^yi(_yi(`yi(ayi(byi(cyi(dyi(eyi(fyi(gyi(hyi(iyi(jyi(kyi(lyi(myi(nyi(oyi(pyi(qyi(ryi(syi(tyi(uyi(vyi(wyi(xyi(yyi(zyi({yi(|yi(}yi)Oyi)Pyi)Qyi)Ryi)Syi)Tyi)Uyi)Vyi)Wyi)Xyi)Yyi)Zyi)[yi)]yi)^yi)_yi)`yi)ayi)byi)cyi)dyi)eyi)fyi)gyi)hyi)iyi)jyi)kyi)lyi)myi)nyi)oyi)pyi)qyi)ryi)syi)tyi)uyi)vyi)wyi)xyi)yyi)zyi){yi)|yi)}yi*Oyi*Pyi*Qyi*Ryi*Syi*Tyi*Uyi*Vyi*Wyi*Xyi*Yyi*Zyi*[yi*]yi*^yi*_yi*`yi*ayi*byi*cyi*dyi*eyi*fyi*gyi*hyi*iyi*jyi*kyi*lyi*myi*nyi*oyi*pyi*qyi*ryi*uyi*vyi*wyi*yyi~O*t'PO~O",goto:"+^&mPPPPPPPPPPPPPPPPPPPPPPPPPPPPP&n'^'j'v'|(Y(]P(c(l'^P(o)OPPPPPPPPPPP'^)Y)fP)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f)f'^P)r'^'^P'^'^*R'^*_*n*}+Q+WPPP'^P+ZQSOQ%lXQ%mYQ%v%_Q&h%|Q&i%}Q&j&OQ&k&PQ&l&QR&v&ce_OXY%_%|%}&O&P&Q&ceROXY%_%|%}&O&P&Q&cQ%`RR%x%aQ%t%^Q&e%yQ&w&fR'O&xR&`%sQ&a%sR&|&tQ%aRQ%jUR%x%`R%u%_Q%|%bQ%}%cQ&O%dQ&P%eR&Q%fY%z%b%c%d%e%fR&g%{eUOXY%_%|%}&O&P&Q&ceTOXY%_%|%}&O&P&Q&cd_OXY%_%|%}&O&P&Q&cR&W%ieYOXY%_%|%}&O&P&Q&cd]OXY%_%|%}&O&P&Q&cR%]Pd^OXY%_%|%}&O&P&Q&cR%r]R%o[Q%p[R&r&]R&[%nR&X%i",nodeNames:"⚠ Bool Ignoring On GroupLeft GroupRight Offset Atan2 Avg Bottomk Count CountValues Group Max Min Quantile Stddev Stdvar Sum Topk By Without And Or Unless Start End LineComment MetricsQL Expr AggregateExpr AggregateOp AggregateModifier GroupingLabels GroupingLabelList GroupingLabel LabelName FunctionCallBody FunctionCallArgs BinaryExpr Pow BinModifiers OnOrIgnoring Mul Div Mod Add Sub Eql Gte Gtr Lte Lss Neq FunctionCall FunctionIdentifier AbsentOverTime Identifier Absent Abs Acos Acosh Asin Asinh Atan Atanh AvgOverTime Ceil Changes Clamp ClampMax ClampMin Cos Cosh CountOverTime DaysInMonth DayOfMonth DayOfWeek DayOfYear Deg Delta Deriv Exp Floor HistogramQuantile HoltWinters Hour Idelta Increase Irate LabelReplace LabelJoin LastOverTime Ln Log10 Log2 MaxOverTime MinOverTime Minute Month Pi PredictLinear PresentOverTime QuantileOverTime Rad Rate Resets Round Scalar Sgn Sin Sinh Sort SortDesc Sqrt StddevOverTime StdvarOverTime SumOverTime Tan Tanh Timestamp Time Vector Year AscentOverTime ChangesPrometheus DecreasesOverTime DefaultRollup DeltaPrometheus DerivFast DescentOverTime DistinctOverTime FirstOverTime GeomeanOverTime HistogramOverTime Ideriv IncreasePrometheus IncreasePure IncreasesOverTime Integrate Lag Lifetime MadOverTime MedianOverTime ModeOverTime RangeOverTime RateOverSum Rollup RollupCandlestick RollupDelta RollupDeriv RollupIncrease RollupRate RollupScrapeInterval ScrapeInterval StaleSamplesOverTime Sum2OverTime TimestampWithName TfirstOverTime TlastChangeOverTime TlastOverTime TmaxOverTime TminOverTime ZscoreOverTime HistogramAvg HistogramStddev HistogramStdvar PrometheusBuckets Interpolate KeepLastValue KeepNextValue RangeAvg RangeFirst RangeLast RangeLinearRegression RangeMad RangeMax RangeMedian RangeMin RangeStddev RangeStdvar RangeSum RangeZscore RemoveResets RunningAvg RunningMax RunningMin RunningSum Distinct Geomean Histogram BottomkAvg BottomkLast BottomkMax BottomkMedian BottomkMin TopkAvg TopkLast TopkMax TopkMedian TopkMin Any Limitk Mad Median Mode Share Sum2 Zscore LabelDel LabelKeep LabelLowercase LabelUppercase SortByLabel SortByLabelDesc SortByLabelNumeric SortByLabelNumericDesc Now Step CountEqOverTime CountGtOverTime CountLeOverTime CountNeOverTime DurationOverTime ShareGtOverTime ShareLeOverTime ShareEqOverTime BitmapAnd BitmapOr BitmapXor Rand RandExponential RandNormal TimezoneOffset LabelSet LabelCopy LabelMove LabelMap MatrixSelector Duration NumberLiteral OffsetExpr ParenExpr StringLiteral SubqueryExpr UnaryExpr UnaryOp VectorSelector MetricIdentifier LabelMatchers LabelMatchList LabelMatcher MatchOp EqlSingle EqlRegex NeqRegex StepInvariantExpr At AtModifierPreprocessors MetricName",maxTerm:456,propSources:[Lt],skippedNodes:[0,27],repeatNodeCount:0,tokenData:"4{~RxX^#opq#oqr$drs$wst&ouv'Wwx']xy)Oyz)Tz{)Y{|)_|})f}!O)k!O!P)r!P!Q*y!Q!R+O!R![,v![!]1b!^!_2R!_!`2`!`!a2u!b!c3S!c!}3X!}#O3x#O#P*a#P#Q3}#Q#R4S#R#S3X#S#T4X#T#o3X#o#p4q#q#r4v#y#z#o$f$g#o#BY#BZ#o$IS$I_#o$I|$JO#o$JT$JU#o$KV$KW#o&FU&FV#o~#tY&r~X^#opq#o#y#z#o$f$g#o#BY#BZ#o$IS$I_#o$I|$JO#o$JT$JU#o$KV$KW#o&FU&FV#o~$gQ!_!`$m#r#s$r~$rO!V~~$wO&i~~$|W&]~OY$wZr$wrs%fs#O$w#O#P%k#P;'S$w;'S;=`&i<%lO$w~%kO&]~~%nRO;'S$w;'S;=`%w;=`O$w~%|X&]~OY$wZr$wrs%fs#O$w#O#P%k#P;'S$w;'S;=`&i;=`<%l$w<%lO$w~&lP;=`<%l$w~&tSk~OY&oZ;'S&o;'S;=`'Q<%lO&o~'TP;=`<%l&o~']O}~~'bW&]~OY']Zw']wx%fx#O']#O#P'z#P;'S'];'S;=`(x<%lO']~'}RO;'S'];'S;=`(W;=`O']~(]X&]~OY']Zw']wx%fx#O']#O#P'z#P;'S'];'S;=`(x;=`<%l']<%lO']~({P;=`<%l']~)TO&s~~)YO&u~~)_O{~R)fO*vP!OQ~)kO&t~R)rO*uP!PQR)wW!ZR}!O)r!O!P)r!Q![)r![!])r!c!})r#O#P*a#R#S)r#T#o)rR*dVuv)rz{)r{|)r}!O)r!P!Q)r!_!`)r#Q#R)r~+OO|~R+TZ*wP!O!P+v!Q![,v!g!h,[#W#X-k#X#Y,[#[#].S#a#b.h#g#h/[#k#l/m#l#m0v#m#n0XP+yP!Q![+|P,RR*wP!Q![+|!g!h,[#X#Y,[P,_R{|,h}!O,h!Q![,nP,kP!Q![,nP,sP*wP!Q![,nR,{Y*wP!O!P+v!Q![,v!g!h,[#W#X-k#X#Y,[#[#].S#a#b.h#g#h/[#k#l/m#m#n0XQ-pP&XQ!Q![-sQ-vS!Q![-s#[#].S#a#b.h#g#h/[Q.XP&XQ!Q![.[Q._R!Q![.[#a#b.h#g#h/[Q.mQ&XQ!Q![.s#g#h/VQ.vR!Q![.s#a#b/P#g#h/[Q/SP#g#h/VQ/[O&XQQ/aP&XQ!Q![/dQ/gQ!Q![/d#a#b/PQ/rP&XQ!Q![/uQ/xT!Q![/u#W#X-k#[#].S#a#b.h#g#h/[Q0^P&XQ!Q![0aQ0dU!Q![0a#W#X-k#[#].S#a#b.h#g#h/[#k#l/mP0yR!Q![1S!c!i1S#T#Z1SP1XR*wP!Q![1S!c!i1S#T#Z1SV1iW*xS!ZR}!O)r!O!P)r!Q![)r![!])r!c!})r#O#P*a#R#S)r#T#o)r~2WP!U~!_!`2Z~2`O!T~~2eQ&gP!_!`2k#r#s2pQ2pO!QQ~2uO&h~~2zP!S~!_!`2}~3SO!R~~3XO&k~V3`W!ZRtS}!O)r!O!P)r!Q![3X![!])r!c!}3X#O#P*a#R#S3X#T#o3X~3}O*s~~4SO*t~~4XOx~~4[TO#S4X#S#T%f#T;'S4X;'S;=`4k<%lO4X~4nP;=`<%l4X~4vO*y~~4{O*z~",tokenizers:[0,1,2],topRules:{MetricsQL:[0,28],MetricName:[1,259]},specialized:[{term:57,get:(e,t)=>Rt(e)<<1,external:Rt},{term:57,get:(e,t)=>Nt(e)<<1|1,external:Nt,extend:!0},{term:57,get:e=>jt[e]||-1}],tokenPrec:0}),Ft=3,Bt=21,Qt=29,$t=30,Vt=31,Xt=32,Gt=33,Ut=34,zt=35,Wt=36,Kt=37,Ht=38,Yt=39,Zt=41,Jt=42,er=54,tr=55,rr=240,nr=242,ir=243,ar=247,or=248,sr=249,lr=250,ur=251,cr=252,dr=[{label:"$__interval",sortValue:"$__interval"},{label:"$__rate_interval",sortValue:"$__rate_interval"},{label:"$__range",sortValue:"$__range"},{label:"1m",sortValue:"00:01:00"},{label:"5m",sortValue:"00:05:00"},{label:"10m",sortValue:"00:10:00"},{label:"30m",sortValue:"00:30:00"},{label:"1h",sortValue:"01:00:00"},{label:"1d",sortValue:"24:00:00"}],pr=[{label:"absent_over_time",insertText:"absent_over_time",detail:"absent_over_time(series_selector[d])",documentation:"returns 1 if the given lookbehind window `d` doesn't contain raw samples. Otherwise it returns an empty result. See also `present_over_time`."},{label:"aggr_over_time",insertText:"aggr_over_time",detail:'aggr_over_time(("rollup_func1", "rollup_func2", ...), series_selector[d])',documentation:'calculates all the listed `rollup_func*` for raw samples on the given lookbehind window `d`. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). `rollup_func*` can contain any rollup function. For instance, `aggr_over_time(("min_over_time", "max_over_time", "rate"), m[d])` would calculate `min_over_time` for `m[d]`.'},{label:"ascent_over_time",insertText:"ascent_over_time",detail:"ascent_over_time(series_selector[d])",documentation:"calculates ascent of raw sample values on the given lookbehind window `d`. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Useful for tracking height gains in GPS tracking. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"avg_over_time",insertText:"avg_over_time",detail:"avg_over_time(series_selector[d])",documentation:"calculates the average value over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). See also `median_over_time`."},{label:"changes",insertText:"changes",detail:"changes(series_selector[d])",documentation:"calculates the number of times the raw samples changed on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Unlike `changes()` in Prometheus it takes into account the change from the last sample before the given lookbehind window `d`. See [this article](https://medium.com/@romanhavronenko/victoriametrics-promql-compliance-d4318203f51e) for details. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"changes_prometheus",insertText:"changes_prometheus",detail:"changes_prometheus(series_selector[d])",documentation:"calculates the number of times the raw samples changed on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). It doesn't take into account the change from the last sample before the given lookbehind window `d` in the same way as Prometheus does. See [this article](https://medium.com/@romanhavronenko/victoriametrics-promql-compliance-d4318203f51e) for details. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"count_eq_over_time",insertText:"count_eq_over_time",detail:"count_eq_over_time(series_selector[d], eq)",documentation:"calculates the number of raw samples on the given lookbehind window `d`, which are equal to `eq`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"count_gt_over_time",insertText:"count_gt_over_time",detail:"count_gt_over_time(series_selector[d], gt)",documentation:"calculates the number of raw samples on the given lookbehind window `d`, which are bigger than `gt`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"count_le_over_time",insertText:"count_le_over_time",detail:"count_le_over_time(series_selector[d], le)",documentation:"calculates the number of raw samples on the given lookbehind window `d`, which don't exceed `le`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"count_ne_over_time",insertText:"count_ne_over_time",detail:"count_ne_over_time(series_selector[d], ne)",documentation:"calculates the number of raw samples on the given lookbehind window `d`, which aren't equal to `ne`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"count_over_time",insertText:"count_over_time",detail:"count_over_time(series_selector[d])",documentation:"calculates the number of raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"decreases_over_time",insertText:"decreases_over_time",detail:"decreases_over_time(series_selector[d])",documentation:"calculates the number of raw sample value decreases over the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"default_rollup",insertText:"default_rollup",detail:"default_rollup(series_selector[d])",documentation:"returns the last raw sample value on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering)."},{label:"delta",insertText:"delta",detail:"delta(series_selector[d])",documentation:"calculates the difference between the last sample before the given lookbehind window `d` and the last sample at the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). The behaviour of `delta()` function in MetricsQL is slightly different to the behaviour of `delta()` function in Prometheus. See [this article](https://medium.com/@romanhavronenko/victoriametrics-promql-compliance-d4318203f51e) for details. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"delta_prometheus",insertText:"delta_prometheus",detail:"delta_prometheus(series_selector[d])",documentation:"calculates the difference between the first and the last samples at the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). The behaviour of `delta_prometheus()` is close to the behaviour of `delta()` function in Prometheus. See [this article](https://medium.com/@romanhavronenko/victoriametrics-promql-compliance-d4318203f51e) for details. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"deriv",insertText:"deriv",detail:"deriv(series_selector[d])",documentation:"calculates per-second derivative over the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). The derivative is calculated using linear regression. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"deriv_fast",insertText:"deriv_fast",detail:"deriv_fast(series_selector[d])",documentation:"calculates per-second derivative using the first and the last raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"descent_over_time",insertText:"descent_over_time",detail:"descent_over_time(series_selector[d])",documentation:"calculates descent of raw sample values on the given lookbehind window `d`. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Useful for tracking height loss in GPS tracking. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"distinct_over_time",insertText:"distinct_over_time",detail:"distinct_over_time(series_selector[d])",documentation:"returns the number of distinct raw sample values on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"duration_over_time",insertText:"duration_over_time",detail:"duration_over_time(series_selector[d], max_interval)",documentation:"returns the duration in seconds when time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering) were present over the given lookbehind window `d`. It is expected that intervals between adjacent samples per each series don't exceed the `max_interval`. Otherwise such intervals are considered as gaps and aren't counted. See also `lifetime`."},{label:"first_over_time",insertText:"first_over_time",detail:"first_over_time(series_selector[d])",documentation:"returns the first raw sample value on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). See also `last_over_time`."},{label:"geomean_over_time",insertText:"geomean_over_time",detail:"geomean_over_time(series_selector[d])",documentation:"calculates [geometric mean](https://en.wikipedia.org/wiki/Geometric_mean) over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"histogram_over_time",insertText:"histogram_over_time",detail:"histogram_over_time(series_selector[d])",documentation:"calculates [VictoriaMetrics histogram](https://godoc.org/github.com/VictoriaMetrics/metrics#Histogram) over raw samples on the given lookbehind window `d`. It is calculated individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). The resulting histograms are useful to pass to `histogram_quantile``."},{label:"hoeffding_bound_lower",insertText:"hoeffding_bound_lower",detail:"hoeffding_bound_lower(phi, series_selector[d])",documentation:"calculates lower [Hoeffding bound](https://en.wikipedia.org/wiki/Hoeffding%27s_inequality) for the given `phi` in the range `[0...1]`. See also `hoeffding_bound_upper`."},{label:"hoeffding_bound_upper",insertText:"hoeffding_bound_upper",detail:"hoeffding_bound_upper(phi, series_selector[d])",documentation:"calculates upper [Hoeffding bound](https://en.wikipedia.org/wiki/Hoeffding%27s_inequality) for the given `phi` in the range `[0...1]`. See also `hoeffding_bound_lower`."},{label:"holt_winters",insertText:"holt_winters",detail:"holt_winters(series_selector[d], sf, tf)",documentation:"calculates Holt-Winters value (aka [double exponential smoothing](https://en.wikipedia.org/wiki/Exponential_smoothing#Double_exponential_smoothing)) for raw samples over the given lookbehind window `d` using the given smoothing factor `sf` and the given trend factor `tf`. Both `sf` and `tf` must be in the range `[0...1]`. It is expected that the [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering) returns time series of [gauge type](https://docs.victoriametrics.com/keyConcepts.html#gauge)."},{label:"idelta",insertText:"idelta",detail:"idelta(series_selector[d])",documentation:"calculates the difference between the last two raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"ideriv",insertText:"ideriv",detail:"ideriv(series_selector[d])",documentation:"calculates the per-second derivative based on the last two raw samples over the given lookbehind window `d`. The derivative is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"increase",insertText:"increase",detail:"increase(series_selector[d])",documentation:"calculates the increase over the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). It is expected that the `series_selector` returns time series of [counter type](https://docs.victoriametrics.com/keyConcepts.html#counter). Unlike Prometheus it takes into account the last sample before the given lookbehind window `d` when calculating the result. See [this article](https://medium.com/@romanhavronenko/victoriametrics-promql-compliance-d4318203f51e) for details. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"increase_prometheus",insertText:"increase_prometheus",detail:"increase_prometheus(series_selector[d])",documentation:"calculates the increase over the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). It is expected that the `series_selector` returns time series of [counter type](https://docs.victoriametrics.com/keyConcepts.html#counter). It doesn't take into account the last sample before the given lookbehind window `d` when calculating the result in the same way as Prometheus does. See [this article](https://medium.com/@romanhavronenko/victoriametrics-promql-compliance-d4318203f51e) for details. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"increase_pure",insertText:"increase_pure",detail:"increase_pure(series_selector[d])",documentation:"works the same as `increase` ignores the first value in a series if it is too big."},{label:"increases_over_time",insertText:"increases_over_time",detail:"increases_over_time(series_selector[d])",documentation:"calculates the number of raw sample value increases over the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"integrate",insertText:"integrate",detail:"integrate(series_selector[d])",documentation:"calculates the integral over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"irate",insertText:"irate",detail:"irate(series_selector[d])",documentation:'calculates the "instant" per-second increase rate over the last two raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). It is expected that the `series_selector` returns time series of [counter type](https://docs.victoriametrics.com/keyConcepts.html#counter). Metric names are stripped from the resulting rollups. Add `keep_metric_names`.'},{label:"lag",insertText:"lag",detail:"lag(series_selector[d])",documentation:"returns the duration in seconds between the last sample on the given lookbehind window `d` and the timestamp of the current point. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"last_over_time",insertText:"last_over_time",detail:"last_over_time(series_selector[d])",documentation:"returns the last raw sample value on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). See also `first_over_time`."},{label:"lifetime",insertText:"lifetime",detail:"lifetime(series_selector[d])",documentation:"returns the duration in seconds between the last and the first sample on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"max_over_time",insertText:"max_over_time",detail:"max_over_time(series_selector[d])",documentation:"calculates the maximum value over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). See also `tmax_over_time`."},{label:"median_over_time",insertText:"median_over_time",detail:"median_over_time(series_selector[d])",documentation:"calculates median value over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). See also `avg_over_time`."},{label:"min_over_time",insertText:"min_over_time",detail:"min_over_time(series_selector[d])",documentation:"calculates the minimum value over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). See also `tmin_over_time`."},{label:"mode_over_time",insertText:"mode_over_time",detail:"mode_over_time(series_selector[d])",documentation:"calculates [mode](https://en.wikipedia.org/wiki/Mode_(statistics)) for raw samples on the given lookbehind window `d`. It is calculated individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). It is expected that raw sample values are discrete."},{label:"predict_linear",insertText:"predict_linear",detail:"predict_linear(series_selector[d], t)",documentation:"calculates the value `t` seconds in the future using linear interpolation over raw samples on the given lookbehind window `d`. The predicted value is calculated individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering)."},{label:"present_over_time",insertText:"present_over_time",detail:"present_over_time(series_selector[d])",documentation:"returns 1 if there is at least a single raw sample on the given lookbehind window `d`. Otherwise an empty result is returned. Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"quantile_over_time",insertText:"quantile_over_time",detail:"quantile_over_time(phi, series_selector[d])",documentation:"calculates `phi`-quantile over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). The `phi` value must be in the range `[0...1]`. See also `quantiles_over_time`."},{label:"quantiles_over_time",insertText:"quantiles_over_time",detail:'quantiles_over_time("phiLabel", phi1, ..., phiN, series_selector[d])',documentation:'calculates `phi*`-quantiles over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). The function returns individual series per each `phi*` with `{phiLabel="phi*"}` label. `phi*` values must be in the range `[0...1]`. See also `quantile_over_time`.'},{label:"range_over_time",insertText:"range_over_time",detail:"range_over_time(series_selector[d])",documentation:"calculates value range over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). E.g. it calculates `max_over_time(series_selector[d]) - min_over_time(series_selector[d])`. Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"rate",insertText:"rate",detail:"rate(series_selector[d])",documentation:"calculates the average per-second increase rate over the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). It is expected that the `series_selector` returns time series of [counter type](https://docs.victoriametrics.com/keyConcepts.html#counter). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"rate_over_sum",insertText:"rate_over_sum",detail:"rate_over_sum(series_selector[d])",documentation:"calculates per-second rate over the sum of raw samples on the given lookbehind window `d`. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"resets",insertText:"resets",detail:"resets(series_selector[d])",documentation:"returns the number of [counter](https://docs.victoriametrics.com/keyConcepts.html#counter) resets over the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). It is expected that the `series_selector` returns time series of [counter type](https://docs.victoriametrics.com/keyConcepts.html#counter). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"rollup",insertText:"rollup",detail:"rollup(series_selector[d])",documentation:"calculates `min`, `max` and `avg` values for raw samples on the given lookbehind window `d`. These values are calculated individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering)."},{label:"rollup_candlestick",insertText:"rollup_candlestick",detail:"rollup_candlestick(series_selector[d])",documentation:"calculates `open`, `high`, `low` and `close` values (aka OHLC) over raw samples on the given lookbehind window `d`. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). This function is useful for financial applications."},{label:"rollup_delta",insertText:"rollup_delta",detail:"rollup_delta(series_selector[d])",documentation:"calculates differences between adjacent raw samples on the given lookbehind window `d` and returns `min`, `max` and `avg` values for the calculated differences. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"rollup_deriv",insertText:"rollup_deriv",detail:"rollup_deriv(series_selector[d])",documentation:"calculates per-second derivatives for adjacent raw samples on the given lookbehind window `d` and returns `min`, `max` and `avg` values for the calculated per-second derivatives. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"rollup_increase",insertText:"rollup_increase",detail:"rollup_increase(series_selector[d])",documentation:"calculates increases for adjacent raw samples on the given lookbehind window `d` and returns `min`, `max` and `avg` values for the calculated increases. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"rollup_rate",insertText:"rollup_rate",detail:"rollup_rate(series_selector[d])",documentation:"calculates per-second change rates for adjacent raw samples on the given lookbehind window `d` and returns `min`, `max` and `avg` values for the calculated per-second change rates. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"rollup_scrape_interval",insertText:"rollup_scrape_interval",detail:"rollup_scrape_interval(series_selector[d])",documentation:"calculates the interval in seconds between adjacent raw samples on the given lookbehind window `d` and returns `min`, `max` and `avg` values for the calculated interval. The calculations are performed individually per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"scrape_interval",insertText:"scrape_interval",detail:"scrape_interval(series_selector[d])",documentation:"calculates the average interval in seconds between raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"share_gt_over_time",insertText:"share_gt_over_time",detail:"share_gt_over_time(series_selector[d], gt)",documentation:"returns share (in the range `[0...1]`) of raw samples on the given lookbehind window `d`, which are bigger than `gt`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"share_le_over_time",insertText:"share_le_over_time",detail:"share_le_over_time(series_selector[d], le)",documentation:"returns share (in the range `[0...1]`) of raw samples on the given lookbehind window `d`, which are smaller or equal to `le`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"stale_samples_over_time",insertText:"stale_samples_over_time",detail:"stale_samples_over_time(series_selector[d])",documentation:"calculates the number of [staleness markers](https://docs.victoriametrics.com/vmagent.html#prometheus-staleness-markers) on the given lookbehind window `d` per each time series matching the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"stddev_over_time",insertText:"stddev_over_time",detail:"stddev_over_time(series_selector[d])",documentation:"calculates standard deviation over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"stdvar_over_time",insertText:"stdvar_over_time",detail:"stdvar_over_time(series_selector[d])",documentation:"calculates standard variance over raw samples on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"sum_over_time",insertText:"sum_over_time",detail:"sum_over_time(series_selector[d])",documentation:"calculates the sum of raw sample values on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"sum2_over_time",insertText:"sum2_over_time",detail:"sum2_over_time(series_selector[d])",documentation:"calculates the sum of squares for raw sample values on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"timestamp",insertText:"timestamp",detail:"timestamp(series_selector[d])",documentation:"returns the timestamp in seconds for the last raw sample on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"timestamp_with_name",insertText:"timestamp_with_name",detail:"timestamp_with_name(series_selector[d])",documentation:"returns the timestamp in seconds for the last raw sample on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are preserved in the resulting rollups. See also `timestamp`."},{label:"tfirst_over_time",insertText:"tfirst_over_time",detail:"tfirst_over_time(series_selector[d])",documentation:"returns the timestamp in seconds for the first raw sample on the given lookbehind window `d` per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"tlast_change_over_time",insertText:"tlast_change_over_time",detail:"tlast_change_over_time(series_selector[d])",documentation:"returns the timestamp in seconds for the last change per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering) on the given lookbehind window `d`. Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"tlast_over_time",insertText:"tlast_over_time",detail:"tlast_over_time(series_selector[d])",documentation:"is an alias for `timestamp`."},{label:"tmax_over_time",insertText:"tmax_over_time",detail:"tmax_over_time(series_selector[d])",documentation:"returns the timestamp in seconds for the raw sample with the maximum value on the given lookbehind window `d`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"tmin_over_time",insertText:"tmin_over_time",detail:"tmin_over_time(series_selector[d])",documentation:"returns the timestamp in seconds for the raw sample with the minimum value on the given lookbehind window `d`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names`."},{label:"zscore_over_time",insertText:"zscore_over_time",detail:"zscore_over_time(series_selector[d])",documentation:"calculates returns [z-score](https://en.wikipedia.org/wiki/Standard_score) for raw samples on the given lookbehind window `d`. It is calculated independently per each time series returned from the given [series_selector](https://docs.victoriametrics.com/keyConcepts.html#filtering). Metric names are stripped from the resulting rollups. Add `keep_metric_names` modifier in order to keep metric names."},{label:"abs",insertText:"abs",detail:"abs(q)",documentation:"calculates the absolute value for every point of every time series returned by `q`."},{label:"absent",insertText:"absent",detail:"absent(q)",documentation:"returns 1 if `q` has no points. Otherwise returns an empty result."},{label:"acos",insertText:"acos",detail:"acos(q)",documentation:"returns [inverse cosine](https://en.wikipedia.org/wiki/Inverse_trigonometric_functions) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"acosh",insertText:"acosh",detail:"acosh(q)",documentation:"returns [inverse hyperbolic cosine](https://en.wikipedia.org/wiki/Inverse_hyperbolic_functions#Inverse_hyperbolic_cosine) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"asin",insertText:"asin",detail:"asin(q)",documentation:"returns [inverse sine](https://en.wikipedia.org/wiki/Inverse_trigonometric_functions) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"asinh",insertText:"asinh",detail:"asinh(q)",documentation:"returns [inverse hyperbolic sine](https://en.wikipedia.org/wiki/Inverse_hyperbolic_functions#Inverse_hyperbolic_sine) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"atan",insertText:"atan",detail:"atan(q)",documentation:"returns [inverse tangent](https://en.wikipedia.org/wiki/Inverse_trigonometric_functions) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"atanh",insertText:"atanh",detail:"atanh(q)",documentation:"returns [inverse hyperbolic tangent](https://en.wikipedia.org/wiki/Inverse_hyperbolic_functions#Inverse_hyperbolic_tangent) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"bitmap_and",insertText:"bitmap_and",detail:"bitmap_and(q, mask)",documentation:"- calculates bitwise `v & mask` for every `v` point of every time series returned from `q`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"bitmap_or",insertText:"bitmap_or",detail:"bitmap_or(q, mask)",documentation:"calculates bitwise `v | mask` for every `v` point of every time series returned from `q`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"bitmap_xor",insertText:"bitmap_xor",detail:"bitmap_xor(q, mask)",documentation:"calculates bitwise `v ^ mask` for every `v` point of every time series returned from `q`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"buckets_limit",insertText:"buckets_limit",detail:"buckets_limit(limit, buckets)",documentation:"limits the number of [histogram buckets](https://valyala.medium.com/improving-histogram-usability-for-prometheus-and-grafana-bc7e5df0e350) to the given `limit`. See also `prometheus_buckets`."},{label:"ceil",insertText:"ceil",detail:"ceil(q)",documentation:"rounds every point for every time series returned by `q` to the upper nearest integer. See also `floor`."},{label:"clamp",insertText:"clamp",detail:"clamp(q, min, max)",documentation:"clamps every point for every time series returned by `q` with the given `min` and `max` values. See also `clamp_min`."},{label:"clamp_max",insertText:"clamp_max",detail:"clamp_max(q, max)",documentation:"clamps every point for every time series returned by `q` with the given `max` value. See also `clamp`."},{label:"clamp_min",insertText:"clamp_min",detail:"clamp_min(q, min)",documentation:"clamps every point for every time series returned by `q` with the given `min` value. See also `clamp`."},{label:"cos",insertText:"cos",detail:"cos(q)",documentation:"returns `cos(v)` for every `v` point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"cosh",insertText:"cosh",detail:"cosh(q)",documentation:"returns [hyperbolic cosine](https://en.wikipedia.org/wiki/Hyperbolic_functions) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"day_of_month",insertText:"day_of_month",detail:"day_of_month(q)",documentation:"returns the day of month for every point of every time series returned by `q`. It is expected that `q` returns unix timestamps. The returned values are in the range `[1...31]`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"day_of_week",insertText:"day_of_week",detail:"day_of_week(q)",documentation:"returns the day of week for every point of every time series returned by `q`. It is expected that `q` returns unix timestamps. The returned values are in the range `[0...6]`, where `0` means Sunday and `6` means Saturday. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"days_in_month",insertText:"days_in_month",detail:"days_in_month(q)",documentation:"returns the number of days in the month identified by every point of every time series returned by `q`. It is expected that `q` returns unix timestamps. The returned values are in the range `[28...31]`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"deg",insertText:"deg",detail:"deg(q)",documentation:"converts [Radians to degrees](https://en.wikipedia.org/wiki/Radian#Conversions) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"end",insertText:"end",detail:"end()",documentation:"returns the unix timestamp in seconds for the last point. See also `start`."},{label:"exp",insertText:"exp",detail:"exp(q)",documentation:"calculates the `e^v` for every point `v` of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"floor",insertText:"floor",detail:"floor(q)",documentation:"rounds every point for every time series returned by `q` to the lower nearest integer. See also `ceil`."},{label:"histogram_avg",insertText:"histogram_avg",detail:"histogram_avg(buckets)",documentation:"calculates the average value for the given `buckets`. It can be used for calculating the average over the given time range across multiple time series. For example, `histogram_avg(sum(histogram_over_time(response_time_duration_seconds[5m])) by (vmrange,job))` would return the average response time per each `job` over the last 5 minutes."},{label:"histogram_quantile",insertText:"histogram_quantile",detail:"histogram_quantile(phi, buckets)",documentation:"calculates `phi`-quantile over the given [histogram buckets](https://valyala.medium.com/improving-histogram-usability-for-prometheus-and-grafana-bc7e5df0e350). `phi` must be in the range `[0...1]`. For example, `histogram_quantile(0.5, sum(rate(http_request_duration_seconds_bucket[5m]) by (le))` would return median request duration for all the requests during the last 5 minutes. It accepts optional third arg - `boundsLabel`. In this case it returns `lower` and `upper` bounds for the estimated percentile. See [this issue for details](https://github.com/prometheus/prometheus/issues/5706). This function is supported by PromQL (except of the `boundLabel` arg). See also `histogram_quantiles`."},{label:"histogram_quantiles",insertText:"histogram_quantiles",detail:'histogram_quantiles("phiLabel", phi1, ..., phiN, buckets)',documentation:"calculates the given `phi*`-quantiles over the given [histogram buckets](https://valyala.medium.com/improving-histogram-usability-for-prometheus-and-grafana-bc7e5df0e350). Argument `phi*` must be in the range `[0...1]`. For example, `histogram_quantiles('le', 0.3, 0.5, sum(rate(http_request_duration_seconds_bucket[5m]) by (le))`. Each calculated quantile is returned in a separate time series with the corresponding `{phiLabel=\"phi*\"}` label. See also `histogram_quantile`."},{label:"histogram_share",insertText:"histogram_share",detail:"histogram_share(le, buckets)",documentation:"calculates the share (in the range `[0...1]`) for `buckets` that fall below `le`. Useful for calculating SLI and SLO. This is inverse to `histogram_quantile`."},{label:"histogram_stddev",insertText:"histogram_stddev",detail:"histogram_stddev(buckets)",documentation:"calculates standard deviation for the given `buckets`."},{label:"histogram_stdvar",insertText:"histogram_stdvar",detail:"histogram_stdvar(buckets)",documentation:"calculates standard variance for the given `buckets`. It can be used for calculating standard deviation over the given time range across multiple time series. For example, `histogram_stdvar(sum(histogram_over_time(temperature[24])) by (vmrange,country))` would return standard deviation for the temperature per each country over the last 24 hours."},{label:"hour",insertText:"hour",detail:"hour(q)",documentation:"returns the hour for every point of every time series returned by `q`. It is expected that `q` returns unix timestamps. The returned values are in the range `[0...23]`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"interpolate",insertText:"interpolate",detail:"interpolate(q)",documentation:"fills gaps with linearly interpolated values calculated from the last and the next non-empty points per each time series returned by `q`. See also `keep_last_value`."},{label:"keep_last_value",insertText:"keep_last_value",detail:"keep_last_value(q)",documentation:"fills gaps with the value of the last non-empty point in every time series returned by `q`. See also `keep_next_value`."},{label:"keep_next_value",insertText:"keep_next_value",detail:"keep_next_value(q)",documentation:"fills gaps with the value of the next non-empty point in every time series returned by `q`. See also `keep_last_value`."},{label:"limit_offset",insertText:"limit_offset",detail:"limit_offset(limit, offset, q)",documentation:"skips `offset` time series from series returned by `q` and then returns up to `limit` of the remaining time series per each group. This allows implementing simple paging for `q` time series. See also `limitk`."},{label:"ln",insertText:"ln",detail:"ln(q)",documentation:"calculates `ln(v)` for every point `v` of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"log2",insertText:"log2",detail:"log2(q)",documentation:"calculates `log2(v)` for every point `v` of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"log10",insertText:"log10",detail:"log10(q)",documentation:"calculates `log10(v)` for every point `v` of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"minute",insertText:"minute",detail:"minute(q)",documentation:"returns the minute for every point of every time series returned by `q`. It is expected that `q` returns unix timestamps. The returned values are in the range `[0...59]`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"month",insertText:"month",detail:"month(q)",documentation:"returns the month for every point of every time series returned by `q`. It is expected that `q` returns unix timestamps. The returned values are in the range `[1...12]`, where `1` means January and `12` means December. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"now",insertText:"now",detail:"now()",documentation:"returns the current timestamp as a floating-point value in seconds. See also `time`."},{label:"pi",insertText:"pi",detail:"pi()",documentation:"returns [Pi number](https://en.wikipedia.org/wiki/Pi)."},{label:"rad",insertText:"rad",detail:"rad(q)",documentation:"converts [degrees to Radians](https://en.wikipedia.org/wiki/Radian#Conversions) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"prometheus_buckets",insertText:"prometheus_buckets",detail:"prometheus_buckets(buckets)",documentation:"converts [VictoriaMetrics histogram buckets](https://valyala.medium.com/improving-histogram-usability-for-prometheus-and-grafana-bc7e5df0e350) with `vmrange` labels to Prometheus histogram buckets with `le` labels. This may be useful for building heatmaps in Grafana. See also `histogram_quantile`."},{label:"rand",insertText:"rand",detail:"rand(seed)",documentation:"returns pseudo-random numbers on the range `[0...1]` with even distribution. Optional `seed` can be used as a seed for pseudo-random number generator. See also `rand_normal`."},{label:"rand_exponential",insertText:"rand_exponential",detail:"rand_exponential(seed)",documentation:"returns pseudo-random numbers with [exponential distribution](https://en.wikipedia.org/wiki/Exponential_distribution). Optional `seed` can be used as a seed for pseudo-random number generator. See also `rand`."},{label:"rand_normal",insertText:"rand_normal",detail:"rand_normal(seed)",documentation:"returns pseudo-random numbers with [normal distribution](https://en.wikipedia.org/wiki/Normal_distribution). Optional `seed` can be used as a seed for pseudo-random number generator. See also `rand`."},{label:"range_avg",insertText:"range_avg",detail:"range_avg(q)",documentation:"calculates the avg value across points per each time series returned by `q`."},{label:"range_first",insertText:"range_first",detail:"range_first(q)",documentation:"returns the value for the first point per each time series returned by `q`."},{label:"range_last",insertText:"range_last",detail:"range_last(q)",documentation:"returns the value for the last point per each time series returned by `q`."},{label:"range_max",insertText:"range_max",detail:"range_max(q)",documentation:"calculates the max value across points per each time series returned by `q`."},{label:"range_median",insertText:"range_median",detail:"range_median(q)",documentation:"calculates the median value across points per each time series returned by `q`."},{label:"range_min",insertText:"range_min",detail:"range_min(q)",documentation:"calculates the min value across points per each time series returned by `q`."},{label:"range_quantile",insertText:"range_quantile",detail:"range_quantile(phi, q)",documentation:"returns `phi`-quantile across points per each time series returned by `q`. `phi` must be in the range `[0...1]`."},{label:"range_sum",insertText:"range_sum",detail:"range_sum(q)",documentation:"calculates the sum of points per each time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"remove_resets",insertText:"remove_resets",detail:"remove_resets(q)",documentation:"removes counter resets from time series returned by `q`."},{label:"round",insertText:"round",detail:"round(q, nearest)",documentation:"round every point of every time series returned by `q` to the `nearest` multiple. If `nearest` is missing then the rounding is performed to the nearest integer. See also `floor`."},{label:"ru",insertText:"ru",detail:"ru(free, max)",documentation:"calculates resource utilization in the range `[0%...100%]` for the given `free` and `max` resources. For instance, `ru(node_memory_MemFree_bytes, node_memory_MemTotal_bytes)` returns memory utilization over [node_exporter](https://github.com/prometheus/node_exporter) metrics."},{label:"running_avg",insertText:"running_avg",detail:"running_avg(q)",documentation:"calculates the running avg per each time series returned by `q`."},{label:"running_max",insertText:"running_max",detail:"running_max(q)",documentation:"calculates the running max per each time series returned by `q`."},{label:"running_min",insertText:"running_min",detail:"running_min(q)",documentation:"calculates the running min per each time series returned by `q`."},{label:"running_sum",insertText:"running_sum",detail:"running_sum(q)",documentation:"calculates the running sum per each time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"scalar",insertText:"scalar",detail:"scalar(q)",documentation:"returns `q` if `q` contains only a single time series. Otherwise it returns nothing."},{label:"sgn",insertText:"sgn",detail:"sgn(q)",documentation:"returns `1` if `v>0`, `-1` if `v<0` and `0` if `v==0` for every point `v` of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"sin",insertText:"sin",detail:"sin(q)",documentation:"returns `sin(v)` for every `v` point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"sinh",insertText:"sinh",detail:"sinh(q)",documentation:"returns [hyperbolic sine](https://en.wikipedia.org/wiki/Hyperbolic_functions) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"tan",insertText:"tan",detail:"tan(q)",documentation:"returns `tan(v)` for every `v` point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"tanh",insertText:"tanh",detail:"tanh(q)",documentation:"returns [hyperbolic tangent](https://en.wikipedia.org/wiki/Hyperbolic_functions) for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names`."},{label:"smooth_exponential",insertText:"smooth_exponential",detail:"smooth_exponential(q, sf)",documentation:"smooths points per each time series returned by `q` using [exponential moving average](https://en.wikipedia.org/wiki/Moving_average#Exponential_moving_average) with the given smooth factor `sf`."},{label:"sort",insertText:"sort",detail:"sort(q)",documentation:"sorts series in ascending order by the last point in every time series returned by `q`. See also `sort_desc`."},{label:"sort_by_label",insertText:"sort_by_label",detail:"sort_by_label(q, label1, ... labelN)",documentation:'sorts series in ascending order by the given set of labels. For example, `sort_by_label(foo, "bar")` would sort `foo` series by values of the label `bar` in these series. See also `sort_by_label_desc`.'},{label:"sort_by_label_desc",insertText:"sort_by_label_desc",detail:"sort_by_label_desc(q, label1, ... labelN)",documentation:'sorts series in descending order by the given set of labels. For example, `sort_by_label(foo, "bar")` would sort `foo` series by values of the label `bar` in these series. See also `sort_by_label`.'},{label:"sort_by_label_numeric",insertText:"sort_by_label_numeric",detail:"sort_by_label_numeric(q, label1, ... labelN)",documentation:'sorts series in ascending order by the given set of labels using [numeric sort](https://www.gnu.org/software/coreutils/manual/html_node/Version-sort-is-not-the-same-as-numeric-sort.html). For example, if `foo` series have `bar` label with values `1`, `101`, `15` and `2`, then `sort_by_label_numeric(foo, "bar")` would return series in the following order of `bar` label values: `1`, `2`, `15` and `101`.'},{label:"sort_by_label_numeric_desc",insertText:"sort_by_label_numeric_desc",detail:"sort_by_label_numeric_desc(q, label1, ... labelN)",documentation:'sorts series in descending order by the given set of labels using [numeric sort](https://www.gnu.org/software/coreutils/manual/html_node/Version-sort-is-not-the-same-as-numeric-sort.html). For example, if `foo` series have `bar` label with values `1`, `101`, `15` and `2`, then `sort_by_label_numeric(foo, "bar")` would return series in the following order of `bar` label values: `101`, `15`, `2` and `1`.'},{label:"sort_desc",insertText:"sort_desc",detail:"sort_desc(q)",documentation:"sorts series in descending order by the last point in every time series returned by `q`. See also `sort`."},{label:"sqrt",insertText:"sqrt",detail:"sqrt(q)",documentation:"calculates square root for every point of every time series returned by `q`. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"start",insertText:"start",detail:"start()",documentation:"returns unix timestamp in seconds for the first point. See also `end`."},{label:"step",insertText:"step",detail:"step()",documentation:"returns the step in seconds (aka interval) between the returned points. It is known as `step` query arg passed to [/api/v1/query_range](https://docs.victoriametrics.com/keyConcepts.html#range-query)."},{label:"time",insertText:"time",detail:"time()",documentation:"returns unix timestamp for every returned point."},{label:"timezone_offset",insertText:"timezone_offset",detail:"timezone_offset(tz)",documentation:'returns offset in seconds for the given timezone `tz` relative to UTC. This can be useful when combining with datetime-related functions. For example, `day_of_week(time()+timezone_offset("America/Los_Angeles"))` would return weekdays for `America/Los_Angeles` time zone. Special `Local` time zone can be used for returning an offset for the time zone set on the host where VictoriaMetrics runs. See [the list of supported timezones](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones).'},{label:"ttf",insertText:"ttf",detail:"ttf(free)",documentation:"estimates the time in seconds needed to exhaust `free` resources. For instance, `ttf(node_filesystem_avail_byte)` returns the time to storage space exhaustion. This function may be useful for capacity planning."},{label:"union",insertText:"union",detail:"union(q1, ..., qN)",documentation:"returns a union of time series returned from `q1`, ..., `qN`. The `union` function name can be skipped - the following queries are equivalent: `union(q1, q2)` and `(q1, q2)`. It is expected that each `q*` query returns time series with unique sets of labels. Otherwise only the first time series out of series with identical set of labels is returned. Use `alias` functions for giving unique labelsets per each `q*` query:"},{label:"vector",insertText:"vector",detail:"vector(q)",documentation:"returns `q`, e.g. it does nothing in MetricsQL."},{label:"year",insertText:"year",detail:"year(q)",documentation:"returns the year for every point of every time series returned by `q`. It is expected that `q` returns unix timestamps. Metric names are stripped from the resulting series. Add `keep_metric_names` modifier in order to keep metric names."},{label:"alias",insertText:"alias",detail:'alias(q, "name")',documentation:'sets the given `name` to all the time series returned by `q`. For example, `alias(up, "foobar")` would rename `up` series to `foobar` series.'},{label:"drop_common_labels",insertText:"drop_common_labels",detail:"drop_common_labels(q1, ...., qN)",documentation:'drops common `label="value"` pairs among time series returned from `q1, ..., qN`.'},{label:"label_copy",insertText:"label_copy",detail:'label_copy(q, "src_label1", "dst_label1", ..., "src_labelN", "dst_labelN")',documentation:"copies label values from `src_label*` to `dst_label*` for all the time series returned by `q`. If `src_label` is empty, then the corresponding `dst_label` is left untouched."},{label:"label_del",insertText:"label_del",detail:'label_del(q, "label1", ..., "labelN")',documentation:"deletes the given `label*` labels from all the time series returned by `q`."},{label:"label_graphite_group",insertText:"label_graphite_group",detail:"label_graphite_group(q, groupNum1, ... groupNumN)",documentation:'replaces metric names returned from `q` with the given Graphite group values concatenated via `.` char. For example, `label_graphite_group({__graphite__="foo*.bar.*"}, 0, 2)` would substitute `foo<any_value>.bar.<other_value>` metric names with `foo<any_value>.<other_value>`. This function is useful for aggregating Graphite metrics with `aggregate functions`. For example, the following query would return per-app memory usage:'},{label:"label_join",insertText:"label_join",detail:'label_join(q, "dst_label", "separator", "src_label1", ..., "src_labelN")',documentation:'joins `src_label*` values with the given `separator` and stores the result in `dst_label`. This is performed individually per each time series returned by `q`. For example, `label_join(up{instance="xxx",job="yyy"}, "foo", "-", "instance", "job")` would store `xxx-yyy` label value into `foo` label.'},{label:"label_keep",insertText:"label_keep",detail:'label_keep(q, "label1", ..., "labelN")',documentation:"deletes all the labels except of the listed `label*` labels in all the time series returned by `q`."},{label:"label_lowercase",insertText:"label_lowercase",detail:'label_lowercase(q, "label1", ..., "labelN")',documentation:"lowercases values for the given `label*` labels in all the time series returned by `q`."},{label:"label_map",insertText:"label_map",detail:'label_map(q, "label", "src_value1", "dst_value1", ..., "src_valueN", "dst_valueN")',documentation:"maps `label` values from `src_*` to `dst*` for all the time series returned by `q`."},{label:"label_match",insertText:"label_match",detail:'label_match(q, "label", "regexp")',documentation:"drops time series from `q` with `label` not matching the given `regexp`. This function can be useful after `rollup`."},{label:"label_mismatch",insertText:"label_mismatch",detail:'label_mismatch(q, "label", "regexp")',documentation:"drops time series from `q` with `label` matching the given `regexp`. This function can be useful after `rollup`."},{label:"label_move",insertText:"label_move",detail:'label_move(q, "src_label1", "dst_label1", ..., "src_labelN", "dst_labelN")',documentation:"moves label values from `src_label*` to `dst_label*` for all the time series returned by `q`. If `src_label` is empty, then the corresponding `dst_label` is left untouched."},{label:"label_replace",insertText:"label_replace",detail:'label_replace(q, "dst_label", "replacement", "src_label", "regex")',documentation:'applies the given `regex` to `src_label` and stores the `replacement` in `dst_label` if the given `regex` matches `src_label`. The `replacement` may contain references to regex captures such as `$1`, `$2`, etc. These references are substituted by the corresponding regex captures. For example, `label_replace(up{job="node-exporter"}, "foo", "bar-$1", "job", "node-(.+)")` would store `bar-exporter` label value into `foo` label.'},{label:"label_set",insertText:"label_set",detail:'label_set(q, "label1", "value1", ..., "labelN", "valueN")',documentation:'sets `{label1="value1", ..., labelN="valueN"}` labels to all the time series returned by `q`.'},{label:"label_transform",insertText:"label_transform",detail:'label_transform(q, "label", "regexp", "replacement")',documentation:"substitutes all the `regexp` occurrences by the given `replacement` in the given `label`."},{label:"label_uppercase",insertText:"label_uppercase",detail:'label_uppercase(q, "label1", ..., "labelN")',documentation:"uppercases values for the given `label*` labels in all the time series returned by `q`."},{label:"label_value",insertText:"label_value",detail:'label_value(q, "label")',documentation:'returns number values for the given `label` for every time series returned by `q`. For example, if `label_value(foo, "bar")` is applied to `foo{bar="1.234"}`, then it will return a time series `foo{bar="1.234"}` with `1.234` value.'},{label:"any",insertText:"any",detail:"any(q) by (group_labels)",documentation:"returns a single series per `group_labels` out of time series returned by `q`. See also `group`."},{label:"avg",insertText:"avg",detail:"avg(q) by (group_labels)",documentation:"returns the average value per `group_labels` for time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"bottomk",insertText:"bottomk",detail:"bottomk(k, q)",documentation:"returns up to `k` points with the smallest values across all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp. See also `topk`."},{label:"bottomk_avg",insertText:"bottomk_avg",detail:'bottomk_avg(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the smallest averages. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `bottomk_avg(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the smallest averages plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `topk_avg`.'},{label:"bottomk_last",insertText:"bottomk_last",detail:'bottomk_last(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the smallest last values. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `bottomk_max(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the smallest maximums plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `topk_last`.'},{label:"bottomk_max",insertText:"bottomk_max",detail:'bottomk_max(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the smallest maximums. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `bottomk_max(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the smallest maximums plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `topk_max`.'},{label:"bottomk_median",insertText:"bottomk_median",detail:'bottomk_median(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q with the smallest medians. If an optional`other_label=other_value`arg is set, then the sum of the remaining time series is returned with the given label. For example,`bottomk_median(3, sum(process_resident_memory_bytes) by (job), "job=other")`would return up to 3 time series with the smallest medians plus a time series with`{job="other"}\\` label with the sum of the remaining series if any. See also `topk_median`.'},{label:"bottomk_min",insertText:"bottomk_min",detail:'bottomk_min(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the smallest minimums. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `bottomk_min(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the smallest minimums plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `topk_min`.'},{label:"count",insertText:"count",detail:"count(q) by (group_labels)",documentation:"returns the number of non-empty points per `group_labels` for time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"count_values",insertText:"count_values",detail:'count_values("label", q)',documentation:"counts the number of points with the same value and stores the counts in a time series with an additional `label`, which contains each initial value. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"distinct",insertText:"distinct",detail:"distinct(q)",documentation:"calculates the number of unique values per each group of points with the same timestamp."},{label:"geomean",insertText:"geomean",detail:"geomean(q)",documentation:"calculates geometric mean per each group of points with the same timestamp."},{label:"group",insertText:"group",detail:"group(q) by (group_labels)",documentation:"returns `1` per each `group_labels` for time series returned by `q`. See also `any`."},{label:"histogram",insertText:"histogram",detail:"histogram(q)",documentation:"calculates [VictoriaMetrics histogram](https://valyala.medium.com/improving-histogram-usability-for-prometheus-and-grafana-bc7e5df0e350) per each group of points with the same timestamp. Useful for visualizing big number of time series via a heatmap. See [this article](https://medium.com/@valyala/improving-histogram-usability-for-prometheus-and-grafana-bc7e5df0e350) for more details."},{label:"limitk",insertText:"limitk",detail:"limitk(k, q) by (group_labels)",documentation:"returns up to `k` time series per each `group_labels` out of time series returned by `q`. The returned set of time series remain the same across calls. See also `limit_offset`."},{label:"mad",insertText:"mad",detail:"mad(q) by (group_labels)",documentation:"returns the [Median absolute deviation](https://en.wikipedia.org/wiki/Median_absolute_deviation) per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp. See also `outliers_mad`."},{label:"max",insertText:"max",detail:"max(q) by (group_labels)",documentation:"returns the maximum value per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"median",insertText:"median",detail:"median(q) by (group_labels)",documentation:"returns the median value per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"min",insertText:"min",detail:"min(q) by (group_labels)",documentation:"returns the minimum value per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"mode",insertText:"mode",detail:"mode(q) by (group_labels)",documentation:"returns [mode](https://en.wikipedia.org/wiki/Mode_(statistics)) per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"outliers_mad",insertText:"outliers_mad",detail:"outliers_mad(tolerance, q)",documentation:"returns time series from `q` with at least a single point outside [Median absolute deviation](https://en.wikipedia.org/wiki/Median_absolute_deviation) (aka MAD) multiplied by `tolerance`. E.g. it returns time series with at least a single point below `median(q) - mad(q)` or a single point above `median(q) + mad(q)`. See also `outliersk`."},{label:"outliersk",insertText:"outliersk",detail:"outliersk(k, q)",documentation:"returns up to `k` time series with the biggest standard deviation (aka outliers) out of time series returned by `q`. See also `outliers_mad`."},{label:"quantile",insertText:"quantile",detail:"quantile(phi, q) by (group_labels)",documentation:"calculates `phi`-quantile per each `group_labels` for all the time series returned by `q`. `phi` must be in the range `[0...1]`. The aggregate is calculated individually per each group of points with the same timestamp. See also `quantiles`."},{label:"quantiles",insertText:"quantiles",detail:'quantiles("phiLabel", phi1, ..., phiN, q)',documentation:'calculates `phi*`-quantiles for all the time series returned by `q` and return them in time series with `{phiLabel="phi*"}` label. `phi*` must be in the range `[0...1]`. The aggregate is calculated individually per each group of points with the same timestamp. See also `quantile`.'},{label:"stddev",insertText:"stddev",detail:"stddev(q) by (group_labels)",documentation:"calculates standard deviation per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"stdvar",insertText:"stdvar",detail:"stdvar(q) by (group_labels)",documentation:"calculates standard variance per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"sum",insertText:"sum",detail:"sum(q) by (group_labels)",documentation:"returns the sum per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"sum2",insertText:"sum2",detail:"sum2(q) by (group_labels)",documentation:"calculates the sum of squares per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp."},{label:"topk",insertText:"topk",detail:"topk(k, q)",documentation:"returns up to `k` points with the biggest values across all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp. See also `bottomk`."},{label:"topk_avg",insertText:"topk_avg",detail:'topk_avg(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the biggest averages. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `topk_avg(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the biggest averages plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `bottomk_avg`.'},{label:"topk_last",insertText:"topk_last",detail:'topk_last(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the biggest last values. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `topk_max(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the biggest maximums plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `bottomk_last`.'},{label:"topk_max",insertText:"topk_max",detail:'topk_max(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the biggest maximums. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `topk_max(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the biggest maximums plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `bottomk_max`.'},{label:"topk_median",insertText:"topk_median",detail:'topk_median(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the biggest medians. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `topk_median(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the biggest medians plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `bottomk_median`.'},{label:"topk_min",insertText:"topk_min",detail:'topk_min(k, q, "other_label=other_value")',documentation:'returns up to `k` time series from `q` with the biggest minimums. If an optional `other_label=other_value` arg is set, then the sum of the remaining time series is returned with the given label. For example, `topk_min(3, sum(process_resident_memory_bytes) by (job), "job=other")` would return up to 3 time series with the biggest minimums plus a time series with `{job="other"}` label with the sum of the remaining series if any. See also `bottomk_min`.'},{label:"zscore",insertText:"zscore",detail:"zscore(q) by (group_labels)",documentation:"returns [z-score](https://en.wikipedia.org/wiki/Standard_score) values per each `group_labels` for all the time series returned by `q`. The aggregate is calculated individually per each group of points with the same timestamp. Useful for detecting anomalies in the group of related time series."},{insertText:"count_scalar",label:"count_scalar",detail:"count_scalar(v instant-vector)",documentation:"Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause."}],fr={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((by|without)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},function:new RegExp(`\\b(?:${pr.map((e=>e.label)).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],idList:{pattern:/\d+(\|\d+)+/,alias:"number"},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:new RegExp(`/[-+*/=%^~]|&&?|\\|?\\||!=?|<(?:=>?|<|>)?|>[>=]?|\\b(?:${["by","group_left","group_right","ignoring","on","offset","without"].join("|")})\\b`,"i"),punctuation:/[{};()`,.]/},mr=fr;var hr=m(6407),gr=m.n(hr);const yr="victoriametrics-datasource",vr=[{label:"Time series",value:"time_series"},{label:"Table",value:"table"},{label:"Heatmap",value:"heatmap"}],br=(0,$.map)([1,2,3,4,5,10],(e=>({value:e,label:"1/"+e})));function Or(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function wr(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){Or(a,n,i,o,s,"next",e)}function s(e){Or(a,n,i,o,s,"throw",e)}o(void 0)}))}}function _r({onChange:e,index:i,operationIndex:o,value:s,query:l,datasource:u}){const[c,d]=(0,r.useState)({});return n().createElement(a.Select,{inputId:jr(o,i),autoFocus:""===s||void 0,openMenuOnFocus:!0,onOpenMenu:wr((function*(){d({isLoading:!0});const e=yield function(e,t){return Sr.apply(this,arguments)}(l,u);d({options:e,isLoading:void 0})})),isLoading:c.isLoading,allowCustomValue:!0,noOptionsMessage:"No labels found",loadingMessage:"Loading labels",options:c.options,value:(0,t.toOption)(s),onChange:t=>e(i,t.value)})}function Sr(){return Sr=wr((function*(e,t){let r=e.labels;t.type===yr&&(r=[{label:"__name__",op:"=",value:e.metric},...e.labels]);const n=Tn.renderLabels(r),i=yield t.languageProvider.fetchSeriesLabels(n);return Object.keys(i).map((e=>({label:e,value:e})))})),Sr.apply(this,arguments)}var Er,xr;function Tr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Tr(e,t,r[t])}))}return e}function kr(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Ir(e,t,r){const n=Dr(e,t),i=e.id+"(";return r&&n.push(r),i+n.join(", ")+")"}function Cr(e,t,r){const n=Dr(e,t),i=e.id+"(";return r&&n.unshift(r),i+n.join(", ")+")"}function Ar(e,t,r,n){if(t.params.length<2)throw`Cannot render a function with params of length [${t.params.length}]`;var i,a;let o=null!==(a=(null!==(i=e.params)&&void 0!==i?i:[])[0])&&void 0!==a?a:"5m";const s=Dr(kr(Pr({},e),{params:e.params.slice(1)}),kr(Pr({},t),{params:t.params.slice(1),defaultParams:t.defaultParams.slice(1)})),l=e.id+"(";return r&&(n?s.push(`${r}[${o}]`):s.unshift(`${r}[${o}]`)),l+s.join(", ")+")"}function qr(e,t,r){return Ar(e,t,r,!1)}function Rr(e,t,r){return Ar(e,t,r,!0)}function Dr(e,t){var r;return(null!==(r=e.params)&&void 0!==r?r:[]).map(((e,r)=>{const n=t.params[r];return"string"===(null==n?void 0:n.type)?'"'+e+'"':e}))}function Nr(e,t){const r={id:e.id,params:e.defaultParams};return kr(Pr({},t),{operations:[...t.operations,r]})}function Lr(e){return(0,$.capitalize)(e.replace(/_/g," "))}function jr(e,t){return`operations.${e}.param.${t}`}function Mr(e=!1){const t={name:"Range",type:"string",options:[{label:"$__interval",value:"$__interval"},{label:"1m",value:"1m"},{label:"5m",value:"5m"},{label:"10m",value:"10m"},{label:"1h",value:"1h"},{label:"24h",value:"24h"}]};return e&&t.options.unshift({label:"$__rate_interval",value:"$__rate_interval"}),t}function Fr(e,t={}){return[Pr({id:e,name:Lr(e),params:[{name:"By label",type:"string",restParam:!0,optional:!0}],defaultParams:[],alternativesKey:"plain aggregations",category:Er.Aggregations,renderer:Ir,paramChangedHandler:(n=`__${e}_by`,function(e,t,r){return t.params.length===r.params.length?kr(Pr({},t),{id:n}):t}),explainHandler:$r(e,""),addOperationHandler:Nr},t),Pr({id:`__${e}_by`,name:`${Lr(e)} by`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:_r}],defaultParams:[""],alternativesKey:"aggregations by",category:Er.Aggregations,renderer:(r=e,function(e,t,n){return`${r} by(${e.params.join(", ")}) (${n})`}),paramChangedHandler:Xr(e),explainHandler:$r(e,"by"),addOperationHandler:Nr,hideFromList:!0},t),Pr({id:`__${e}_without`,name:`${Lr(e)} without`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:_r}],defaultParams:[""],alternativesKey:"aggregations by",category:Er.Aggregations,renderer:Qr(e),paramChangedHandler:Xr(e),explainHandler:$r(e,"without"),addOperationHandler:Nr,hideFromList:!0},t)];var r,n}function Br(e,t,r={}){const n=Fr(e,r);return n[0].params.unshift(...t.params),n[1].params.unshift(...t.params),n[2].params.unshift(...t.params),n[0].defaultParams=t.defaultParams,n[1].defaultParams=[...t.defaultParams,""],n[2].defaultParams=[...t.defaultParams,""],n[1].renderer=Vr(e),n[2].renderer=Vr(e),n}function Qr(e){return function(t,r,n){return`${e} without(${t.params.join(", ")}) (${n})`}}function $r(e,t){return function(r){const n=r.params.map((e=>`\`${e}\``)).join(" and "),i=gr()("label",r.params.length);switch(t){case"by":return`Calculates ${e} over dimensions while preserving ${i} ${n}.`;case"without":return`Calculates ${e} over the dimensions ${n}. All other labels are preserved.`;default:return`Calculates ${e} over the dimensions.`}}}function Vr(e){return function(t,r,n){const i=r.params.findIndex((e=>e.restParam)),a=t.params.slice(0,i),o=t.params.slice(i);return`${e} by(${o.join(", ")}) (${a.map(((e,t)=>"string"===r.params[t].type?`"${e}"`:e)).join(", ")}, ${n})`}}function Xr(e){return function(t,r,n){return r.params.length<n.params.length?kr(Pr({},r),{id:e}):r}}!function(e){e.Aggregations="Aggregations",e.RangeFunctions="Range functions",e.Functions="Functions",e.BinaryOps="Binary operations",e.Trigonometric="Trigonometric",e.Time="Time Functions"}(Er||(Er={})),function(e){e.Absent="absent",e.AbsentOverTime="absent_over_time",e.Acos="acos",e.Acosh="acosh",e.Asin="asin",e.Asinh="asinh",e.Atan="atan",e.Atanh="atanh",e.Avg="avg",e.AvgOverTime="avg_over_time",e.BottomK="bottomk",e.Ceil="ceil",e.Changes="changes",e.Clamp="clamp",e.ClampMax="clamp_max",e.ClampMin="clamp_min",e.Cos="cos",e.Cosh="cosh",e.Count="count",e.CountOverTime="count_over_time",e.CountValues="count_values",e.DayOfMonth="day_of_month",e.DayOfWeek="day_of_week",e.DaysInMonth="days_in_month",e.Deg="deg",e.Delta="delta",e.Deriv="deriv",e.Exp="exp",e.Floor="floor",e.Group="group",e.HistogramQuantile="histogram_quantile",e.HoltWinters="holt_winters",e.Hour="hour",e.Idelta="idelta",e.Increase="increase",e.Irate="irate",e.LabelJoin="label_join",e.LabelReplace="label_replace",e.LastOverTime="last_over_time",e.Ln="ln",e.Log10="log10",e.Log2="log2",e.Max="max",e.MaxOverTime="max_over_time",e.Min="min",e.MinOverTime="min_over_time",e.Minute="minute",e.Month="month",e.Pi="pi",e.PredictLinear="predict_linear",e.PresentOverTime="present_over_time",e.Quantile="quantile",e.QuantileOverTime="quantile_over_time",e.Rad="rad",e.Rate="rate",e.Resets="resets",e.Round="round",e.Scalar="scalar",e.Sgn="sgn",e.Sin="sin",e.Sinh="sinh",e.Sort="sort",e.SortDesc="sort_desc",e.Sqrt="sqrt",e.Stddev="stddev",e.StddevOverTime="stddev_over_time",e.Sum="sum",e.SumOverTime="sum_over_time",e.Tan="tan",e.Tanh="tanh",e.Time="time",e.Timestamp="timestamp",e.TopK="topk",e.Vector="vector",e.Year="year",e.Addition="__addition",e.Subtraction="__subtraction",e.MultiplyBy="__multiply_by",e.DivideBy="__divide_by",e.Modulo="__modulo",e.Exponent="__exponent",e.NestedQuery="__nested_query",e.EqualTo="__equal_to",e.NotEqualTo="__not_equal_to",e.GreaterThan="__greater_than",e.LessThan="__less_than",e.GreaterOrEqual="__greater_or_equal",e.LessOrEqual="__less_or_equal",e.AscentOverTime="ascent_over_time",e.ChangesPrometheus="changes_prometheus",e.DecreasesOverTime="decreases_over_time",e.DefaultRollup="default_rollup",e.DeltaPrometheus="delta_prometheus",e.DerivFast="deriv_fast",e.DescentOverTime="descent_over_time",e.DistinctOverTime="distinct_over_time",e.FirstOverTime="first_over_time",e.GeomeanOverTime="geomean_over_time",e.HistogramOverTime="histogram_over_time",e.Ideriv="ideriv",e.IncreasePrometheus="increase_prometheus",e.IncreasePure="increase_pure",e.IncreasesOverTime="increases_over_time",e.Integrate="integrate",e.Lag="lag",e.Lifetime="lifetime",e.MadOverTime="mad_over_time",e.MedianOverTime="median_over_time",e.ModeOverTime="mode_over_time",e.RangeOverTime="range_over_time",e.RateOverSum="rate_over_sum",e.Rollup="rollup",e.RollupCandlestick="rollup_candlestick",e.RollupDelta="rollup_delta",e.RollupDeriv="rollup_deriv",e.RollupIncrease="rollup_increase",e.RollupRate="rollup_rate",e.RollupScrapeInterval="rollup_scrape_interval",e.ScrapeInterval="scrape_interval",e.StaleSamplesOverTime="stale_samples_over_time",e.StdvarOverTime="stdvar_over_time",e.Sum2OverTime="sum2_over_time",e.TimestampWithName="timestamp_with_name",e.TfirstOverTime="tfirst_over_time",e.TlastChangeOverTime="tlast_change_over_time",e.TlastOverTime="tlast_over_time",e.TmaxOverTime="tmax_over_time",e.TminOverTime="tmin_over_time",e.ZscoreOverTime="zscore_over_time",e.HistogramAvg="histogram_avg",e.HistogramStddev="histogram_stddev",e.HistogramStdvar="histogram_stdvar",e.PrometheusBuckets="prometheus_buckets",e.Abs="abs",e.Interpolate="interpolate",e.KeepLastValue="keep_last_value",e.KeepNextValue="keep_next_value",e.RangeAvg="range_avg",e.RangeFirst="range_first",e.RangeLast="range_last",e.RangeLinearRegression="range_linear_regression",e.RangeMad="range_mad",e.RangeMax="range_max",e.RangeMedian="range_median",e.RangeMin="range_min",e.RangeStddev="range_stddev",e.RangeStdvar="range_stdvar",e.RangeSum="range_sum",e.RangeZscore="range_zscore",e.RemoveResets="remove_resets",e.RunningAvg="running_avg",e.RunningMax="running_max",e.RunningMin="running_min",e.RunningSum="running_sum",e.Distinct="distinct",e.Geomean="geomean",e.Histogram="histogram",e.BottomkAvg="bottomk_avg",e.BottomkLast="bottomk_last",e.BottomkMax="bottomk_max",e.BottomkMedian="bottomk_median",e.BottomkMin="bottomk_min",e.TopkAvg="topk_avg",e.TopkLast="topk_last",e.TopkMax="topk_max",e.TopkMedian="topk_median",e.TopkMin="topk_min",e.Any="any",e.Limitk="limitk",e.Mad="mad",e.Median="median",e.Mode="mode",e.Share="share",e.Stdvar="stdvar",e.Sum2="sum2",e.Zscore="zscore",e.LabelDel="label_del",e.LabelKeep="label_keep",e.LabelLowercase="label_lowercase",e.LabelUppercase="label_uppercase",e.SortByLabel="sort_by_label",e.SortByLabelDesc="sort_by_label_desc",e.SortByLabelNumeric="sort_by_label_numeric",e.SortByLabelNumericDesc="sort_by_label_numeric_desc",e.End="end",e.Now="now",e.Start="start",e.Step="step",e.CountEqOverTime="count_eq_over_time",e.CountGtOverTime="count_gt_over_time",e.CountLeOverTime="count_le_over_time",e.CountNeOverTime="count_ne_over_time",e.DurationOverTime="duration_over_time",e.ShareGtOverTime="share_gt_over_time",e.ShareLeOverTime="share_le_over_time",e.ShareEqOverTime="share_eq_over_time",e.BitmapAnd="bitmap_and",e.BitmapOr="bitmap_or",e.BitmapXor="bitmap_xor",e.Rand="rand",e.RandExponential="rand_exponential",e.RandNormal="rand_normal",e.TimezoneOffset="timezone_offset",e.LabelSet="label_set",e.LabelCopy="label_copy",e.LabelMove="label_move",e.LabelMap="label_map"}(xr||(xr={}));const Gr=[{id:xr.Addition,name:"Add scalar",sign:"+"},{id:xr.Subtraction,name:"Subtract scalar",sign:"-"},{id:xr.MultiplyBy,name:"Multiply by scalar",sign:"*"},{id:xr.DivideBy,name:"Divide by scalar",sign:"/"},{id:xr.Modulo,name:"Modulo by scalar",sign:"%"},{id:xr.Exponent,name:"Exponent",sign:"^"},{id:xr.EqualTo,name:"Equal to",sign:"==",comparison:!0},{id:xr.NotEqualTo,name:"Not equal to",sign:"!=",comparison:!0},{id:xr.GreaterThan,name:"Greater than",sign:">",comparison:!0},{id:xr.LessThan,name:"Less than",sign:"<",comparison:!0},{id:xr.GreaterOrEqual,name:"Greater or equal to",sign:">=",comparison:!0},{id:xr.LessOrEqual,name:"Less or equal to",sign:"<=",comparison:!0}],Ur=Gr.reduce(((e,t)=>(e[t.sign]={id:t.id,comparison:t.comparison},e)),{}),zr=Gr.map((e=>{const t=[{name:"Value",type:"number"}],r=[2];return e.comparison&&(t.push({name:"Bool",type:"boolean",description:"If checked comparison will return 0 or 1 for the value rather than filtering."}),r.push(!1)),{id:e.id,name:e.name,params:t,defaultParams:r,alternativesKey:"binary scalar operations",category:Er.BinaryOps,renderer:Wr(e.sign),addOperationHandler:Nr}}));function Wr(e){return function(t,r,n){let i=t.params[0],a="";return 2===t.params.length&&(a=t.params[1]?" bool":""),`${n} ${e}${a} ${i}`}}function Kr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Kr(e,t,r[t])}))}return e}function Yr(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Zr(e){var t,r,n,i,a,o;return Yr(Hr({},e),{id:e.id,name:null!==(t=e.name)&&void 0!==t?t:Lr(e.id),params:null!==(r=e.params)&&void 0!==r?r:[],defaultParams:null!==(n=e.defaultParams)&&void 0!==n?n:[],category:null!==(i=e.category)&&void 0!==i?i:Er.Functions,renderer:null!==(a=e.renderer)&&void 0!==a?a:e.params?Cr:Ir,addOperationHandler:null!==(o=e.addOperationHandler)&&void 0!==o?o:Nr})}function Jr(e,t=!1){return{id:e,name:Lr(e),params:[Mr(t)],defaultParams:[t?"$__rate_interval":"$__interval"],alternativesKey:"range function",category:Er.RangeFunctions,renderer:tn,addOperationHandler:rn,changeTypeHandler:en}}function en(e,t){return("$__rate_interval"===e.params[0]&&"$__rate_interval"!==t.defaultParams[0]||"$__interval"===e.params[0]&&"$__interval"!==t.defaultParams[0])&&(e.params=t.defaultParams),e}function tn(e,t,r){var n,i;let a=null!==(i=(null!==(n=e.params)&&void 0!==n?n:[])[0])&&void 0!==i?i:"5m";return`${t.id}(${r}[${a}])`}function rn(e,t,r){const n={id:e.id,params:e.defaultParams};return t.operations.length>0&&r.getOperationDef(t.operations[0].id).addOperationHandler===rn?Yr(Hr({},t),{operations:[n,...t.operations.slice(1)]}):Yr(Hr({},t),{operations:[n,...t.operations]})}function nn(e,t){var r;return Yr(Hr({},t),{binaryQueries:[...null!==(r=t.binaryQueries)&&void 0!==r?r:[],{operator:"/",query:t}]})}function an(e,t,r){if("string"!=typeof e.params[1])throw"The separator must be a string";const n=`"${e.params[1]}"`;return`${e.id}(${r}, "${e.params[0]}", ${n}, "${e.params.slice(2).join(n)}")`}function on(e,t){const r={id:e.id,params:e.defaultParams};return Yr(Hr({},t),{operations:[...t.operations,r]})}function sn(e){return{id:e,name:Lr(e),params:[Mr()],defaultParams:["$__interval"],alternativesKey:"overtime function",category:Er.RangeFunctions,renderer:ln,addOperationHandler:rn}}function ln(e,t,r){var n,i;let a=null!==(i=(null!==(n=e.params)&&void 0!==n?n:[])[0])&&void 0!==i?i:"$__interval";return`${t.id}(${r}[${a}])`}const un=[xr.Any,xr.Limitk,xr.Mad,xr.Median,xr.Mode,xr.Share,xr.Stdvar,xr.Sum2,xr.Zscore],cn=[xr.AscentOverTime,xr.ChangesPrometheus,xr.DecreasesOverTime,xr.DefaultRollup,xr.DeltaPrometheus,xr.DerivFast,xr.DescentOverTime,xr.DistinctOverTime,xr.FirstOverTime,xr.GeomeanOverTime,xr.HistogramOverTime,xr.Ideriv,xr.IncreasePrometheus,xr.IncreasePure,xr.IncreasesOverTime,xr.Integrate,xr.Lag,xr.Lifetime,xr.MadOverTime,xr.MedianOverTime,xr.ModeOverTime,xr.RangeOverTime,xr.RateOverSum,xr.Rollup,xr.RollupCandlestick,xr.RollupDelta,xr.RollupDeriv,xr.RollupIncrease,xr.RollupRate,xr.RollupScrapeInterval,xr.ScrapeInterval,xr.StaleSamplesOverTime,xr.StdvarOverTime,xr.Sum2OverTime,xr.TimestampWithName,xr.TfirstOverTime,xr.TlastChangeOverTime,xr.TlastOverTime,xr.TmaxOverTime,xr.TminOverTime,xr.ZscoreOverTime,xr.HistogramAvg,xr.HistogramStddev,xr.HistogramStdvar,xr.PrometheusBuckets],dn=[xr.Abs,xr.Interpolate,xr.KeepLastValue,xr.KeepNextValue,xr.RangeAvg,xr.RangeFirst,xr.RangeLast,xr.RangeLinearRegression,xr.RangeMad,xr.RangeMax,xr.RangeMedian,xr.RangeMin,xr.RangeStddev,xr.RangeStdvar,xr.RangeSum,xr.RangeZscore,xr.RemoveResets,xr.RunningAvg,xr.RunningMax,xr.RunningMin,xr.RunningSum,xr.Distinct,xr.Geomean,xr.Histogram],pn=[xr.BitmapAnd,xr.BitmapOr,xr.BitmapXor];function fn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const mn=[xr.LabelDel,xr.LabelKeep,xr.LabelLowercase,xr.LabelUppercase,xr.SortByLabel,xr.SortByLabelDesc,xr.SortByLabelNumeric,xr.SortByLabelNumericDesc];function hn(){return mn.map((e=>Zr({id:e,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:_r}],defaultParams:[""],renderer:(e,t,r)=>`${e.id}(${r}, ${e.params.map((e=>`"${e}"`)).join(", ")})`,addOperationHandler:(e,t)=>{return r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){fn(e,t,r[t])}))}return e}({},t),n=null!=(n={operations:[...t.operations,{id:e.id,params:e.defaultParams}]})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))})),r;var r,n}})))}const gn=[xr.LabelCopy,xr.LabelMove],yn=[xr.Rand,xr.RandExponential,xr.RandNormal],vn=[[xr.CountEqOverTime,"eq"],[xr.CountGtOverTime,"gt"],[xr.CountLeOverTime,"le"],[xr.CountNeOverTime,"ne"],[xr.DurationOverTime,"max_interval"],[xr.ShareGtOverTime,"gt"],[xr.ShareLeOverTime,"le"],[xr.ShareEqOverTime,"eq"]],bn=[xr.End,xr.Now,xr.Start,xr.Step];var On;const wn=(null===(On=Intl)||void 0===On?void 0:On.supportedValuesOf)?Intl.supportedValuesOf("timeZone"):[],_n=[xr.BottomkAvg,xr.BottomkLast,xr.BottomkMax,xr.BottomkMedian,xr.BottomkMin,xr.TopkAvg,xr.TopkLast,xr.TopkMax,xr.TopkMedian,xr.TopkMin];function Sn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class En{setOperationCategories(e){this.categories=e}getOperationsForCategory(e){return this.operationsRegistry.list().filter((t=>t.category===e&&!t.hideFromList))}getAlternativeOperations(e){return this.operationsRegistry.list().filter((t=>t.alternativesKey&&t.alternativesKey===e))}getCategories(){return this.categories}getOperationDef(e){return this.operationsRegistry.getIfExists(e)}renderOperations(e,t){for(const r of t){const t=this.operationsRegistry.getIfExists(r.id);if(!t)throw new Error(`Could not find operation ${r.id} in the registry`);e=t.renderer(r,t,e)}return e}renderBinaryQueries(e,t){if(t)for(const r of t)e=`${this.renderBinaryQuery(e,r)}`;return e}renderBinaryQuery(e,t){let r=e+` ${t.operator} `;return t.vectorMatches&&(r+=`${t.vectorMatchesType}(${t.vectorMatches}) `),r+this.renderQuery(t.query,!0)}renderLabels(e){if(0===e.length)return"";let t="{";for(const r of e)"{"!==t&&(t+=", "),t+=`${r.label}${r.op}"${r.value}"`;return t+"}"}renderQuery(e,t){var r,n,i;let a=`${null!==(i=e.metric)&&void 0!==i?i:""}${this.renderLabels(e.labels)}`;return a=this.renderOperations(a,e.operations),!t&&this.hasBinaryOp(e)&&Boolean(null===(r=e.binaryQueries)||void 0===r?void 0:r.length)&&(a=`(${a})`),a=this.renderBinaryQueries(a,e.binaryQueries),t&&(this.hasBinaryOp(e)||Boolean(null===(n=e.binaryQueries)||void 0===n?void 0:n.length))&&(a=`(${a})`),a}hasBinaryOp(e){return void 0!==e.operations.find((e=>{const t=this.getOperationDef(e.id);return(null==t?void 0:t.category)===Er.BinaryOps}))}constructor(e){Sn(this,"operationsRegistry",void 0),Sn(this,"categories",[]),this.operationsRegistry=new t.Registry(e)}}class xn extends En{getQueryPatterns(){return[{name:"Rate then sum",operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]},{name:"Rate then sum by(label) then avg",operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:[""]},{id:"avg",params:[]}]},{name:"Histogram quantile on rate",operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Histogram quantile on increase ",operations:[{id:"increase",params:["$__rate_interval"]},{id:"__max_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]}]}constructor(){super((()=>{const e=[{id:xr.HistogramQuantile,name:"Histogram quantile",params:[{name:"Quantile",type:"number",options:[.99,.95,.9,.75,.5,.25]}],defaultParams:[.9],category:Er.Functions,renderer:Ir,addOperationHandler:Nr},{id:xr.LabelReplace,name:"Label replace",params:[{name:"Destination label",type:"string"},{name:"Replacement",type:"string"},{name:"Source label",type:"string"},{name:"Regex",type:"string"}],category:Er.Functions,defaultParams:["","$1","","(.*)"],renderer:Cr,addOperationHandler:Nr},{id:xr.Ln,name:"Ln",params:[],defaultParams:[],category:Er.Functions,renderer:Ir,addOperationHandler:Nr},Jr(xr.Changes),Jr(xr.Rate,!0),Jr(xr.Irate),Jr(xr.Increase,!0),Jr(xr.Idelta),Jr(xr.Delta),Zr({id:xr.HoltWinters,params:[Mr(),{name:"Smoothing Factor",type:"number"},{name:"Trend Factor",type:"number"}],defaultParams:["$__interval",.5,.5],alternativesKey:"range function",category:Er.RangeFunctions,renderer:qr,addOperationHandler:rn,changeTypeHandler:en}),Zr({id:xr.PredictLinear,params:[Mr(),{name:"Seconds from now",type:"number"}],defaultParams:["$__interval",60],alternativesKey:"range function",category:Er.RangeFunctions,renderer:qr,addOperationHandler:rn,changeTypeHandler:en}),Zr({id:xr.QuantileOverTime,params:[Mr(),{name:"Quantile",type:"number"}],defaultParams:["$__interval",.5],alternativesKey:"overtime function",category:Er.RangeFunctions,renderer:Rr,addOperationHandler:rn,changeTypeHandler:en}),...zr,{id:xr.NestedQuery,name:"Binary operation with query",params:[],defaultParams:[],category:Er.BinaryOps,renderer:(e,t,r)=>r,addOperationHandler:nn},Zr({id:xr.Absent}),Zr({id:xr.Acos,category:Er.Trigonometric}),Zr({id:xr.Acosh,category:Er.Trigonometric}),Zr({id:xr.Asin,category:Er.Trigonometric}),Zr({id:xr.Asinh,category:Er.Trigonometric}),Zr({id:xr.Atan,category:Er.Trigonometric}),Zr({id:xr.Atanh,category:Er.Trigonometric}),Zr({id:xr.Ceil}),Zr({id:xr.Clamp,name:"Clamp",params:[{name:"Minimum Scalar",type:"number"},{name:"Maximum Scalar",type:"number"}],defaultParams:[1,1]}),Zr({id:xr.ClampMax,params:[{name:"Maximum Scalar",type:"number"}],defaultParams:[1]}),Zr({id:xr.ClampMin,params:[{name:"Minimum Scalar",type:"number"}],defaultParams:[1]}),Zr({id:xr.Cos,category:Er.Trigonometric}),Zr({id:xr.Cosh,category:Er.Trigonometric}),Zr({id:xr.DayOfMonth,category:Er.Time}),Zr({id:xr.DayOfWeek,category:Er.Time}),Zr({id:xr.DaysInMonth,category:Er.Time}),Zr({id:xr.Deg}),Jr(xr.Deriv),Zr({id:xr.Exp}),Zr({id:xr.Floor}),Zr({id:xr.Group}),Zr({id:xr.Hour}),Zr({id:xr.LabelJoin,params:[{name:"Destination Label",type:"string",editor:_r},{name:"Separator",type:"string"},{name:"Source Label",type:"string",restParam:!0,optional:!0,editor:_r}],defaultParams:["",",",""],renderer:an,addOperationHandler:on}),Zr({id:xr.Log10}),Zr({id:xr.Log2}),Zr({id:xr.Minute}),Zr({id:xr.Month}),Zr({id:xr.Pi,renderer:e=>`${e.id}()`}),Zr({id:xr.Quantile,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:Ir}),Zr({id:xr.Rad}),Jr(xr.Resets),Zr({id:xr.Round,category:Er.Functions,params:[{name:"To Nearest",type:"number"}],defaultParams:[1]}),Zr({id:xr.Scalar}),Zr({id:xr.Sgn}),Zr({id:xr.Sin,category:Er.Trigonometric}),Zr({id:xr.Sinh,category:Er.Trigonometric}),Zr({id:xr.Sort}),Zr({id:xr.SortDesc}),Zr({id:xr.Sqrt}),Zr({id:xr.Stddev}),Zr({id:xr.Tan,category:Er.Trigonometric}),Zr({id:xr.Tanh,category:Er.Trigonometric}),Zr({id:xr.Time,renderer:e=>`${e.id}()`}),Zr({id:xr.Timestamp}),Zr({id:xr.Vector,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:e=>`${e.id}(${e.params[0]})`}),Zr({id:xr.Year}),...Fr(xr.Sum),...Fr(xr.Avg),...Fr(xr.Min),...Fr(xr.Max),...Fr(xr.Count),...Br(xr.TopK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...Br(xr.BottomK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...Br(xr.CountValues,{params:[{name:"Identifier",type:"string"}],defaultParams:["count"]}),sn(xr.SumOverTime),sn(xr.AvgOverTime),sn(xr.MinOverTime),sn(xr.MaxOverTime),sn(xr.CountOverTime),sn(xr.LastOverTime),sn(xr.PresentOverTime),sn(xr.AbsentOverTime),sn(xr.StddevOverTime),...cn.map((e=>sn(e))),...un.map((e=>Fr(e))).flat(),...dn.map((e=>Zr({id:e}))),...pn.map((e=>Zr({id:e,params:[{name:"mask",type:"number"}],defaultParams:[1]}))),...gn.map((e=>Zr({id:e,params:[{name:"src_label",type:"string",restParam:!0,editor:_r},{name:"dst_label",type:"string",restParam:!0,editor:_r}],defaultParams:["",""],renderer:(e,t,r)=>`${e.id}(${r}, ${e.params.map((e=>`"${e}"`)).join(", ")})`}))),...hn(),Zr({id:xr.LabelMap,params:[{name:"Label",type:"string",editor:_r},{name:"src_value",type:"string",restParam:!0},{name:"dst_value",type:"string",restParam:!0}],defaultParams:["","",""],renderer:(e,t,r)=>`${e.id}(${r}, ${e.params.map((e=>`"${e}"`)).join(", ")})`}),Zr({id:xr.LabelSet,params:[{name:"Label",type:"string",restParam:!0,editor:_r},{name:"Value",type:"string",restParam:!0}],defaultParams:["",""],renderer:(e,t,r)=>`${e.id}(${r}, ${e.params.map((e=>`"${e}"`)).join(", ")})`}),...yn.map((e=>Zr({id:e,params:[{name:"seed",type:"number",optional:!0}],defaultParams:[1],renderer:e=>{var t;return`${e.id}(${null!==(t=e.params[0])&&void 0!==t?t:""})`}}))),...vn.map((e=>Zr({id:e[0],params:[Mr(),{name:e[1],type:"number"}],defaultParams:["$__interval",60],alternativesKey:"range function",category:Er.RangeFunctions,renderer:qr,addOperationHandler:rn,changeTypeHandler:en}))),...bn.map((e=>Zr({id:e,renderer:e=>`${e.id}()`}))),Zr({id:xr.TimezoneOffset,params:[{name:"tz",type:"string",options:wn}],defaultParams:[""]}),..._n.map((e=>Zr({id:e,params:[{name:"K-value",type:"number"},{name:"other_label=other_value",type:"string",optional:!0}],defaultParams:[5,""],renderer:(e,t,r)=>`${e.id}(${e.params[0]}, ${r}, "${e.params[1]}")`})))];for(const t of e){const e=pr.find((e=>e.insertText===t.id));e&&(t.documentation=e.documentation)}return e})),this.setOperationCategories(Object.values(Er))}}const Tn=new xn,Pn="⚠";function kn(e){return e.firstChild?kn(e.firstChild):e}function In(e,t){var r;return{text:qn(e,t),from:t.from,to:t.to,parentType:null===(r=t.parent)||void 0===r?void 0:r.name}}const Cn=/\$(\w+)|\[\[([\s\S]+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g,An=[e=>`$${e}`,(e,t)=>`[[${e}${t?`:${t}`:""}]]`,(e,t)=>`\${${e}${t?`:${t}`:""}}`];function qn(e,t){return t?function(e){return e.replace(/__V_(\d)__(.+?)__V__(?:__F__(\w+)__F__)?/g,((e,t,r,n)=>An[parseInt(t,10)](r,n)))}(e.substring(t.from,t.to)):""}function Rn(e,t,r,n){const i=[parseFloat(qn(t,r))];return e.comparison&&i.push(n),{id:e.id,params:i}}function Dn(e,t,r){if(t.type.id===r||t.name===r)return[qn(e,t)];const n=[];let i=0,a=t.childAfter(i);for(;a;)n.push(...Dn(e,a,r)),i=a.to,a=t.childAfter(i);return n}function Nn(e){const t=function(e){return e.replace(Cn,((e,t,r,n,i,a,o)=>{const s=n||o;let l=t,u="0";return r&&(l=r,u="1"),i&&(l=i,u="2"),`__V_${u}__`+l+"__V__"+(s?"__F__"+s+"__F__":"")}))}(e),r=Mt.parse(t).topNode,n={query:{metric:"",labels:[],operations:[]},errors:[]};try{jn(t,r,n)}catch(e){console.error(e),e instanceof Error&&n.errors.push({text:e.message})}var i;return 0!==(i=n.query).labels.length||0!==i.operations.length||i.metric||(n.errors=[]),n}const Ln=0;function jn(e,t,r){const n=r.query;switch(t.type.id){case or:n.metric=qn(e,t);break;case ur:{n.labels.push(function(e,t){return{label:qn(e,t.getChild(Wt)),op:qn(e,t.getChild(cr)),value:qn(e,t.getChild(ir)).replace(/"/g,"")}}(e,t));const i=t.getChild(Pn);i&&r.errors.push(In(e,i));break}case er:!function(e,t,r){const n=r.query,i=qn(e,t.getChild(tr)),a=t.getChild(Kt).getChild(Ht),o=[];let s="";if(Mn.includes(i)||i.endsWith("_over_time")){let r=qn(e,t).match(RegExp("(?<!\\{[^}]*)\\[(.+?)](?![^{]*})"));(null==r?void 0:r[1])&&(s=r[1],o.push(r[1]))}const l={id:i,params:o};if(n.operations.unshift(l),a){if(qn(e,a)===s+"]")return;Fn(e,a,r,l)}}(e,t,r);break;case $t:!function(e,t,r){const n=r.query;let i=qn(e,t.getChild(Vt));const a=t.getChild(Xt),o=[];a&&(a.getChild("By")&&i&&(i=`__${i}_by`),a.getChild(Bt)&&(i=`__${i}_without`),o.push(...Dn(e,a,zt)));const s=t.getChild(Kt).getChild(Ht),l={id:i,params:[]};n.operations.unshift(l),Fn(e,s,r,l),l.params.push(...o)}(e,t,r);break;case Yt:!function(e,t,r){const n=r.query,i=t.firstChild,a=qn(e,i.nextSibling),o=function(e,t){if(t){if(t.getChild("Bool"))return{isBool:!0,isMatcher:!1};{var r;const n=t.getChild(Jt);if(!n)return;return{isMatcher:!0,isBool:!1,matches:qn(e,null===(r=n.getChild(Gt))||void 0===r?void 0:r.getChild(Ut)),matchType:n.getChild(Ft)?"on":"ignoring"}}}}(e,t.getChild(Zt)),s=t.lastChild,l=Ur[a],u=i.getChild(rr),c=s.getChild(rr),d=s.getChild(Yt);if(u||jn(e,i,r),c)n.operations.push(Rn(l,e,s,!!(null==o?void 0:o.isBool)));else if(d){const t=kn(s);(null==t?void 0:t.type.id)===rr&&n.operations.push(Rn(l,e,t,!!(null==o?void 0:o.isBool))),jn(e,s,r)}else{n.binaryQueries=n.binaryQueries||[];const t={operator:a,query:{metric:"",labels:[],operations:[]}};(null==o?void 0:o.isMatcher)&&(t.vectorMatchesType=o.matchType,t.vectorMatches=o.matches),n.binaryQueries.push(t),jn(e,s,{query:t.query,errors:r.errors})}}(e,t,r);break;case Ln:if(function(e){var t,r,n;return(null===(t=e.prevSibling)||void 0===t?void 0:t.type.id)===Qt&&(null===(n=e.prevSibling)||void 0===n||null===(r=n.firstChild)||void 0===r?void 0:r.type.id)===ar}(t))break;r.errors.push(In(e,t));break;default:{t.type.id===nr&&r.errors.push(In(e,t));let n=t.firstChild;for(;n;)jn(e,n,r),n=n.nextSibling}}}const Mn=["changes","rate","irate","increase","delta"];function Fn(e,t,r,n){if(t)switch(t.type.id){case Qt:case Ht:{let i=t.firstChild;for(;i;)Fn(e,i,r,n),i=i.nextSibling;break}case rr:n.params.push(parseFloat(qn(e,t)));break;case ir:n.params.push(qn(e,t).replace(/"/g,""));break;default:jn(e,t,r)}}function Bn(e,t,r,n="="){if(!t||!r)throw new Error("Need label to add to query.");const i=function(e){const t=Mt.parse(e),r=[];return t.iterate({enter:({to:t,from:n,type:i})=>{if(i.id===ar){const i=Nn(e.substring(n,t));return r.push({query:i.query,from:n,to:t}),!1}}}),r}(e);if(!i.length)return e;const a=function(e,t,r){return{label:e,op:r,value:t===1/0?"+Inf":t.toString()}}(t,r,n);return function(e,t,r){const n=new xn;let i="",a=0;for(let o=0;o<t.length;o++){const s=t[o],l=o===t.length-1,u=e.substring(a,s.from),c=l?e.substring(s.to):"";Qn(s.query.labels,r)||s.query.labels.push(r),i+=u+n.renderQuery(s.query)+c,a=s.to}return i}(e,i,a)}function Qn(e,t){return e.find((e=>e.label===t.label&&e.value===t.value))}function $n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Vn=/\{[^}]*?(\}|$)/,Xn=/\b(\w+)(!?=~?)("[^"\n]*?")/g;function Gn(e,t=1){if(!e.match(Vn)){if(e.match(/^[A-Za-z:][\w:]*$/))return{selector:`{__name__="${e}"}`,labelKeys:["__name__"]};throw new Error("Query must contain a selector: "+e)}const r=e.slice(0,t),n=r.lastIndexOf("{"),i=r.lastIndexOf("}");if(-1===n)throw new Error("Not inside selector, missing open brace: "+r);if(i>-1&&i>n)throw new Error("Not inside selector, previous selector already closed: "+r);const a=e.slice(t),o=a.indexOf("}")+t,s=a.indexOf("{"),l=s+t;if(-1===o)throw new Error("Not inside selector, missing closing brace in suffix: "+a);if(s>-1&&l<o)throw new Error("Not inside selector, next selector opens before this one closed: "+a);const u=e.slice(n,o),c={};u.replace(Xn,((r,n,i,a)=>{const o=e.indexOf(r),s=o+n.length+i.length+1,l=o+n.length+i.length+a.length-1;return(t<s||t>l)&&(c[n]={value:a,operator:i}),""}));const d=e.slice(0,n).match(/[A-Za-z:][\w:]*$/);d&&(c.__name__={value:`"${d[0]}"`,operator:"="});const p=Object.keys(c).sort(),f=p.map((e=>`${e}${c[e].operator}${c[e].value}`)).join(",");return{labelKeys:p,selector:["{",f,"}"].join("")}}function Un(e){return zn(e/1e3)}function zn(e){return Math.floor(e/60)}function Wn(e){return e.slice(0,fi)}function Kn(e){return e&&e.length>=fi?`, limited to the first ${fi} received items`:""}const Hn=/[*+?()|\\.\[\]{}^$]/g;function Yn(e){return e.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function Zn(e){return Yn(e.replace(Hn,"\\$&"))}function Jn(e){return e.replace(/[-+*\/%^=]/g,(e=>"\\"+e))}function ei(e){return e.replace(/\\([-+*\/%^=])/g,((e,t)=>t))}var ti;!function(e){e.Equal="Equal",e.NotEqual="NotEqual",e.EqualRegEx="EqualRegEx",e.NotEqualRegEx="NotEqualRegEx"}(ti||(ti={}));const ri={"=":"Equal","!=":"NotEqual","=~":"EqualRegEx","!~":"NotEqualRegEx"},ni=(0,$.invert)(ri);function ii(e){const t=e.labelMatchers.map((e=>{const t=ni[e.operator];return t?`${e.name}${t}"${e.value}"`:""})).filter((e=>""!==e)).join(", ");return t?`{${t}}`:""}function ai(e,r){return"string"==typeof e&&(e=t.dateMath.parse(e,r)),Math.ceil(e.valueOf()/1e3)}function oi(e,t){return void 0===t&&(t=1e3),e.length=Math.min(e.length,t),e}function si(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function li(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){si(a,n,i,o,s,"next",e)}function s(e){si(a,n,i,o,s,"throw",e)}o(void 0)}))}}function ui(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ci(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ui(e,t,r[t])}))}return e}function di(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const pi=["job","instance"],fi=1e4,mi=e=>({label:e}),hi=e=>(e.kind="function",e);function gi(e,t){if(!t[e])return;const{type:r,help:n}=t[e];return`${r.toUpperCase()}: ${n}`}class yi extends t.LanguageProvider{get syntax(){return mr}loadMetricsMetadata(){var e=this;return li((function*(){e.metricsMetadata=function(e){if(!e)return e;const t={},r={};for(const n in e){const i=e[n][0];t[n]=i,"histogram"===i.type&&(r[`${n}_bucket`]={type:"counter",help:`Cumulative counters for the observation buckets (${i.help})`},r[`${n}_count`]={type:"counter",help:`Count of events that have been observed for the histogram metric (${i.help})`},r[`${n}_sum`]={type:"counter",help:`Total sum of all observed values for the histogram metric (${i.help})`}),"summary"===i.type&&(r[`${n}_count`]={type:"counter",help:`Count of events that have been observed for the base metric (${i.help})`},r[`${n}_sum`]={type:"counter",help:`Total sum of all observed values for the base metric (${i.help})`})}return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){$n(e,t,r[t])}))}return e}({},t,r,{ALERTS:{type:"counter",help:"Time series showing pending and firing alerts. The sample value is set to 1 as long as the alert is in the indicated active (pending or firing) state."}})}(yield e.request("/api/v1/metadata",{},{},{showErrorAlert:!1}))}))()}getLabelKeys(){return this.labelKeys}getRangeCompletionItems(){return{context:"context-range",suggestions:[{label:"Range vector",items:[...dr]}]}}importFromAbstractQuery(e){return function(e){return{refId:e.refId,expr:ii(e),range:!0}}(e)}exportToAbstractQuery(e){const t=e.expr;if(!t||0===t.length)return{refId:e.refId,labelMatchers:[]};const r=ce().tokenize(t,mr),n=function(e){const t=[];for(let r in e)if(e[r]instanceof ue.Token){let n=e[r];if("context-labels"===n.type){let e="",r="",i="",a=n.content;for(let n in a)if("string"==typeof a[n]){let e;e=a[n],"="!==e&&"!="!==e&&"=~"!==e&&"!~"!==e||(i=e)}else if(a[n]instanceof ue.Token)switch(a[n].type){case"label-key":e=a[n].content;break;case"label-value":r=a[n].content,r=r.substring(1,r.length-1);const o=ri[i];o&&t.push({name:e,operator:o,value:r})}}}return t}(r),i=function(e,t){let r="";for(let e in t)if("string"==typeof t[e]){r=t[e];break}return r}(0,r);return i&&i.length>0&&n.push({name:"__name__",operator:ti.Equal,value:i}),{refId:e.refId,labelMatchers:n}}getSeries(e,t){var r=this;return li((function*(){if(r.datasource.lookupsDisabled)return{};try{return"{}"===e?yield r.fetchDefaultSeries():yield r.fetchSeriesLabels(e,t)}catch(e){return console.error(e),{}}}))()}getLabelValues(e){var t=this;return li((function*(){return yield t.fetchLabelValues(e)}))()}fetchLabels(){var e=this;return li((function*(){const t=e.datasource.getTimeRangeParams(),r=e.datasource.getLimitMetrics("maxTagKeys");e.labelFetchTs=Date.now().valueOf();const n=yield e.request("/api/v1/labels",[],di(ci({},t),{limit:r}));return Array.isArray(n)&&(e.labelKeys=n.slice().sort()),[]}))()}constructor(e,r){super(),ui(this,"histogramMetrics",void 0),ui(this,"timeRange",void 0),ui(this,"metrics",void 0),ui(this,"metricsMetadata",void 0),ui(this,"datasource",void 0),ui(this,"labelKeys",[]),ui(this,"withTemplates",void 0),ui(this,"labelsCache",new le({max:10}));var n,i=this;ui(this,"request",(n=li((function*(e,t,r={},n){try{return(yield i.datasource.metadataRequest(e,r,n)).data.data}catch(e){console.error(e)}return t})),function(e,t){return n.apply(this,arguments)}));var o=this;ui(this,"start",function(){var e=li((function*(e){return o.timeRange=null!=e?e:(0,t.getDefaultTimeRange)(),o.datasource.lookupsDisabled?[]:(o.metrics=(yield o.fetchLabelValues("__name__"))||[],o.histogramMetrics=(e=>{const t=new Set,r=new RegExp("_bucket($|:)");for(let n=0;n<e.length;n++){const i=e[n];r.test(i)&&t.add(i)}return[...t]})(o.metrics).sort(),Promise.all([o.loadMetricsMetadata(),o.fetchLabels()]))}));return function(t){return e.apply(this,arguments)}}());var s=this;ui(this,"provideCompletionItems",function(){var e=li((function*({prefix:e,text:t,value:r,labelKey:n,wrapperClasses:i},a={}){const o={suggestions:[]};if(!r)return o;const l=0===r.document.text.length,u=r.document.getTextsAtRange(r.selection),c=1===u.size?u.first().getText():null,d=c?c[r.selection.anchor.offset]:null,p=i.length>3,f=e&&!p,m=!d||")"===d,h=e&&!t.match(/^[\]})\s]+$/)&&m,g=t.match(/[+\-*/^%]/);return i.includes("context-range")?s.getRangeCompletionItems():i.includes("context-labels")?s.getLabelCompletionItems({prefix:e,text:t,value:r,labelKey:n,wrapperClasses:i}):i.includes("context-aggregation")?s.getAggregationCompletionItems(r):l?s.getEmptyCompletionItems(a):f&&m&&!g?s.getBeginningCompletionItems(a):f&&h?s.getTermCompletionItems():o}));return function(t){return e.apply(this,arguments)}}()),ui(this,"getBeginningCompletionItems",(e=>({suggestions:[...this.getEmptyCompletionItems(e).suggestions,...this.getTermCompletionItems().suggestions]}))),ui(this,"getEmptyCompletionItems",(e=>{const{history:r}=e,n=[];if(r&&r.length){const e=(0,$.chain)(r).map((e=>e.query.expr)).filter().uniq().take(5).map(mi).map((e=>function(e,r){const n=Date.now()-864e5,i=r.filter((t=>t.ts>n&&t.query===e.label)),a=i.length,o=i[0];let s=`Queried ${a} times in the last 24h.`;return o&&(s=`${s} Last queried ${(0,t.dateTime)(o.ts).fromNow()}.`),di(ci({},e),{documentation:s})}(e,r))).value();n.push({searchFunctionType:a.SearchFunctionType.Prefix,skipSort:!0,label:"History",items:e})}return{suggestions:n}})),ui(this,"getTermCompletionItems",(()=>{const{metrics:e,metricsMetadata:t}=this,r=[];return r.push({searchFunctionType:a.SearchFunctionType.Prefix,label:"Functions",items:pr.map(hi)}),e&&e.length&&r.push({label:"Metrics",items:e.map((e=>function(e,t){const r={label:e};return t&&t[e]&&(r.documentation=gi(e,t)),r}(e,t))),searchFunctionType:a.SearchFunctionType.Fuzzy}),{suggestions:r}}));var l=this;ui(this,"getAggregationCompletionItems",function(){var e=li((function*(e){const t=[];let r;const n=e.document.getBlocks().reduce(((t,n)=>{if(void 0===t)return"";if(!n)return t;const i=null==n?void 0:n.getText();return e.anchorBlock.key===n.key&&(r=e.selection.anchor.offset+t.length),t+i}),""),i=n.lastIndexOf("(",r);let o=n.lastIndexOf("(",i-1),s=n.indexOf(")",o);if(-1===o){const e=n.indexOf(")",r);s=n.indexOf(")",e+1),o=n.lastIndexOf("(",s)}const u={suggestions:t,context:"context-aggregation"};if(-1===o)return u;const c=n.slice(o+1,s).replace(/\[[^\]]+\]$/,""),d=Gn(c,c.length-2).selector,p=yield l.getSeries(d),f=Object.keys(p);if(f.length>0){const e=Kn(f);t.push({label:`Labels${e}`,items:f.map(mi),searchFunctionType:a.SearchFunctionType.Fuzzy})}return u}));return function(t){return e.apply(this,arguments)}}());var u=this;ui(this,"getLabelCompletionItems",function(){var e=li((function*({text:e,wrapperClasses:t,labelKey:r,value:n}){if(!n)return{suggestions:[]};const i=[],o=n.anchorBlock.getText(),s=n.selection.anchor.offset,l=o.substr(s),c=o.substr(0,s),d=e.match(/^(=|=~|!=|!~)/),p=l.match(/^"?[,}]|$/),f=c.match(/(=|=~|!=|!~)$/)&&l.match(/^"/);if((!d||!p)&&(!p||d)||f)return{suggestions:i};let m,h;try{h=Gn(o,s),m=h.selector}catch(e){m="{}"}const g=m.includes("__name__="),y=h?h.labelKeys:[];let v,b={};if(m&&(b=yield u.getSeries(m,!g)),0===Object.keys(b).length)return console.warn(`Server did not return any values for selector = ${m}`),{suggestions:i};if(e&&d||t.includes("attr-value")){if(r&&b[r]){v="context-label-values";const e=Kn(b[r]);i.push({label:`Label values for "${r}"${e}`,items:b[r].map(mi),searchFunctionType:a.SearchFunctionType.Fuzzy})}}else{const e=b?Object.keys(b):g?null:pi;if(e){const t=(0,$.difference)(e,y);if(t.length){v="context-labels";const e=t.map((e=>({label:e}))),r={label:`Labels${Kn(e)}`,items:e,searchFunctionType:a.SearchFunctionType.Fuzzy};i.push(r)}}}return{context:v,suggestions:i}}));return function(t){return e.apply(this,arguments)}}());var c=this;ui(this,"getSeriesLabels",function(){var e=li((function*(e,t){t.push({name:"__name__",value:"",op:"!="});const r=yield c.fetchSeriesLabelsMatch(e),n=new Set(t.map((e=>e.name)));return r.filter((e=>!n.has(e)))}));return function(t,r){return e.apply(this,arguments)}}());var d=this;ui(this,"fetchSeriesLabelsMatch",function(){var e=li((function*(e){const t=d.datasource.interpolateString(e),r=di(ci({},d.datasource.getAdjustedInterval(d.timeRange)),{"match[]":t});return yield d.request("/api/v1/labels",[],r)}));return function(t){return e.apply(this,arguments)}}());var p=this;ui(this,"fetchSeriesValuesWithMatch",function(){var e=li((function*(e,t,r=p.timeRange){const n=e?p.datasource.interpolateString(e):null,i=t?p.datasource.interpolateString(t):null,a=ci({},p.datasource.getAdjustedInterval(r),i&&{"match[]":i}),o=yield p.request(`/api/v1/label/${n}/values`,[],a);return null!=o?o:[]}));return function(t,r){return e.apply(this,arguments)}}());var f=this;ui(this,"fetchLabelValues",function(){var e=li((function*(e){const t=f.datasource.getTimeRangeParams(),r=f.datasource.getLimitMetrics("maxTagValues"),n=`/api/v1/label/${f.datasource.interpolateString(e)}/values`;return yield f.request(n,[],di(ci({},t),{limit:r}))}));return function(t){return e.apply(this,arguments)}}());var m=this;ui(this,"fetchSeriesLabels",function(){var e=li((function*(e,t){const r=m.datasource.interpolateString(e),n=m.datasource.getTimeRangeParams(),i=m.datasource.getLimitMetrics("maxSeries"),a=di(ci({},n),{limit:i,"match[]":r}),o=`/api/v1/series?${new URLSearchParams({"match[]":r,start:zn(parseInt(n.start,10)).toString(),end:zn(parseInt(n.end,10)).toString(),withName:t?"true":"false"}).toString()}`;let s=m.labelsCache.get(o);if(!s){const e=yield m.request("/api/v1/series",[],a),{values:r}=function(e,t=!1){const r={};e.forEach((e=>{const{__name__:n}=e,i=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["__name__"]);t&&(r.__name__=r.__name__||new Set,r.__name__.has(n)||r.__name__.add(n)),Object.keys(i).forEach((e=>{r[e]||(r[e]=new Set),r[e].has(i[e])||r[e].add(i[e])}))}));const n={};return Wn(Object.keys(r)).forEach((e=>{n[e]=Wn(Array.from(r[e]))})),{values:n,keys:Object.keys(n)}}(e,t);s=r,m.labelsCache.set(o,s)}return s}));return function(t,r){return e.apply(this,arguments)}}());var h=this;ui(this,"fetchSeries",function(){var e=li((function*(e){const t=h.datasource.getTimeRangeParams(),r=h.datasource.getLimitMetrics("maxSeries"),n=di(ci({},t),{"match[]":e,limit:r});return yield h.request("/api/v1/series",{},n)}));return function(t){return e.apply(this,arguments)}}());var g=this;ui(this,"fetchDefaultSeries",(0,$.once)(li((function*(){const e=yield Promise.all(pi.map((e=>g.fetchLabelValues(e))));return pi.reduce(((t,r,n)=>di(ci({},t),{[r]:e[n]})),{})})))),this.datasource=e,this.histogramMetrics=[],this.timeRange=(0,t.getDefaultTimeRange)(),this.metrics=[],this.withTemplates=[],Object.assign(this,r)}}var vi={id:"promql",extensions:[".promql"],aliases:["Prometheus","prometheus","prom","Prom","promql","Promql","promQL","PromQL"],mimetypes:[],loader:function(){return Promise.all([m.e(719),m.e(8)]).then(m.bind(m,719))}};const bi=function(e){var t=(0,r.useRef)(e);return t.current=e,t},Oi={Breadcrumbs:{breadcrumb:e=>`data-testid ${e} breadcrumb`},TimePicker:{openButton:"data-testid TimePicker Open Button",fromField:"Time Range from field",toField:"Time Range to field",applyTimeRange:"data-testid TimePicker submit button",calendar:{label:"Time Range calendar",openButton:"Open time range calendar",closeButton:"Close time range Calendar"},absoluteTimeRangeTitle:"data-testid-absolute-time-range-narrow"},DataSourcePermissions:{form:()=>'form[name="addPermission"]',roleType:"Role to add new permission to",rolePicker:"Built-in role picker",permissionLevel:"Permission Level"},DataSource:{TestData:{QueryTab:{scenarioSelectContainer:"Test Data Query scenario select container",scenarioSelect:"Test Data Query scenario select",max:"TestData max",min:"TestData min",noise:"TestData noise",seriesCount:"TestData series count",spread:"TestData spread",startValue:"TestData start value",drop:"TestData drop values"}},DataSourceHttpSettings:{urlInput:"Datasource HTTP settings url"},Jaeger:{traceIDInput:"Trace ID"},Prometheus:{configPage:{exemplarsAddButton:"Add exemplar config button",internalLinkSwitch:"Internal link switch"},exemplarMarker:"Exemplar marker"}},Menu:{MenuComponent:e=>`${e} menu`,MenuGroup:e=>`${e} menu group`,MenuItem:e=>`${e} menu item`,SubMenu:{container:"SubMenu container",icon:"SubMenu icon"}},Panels:{Panel:{title:e=>`data-testid Panel header ${e}`,headerItems:e=>`Panel header item ${e}`,menuItems:e=>`data-testid Panel menu item ${e}`,menu:e=>`data-testid Panel menu ${e}`,containerByTitle:e=>`${e} panel`,headerCornerInfo:e=>`Panel header ${e}`,loadingBar:()=>"Panel loading bar",HoverWidget:{container:"data-testid hover-header-container",dragIcon:"data-testid drag-icon"}},Visualization:{Graph:{container:"Graph container",VisualizationTab:{legendSection:"Legend section"},Legend:{legendItemAlias:e=>`gpl alias ${e}`,showLegendSwitch:"gpl show legend"},xAxis:{labels:()=>"div.flot-x-axis > div.flot-tick-label"}},BarGauge:{value:"Bar gauge value",valueV2:"data-testid Bar gauge value"},PieChart:{svgSlice:"Pie Chart Slice"},Text:{container:()=>".markdown-html"},Table:{header:"table header",footer:"table-footer"}}},VizLegend:{seriesName:e=>`VizLegend series ${e}`},Drawer:{General:{title:e=>`Drawer title ${e}`,expand:"Drawer expand",contract:"Drawer contract",close:"Drawer close",rcContentWrapper:()=>".rc-drawer-content-wrapper"}},PanelEditor:{General:{content:"Panel editor content"},OptionsPane:{content:"Panel editor option pane content",select:"Panel editor option pane select",fieldLabel:e=>`${e} field property editor`},DataPane:{content:"Panel editor data pane content"},applyButton:"data-testid Apply changes and go back to dashboard",toggleVizPicker:"data-testid toggle-viz-picker",toggleVizOptions:"data-testid toggle-viz-options",toggleTableView:"toggle-table-view",measureButton:"show measure tools"},PanelInspector:{Data:{content:"Panel inspector Data content"},Stats:{content:"Panel inspector Stats content"},Json:{content:"Panel inspector Json content"},Query:{content:"Panel inspector Query content",refreshButton:"Panel inspector Query refresh button",jsonObjectKeys:()=>".json-formatter-key"}},Tab:{title:e=>`Tab ${e}`,active:()=>'[class*="-activeTabStyle"]'},RefreshPicker:{runButton:"RefreshPicker run button",intervalButton:"RefreshPicker interval button",runButtonV2:"data-testid RefreshPicker run button",intervalButtonV2:"data-testid RefreshPicker interval button"},QueryTab:{content:"Query editor tab content",queryInspectorButton:"Query inspector button",queryHistoryButton:"Rich history button",addQuery:"Query editor add query button"},QueryHistory:{queryText:"Query text"},QueryEditorRows:{rows:"Query editor row"},QueryEditorRow:{actionButton:e=>`${e}`,title:e=>`Query editor row title ${e}`,container:e=>`Query editor row ${e}`},AlertTab:{content:"Alert editor tab content"},Alert:{alert:e=>`Alert ${e}`,alertV2:e=>`data-testid Alert ${e}`},TransformTab:{content:"data-testid Transform editor tab content",newTransform:e=>`data-testid New transform ${e}`,transformationEditor:e=>`data-testid Transformation editor ${e}`,transformationEditorDebugger:e=>`data-testid Transformation editor debugger ${e}`},Transforms:{card:e=>`data-testid New transform ${e}`,Reduce:{modeLabel:"Transform mode label",calculationsLabel:"Transform calculations label"},SpatialOperations:{actionLabel:"root Action field property editor",locationLabel:"root Location field property editor",location:{autoOption:"Auto location option",coords:{option:"Coords location option",latitudeFieldLabel:"root Latitude field field property editor",longitudeFieldLabel:"root Longitude field field property editor"},geohash:{option:"Geohash location option",geohashFieldLabel:"root Geohash field field property editor"},lookup:{option:"Lookup location option",lookupFieldLabel:"root Lookup field field property editor",gazetteerFieldLabel:"root Gazetteer field property editor"}}},searchInput:"search transformations",addTransformationButton:"data-testid add transformation button"},NavBar:{Configuration:{button:"Configuration"},Toggle:{button:"Toggle menu"},Reporting:{button:"Reporting"}},NavMenu:{item:"data-testid Nav menu item"},NavToolbar:{container:"data-testid Nav toolbar"},PageToolbar:{container:()=>".page-toolbar",item:e=>`${e}`,itemButton:e=>`data-testid ${e}`},QueryEditorToolbarItem:{button:e=>`QueryEditor toolbar item button ${e}`},BackButton:{backArrow:"Go Back"},OptionsGroup:{group:e=>e?`Options group ${e}`:"Options group",toggle:e=>e?`Options group ${e} toggle`:"Options group toggle"},PluginVisualization:{item:e=>`Plugin visualization item ${e}`,current:()=>'[class*="-currentVisualizationItem"]'},Select:{option:"Select option",input:()=>'input[id*="time-options-input"]',singleValue:()=>'div[class*="-singleValue"]'},FieldConfigEditor:{content:"Field config editor content"},OverridesConfigEditor:{content:"Field overrides editor content"},FolderPicker:{container:"Folder picker select container",containerV2:"data-testid Folder picker select container",input:"Select a folder"},ReadonlyFolderPicker:{container:"data-testid Readonly folder picker select container"},DataSourcePicker:{container:"data-testid Data source picker select container",input:()=>'input[id="data-source-picker"]',inputV2:"data-testid Select a data source"},TimeZonePicker:{container:"Time zone picker select container",containerV2:"data-testid Time zone picker select container"},WeekStartPicker:{container:"Choose starting day of the week",containerV2:"data-testid Choose starting day of the week",placeholder:"Choose starting day of the week"},TraceViewer:{spanBar:"data-testid SpanBar--wrapper"},QueryField:{container:"Query field"},QueryBuilder:{queryPatterns:"Query patterns",labelSelect:"Select label",valueSelect:"Select value",matchOperatorSelect:"Select match operator"},ValuePicker:{button:e=>`Value picker button ${e}`,select:e=>`Value picker select ${e}`},Search:{section:"Search section",sectionV2:"data-testid Search section",items:"Search items",itemsV2:"data-testid Search items",cards:"data-testid Search cards",collapseFolder:e=>`data-testid Collapse folder ${e}`,expandFolder:e=>`data-testid Expand folder ${e}`,dashboardItem:e=>`${Oi.Search.dashboardItems} ${e}`,dashboardCard:e=>`data-testid Search card ${e}`,folderHeader:e=>`data-testid Folder header ${e}`,folderContent:e=>`data-testid Folder content ${e}`,dashboardItems:"data-testid Dashboard search item"},DashboardLinks:{container:"data-testid Dashboard link container",dropDown:"data-testid Dashboard link dropdown",link:"data-testid Dashboard link"},LoadingIndicator:{icon:"Loading indicator"},CallToActionCard:{button:e=>`Call to action button ${e}`,buttonV2:e=>`data-testid Call to action button ${e}`},DataLinksContextMenu:{singleLink:"Data link"},CodeEditor:{container:"Code editor container"},DashboardImportPage:{textarea:"data-testid-import-dashboard-textarea",submit:"data-testid-load-dashboard"},ImportDashboardForm:{name:"data-testid-import-dashboard-title",submit:"data-testid-import-dashboard-submit"},PanelAlertTabContent:{content:"Unified alert editor tab content"},VisualizationPreview:{card:e=>`data-testid suggestion-${e}`},ColorSwatch:{name:"data-testid-colorswatch"},DashboardRow:{title:e=>`data-testid dashboard-row-title-${e}`},UserProfile:{profileSaveButton:"data-testid-user-profile-save",preferencesSaveButton:"data-testid-shared-prefs-save",orgsTable:"data-testid-user-orgs-table",sessionsTable:"data-testid-user-sessions-table"},FileUpload:{inputField:"data-testid-file-upload-input-field",fileNameSpan:"data-testid-file-upload-file-name"},DebugOverlay:{wrapper:"debug-overlay"},OrgRolePicker:{input:"Role"},AnalyticsToolbarButton:{button:"Dashboard insights"},Variables:{variableOption:"data-testid variable-option"},Annotations:{annotationsTypeInput:"annotations-type-input",annotationsChoosePanelInput:"choose-panels-input"}},wi={pages:{Login:{url:"/login",username:"Username input field",password:"Password input field",submit:"Login button",skip:"Skip change password button"},Home:{url:"/"},DataSource:{name:"Data source settings page name input field",delete:"Data source settings page Delete button",readOnly:"Data source settings page read only message",saveAndTest:"data-testid Data source settings page Save and Test button",alert:"Data source settings page Alert"},DataSources:{url:"/datasources",dataSources:e=>`Data source list item ${e}`},EditDataSource:{url:e=>`/datasources/edit/${e}`,settings:"Datasource settings page basic settings"},AddDataSource:{url:"/datasources/new",dataSourcePlugins:e=>`Data source plugin item ${e}`,dataSourcePluginsV2:e=>`Add new data source ${e}`},ConfirmModal:{delete:"data-testid Confirm Modal Danger Button"},AddDashboard:{url:"/dashboard/new",itemButton:e=>`data-testid ${e}`,addNewPanel:"Add new panel",addNewRow:"Add new row",addNewPanelLibrary:"Add new panel from panel library"},Dashboard:{url:e=>`/d/${e}`,DashNav:{nav:"Dashboard navigation",navV2:"data-testid Dashboard navigation",publicDashboardTag:"data-testid public dashboard tag"},SubMenu:{submenu:"Dashboard submenu",submenuItem:"data-testid template variable",submenuItemLabels:e=>`data-testid Dashboard template variables submenu Label ${e}`,submenuItemValueDropDownValueLinkTexts:e=>`data-testid Dashboard template variables Variable Value DropDown value link text ${e}`,submenuItemValueDropDownDropDown:"Variable options",submenuItemValueDropDownOptionTexts:e=>`data-testid Dashboard template variables Variable Value DropDown option text ${e}`,Annotations:{annotationsWrapper:"data-testid annotation-wrapper",annotationLabel:e=>`data-testid Dashboard annotations submenu Label ${e}`,annotationToggle:e=>`data-testid Dashboard annotations submenu Toggle ${e}`}},Settings:{Actions:{close:"data-testid dashboard-settings-close"},General:{deleteDashBoard:"Dashboard settings page delete dashboard button",sectionItems:e=>`Dashboard settings section item ${e}`,saveDashBoard:"Dashboard settings aside actions Save button",saveAsDashBoard:"Dashboard settings aside actions Save As button",timezone:"Time zone picker select container",title:"Tab General"},Annotations:{List:{addAnnotationCTA:Oi.CallToActionCard.button("Add annotation query"),addAnnotationCTAV2:Oi.CallToActionCard.buttonV2("Add annotation query")},Settings:{name:"Annotations settings name input"},NewAnnotation:{panelFilterSelect:"data-testid annotations-panel-filter",showInLabel:"show-in-label",previewInDashboard:"data-testid annotations-preview"}},Variables:{List:{addVariableCTA:Oi.CallToActionCard.button("Add variable"),addVariableCTAV2:Oi.CallToActionCard.buttonV2("Add variable"),newButton:"Variable editor New variable button",table:"Variable editor Table",tableRowNameFields:e=>`Variable editor Table Name field ${e}`,tableRowDefinitionFields:e=>`Variable editor Table Definition field ${e}`,tableRowArrowUpButtons:e=>`Variable editor Table ArrowUp button ${e}`,tableRowArrowDownButtons:e=>`Variable editor Table ArrowDown button ${e}`,tableRowDuplicateButtons:e=>`Variable editor Table Duplicate button ${e}`,tableRowRemoveButtons:e=>`Variable editor Table Remove button ${e}`},Edit:{General:{headerLink:"Variable editor Header link",modeLabelNew:"Variable editor Header mode New",modeLabelEdit:"Variable editor Header mode Edit",generalNameInput:"Variable editor Form Name field",generalNameInputV2:"data-testid Variable editor Form Name field",generalTypeSelect:"Variable editor Form Type select",generalTypeSelectV2:"data-testid Variable editor Form Type select",generalLabelInput:"Variable editor Form Label field",generalLabelInputV2:"data-testid Variable editor Form Label field",generalHideSelect:"Variable editor Form Hide select",generalHideSelectV2:"data-testid Variable editor Form Hide select",selectionOptionsMultiSwitch:"Variable editor Form Multi switch",selectionOptionsIncludeAllSwitch:"Variable editor Form IncludeAll switch",selectionOptionsCustomAllInput:"Variable editor Form IncludeAll field",selectionOptionsCustomAllInputV2:"data-testid Variable editor Form IncludeAll field",previewOfValuesOption:"Variable editor Preview of Values option",submitButton:"Variable editor Submit button",applyButton:"data-testid Variable editor Apply button"},QueryVariable:{queryOptionsDataSourceSelect:Oi.DataSourcePicker.container,queryOptionsRefreshSelect:"Variable editor Form Query Refresh select",queryOptionsRefreshSelectV2:"data-testid Variable editor Form Query Refresh select",queryOptionsRegExInput:"Variable editor Form Query RegEx field",queryOptionsRegExInputV2:"data-testid Variable editor Form Query RegEx field",queryOptionsSortSelect:"Variable editor Form Query Sort select",queryOptionsSortSelectV2:"data-testid Variable editor Form Query Sort select",queryOptionsQueryInput:"Variable editor Form Default Variable Query Editor textarea",valueGroupsTagsEnabledSwitch:"Variable editor Form Query UseTags switch",valueGroupsTagsTagsQueryInput:"Variable editor Form Query TagsQuery field",valueGroupsTagsTagsValuesQueryInput:"Variable editor Form Query TagsValuesQuery field"},ConstantVariable:{constantOptionsQueryInput:"Variable editor Form Constant Query field",constantOptionsQueryInputV2:"data-testid Variable editor Form Constant Query field"},DatasourceVariable:{datasourceSelect:"data-testid datasource variable datasource type"},TextBoxVariable:{textBoxOptionsQueryInput:"Variable editor Form TextBox Query field",textBoxOptionsQueryInputV2:"data-testid Variable editor Form TextBox Query field"},CustomVariable:{customValueInput:"data-testid custom-variable-input"},IntervalVariable:{intervalsValueInput:"data-testid interval variable intervals input"}}}},Annotations:{marker:"data-testid annotation-marker"}},Dashboards:{url:"/dashboards",dashboards:e=>`Dashboard search item ${e}`},SaveDashboardAsModal:{newName:"Save dashboard title field",save:"Save dashboard button"},SaveDashboardModal:{save:"Dashboard settings Save Dashboard Modal Save button",saveVariables:"Dashboard settings Save Dashboard Modal Save variables checkbox",saveTimerange:"Dashboard settings Save Dashboard Modal Save timerange checkbox"},SharePanelModal:{linkToRenderedImage:"Link to rendered image"},ShareDashboardModal:{shareButton:"Share dashboard or panel",PublicDashboard:{Tab:"Tab Public dashboard",WillBePublicCheckbox:"data-testid public dashboard will be public checkbox",LimitedDSCheckbox:"data-testid public dashboard limited datasources checkbox",CostIncreaseCheckbox:"data-testid public dashboard cost may increase checkbox",PauseSwitch:"data-testid public dashboard pause switch",EnableAnnotationsSwitch:"data-testid public dashboard on off switch for annotations",CreateButton:"data-testid public dashboard create button",DeleteButton:"data-testid public dashboard delete button",CopyUrlInput:"data-testid public dashboard copy url input",CopyUrlButton:"data-testid public dashboard copy url button",SettingsDropdown:"data-testid public dashboard settings dropdown",TemplateVariablesWarningAlert:"data-testid public dashboard disabled template variables alert",UnsupportedDataSourcesWarningAlert:"data-testid public dashboard unsupported data sources alert",NoUpsertPermissionsWarningAlert:"data-testid public dashboard no upsert permissions alert",EnableTimeRangeSwitch:"data-testid public dashboard on off switch for time range",EmailSharingConfiguration:{Container:"data-testid email sharing config container",ShareType:"data-testid public dashboard share type",EmailSharingInput:"data-testid public dashboard email sharing input",EmailSharingInviteButton:"data-testid public dashboard email sharing invite button",EmailSharingList:"data-testid public dashboard email sharing list",DeleteEmail:"data-testid public dashboard delete email button",ReshareLink:"data-testid public dashboard reshare link button"}}},PublicDashboard:{page:"public-dashboard-page",NotAvailable:{container:"public-dashboard-not-available",title:"public-dashboard-title",pausedDescription:"public-dashboard-paused-description"}},RequestViewAccess:{form:"request-view-access-form",recipientInput:"request-view-access-recipient-input",submitButton:"request-view-access-submit-button"},Explore:{url:"/explore",General:{container:"data-testid Explore",graph:"Explore Graph",table:"Explore Table",scrollView:"data-testid explorer scroll view"}},SoloPanel:{url:e=>`/d-solo/${e}`},PluginsList:{page:"Plugins list page",list:"Plugins list",listItem:"Plugins list item",signatureErrorNotice:"Unsigned plugins notice"},PluginPage:{page:"Plugin page",signatureInfo:"Plugin signature info",disabledInfo:"Plugin disabled info"},PlaylistForm:{name:"Playlist name",interval:"Playlist interval",itemDelete:"Delete playlist item"},BrowseDashbards:{table:{row:e=>`data-testid ${e} row`,checkbox:e=>`data-testid ${e} checkbox`}},Search:{url:"/?search=openn",FolderView:{url:"/?search=open&layout=folders"}},PublicDashboards:{ListItem:{linkButton:"public-dashboard-link-button",configButton:"public-dashboard-configuration-button",trashcanButton:"public-dashboard-remove-button",pauseSwitch:"data-testid public dashboard pause switch"}},UserListPage:{tabs:{allUsers:"data-testid all-users-tab",orgUsers:"data-testid org-users-tab",publicDashboardsUsers:"data-testid public-dashboards-users-tab",users:"data-testid users-tab"},org:{url:"/org/users"},admin:{url:"/admin/users"},publicDashboards:{container:"data-testid public-dashboards-users-list"},UserListAdminPage:{container:"data-testid user-list-admin-page"},UsersListPage:{container:"data-testid users-list-page"},UsersListPublicDashboardsPage:{container:"data-testid users-list-public-dashboards-page",DashboardsListModal:{listItem:e=>`data-testid dashboards-list-item-${e}`}}}},components:Oi};function _i(){const e=new Map;return e.set("expandSuggestionDocs",(!0).toString()),{onDidChangeValue:e=>{},onDidChangeTarget:e=>{},onWillSaveState:e=>{},get:(t,r,n)=>{var i;return null!==(i=e.get(t))&&void 0!==i?i:n},getBoolean:(t,r,n)=>{const i=e.get(t);return void 0!==i?"true"===i:n},getNumber:(t,r,n)=>{const i=e.get(t);return void 0!==i?parseInt(i,10):n},store:(t,r,n,i)=>{null==r?e.delete(t):e.set(t,r.toString())},remove:(t,r)=>{e.delete(t)},keys:(t,r)=>Array.from(e.keys()),logStorage:()=>{console.log("logStorage: not implemented")},migrate:()=>Promise.resolve(void 0),isNew:e=>!0,flush:e=>Promise.resolve(void 0)}}let Si=null;class Ei extends Error{constructor(){super("should never happen")}}function xi(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function Ti(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){xi(a,n,i,o,s,"next",e)}function s(e){xi(a,n,i,o,s,"throw",e)}o(void 0)}))}}var Pi;function ki(e){return Ii.apply(this,arguments)}function Ii(){return(Ii=Ti((function*(e){return(yield e.getAllMetricNames()).map((e=>({type:"METRIC_NAME",label:e.name,insertText:e.name,detail:`${e.name} : ${e.type}`,documentation:e.help})))}))).apply(this,arguments)}function Ci(e){return Ai.apply(this,arguments)}function Ai(){return(Ai=Ti((function*(e){return(yield e.getAllWithTemplates()).map((e=>({type:"WITH_TEMPLATE",label:e.name,insertText:e.name,detail:e.value,documentation:e.help})))}))).apply(this,arguments)}!function(e){e.history="HISTORY",e.function="FUNCTION",e.metricName="METRIC_NAME",e.withTemplate="WITH_TEMPLATE",e.duration="DURATION",e.labelName="LABEL_NAME",e.labelValue="LABEL_VALUE"}(Pi||(Pi={}));const qi=pr.map((e=>{var t;return{type:"FUNCTION",label:e.label,insertText:null!==(t=e.insertText)&&void 0!==t?t:"",detail:e.detail,documentation:e.documentation}}));function Ri(){return(Ri=Ti((function*(e){const t=yield ki(e),r=yield Ci(e);return[...qi,...t,...r]}))).apply(this,arguments)}const Di=["$__interval","$__range","$__rate_interval","1m","5m","10m","30m","1h","1d"].map((e=>({type:"DURATION",label:e,insertText:e})));function Ni(){return(Ni=Ti((function*(e){return(yield e.getHistory()).slice(0,10).map((e=>({type:"HISTORY",label:e,insertText:e})))}))).apply(this,arguments)}function Li(e,t){const r=[...t];return void 0!==e&&r.push({name:"__name__",value:e,op:"="}),`{${r.map((e=>`${e.name}${e.op}"${Yn(e.value)}"`)).join(",")}}`}function ji(){return ji=Ti((function*(e,t,r){if(void 0===e&&0===t.length)return r.getAllLabelNames();{const n=Li(e,t),i=yield r.getSeries(n),a=Object.keys(i),o=new Set(t.map((e=>e.name)));return a.filter((e=>!o.has(e)))}})),ji.apply(this,arguments)}function Mi(e,t,r,n,i){return Fi.apply(this,arguments)}function Fi(){return Fi=Ti((function*(e,t,r,n,i){const a=yield function(e,t,r){return ji.apply(this,arguments)}(e,n,i),o=a.map((e=>({type:"LABEL_NAME",label:e,insertText:`${e}${t}`,triggerOnInsert:r}))),s=(yield Ci(i)).filter((e=>{var t;const r=new RegExp(`${e.label}\\s?=\\s?`,"gm");return"{"===(null===(t=e.detail)||void 0===t?void 0:t.replace(r,"").charAt(0))}));return o.concat(s)})),Fi.apply(this,arguments)}function Bi(){return(Bi=Ti((function*(e,t,r){return Mi(e,"=",!0,t,r)}))).apply(this,arguments)}function Qi(){return(Qi=Ti((function*(e,t,r){return Mi(e,"",!1,t,r)}))).apply(this,arguments)}function $i(){return($i=Ti((function*(e,t,r,n){if(void 0===e&&0===r.length)return n.getLabelValues(t);{const a=Li(e,r);var i;return null!==(i=(yield n.getSeries(a))[t])&&void 0!==i?i:[]}}))).apply(this,arguments)}function Vi(){return Vi=Ti((function*(e,t,r,n,i){const a=yield function(e,t,r,n){return $i.apply(this,arguments)}(e,t,n,i);return a.map((e=>({type:"LABEL_VALUE",label:e,insertText:r?e:`"${e}"`})))})),Vi.apply(this,arguments)}function Xi(){return Xi=Ti((function*(e,t){switch(e.type){case"IN_DURATION":return Di;case"IN_FUNCTION":case"AT_ROOT":return function(e){return Ri.apply(this,arguments)}(t);case"EMPTY":{const e=yield ki(t),r=yield function(e){return Ni.apply(this,arguments)}(t);return[...r,...qi,...e]}case"IN_LABEL_SELECTOR_NO_LABEL_NAME":return function(e,t,r){return Bi.apply(this,arguments)}(e.metricName,e.otherLabels,t);case"IN_GROUPING":return function(e,t,r){return Qi.apply(this,arguments)}(e.metricName,e.otherLabels,t);case"IN_LABEL_SELECTOR_WITH_LABEL_NAME":return function(e,t,r,n,i){return Vi.apply(this,arguments)}(e.metricName,e.labelName,e.betweenQuotes,e.otherLabels,t);default:throw new Ei}})),Xi.apply(this,arguments)}function Gi(e,t){switch(t){case"parent":return e.parent;case"firstChild":return e.firstChild;case"lastChild":return e.lastChild;case"nextSibling":return e.nextSibling;default:throw new Ei}}function Ui(e,t){let r=e;for(const[e,n]of t){if(r=Gi(r,e),null===r)return null;if(r.type.id!==n)return null}return r}function zi(e,t){return t.slice(e.from,e.to)}function Wi(e,t){return e.every(((e,r)=>e===t[r]))}const Ki=[{path:[sr,ar],fun:function(e,t,r){if(function(e){return null!==Ji(e,0)}(e))return null;const n=Ui(e,[["firstChild",lr]]);if(null!==n&&!t.slice(n.to,r).includes(","))return null;const i=Ui(e,[["parent",ar],["firstChild",or],["firstChild",57]]),a=Zi(e,t);return null===i?{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",otherLabels:a}:{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",metricName:zi(i,t),otherLabels:a}}},{path:[28],fun:function(){return{type:"AT_ROOT"}}},{path:[Kt],fun:function(){return{type:"IN_FUNCTION"}}},{path:[ir,ur],fun:ea},{path:[0,ur],fun:ea},{path:[0,238],fun:function(){return{type:"IN_DURATION"}}},{path:[Gt],fun:function(e,t){const r=Ui(e,[["parent",Xt],["parent",$t]]);if(null===r)return null;const n=r.getChild(Kt);if(null===n)return null;const i=Ji(n,or);if(null===i)return null;const a=Ui(i,[["firstChild",57]]);return null===a?null:{type:"IN_GROUPING",metricName:zi(a,t),otherLabels:[]}}}],Hi=new Map([[253,"="],[254,"=~"],[53,"!="],[255,"!~"]]);function Yi(e,t){if(e.type.id!==ur)return null;const r=Ui(e,[["firstChild",Wt]]);if(null===r)return null;const n=Ui(r,[["nextSibling",cr]]);if(null===n)return null;const i=function(e){const t=e.firstChild;return null===t?null:null!==(r=Hi.get(t.type.id))&&void 0!==r?r:null;var r}(n);if(null===i)return null;const a=Ui(e,[["lastChild",ir]]);if(null===a)return null;const o=zi(r,t),s=function(e){const t=e.slice(1,e.length-1);if(e.startsWith('"')&&e.endsWith('"'))return t.replace(/\\"/,'"');if(e.startsWith("'")&&e.endsWith("'"))return t.replace(/\\'/,"'");if(e.startsWith("`")&&e.endsWith("`"))return t;throw new Error("FIXME: invalid string literal")}(zi(a,t));return{name:o,value:s,op:i}}function Zi(e,t){if(e.type.id!==sr)return[];let r=Ui(e,[["firstChild",lr]]);const n=[];for(;null!==r;){const e=Ui(r,[["lastChild",ur]]);if(null===e)return[];const i=Yi(e,t);null!==i&&n.push(i),r=Ui(r,[["firstChild",lr]])}return n.reverse(),n}function Ji(e,t){if(e.type.id===t)return e;const r=function(e){let t=e.firstChild;const r=[];for(;null!==t;)r.push(t),t=t.nextSibling;return r}(e);for(const e of r){const r=Ji(e,t);if(null!==r)return r}return null}function ea(e,t){const r=!e.type.isError,n=Ui(e,[["parent",ur]]);if(null===n)return null;const i=Ui(n,[["firstChild",Wt]]);if(null===i)return null;const a=zi(i,t),o=Ui(n,[["parent",lr]]);if(null===o)return null;let s=o,l=null;for(;null===l;){const e=s.parent;if(null===e)return null;const{id:t}=e.type;switch(t){case lr:s=e;continue;case sr:l=e;continue;default:return null}}const u=Zi(l,t).filter((e=>e.name!==a)),c=Ui(l,[["parent",ar],["firstChild",or],["firstChild",57]]);return null===c?{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",labelName:a,betweenQuotes:r,otherLabels:u}:{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",metricName:zi(c,t),labelName:a,betweenQuotes:r,otherLabels:u}}function ta(e,t){switch(e){case Pi.duration:return t.languages.CompletionItemKind.Unit;case Pi.function:return t.languages.CompletionItemKind.Variable;case Pi.history:return t.languages.CompletionItemKind.Snippet;case Pi.labelName:return t.languages.CompletionItemKind.Enum;case Pi.labelValue:return t.languages.CompletionItemKind.EnumMember;case Pi.metricName:return t.languages.CompletionItemKind.Constructor;case Pi.withTemplate:return t.languages.CompletionItemKind.Constant;default:throw new Ei}}function ra(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function na(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ra(e,t,r[t])}))}return e}function ia(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const aa={codeLens:!1,contextmenu:!1,fixedOverflowWidgets:!0,folding:!1,fontSize:14,lineDecorationsWidth:8,lineNumbers:"off",minimap:{enabled:!1},overviewRulerBorder:!1,overviewRulerLanes:0,padding:{top:4,bottom:5},renderLineHighlight:"none",scrollbar:{vertical:"hidden",verticalScrollbarSize:8,horizontal:"hidden",horizontalScrollbarSize:0},scrollBeyondLastLine:!1,suggest:{showWords:!1},suggestFontSize:12,wordWrap:"on"},oa=vi.id;let sa=!1;const la=e=>{const t=(0,r.useRef)((null===Si&&(Si={storageService:_i()}),Si)),i=(0,r.useRef)(null),{languageProvider:o,history:s,onBlur:l,onRunQuery:u,initialValue:d,placeholder:p,readOnly:f}=e,h=bi(o),g=bi(s),y=bi(u),v=bi(l),b=(0,r.useRef)(null),O=((e,t)=>({container:c.css`
      border-radius: ${e.shape.borderRadius()};
      border: 1px solid ${e.components.input.borderColor};
    `,placeholder:c.css`
      ::after {
        content: '${t}';
        font-family: ${e.typography.fontFamilyMonospace};
        opacity: 0.3;
      }
    `}))((0,a.useTheme2)(),p);return(0,r.useEffect)((()=>()=>{var e;null===(e=b.current)||void 0===e||e.call(b)}),[]),n().createElement("div",{"aria-label":wi.components.QueryField.container,className:O.container,ref:i},n().createElement(a.ReactMonacoEditor,{overrideServices:t.current,options:ia(na({},aa),{readOnly:f}),language:"promql",value:d,beforeMount:e=>{!function(e){if(!sa){sa=!0;const{aliases:t,extensions:r,mimetypes:n,loader:i}=vi;e.languages.register({id:oa,aliases:t,extensions:r,mimetypes:n}),i().then((t=>{e.languages.setMonarchTokensProvider(oa,t.language),e.languages.setLanguageConfiguration(oa,t.languageConfiguration)}))}}(e)},onMount:(e,t)=>{e.onDidBlurEditorWidget((()=>{v.current(e.getValue())}));const r={getSeries:e=>h.current.getSeries(e),getHistory:()=>Promise.resolve(g.current.map((e=>e.query.expr)).filter((e=>void 0!==e))),getAllMetricNames:()=>{const{metrics:e,metricsMetadata:t}=h.current,r=e.map((e=>{const r=null==t?void 0:t[e];var n,i;return{name:e,help:null!==(n=null==r?void 0:r.help)&&void 0!==n?n:"",type:null!==(i=null==r?void 0:r.type)&&void 0!==i?i:""}}));return Promise.resolve(r)},getAllWithTemplates:()=>{const{withTemplates:e}=h.current,t=e.map((e=>({name:e.label,help:e.comment||"",value:e.value})));return Promise.resolve(t)},getAllLabelNames:()=>Promise.resolve(h.current.getLabelKeys()),getLabelValues:e=>h.current.getLabelValues(e)},n=function(e,t){return{triggerCharacters:["{",",","[","(","=","~"," ",'"'],provideCompletionItems:(r,n)=>{const i=r.getWordAtPosition(n),a=null!=i?e.Range.lift({startLineNumber:n.lineNumber,endLineNumber:n.lineNumber,startColumn:i.startColumn,endColumn:i.endColumn}):e.Range.fromPositions(n),o={column:n.column,lineNumber:n.lineNumber},s=r.getOffsetAt(o),l=function(e,t){if(""===e)return{type:"EMPTY"};const r=Mt.parse(e),n=function(e,t){const r=e.cursorAt(t);for(;;){if(r.from===t&&r.to===t){const{node:e}=r;if(e.type.isError)return e}if(!r.next())break}return null}(r,t),i=null!=n?n.cursor():r.cursorAt(t),a=i.node,o=[i.type.id];for(;i.parent();)o.push(i.type.id);for(let r of Ki)if(Wi(r.path,o))return r.fun(a,e,t);return null}(r.getValue(),s),u=null!=l?function(e,t){return Xi.apply(this,arguments)}(l,t):Promise.resolve([]);return u.then((t=>{const r=t.length.toString().length;return{suggestions:t.map(((t,n)=>({kind:ta(t.type,e),label:t.label,insertText:t.type===Pi.metricName?Jn(t.insertText):t.insertText,detail:t.detail,documentation:{value:t.documentation},sortText:n.toString().padStart(r,"0"),range:a,command:t.triggerOnInsert?{id:"editor.action.triggerSuggest",title:""}:void 0})))}}))}}}(t,r),a=ia(na({},n),{provideCompletionItems:(t,r,i,a)=>{var o;return(null===(o=e.getModel())||void 0===o?void 0:o.id)!==t.id?{suggestions:[]}:n.provideCompletionItems(t,r,i,a)}}),{dispose:o}=t.languages.registerCompletionItemProvider(oa,a);b.current=o;const s=()=>{const t=i.current;if(null!==t){const r=e.getContentHeight();t.style.height=`${r+2}px`,t.style.width="100%";const n=t.clientWidth;e.layout({width:n,height:r})}};if(e.onDidContentSizeChange(s),s(),e.addAction({id:"execute-shift-enter",label:"Execute",keybindings:[t.KeyMod.Shift|t.KeyCode.Enter],run:()=>y.current(e.getValue()||"")}),e.addCommand(t.KeyMod.CtrlCmd|t.KeyCode.KeyK,(function(){m.g.dispatchEvent(new KeyboardEvent("keydown",{key:"k",metaKey:!0}))})),p){const r=[{range:new t.Range(1,1,1,1),contents:[{value:"**bold** _italics_ regular `code`"}],options:{className:O.placeholder,isWholeLine:!0}}];let n=[];const i=()=>{const t=e.getModel();if(!t)return;const i=0===t.getValueLength()?r:[];n=t.deltaDecorations(n,i)};i(),e.onDidChangeModelContent(i)}}}))},ua=e=>n().createElement(r.Suspense,{fallback:null},n().createElement(la,e));function ca(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const da=e=>{const t=(0,r.useRef)(null),{runQueryOnBlur:i,onRunQuery:a,onChange:o}=e,s=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["runQueryOnBlur","onRunQuery","onChange"]),l=e=>{t.current=e,o(e),a()};return n().createElement(ua,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ca(e,t,r[t])}))}return e}({onRunQuery:l,onBlur:e=>{i?e!==t.current&&l(e):o(e)}},s))},pa=({initialValue:e,datasource:t,onChange:i})=>((0,r.useEffect)((()=>{var e,r;t.languageProvider=new yi(t),null===(r=t.languageProvider)||void 0===r||null===(e=r.start)||void 0===e||e.call(r)}),[t]),n().createElement(da,{runQueryOnBlur:!1,languageProvider:t.languageProvider,history:[],onChange:i,onRunQuery:()=>{},initialValue:e,placeholder:"Enter a WITH expressions..."}));var fa=m(1177);function ma(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function ha(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){ma(a,n,i,o,s,"next",e)}function s(e){ma(a,n,i,o,s,"throw",e)}o(void 0)}))}}function ga(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ya(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ga(e,t,r[t])}))}return e}function va(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const ba=({datasourceUID:e,dashboardUID:t})=>{const n=(0,r.useCallback)((a=ha((function*(t,r){return yield(0,fa.lastValueFrom)((0,i.getBackendSrv)().fetch({url:`/api/datasources/uid/${e}`,method:t,data:r}))})),function(e,t){return a.apply(this,arguments)}),[e]);var a;const o=(0,r.useCallback)(function(){var e=ha((function*(e){var r;const i=(yield n("GET")).data,a=(null==i||null===(r=i.jsonData)||void 0===r?void 0:r.withTemplates)||[],o=a.find((e=>(null==e?void 0:e.uid)===t));return o?o.expr=e:a.push({uid:t,expr:e}),va(ya({},i),{jsonData:va(ya({},i.jsonData),{withTemplates:a})})}));return function(t){return e.apply(this,arguments)}}(),[t,n]),s=(0,r.useCallback)(function(){var e=ha((function*(e){var t,r,i;const a=yield o(e),s=yield n("PUT",a);return(null==s||null===(i=s.data)||void 0===i||null===(r=i.datasource)||void 0===r||null===(t=r.jsonData)||void 0===t?void 0:t.withTemplates)||[]}));return function(t){return e.apply(this,arguments)}}(),[o,n]);return{updateDatasource:s}};function Oa(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function wa(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){wa(e,t,r[t])}))}return e}function Sa(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const Ea={noValidate:{title:"No validation",icon:"exclamation-triangle",color:"orange"},success:{title:"Valid WITH Expression",icon:"check",color:"green"},await:{title:"Validating WITH Expressions...",icon:"fa fa-spinner",color:"blue"},invalid:{title:"Invalid WITH Expression",icon:"exclamation-triangle",color:"red"},serverError:{title:"Unable to Validate WITH Expressions",icon:"exclamation-triangle",color:"red"}},xa=e=>{const[t,n]=(0,r.useState)(Ea.noValidate),a=(0,r.useCallback)((o=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){Oa(a,n,i,o,s,"next",e)}function s(e){Oa(a,n,i,o,s,"throw",e)}o(void 0)}))}}((function*(t){if(!t)return n(Ea.noValidate),!0;n(Ea.await);try{const r=t.replace(/\$__interval|\$__range|\$__rate_interval/gm,"1s"),a=encodeURIComponent(`WITH(${r})()`),o=yield(0,fa.lastValueFrom)((0,i.getBackendSrv)().fetch({url:`api/datasources/proxy/${e}/expand-with-exprs?query=${a}&format=json`,method:"GET"})),{status:s,error:l=""}=null==o?void 0:o.data;return n(Sa(_a({},"success"===s?Ea.success:Ea.invalid),{error:l})),"success"===s}catch(e){return console.error("Error validating WITH templates:",e),e instanceof Error&&n(Sa(_a({},Ea.serverError),{error:e.message})),!1}})),function(e){return o.apply(this,arguments)}),[e]);var o;return{validateResult:t,isValidExpr:a}},Ta=e=>({body:c.css`
    display: grid;
    gap: ${e.spacing(1)};
  `,button:c.css`
    display: flex;
    gap: ${e.spacing(1)};
    justify-content: space-between;
    align-items: center;
  `});function Pa(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function ka(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){Pa(a,n,i,o,s,"next",e)}function s(e){Pa(a,n,i,o,s,"throw",e)}o(void 0)}))}}const Ia=({datasource:e,dashboardUID:t,template:i,setTemplate:o,handleClose:s})=>{const l=(0,a.useStyles2)(Ta),{validateResult:u,isValidExpr:c}=xa(e.id),{updateDatasource:d}=ba({datasourceUID:e.uid,dashboardUID:t}),[p,f]=(0,r.useState)((null==i?void 0:i.expr)||""),[m,h]=(0,r.useState)(!1),g=(0,r.useCallback)(ka((function*(){if(h(!0),yield c(p)){try{const r=yield d(p);e.withTemplatesUpdate(r),o(r.find((e=>(null==e?void 0:e.uid)===t))),s()}catch(e){console.error(e)}h(!1)}else h(!1)})),[p,c,d,e,t,o,s]);return(0,r.useEffect)((()=>{o(e.withTemplates.find((e=>e.uid===t)))}),[o,e,t]),(0,r.useEffect)((()=>{p&&c(p)}),[p,c]),(0,r.useEffect)((()=>{f((null==i?void 0:i.expr)||"")}),[i]),n().createElement("div",{className:l.body},n().createElement(pa,{initialValue:p,datasource:e,onChange:f}),n().createElement(a.Badge,{icon:u.icon||"info",color:u.color||"blue",text:u.error||u.title}),n().createElement("div",{className:l.button},n().createElement("a",{className:"text-link",target:"_blank",href:"https://github.com/VictoriaMetrics/grafana-datasource#how-to-use-with-templates",rel:"noreferrer"},n().createElement(a.Button,{variant:"secondary",fill:"text",icon:"book",size:"sm"},"How it works?")),n().createElement(a.Button,{variant:"success",onClick:g,disabled:m},"Save")))};function Ca(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}const Aa=(qa=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){Ca(a,n,i,o,s,"next",e)}function s(e){Ca(a,n,i,o,s,"throw",e)}o(void 0)}))}}((function*(e){const t=yield(0,fa.lastValueFrom)((0,i.getBackendSrv)().fetch({url:`/api/dashboards/uid/${e}`,method:"GET"}));return null==t?void 0:t.data})),function(e){return qa.apply(this,arguments)});var qa;const Ra=Aa;function Da(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}const Na=({template:e,setTemplate:i,dashboardUID:o,datasource:s,app:l})=>{const[u,c]=(0,r.useState)(l===t.CoreApp.Explore),[d,p]=(0,r.useState)(),f=(0,r.useMemo)((()=>{var e,r;const n="WITH templates",i=[l===t.CoreApp.Explore?"Explore":"",null==d||null===(e=d.meta)||void 0===e?void 0:e.folderTitle,null==d||null===(r=d.dashboard)||void 0===r?void 0:r.title,n].filter(Boolean).join(" / ");return u?i:n}),[u,d,l]),[m,h]=(0,r.useState)(!1),g=()=>h(!1);return(0,r.useEffect)((()=>{i(s.withTemplates.find((e=>e.uid===o)))}),[i,s,o]),(0,r.useEffect)((()=>{const e=function(){var e=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){Da(a,n,i,o,s,"next",e)}function s(e){Da(a,n,i,o,s,"throw",e)}o(void 0)}))}}((function*(){try{const e=yield Ra(o);p(e),c(!0)}catch(e){console.error(e)}}));return function(){return e.apply(this,arguments)}}();o?e():l!==t.CoreApp.Explore&&c(!1)}),[o,l]),n().createElement(n().Fragment,null,n().createElement(a.IconButton,{key:"with_templates",name:"cog",tooltip:"WITH templates",onClick:()=>h(!0)}),n().createElement(a.Modal,{title:f,isOpen:m,closeOnEscape:!0,closeOnBackdropClick:!1,onDismiss:g},u?n().createElement(Ia,{datasource:s,dashboardUID:o||l||"",handleClose:g,template:e,setTemplate:i}):n().createElement(Y,{onAccept:()=>c(!0),onClose:g})))},La=e=>{if(!e)return[];const{expr:t}=e;return(e=>{let t=0,r=0;return e.split("").reduce(((e,n)=>((e=>['"',"'"].includes(e))(n)&&r++,r%2==0&&((e=>["(","{","["].includes(e))(n)&&t++,(e=>[")","}","]"].includes(e))(n)&&t--),((e,t,r)=>","===e&&0===t&&r%2==0)(n,t,r)?e.push(""):e[e.length-1]+=n,e)),[""])})(t).filter((e=>e)).map((e=>{var t,r;const n=e.match(/#.*\n/gm),i=(null==n||null===(t=n.join(""))||void 0===t?void 0:t.trim())||"",a=e.match(/(.*?)=/);return{label:`${(null==a||null===(r=a[0])||void 0===r?void 0:r.slice(0,-2))||""}`,comment:i.replace(/#/gm,""),value:e.replace(i,"").trim()}}))},ja=(e="",t)=>{const r=null==t?void 0:t.expr;if(!r)return e;const n=La(t).map((e=>e.label)),i=n.some((t=>{const r=t.replace(/(\w+)\(.*?\)/g,"$1");return e.includes(r)}));return i?`WITH(\n  ${(e=>{const t=La({expr:e,uid:""}).map((e=>e.value));return t.join(",\n")})(r)}\n)\n${e}`:e};var Ma;!function(e){e.Code="code",e.Builder="builder"}(Ma||(Ma={}));const Fa=[{label:"Builder",value:Ma.Builder},{label:"Code",value:Ma.Code}];function Ba({mode:e,onChange:t}){return n().createElement("div",{"data-testid":"QueryEditorModeToggle"},n().createElement(a.RadioButtonGroup,{options:Fa,size:"sm",value:e,onChange:t}))}function Qa(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $a(e){var{label:t}=e,i=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["label"]);const o=t.replace(" ","-"),s=(0,r.useRef)((0,$.uniqueId)(`switch-${o}`)),l=(0,a.useStyles2)(Va);return n().createElement(g,{gap:1},n().createElement("label",{htmlFor:s.current,className:l.switchLabel},t),n().createElement(a.Switch,(u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Qa(e,t,r[t])}))}return e}({},i),c=null!=(c={id:s.current})?c:{},Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(c)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(c)).forEach((function(e){Object.defineProperty(u,e,Object.getOwnPropertyDescriptor(c,e))})),u)));var u,c}const Va=e=>({switchLabel:(0,c.css)({color:e.colors.text.secondary,cursor:"pointer",fontSize:e.typography.bodySmall.fontSize,"&:hover":{color:e.colors.text.primary}})}),Xa=new class{get(e){return window.localStorage[e]}set(e,t){window.localStorage[e]=t}getObject(e,t){let r=t;if(this.exists(e)){const n=window.localStorage[e];try{r=JSON.parse(n)}catch(r){console.error(`Error parsing store object: ${e}. Returning default: ${t}. [${r}]`)}}return r}setObject(e,t){let r;try{r=JSON.stringify(t)}catch(t){throw new Error(`Could not stringify object: ${e}. [${t}]`)}try{this.set(e,r)}catch(t){const r=new Error(`Could not save item in localStorage: ${e}. [${t}]`);throw t instanceof Error&&(r.name=t.name),r}return!0}exists(e){return void 0!==window.localStorage[e]}delete(e){window.localStorage.removeItem(e)}};var Ga,Ua,za;function Wa(e){return"values"in e}function Ka(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ha(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Ka(e,t,r[t])}))}return e}function Ya(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}!function(e){e.timeSeriesQuery="timeSeriesQuery"}(Ga||(Ga={})),function(e){e.Auto="__auto",e.Verbose="__verbose",e.Custom="__custom"}(Ua||(Ua={})),function(e){e[e.LabelNames=0]="LabelNames",e[e.LabelValues=1]="LabelValues",e[e.MetricNames=2]="MetricNames",e[e.VarQueryResult=3]="VarQueryResult",e[e.SeriesQuery=4]="SeriesQuery",e[e.ClassicQuery=5]="ClassicQuery"}(za||(za={}));const Za="PrometheusQueryEditorModeDefault";function Ja(e,t,r){""===e.expr&&Xa.set(Za,t),r(Ya(Ha({},e),{editorMode:t}))}function eo(e){if(null!=e&&""!==e)return Ma.Code;const t=Xa.get(Za);switch(t){case Ma.Builder:case Ma.Code:return t;default:return Ma.Builder}}function to(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function ro(e){return!!e&&!!e[Vo]}function no(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===Xo}(e)||Array.isArray(e)||!!e[$o]||!!(null===(t=e.constructor)||void 0===t?void 0:t[$o])||uo(e)||co(e))}function io(e,t,r){void 0===r&&(r=!1),0===ao(e)?(r?Object.keys:Go)(e).forEach((function(n){r&&"symbol"==typeof n||t(n,e[n],e)})):e.forEach((function(r,n){return t(n,r,e)}))}function ao(e){var t=e[Vo];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:uo(e)?2:co(e)?3:0}function oo(e,t){return 2===ao(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function so(e,t,r){var n=ao(e);2===n?e.set(t,r):3===n?e.add(r):e[t]=r}function lo(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function uo(e){return Mo&&e instanceof Map}function co(e){return Fo&&e instanceof Set}function po(e){return e.o||e.t}function fo(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=Uo(e);delete t[Vo];for(var r=Go(t),n=0;n<r.length;n++){var i=r[n],a=t[i];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[i]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function mo(e,t){return void 0===t&&(t=!1),go(e)||ro(e)||!no(e)||(ao(e)>1&&(e.set=e.add=e.clear=e.delete=ho),Object.freeze(e),t&&io(e,(function(e,t){return mo(t,!0)}),!0)),e}function ho(){to(2)}function go(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function yo(e){var t=zo[e];return t||to(18,e),t}function vo(){return Lo}function bo(e,t){t&&(yo("Patches"),e.u=[],e.s=[],e.v=t)}function Oo(e){wo(e),e.p.forEach(So),e.p=null}function wo(e){e===Lo&&(Lo=e.l)}function _o(e){return Lo={p:[],l:Lo,h:e,m:!0,_:0}}function So(e){var t=e[Vo];0===t.i||1===t.i?t.j():t.g=!0}function Eo(e,t){t._=t.p.length;var r=t.p[0],n=void 0!==e&&e!==r;return t.h.O||yo("ES5").S(t,e,n),n?(r[Vo].P&&(Oo(t),to(4)),no(e)&&(e=xo(t,e),t.l||Po(t,e)),t.u&&yo("Patches").M(r[Vo].t,e,t.u,t.s)):e=xo(t,r,[]),Oo(t),t.u&&t.v(t.u,t.s),e!==Qo?e:void 0}function xo(e,t,r){if(go(t))return t;var n=t[Vo];if(!n)return io(t,(function(i,a){return To(e,n,t,i,a,r)}),!0),t;if(n.A!==e)return t;if(!n.P)return Po(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var i=4===n.i||5===n.i?n.o=fo(n.k):n.o,a=i,o=!1;3===n.i&&(a=new Set(i),i.clear(),o=!0),io(a,(function(t,a){return To(e,n,i,t,a,r,o)})),Po(e,i,!1),r&&e.u&&yo("Patches").N(n,r,e.u,e.s)}return n.o}function To(e,t,r,n,i,a,o){if(ro(i)){var s=xo(e,i,a&&t&&3!==t.i&&!oo(t.R,n)?a.concat(n):void 0);if(so(r,n,s),!ro(s))return;e.m=!1}else o&&r.add(i);if(no(i)&&!go(i)){if(!e.h.D&&e._<1)return;xo(e,i),t&&t.A.l||Po(e,i)}}function Po(e,t,r){void 0===r&&(r=!1),!e.l&&e.h.D&&e.m&&mo(t,r)}function ko(e,t){var r=e[Vo];return(r?po(r):e)[t]}function Io(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function Co(e){e.P||(e.P=!0,e.l&&Co(e.l))}function Ao(e){e.o||(e.o=fo(e.t))}function qo(e,t,r){var n=uo(t)?yo("MapSet").F(t,r):co(t)?yo("MapSet").T(t,r):e.O?function(e,t){var r=Array.isArray(e),n={i:r?1:0,A:t?t.A:vo(),P:!1,I:!1,R:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=n,a=Wo;r&&(i=[n],a=Ko);var o=Proxy.revocable(i,a),s=o.revoke,l=o.proxy;return n.k=l,n.j=s,l}(t,r):yo("ES5").J(t,r);return(r?r.A:vo()).p.push(n),n}function Ro(e){return ro(e)||to(22,e),function e(t){if(!no(t))return t;var r,n=t[Vo],i=ao(t);if(n){if(!n.P&&(n.i<4||!yo("ES5").K(n)))return n.t;n.I=!0,r=Do(t,i),n.I=!1}else r=Do(t,i);return io(r,(function(t,i){n&&function(e,t){return 2===ao(e)?e.get(t):e[t]}(n.t,t)===i||so(r,t,e(i))})),3===i?new Set(r):r}(e)}function Do(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return fo(e)}var No,Lo,jo="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),Mo="undefined"!=typeof Map,Fo="undefined"!=typeof Set,Bo="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,Qo=jo?Symbol.for("immer-nothing"):((No={})["immer-nothing"]=!0,No),$o=jo?Symbol.for("immer-draftable"):"__$immer_draftable",Vo=jo?Symbol.for("immer-state"):"__$immer_state",Xo=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),Go="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,Uo=Object.getOwnPropertyDescriptors||function(e){var t={};return Go(e).forEach((function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)})),t},zo={},Wo={get:function(e,t){if(t===Vo)return e;var r=po(e);if(!oo(r,t))return function(e,t,r){var n,i=Io(t,r);return i?"value"in i?i.value:null===(n=i.get)||void 0===n?void 0:n.call(e.k):void 0}(e,r,t);var n=r[t];return e.I||!no(n)?n:n===ko(e.t,t)?(Ao(e),e.o[t]=qo(e.A.h,n,e)):n},has:function(e,t){return t in po(e)},ownKeys:function(e){return Reflect.ownKeys(po(e))},set:function(e,t,r){var n=Io(po(e),t);if(null==n?void 0:n.set)return n.set.call(e.k,r),!0;if(!e.P){var i=ko(po(e),t),a=null==i?void 0:i[Vo];if(a&&a.t===r)return e.o[t]=r,e.R[t]=!1,!0;if(lo(r,i)&&(void 0!==r||oo(e.t,t)))return!0;Ao(e),Co(e)}return e.o[t]===r&&(void 0!==r||t in e.o)||Number.isNaN(r)&&Number.isNaN(e.o[t])||(e.o[t]=r,e.R[t]=!0),!0},deleteProperty:function(e,t){return void 0!==ko(e.t,t)||t in e.t?(e.R[t]=!1,Ao(e),Co(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var r=po(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},defineProperty:function(){to(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){to(12)}},Ko={};io(Wo,(function(e,t){Ko[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),Ko.deleteProperty=function(e,t){return Ko.set.call(this,e,t,void 0)},Ko.set=function(e,t,r){return Wo.set.call(this,e[0],t,r,e[0])};var Ho=function(){function e(e){var t=this;this.O=Bo,this.D=!0,this.produce=function(e,r,n){if("function"==typeof e&&"function"!=typeof r){var i=r;r=e;var a=t;return function(e){var t=this;void 0===e&&(e=i);for(var n=arguments.length,o=Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];return a.produce(e,(function(e){var n;return(n=r).call.apply(n,[t,e].concat(o))}))}}var o;if("function"!=typeof r&&to(6),void 0!==n&&"function"!=typeof n&&to(7),no(e)){var s=_o(t),l=qo(t,e,void 0),u=!0;try{o=r(l),u=!1}finally{u?Oo(s):wo(s)}return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return bo(s,n),Eo(e,s)}),(function(e){throw Oo(s),e})):(bo(s,n),Eo(o,s))}if(!e||"object"!=typeof e){if(void 0===(o=r(e))&&(o=e),o===Qo&&(o=void 0),t.D&&mo(o,!0),n){var c=[],d=[];yo("Patches").M(e,o,c,d),n(c,d)}return o}to(21,e)},this.produceWithPatches=function(e,r){if("function"==typeof e)return function(r){for(var n=arguments.length,i=Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return t.produceWithPatches(r,(function(t){return e.apply(void 0,[t].concat(i))}))};var n,i,a=t.produce(e,r,(function(e,t){n=e,i=t}));return"undefined"!=typeof Promise&&a instanceof Promise?a.then((function(e){return[e,n,i]})):[a,n,i]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){no(e)||to(8),ro(e)&&(e=Ro(e));var t=_o(this),r=qo(this,e,void 0);return r[Vo].C=!0,wo(t),r},t.finishDraft=function(e,t){var r=(e&&e[Vo]).A;return bo(r,t),Eo(void 0,r)},t.setAutoFreeze=function(e){this.D=e},t.setUseProxies=function(e){e&&!Bo&&to(20),this.O=e},t.applyPatches=function(e,t){var r;for(r=t.length-1;r>=0;r--){var n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}r>-1&&(t=t.slice(r+1));var i=yo("Patches").$;return ro(e)?i(e,t):this.produce(e,(function(e){return i(e,t)}))},e}(),Yo=new Ho,Zo=Yo.produce;Yo.produceWithPatches.bind(Yo),Yo.setAutoFreeze.bind(Yo),Yo.setUseProxies.bind(Yo),Yo.applyPatches.bind(Yo),Yo.createDraft.bind(Yo),Yo.finishDraft.bind(Yo);const Jo=Zo;var es,ts=m(3129),rs=(es=function(e,t){return es=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},es(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}es(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),ns=function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e},is=Object.defineProperty,as=Object.defineProperties,os=Object.getOwnPropertyDescriptors,ss=Object.getOwnPropertySymbols,ls=Object.prototype.hasOwnProperty,us=Object.prototype.propertyIsEnumerable,cs=function(e,t,r){return t in e?is(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},ds=function(e,t){for(var r in t||(t={}))ls.call(t,r)&&cs(e,r,t[r]);if(ss)for(var n=0,i=ss(t);n<i.length;n++)r=i[n],us.call(t,r)&&cs(e,r,t[r]);return e},ps=function(e,t){return as(e,os(t))};function fs(e,t){function r(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(t){var i=t.apply(void 0,r);if(!i)throw new Error("prepareAction did not return an object");return ds(ds({type:e,payload:i.payload},"meta"in i&&{meta:i.meta}),"error"in i&&{error:i.error})}return{type:e,payload:r[0]}}return r.toString=function(){return""+e},r.type=e,r.match=function(t){return t.type===e},r}function ms(e){return no(e)?Jo(e,(function(){})):e}function hs(e){var t,r={},n=[],i={addCase:function(e,t){var n="string"==typeof e?e:e.type;if(!n)throw new Error("`builder.addCase` cannot be called with an empty action type");if(n in r)throw new Error("`builder.addCase` cannot be called with two reducers for the same action type");return r[n]=t,i},addMatcher:function(e,t){return n.push({matcher:e,reducer:t}),i},addDefaultCase:function(e){return t=e,i}};return e(i),[r,n,t]}"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__,"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__,function(e){function t(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=e.apply(this,r)||this;return Object.setPrototypeOf(i,t.prototype),i}rs(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,ns([void 0],e[0].concat(this)))):new(t.bind.apply(t,ns([void 0],e.concat(this))))}}(Array),function(e){function t(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=e.apply(this,r)||this;return Object.setPrototypeOf(i,t.prototype),i}rs(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,ns([void 0],e[0].concat(this)))):new(t.bind.apply(t,ns([void 0],e.concat(this))))}}(Array);var gs=["name","message","stack","code"],ys=function(e,t){this.payload=e,this.meta=t},vs=function(e,t){this.payload=e,this.meta=t},bs=function(e){if("object"==typeof e&&null!==e){for(var t={},r=0,n=gs;r<n.length;r++){var i=n[r];"string"==typeof e[i]&&(t[i]=e[i])}return t}return{message:String(e)}};function Os(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}!function(){function e(e,t,r){var n=fs(e+"/fulfilled",(function(e,t,r,n){return{payload:e,meta:ps(ds({},n||{}),{arg:r,requestId:t,requestStatus:"fulfilled"})}})),i=fs(e+"/pending",(function(e,t,r){return{payload:void 0,meta:ps(ds({},r||{}),{arg:t,requestId:e,requestStatus:"pending"})}})),a=fs(e+"/rejected",(function(e,t,n,i,a){return{payload:i,error:(r&&r.serializeError||bs)(e||"Rejected"),meta:ps(ds({},a||{}),{arg:n,requestId:t,rejectedWithValue:!!i,requestStatus:"rejected",aborted:"AbortError"===(null==e?void 0:e.name),condition:"ConditionError"===(null==e?void 0:e.name)})}})),o="undefined"!=typeof AbortController?AbortController:function(){function e(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return e.prototype.abort=function(){},e}();return Object.assign((function(e){return function(s,l,u){var c,d=(null==r?void 0:r.idGenerator)?r.idGenerator(e):function(e){void 0===e&&(e=21);for(var t="",r=e;r--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t}(),p=new o;function f(e){c=e,p.abort()}var m=function(){return o=this,m=null,h=function(){var o,m,h,g,y,v;return function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,(function(b){switch(b.label){case 0:return b.trys.push([0,4,,5]),null===(O=g=null==(o=null==r?void 0:r.condition)?void 0:o.call(r,e,{getState:l,extra:u}))||"object"!=typeof O||"function"!=typeof O.then?[3,2]:[4,g];case 1:g=b.sent(),b.label=2;case 2:if(!1===g||p.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return y=new Promise((function(e,t){return p.signal.addEventListener("abort",(function(){return t({name:"AbortError",message:c||"Aborted"})}))})),s(i(d,e,null==(m=null==r?void 0:r.getPendingMeta)?void 0:m.call(r,{requestId:d,arg:e},{getState:l,extra:u}))),[4,Promise.race([y,Promise.resolve(t(e,{dispatch:s,getState:l,extra:u,requestId:d,signal:p.signal,abort:f,rejectWithValue:function(e,t){return new ys(e,t)},fulfillWithValue:function(e,t){return new vs(e,t)}})).then((function(t){if(t instanceof ys)throw t;return t instanceof vs?n(t.payload,d,e,t.meta):n(t,d,e)}))])];case 3:return h=b.sent(),[3,5];case 4:return v=b.sent(),h=v instanceof ys?a(null,d,e,v.payload,v.meta):a(v,d,e),[3,5];case 5:return r&&!r.dispatchConditionRejection&&a.match(h)&&h.meta.condition||s(h),[2,h]}var O}))},new Promise((function(e,t){var r=function(e){try{i(h.next(e))}catch(e){t(e)}},n=function(e){try{i(h.throw(e))}catch(e){t(e)}},i=function(t){return t.done?e(t.value):Promise.resolve(t.value).then(r,n)};i((h=h.apply(o,m)).next())}));var o,m,h}();return Object.assign(m,{abort:f,requestId:d,arg:e,unwrap:function(){return m.then(Os)}})}}),{pending:i,rejected:a,fulfilled:n,typePrefix:e})}e.withTypes=function(){return e}}(),Object.assign;var ws="listenerMiddleware";fs(ws+"/add"),fs(ws+"/removeAll"),fs(ws+"/remove"),"function"==typeof queueMicrotask&&queueMicrotask.bind("undefined"!=typeof window?window:void 0!==m.g?m.g:globalThis);function _s(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function Ss(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){_s(a,n,i,o,s,"next",e)}function s(e){_s(a,n,i,o,s,"throw",e)}o(void 0)}))}}function Es(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xs(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Es(e,t,r[t])}))}return e}function Ts(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Ps({item:e,defaultOp:i,onChange:o,onDelete:s,onGetLabelNames:l,onGetLabelValues:u}){const[c,d]=(0,r.useState)({}),f=()=>{var t;return null===(t=ks.find((t=>t.label===e.op)))||void 0===t?void 0:t.isMultiValue},m=e=>e?e.indexOf("|")>0?e.split("|"):[e]:[];var h;return n().createElement("div",{"data-testid":"prometheus-dimensions-filter-item"},n().createElement(B,null,n().createElement(a.Select,{placeholder:"Select label","aria-label":wi.components.QueryBuilder.labelSelect,inputId:"prometheus-dimensions-filter-item-key",width:"auto",value:e.label?(0,t.toOption)(e.label):null,allowCustomValue:!0,onOpenMenu:Ss((function*(){d({isLoadingLabelNames:!0});const t=yield l(e);d({labelNames:t,isLoadingLabelNames:void 0})})),isLoading:c.isLoadingLabelNames,options:c.labelNames,onChange:t=>{var r;t.label&&o(Ts(xs({},e),{op:null!==(r=e.op)&&void 0!==r?r:i,label:t.label}))}}),n().createElement(a.Select,{"aria-label":wi.components.QueryBuilder.matchOperatorSelect,value:(0,t.toOption)(null!==(h=e.op)&&void 0!==h?h:i),options:ks,width:"auto",onChange:t=>{null!=t.value&&o(Ts(xs({},e),{op:t.value}))}}),n().createElement(a.Select,{placeholder:"Select value","aria-label":wi.components.QueryBuilder.valueSelect,inputId:"prometheus-dimensions-filter-item-value",width:"auto",value:f()?m(null==e?void 0:e.value).map(t.toOption):m(null==e?void 0:e.value).map(t.toOption)[0],allowCustomValue:!0,onOpenMenu:Ss((function*(){d({isLoadingLabelValues:!0});const t=yield u(e);d(Ts(xs({},c),{labelValues:t,isLoadingLabelValues:void 0}))})),isMulti:f(),isLoading:c.isLoadingLabelValues,options:(()=>{const r=c.labelValues?[...c.labelValues]:[],n=m(null==e?void 0:e.value).map(t.toOption);return(0,$.uniqBy)([...n,...r],"value")})(),onChange:t=>{if(t.value){var r;o(Ts(xs({},e),{value:t.value,op:null!==(r=e.op)&&void 0!==r?r:i}))}else{const r=t.map((e=>e.label)).join("|");var n;o(Ts(xs({},e),{value:r,op:null!==(n=e.op)&&void 0!==n?n:i}))}}}),n().createElement(p,{"aria-label":"remove",icon:"times",variant:"secondary",onClick:s})))}"undefined"!=typeof window&&window.requestAnimationFrame&&window.requestAnimationFrame,function(){function e(e,t){var r=i[e];return r?r.enumerable=t:i[e]=r={configurable:!0,enumerable:t,get:function(){var t=this[Vo];return Wo.get(t,e)},set:function(t){var r=this[Vo];Wo.set(r,e,t)}},r}function t(e){for(var t=e.length-1;t>=0;t--){var i=e[t][Vo];if(!i.P)switch(i.i){case 5:n(i)&&Co(i);break;case 4:r(i)&&Co(i)}}}function r(e){for(var t=e.t,r=e.k,n=Go(r),i=n.length-1;i>=0;i--){var a=n[i];if(a!==Vo){var o=t[a];if(void 0===o&&!oo(t,a))return!0;var s=r[a],l=s&&s[Vo];if(l?l.t!==o:!lo(s,o))return!0}}var u=!!t[Vo];return n.length!==Go(t).length+(u?0:1)}function n(e){var t=e.k;if(t.length!==e.t.length)return!0;var r=Object.getOwnPropertyDescriptor(t,t.length-1);if(r&&!r.get)return!0;for(var n=0;n<t.length;n++)if(!t.hasOwnProperty(n))return!0;return!1}var i={};!function(e,t){zo[e]||(zo[e]=t)}("ES5",{J:function(t,r){var n=Array.isArray(t),i=function(t,r){if(t){for(var n=Array(r.length),i=0;i<r.length;i++)Object.defineProperty(n,""+i,e(i,!0));return n}var a=Uo(r);delete a[Vo];for(var o=Go(a),s=0;s<o.length;s++){var l=o[s];a[l]=e(l,t||!!a[l].enumerable)}return Object.create(Object.getPrototypeOf(r),a)}(n,t),a={i:n?5:4,A:r?r.A:vo(),P:!1,I:!1,R:{},l:r,t,k:i,o:null,g:!1,C:!1};return Object.defineProperty(i,Vo,{value:a,writable:!0}),i},S:function(e,r,i){i?ro(r)&&r[Vo].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var r=t[Vo];if(r){var i=r.t,a=r.k,o=r.R,s=r.i;if(4===s)io(a,(function(t){t!==Vo&&(void 0!==i[t]||oo(i,t)?o[t]||e(a[t]):(o[t]=!0,Co(r)))})),io(i,(function(e){void 0!==a[e]||oo(a,e)||(o[e]=!1,Co(r))}));else if(5===s){if(n(r)&&(Co(r),o.length=!0),a.length<i.length)for(var l=a.length;l<i.length;l++)o[l]=!1;else for(var u=i.length;u<a.length;u++)o[u]=!0;for(var c=Math.min(a.length,i.length),d=0;d<c;d++)a.hasOwnProperty(d)||(o[d]=!0),void 0===o[d]&&e(a[d])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?r(e):n(e)}})}();const ks=[{label:"=~",value:"=~",isMultiValue:!0},{label:"=",value:"=",isMultiValue:!1},{label:"!=",value:"!=",isMultiValue:!1},{label:"!~",value:"!~",isMultiValue:!0}];function Is({labelsFilters:e,onChange:t,onGetLabelNames:i,onGetLabelValues:a,error:o}){const[s,l]=(0,r.useState)([{op:"="}]);return(0,r.useEffect)((()=>{e.length>0?l(e):l([{op:"="}])}),[e]),n().createElement(v,null,n().createElement(E,{label:"Label filters",error:o,invalid:!!o},n().createElement(k,{items:s,onChange:r=>{l(r);const n=r.filter((e=>null!=e.label&&null!=e.value));(0,$.isEqual)(n,e)||t(n)},renderItem:(e,t,r)=>n().createElement(Ps,{item:e,defaultOp:"=",onChange:t,onDelete:r,onGetLabelNames:i,onGetLabelValues:a})})))}function Cs({title:e,stepNumber:r,markdown:i,children:o}){const s=(0,a.useStyles2)(As);return n().createElement("div",{className:s.box},void 0!==r&&n().createElement("div",{className:s.stepNumber},r),n().createElement("div",{className:s.boxInner},e&&n().createElement("div",{className:s.header},n().createElement("span",null,e)),n().createElement("div",{className:s.body},i&&n().createElement("div",{dangerouslySetInnerHTML:{__html:(0,t.renderMarkdown)(i)}}),o)))}const As=e=>({box:(0,c.css)({background:e.colors.background.secondary,padding:e.spacing(1),borderRadius:e.shape.borderRadius(),position:"relative"}),boxInner:(0,c.css)({marginLeft:e.spacing(4)}),stepNumber:(0,c.css)({fontWeight:e.typography.fontWeightMedium,background:e.colors.secondary.main,width:"20px",height:"20px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"10px",left:"11px",fontSize:e.typography.bodySmall.fontSize}),header:(0,c.css)({paddingBottom:e.spacing(.5),display:"flex",alignItems:"center",fontFamily:e.typography.fontFamilyMonospace}),body:(0,c.css)({color:e.colors.text.secondary,"p:last-child":{margin:0},a:{color:e.colors.text.link,textDecoration:"underline"}})});function qs(e,t){return qs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qs(e,t)}function Rs(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,qs(e,t)}function Ds(){return Ds=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ds.apply(this,arguments)}var Ns=m(3929);function Ls(e,t){var n=(0,r.useState)((function(){return{inputs:t,result:e()}}))[0],i=(0,r.useRef)(!0),a=(0,r.useRef)(n),o=i.current||Boolean(t&&a.current.inputs&&function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(t,a.current.inputs)),s=o?a.current:{inputs:t,result:e()};return(0,r.useEffect)((function(){i.current=!1,a.current=s}),[s]),s.result}var js=Ls,Ms=function(e,t){return Ls((function(){return e}),t)},Fs=function(e){var t=e.top,r=e.right,n=e.bottom,i=e.left;return{top:t,right:r,bottom:n,left:i,width:r-i,height:n-t,x:i,y:t,center:{x:(r+i)/2,y:(n+t)/2}}},Bs=function(e,t){return{top:e.top-t.top,left:e.left-t.left,bottom:e.bottom+t.bottom,right:e.right+t.right}},Qs=function(e,t){return{top:e.top+t.top,left:e.left+t.left,bottom:e.bottom-t.bottom,right:e.right-t.right}},$s={top:0,right:0,bottom:0,left:0},Vs=function(e){var t=e.borderBox,r=e.margin,n=void 0===r?$s:r,i=e.border,a=void 0===i?$s:i,o=e.padding,s=void 0===o?$s:o,l=Fs(Bs(t,n)),u=Fs(Qs(t,a)),c=Fs(Qs(u,s));return{marginBox:l,borderBox:Fs(t),paddingBox:u,contentBox:c,margin:n,border:a,padding:s}},Xs=function(e){var t=e.slice(0,-2);if("px"!==e.slice(-2))return 0;var r=Number(t);return isNaN(r)&&function(e,t){throw new Error("Invariant failed")}(),r},Gs=function(e,t){var r,n,i=e.borderBox,a=e.border,o=e.margin,s=e.padding,l=(n=t,{top:(r=i).top+n.y,left:r.left+n.x,bottom:r.bottom+n.y,right:r.right+n.x});return Vs({borderBox:l,border:a,margin:o,padding:s})},Us=function(e,t){return void 0===t&&(t={x:window.pageXOffset,y:window.pageYOffset}),Gs(e,t)},zs=function(e,t){var r={top:Xs(t.marginTop),right:Xs(t.marginRight),bottom:Xs(t.marginBottom),left:Xs(t.marginLeft)},n={top:Xs(t.paddingTop),right:Xs(t.paddingRight),bottom:Xs(t.paddingBottom),left:Xs(t.paddingLeft)},i={top:Xs(t.borderTopWidth),right:Xs(t.borderRightWidth),bottom:Xs(t.borderBottomWidth),left:Xs(t.borderLeftWidth)};return Vs({borderBox:e,margin:r,padding:n,border:i})},Ws=function(e){var t=e.getBoundingClientRect(),r=window.getComputedStyle(e);return zs(t,r)},Ks=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function Hs(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!((n=e[r])===(i=t[r])||Ks(n)&&Ks(i)))return!1;var n,i;return!0}const Ys=function(e,t){var r;void 0===t&&(t=Hs);var n,i=[],a=!1;return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return a&&r===this&&t(o,i)||(n=e.apply(this,o),a=!0,r=this,i=o),n}},Zs=function(e){var t=[],r=null,n=function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];t=i,r||(r=requestAnimationFrame((function(){r=null,e.apply(void 0,t)})))};return n.cancel=function(){r&&(cancelAnimationFrame(r),r=null)},n};var Js=m(2729),el=m.n(Js);function tl(e,t){}function rl(){}function nl(e,t,r){var n=t.map((function(t){var n,i,a=(n=r,i=t.options,Ds({},n,{},i));return e.addEventListener(t.eventName,t.fn,a),function(){e.removeEventListener(t.eventName,t.fn,a)}}));return function(){n.forEach((function(e){e()}))}}tl.bind(null,"warn"),tl.bind(null,"error");var il=!0,al="Invariant failed";function ol(e){this.message=e}function sl(e,t){if(!e)throw new ol(il?al:al+": "+(t||""))}ol.prototype.toString=function(){return this.message};var ll=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=e.call.apply(e,[this].concat(n))||this).callbacks=null,t.unbind=rl,t.onWindowError=function(e){var r=t.getCallbacks();r.isDragging()&&r.tryAbort(),e.error instanceof ol&&e.preventDefault()},t.getCallbacks=function(){if(!t.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return t.callbacks},t.setCallbacks=function(e){t.callbacks=e},t}Rs(t,e);var r=t.prototype;return r.componentDidMount=function(){this.unbind=nl(window,[{eventName:"error",fn:this.onWindowError}])},r.componentDidCatch=function(e){if(!(e instanceof ol))throw e;this.setState({})},r.componentWillUnmount=function(){this.unbind()},r.render=function(){return this.props.children(this.setCallbacks)},t}(n().Component),ul=function(e){return e+1},cl=function(e,t){var r=e.droppableId===t.droppableId,n=ul(e.index),i=ul(t.index);return r?"\n      You have moved the item from position "+n+"\n      to position "+i+"\n    ":"\n    You have moved the item from position "+n+"\n    in list "+e.droppableId+"\n    to list "+t.droppableId+"\n    in position "+i+"\n  "},dl=function(e,t,r){return t.droppableId===r.droppableId?"\n      The item "+e+"\n      has been combined with "+r.draggableId:"\n      The item "+e+"\n      in list "+t.droppableId+"\n      has been combined with "+r.draggableId+"\n      in list "+r.droppableId+"\n    "},pl=function(e){return"\n  The item has returned to its starting position\n  of "+ul(e.index)+"\n"},fl={dragHandleUsageInstructions:"\n  Press space bar to start a drag.\n  When dragging you can use the arrow keys to move the item around and escape to cancel.\n  Some screen readers may require you to be in focus mode or to use your pass through key\n",onDragStart:function(e){return"\n  You have lifted an item in position "+ul(e.source.index)+"\n"},onDragUpdate:function(e){var t=e.destination;if(t)return cl(e.source,t);var r=e.combine;return r?dl(e.draggableId,e.source,r):"You are over an area that cannot be dropped on"},onDragEnd:function(e){if("CANCEL"===e.reason)return"\n      Movement cancelled.\n      "+pl(e.source)+"\n    ";var t=e.destination,r=e.combine;return t?"\n      You have dropped the item.\n      "+cl(e.source,t)+"\n    ":r?"\n      You have dropped the item.\n      "+dl(e.draggableId,e.source,r)+"\n    ":"\n    The item has been dropped while not over a drop area.\n    "+pl(e.source)+"\n  "}},ml={x:0,y:0},hl=function(e,t){return{x:e.x+t.x,y:e.y+t.y}},gl=function(e,t){return{x:e.x-t.x,y:e.y-t.y}},yl=function(e,t){return e.x===t.x&&e.y===t.y},vl=function(e){return{x:0!==e.x?-e.x:0,y:0!==e.y?-e.y:0}},bl=function(e,t,r){var n;return void 0===r&&(r=0),(n={})[e]=t,n["x"===e?"y":"x"]=r,n},Ol=function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},wl=function(e,t){return Math.min.apply(Math,t.map((function(t){return Ol(e,t)})))},_l=function(e){return function(t){return{x:e(t.x),y:e(t.y)}}},Sl=function(e,t){return{top:e.top+t.y,left:e.left+t.x,bottom:e.bottom+t.y,right:e.right+t.x}},El=function(e){return[{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.left,y:e.bottom},{x:e.right,y:e.bottom}]},xl=function(e,t){return t&&t.shouldClipSubject?function(e,t){var r=Fs({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return r.width<=0||r.height<=0?null:r}(t.pageMarginBox,e):Fs(e)},Tl=function(e){var t=e.page,r=e.withPlaceholder,n=e.axis,i=e.frame,a=function(e,t){return t?Sl(e,t.scroll.diff.displacement):e}(t.marginBox,i),o=function(e,t,r){var n;return r&&r.increasedBy?Ds({},e,((n={})[t.end]=e[t.end]+r.increasedBy[t.line],n)):e}(a,n,r);return{page:t,withPlaceholder:r,active:xl(o,i)}},Pl=function(e,t){e.frame||sl(!1);var r=e.frame,n=gl(t,r.scroll.initial),i=vl(n),a=Ds({},r,{scroll:{initial:r.scroll.initial,current:t,diff:{value:n,displacement:i},max:r.scroll.max}});return Ds({},e,{frame:a,subject:Tl({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:a})})};function kl(e){return Object.values?Object.values(e):Object.keys(e).map((function(t){return e[t]}))}function Il(e,t){if(e.findIndex)return e.findIndex(t);for(var r=0;r<e.length;r++)if(t(e[r]))return r;return-1}function Cl(e,t){if(e.find)return e.find(t);var r=Il(e,t);return-1!==r?e[r]:void 0}function Al(e){return Array.prototype.slice.call(e)}var ql=Ys((function(e){return e.reduce((function(e,t){return e[t.descriptor.id]=t,e}),{})})),Rl=Ys((function(e){return e.reduce((function(e,t){return e[t.descriptor.id]=t,e}),{})})),Dl=Ys((function(e){return kl(e)})),Nl=Ys((function(e){return kl(e)})),Ll=Ys((function(e,t){var r=Nl(t).filter((function(t){return e===t.descriptor.droppableId})).sort((function(e,t){return e.descriptor.index-t.descriptor.index}));return r}));function jl(e){return e.at&&"REORDER"===e.at.type?e.at.destination:null}function Ml(e){return e.at&&"COMBINE"===e.at.type?e.at.combine:null}var Fl=Ys((function(e,t){return t.filter((function(t){return t.descriptor.id!==e.descriptor.id}))})),Bl=function(e,t){return e.descriptor.droppableId===t.descriptor.id},Ql={point:ml,value:0},$l={invisible:{},visible:{},all:[]},Vl={displaced:$l,displacedBy:Ql,at:null},Xl=function(e,t){return function(r){return e<=r&&r<=t}},Gl=function(e){var t=Xl(e.top,e.bottom),r=Xl(e.left,e.right);return function(n){if(t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right))return!0;var i=t(n.top)||t(n.bottom),a=r(n.left)||r(n.right);if(i&&a)return!0;var o=n.top<e.top&&n.bottom>e.bottom,s=n.left<e.left&&n.right>e.right;return!(!o||!s)||o&&a||s&&i}},Ul=function(e){var t=Xl(e.top,e.bottom),r=Xl(e.left,e.right);return function(e){return t(e.top)&&t(e.bottom)&&r(e.left)&&r(e.right)}},zl={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},Wl={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"},Kl=function(e){var t=e.target,r=e.destination,n=e.viewport,i=e.withDroppableDisplacement,a=e.isVisibleThroughFrameFn,o=i?function(e,t){var r=t.frame?t.frame.scroll.diff.displacement:ml;return Sl(e,r)}(t,r):t;return function(e,t,r){return!!t.subject.active&&r(t.subject.active)(e)}(o,r,a)&&function(e,t,r){return r(t)(e)}(o,n,a)},Hl=function(e){return Kl(Ds({},e,{isVisibleThroughFrameFn:Gl}))},Yl=function(e){return Kl(Ds({},e,{isVisibleThroughFrameFn:Ul}))},Zl=function(e,t,r){if("boolean"==typeof r)return r;if(!t)return!0;var n=t.invisible,i=t.visible;if(n[e])return!1;var a=i[e];return!a||a.shouldAnimate};function Jl(e){var t=e.afterDragging,r=e.destination,n=e.displacedBy,i=e.viewport,a=e.forceShouldAnimate,o=e.last;return t.reduce((function(e,t){var s=function(e,t){var r=e.page.marginBox,n={top:t.point.y,right:0,bottom:0,left:t.point.x};return Fs(Bs(r,n))}(t,n),l=t.descriptor.id;if(e.all.push(l),!Hl({target:s,destination:r,viewport:i,withDroppableDisplacement:!0}))return e.invisible[t.descriptor.id]=!0,e;var u={draggableId:l,shouldAnimate:Zl(l,o,a)};return e.visible[l]=u,e}),{all:[],visible:{},invisible:{}})}function eu(e){var t=e.insideDestination,r=e.inHomeList,n=e.displacedBy,i=e.destination,a=function(e,t){if(!e.length)return 0;var r=e[e.length-1].descriptor.index;return t.inHomeList?r:r+1}(t,{inHomeList:r});return{displaced:$l,displacedBy:n,at:{type:"REORDER",destination:{droppableId:i.descriptor.id,index:a}}}}function tu(e){var t=e.draggable,r=e.insideDestination,n=e.destination,i=e.viewport,a=e.displacedBy,o=e.last,s=e.index,l=e.forceShouldAnimate,u=Bl(t,n);if(null==s)return eu({insideDestination:r,inHomeList:u,displacedBy:a,destination:n});var c=Cl(r,(function(e){return e.descriptor.index===s}));if(!c)return eu({insideDestination:r,inHomeList:u,displacedBy:a,destination:n});var d=Fl(t,r),p=r.indexOf(c);return{displaced:Jl({afterDragging:d.slice(p),destination:n,displacedBy:a,last:o,viewport:i.frame,forceShouldAnimate:l}),displacedBy:a,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:s}}}}function ru(e,t){return Boolean(t.effected[e])}var nu=function(e,t){return t.margin[e.start]+t.borderBox[e.size]/2},iu=function(e,t,r){return t[e.crossAxisStart]+r.margin[e.crossAxisStart]+r.borderBox[e.crossAxisSize]/2},au=function(e){var t=e.axis,r=e.moveRelativeTo,n=e.isMoving;return bl(t.line,r.marginBox[t.end]+nu(t,n),iu(t,r.marginBox,n))},ou=function(e){var t=e.axis,r=e.moveRelativeTo,n=e.isMoving;return bl(t.line,r.marginBox[t.start]-function(e,t){return t.margin[e.end]+t.borderBox[e.size]/2}(t,n),iu(t,r.marginBox,n))},su=function(e,t){var r=e.frame;return r?hl(t,r.scroll.diff.displacement):t},lu=function(e){var t=function(e){var t=e.impact,r=e.draggable,n=e.droppable,i=e.draggables,a=e.afterCritical,o=r.page.borderBox.center,s=t.at;return n&&s?"REORDER"===s.type?function(e){var t=e.impact,r=e.draggable,n=e.draggables,i=e.droppable,a=e.afterCritical,o=Ll(i.descriptor.id,n),s=r.page,l=i.axis;if(!o.length)return function(e){var t=e.axis,r=e.moveInto,n=e.isMoving;return bl(t.line,r.contentBox[t.start]+nu(t,n),iu(t,r.contentBox,n))}({axis:l,moveInto:i.page,isMoving:s});var u=t.displaced,c=t.displacedBy,d=u.all[0];if(d){var p=n[d];if(ru(d,a))return ou({axis:l,moveRelativeTo:p.page,isMoving:s});var f=Gs(p.page,c.point);return ou({axis:l,moveRelativeTo:f,isMoving:s})}var m=o[o.length-1];if(m.descriptor.id===r.descriptor.id)return s.borderBox.center;if(ru(m.descriptor.id,a)){var h=Gs(m.page,vl(a.displacedBy.point));return au({axis:l,moveRelativeTo:h,isMoving:s})}return au({axis:l,moveRelativeTo:m.page,isMoving:s})}({impact:t,draggable:r,draggables:i,droppable:n,afterCritical:a}):function(e){var t=e.afterCritical,r=e.impact,n=e.draggables,i=Ml(r);i||sl(!1);var a=i.draggableId,o=n[a].page.borderBox.center,s=function(e){var t=e.displaced,r=e.afterCritical,n=e.combineWith,i=e.displacedBy,a=Boolean(t.visible[n]||t.invisible[n]);return ru(n,r)?a?ml:vl(i.point):a?i.point:ml}({displaced:r.displaced,afterCritical:t,combineWith:a,displacedBy:r.displacedBy});return hl(o,s)}({impact:t,draggables:i,afterCritical:a}):o}(e),r=e.droppable;return r?su(r,t):t},uu=function(e,t){var r=gl(t,e.scroll.initial),n=vl(r);return{frame:Fs({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:r,displacement:n}}}};function cu(e,t){return e.map((function(e){return t[e]}))}var du=function(e){var t=e.pageBorderBoxCenter,r=e.draggable,n=function(e,t){return hl(e.scroll.diff.displacement,t)}(e.viewport,t),i=gl(n,r.page.borderBox.center);return hl(r.client.borderBox.center,i)},pu=function(e){var t=e.draggable,r=e.destination,n=e.newPageBorderBoxCenter,i=e.viewport,a=e.withDroppableDisplacement,o=e.onlyOnMainAxis,s=void 0!==o&&o,l=gl(n,t.page.borderBox.center),u={target:Sl(t.page.borderBox,l),destination:r,withDroppableDisplacement:a,viewport:i};return s?function(e){return Kl(Ds({},e,{isVisibleThroughFrameFn:(t=e.destination.axis,function(e){var r=Xl(e.top,e.bottom),n=Xl(e.left,e.right);return function(e){return t===zl?r(e.top)&&r(e.bottom):n(e.left)&&n(e.right)}})}));var t}(u):Yl(u)},fu=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,i=e.draggables,a=e.previousImpact,o=e.viewport,s=e.previousPageBorderBoxCenter,l=e.previousClientSelection,u=e.afterCritical;if(!n.isEnabled)return null;var c=Ll(n.descriptor.id,i),d=Bl(r,n),p=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,i=e.insideDestination,a=e.previousImpact;if(!n.isCombineEnabled)return null;if(!jl(a))return null;function o(e){var t={type:"COMBINE",combine:{draggableId:e,droppableId:n.descriptor.id}};return Ds({},a,{at:t})}var s=a.displaced.all,l=s.length?s[0]:null;if(t)return l?o(l):null;var u=Fl(r,i);if(!l)return u.length?o(u[u.length-1].descriptor.id):null;var c=Il(u,(function(e){return e.descriptor.id===l}));-1===c&&sl(!1);var d=c-1;return d<0?null:o(u[d].descriptor.id)}({isMovingForward:t,draggable:r,destination:n,insideDestination:c,previousImpact:a})||function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.draggable,i=e.draggables,a=e.destination,o=e.insideDestination,s=e.previousImpact,l=e.viewport,u=e.afterCritical,c=s.at;if(c||sl(!1),"REORDER"===c.type){var d=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.insideDestination,i=e.location;if(!n.length)return null;var a=i.index,o=t?a+1:a-1,s=n[0].descriptor.index,l=n[n.length-1].descriptor.index;return o<s||o>(r?l:l+1)?null:o}({isMovingForward:t,isInHomeList:r,location:c.destination,insideDestination:o});return null==d?null:tu({draggable:n,insideDestination:o,destination:a,viewport:l,last:s.displaced,displacedBy:s.displacedBy,index:d})}var p=function(e){var t=e.isMovingForward,r=e.draggables,n=e.combine,i=e.afterCritical;if(!e.destination.isCombineEnabled)return null;var a=n.draggableId,o=r[a].descriptor.index;return ru(a,i)?t?o:o-1:t?o+1:o}({isMovingForward:t,destination:a,displaced:s.displaced,draggables:i,combine:c.combine,afterCritical:u});return null==p?null:tu({draggable:n,insideDestination:o,destination:a,viewport:l,last:s.displaced,displacedBy:s.displacedBy,index:p})}({isMovingForward:t,isInHomeList:d,draggable:r,draggables:i,destination:n,insideDestination:c,previousImpact:a,viewport:o,afterCritical:u});if(!p)return null;var f=lu({impact:p,draggable:r,droppable:n,draggables:i,afterCritical:u});if(pu({draggable:r,destination:n,newPageBorderBoxCenter:f,viewport:o.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:du({pageBorderBoxCenter:f,draggable:r,viewport:o}),impact:p,scrollJumpRequest:null};var m=gl(f,s),h=function(e){var t=e.impact,r=e.viewport,n=e.destination,i=e.draggables,a=e.maxScrollChange,o=uu(r,hl(r.scroll.current,a)),s=n.frame?Pl(n,hl(n.frame.scroll.current,a)):n,l=t.displaced,u=Jl({afterDragging:cu(l.all,i),destination:n,displacedBy:t.displacedBy,viewport:o.frame,last:l,forceShouldAnimate:!1}),c=Jl({afterDragging:cu(l.all,i),destination:s,displacedBy:t.displacedBy,viewport:r.frame,last:l,forceShouldAnimate:!1}),d={},p={},f=[l,u,c];return l.all.forEach((function(e){var t=function(e,t){for(var r=0;r<t.length;r++){var n=t[r].visible[e];if(n)return n}return null}(e,f);t?p[e]=t:d[e]=!0})),Ds({},t,{displaced:{all:l.all,invisible:d,visible:p}})}({impact:p,viewport:o,destination:n,draggables:i,maxScrollChange:m});return{clientSelection:l,impact:h,scrollJumpRequest:m}},mu=function(e){var t=e.subject.active;return t||sl(!1),t},hu=function(e,t){var r=e.page.borderBox.center;return ru(e.descriptor.id,t)?gl(r,t.displacedBy.point):r},gu=function(e,t){var r=e.page.borderBox;return ru(e.descriptor.id,t)?Sl(r,vl(t.displacedBy.point)):r},yu=Ys((function(e,t){var r=t[e.line];return{value:r,point:bl(e.line,r)}})),vu=function(e,t){return Ds({},e,{scroll:Ds({},e.scroll,{max:t})})},bu=function(e,t,r){var n=e.frame;Bl(t,e)&&sl(!1),e.subject.withPlaceholder&&sl(!1);var i=yu(e.axis,t.displaceBy).point,a=function(e,t,r){var n=e.axis;if("virtual"===e.descriptor.mode)return bl(n.line,t[n.line]);var i=e.subject.page.contentBox[n.size],a=Ll(e.descriptor.id,r).reduce((function(e,t){return e+t.client.marginBox[n.size]}),0)+t[n.line]-i;return a<=0?null:bl(n.line,a)}(e,i,r),o={placeholderSize:i,increasedBy:a,oldFrameMaxScroll:e.frame?e.frame.scroll.max:null};if(!n)return Ds({},e,{subject:Tl({page:e.subject.page,withPlaceholder:o,axis:e.axis,frame:e.frame})});var s=a?hl(n.scroll.max,a):n.scroll.max,l=vu(n,s);return Ds({},e,{subject:Tl({page:e.subject.page,withPlaceholder:o,axis:e.axis,frame:l}),frame:l})},Ou=function(e){var t=e.at;return t?"REORDER"===t.type?t.destination.droppableId:t.combine.droppableId:null},wu=function(e){var t=e.state,r=e.type,n=function(e,t){var r=Ou(e);return r?t[r]:null}(t.impact,t.dimensions.droppables),i=Boolean(n),a=t.dimensions.droppables[t.critical.droppable.id],o=n||a,s=o.axis.direction,l="vertical"===s&&("MOVE_UP"===r||"MOVE_DOWN"===r)||"horizontal"===s&&("MOVE_LEFT"===r||"MOVE_RIGHT"===r);if(l&&!i)return null;var u="MOVE_DOWN"===r||"MOVE_RIGHT"===r,c=t.dimensions.draggables[t.critical.draggable.id],d=t.current.page.borderBoxCenter,p=t.dimensions,f=p.draggables,m=p.droppables;return l?fu({isMovingForward:u,previousPageBorderBoxCenter:d,draggable:c,destination:o,draggables:f,viewport:t.viewport,previousClientSelection:t.current.client.selection,previousImpact:t.impact,afterCritical:t.afterCritical}):function(e){var t=e.isMovingForward,r=e.previousPageBorderBoxCenter,n=e.draggable,i=e.isOver,a=e.draggables,o=e.droppables,s=e.viewport,l=e.afterCritical,u=function(e){var t=e.isMovingForward,r=e.pageBorderBoxCenter,n=e.source,i=e.droppables,a=e.viewport,o=n.subject.active;if(!o)return null;var s=n.axis,l=Xl(o[s.start],o[s.end]),u=Dl(i).filter((function(e){return e!==n})).filter((function(e){return e.isEnabled})).filter((function(e){return Boolean(e.subject.active)})).filter((function(e){return Gl(a.frame)(mu(e))})).filter((function(e){var r=mu(e);return t?o[s.crossAxisEnd]<r[s.crossAxisEnd]:r[s.crossAxisStart]<o[s.crossAxisStart]})).filter((function(e){var t=mu(e),r=Xl(t[s.start],t[s.end]);return l(t[s.start])||l(t[s.end])||r(o[s.start])||r(o[s.end])})).sort((function(e,r){var n=mu(e)[s.crossAxisStart],i=mu(r)[s.crossAxisStart];return t?n-i:i-n})).filter((function(e,t,r){return mu(e)[s.crossAxisStart]===mu(r[0])[s.crossAxisStart]}));if(!u.length)return null;if(1===u.length)return u[0];var c=u.filter((function(e){return Xl(mu(e)[s.start],mu(e)[s.end])(r[s.line])}));return 1===c.length?c[0]:c.length>1?c.sort((function(e,t){return mu(e)[s.start]-mu(t)[s.start]}))[0]:u.sort((function(e,t){var n=wl(r,El(mu(e))),i=wl(r,El(mu(t)));return n!==i?n-i:mu(e)[s.start]-mu(t)[s.start]}))[0]}({isMovingForward:t,pageBorderBoxCenter:r,source:i,droppables:o,viewport:s});if(!u)return null;var c=Ll(u.descriptor.id,a),d=function(e){var t=e.pageBorderBoxCenter,r=e.viewport,n=e.destination,i=e.afterCritical,a=e.insideDestination.filter((function(e){return Yl({target:gu(e,i),destination:n,viewport:r.frame,withDroppableDisplacement:!0})})).sort((function(e,r){var a=Ol(t,su(n,hu(e,i))),o=Ol(t,su(n,hu(r,i)));return a<o?-1:o<a?1:e.descriptor.index-r.descriptor.index}));return a[0]||null}({pageBorderBoxCenter:r,viewport:s,destination:u,insideDestination:c,afterCritical:l}),p=function(e){var t=e.previousPageBorderBoxCenter,r=e.moveRelativeTo,n=e.insideDestination,i=e.draggable,a=e.draggables,o=e.destination,s=e.viewport,l=e.afterCritical;if(!r){if(n.length)return null;var u={displaced:$l,displacedBy:Ql,at:{type:"REORDER",destination:{droppableId:o.descriptor.id,index:0}}},c=lu({impact:u,draggable:i,droppable:o,draggables:a,afterCritical:l}),d=Bl(i,o)?o:bu(o,i,a);return pu({draggable:i,destination:d,newPageBorderBoxCenter:c,viewport:s.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?u:null}var p,f=Boolean(t[o.axis.line]<=r.page.borderBox.center[o.axis.line]),m=(p=r.descriptor.index,r.descriptor.id===i.descriptor.id||f?p:p+1);return tu({draggable:i,insideDestination:n,destination:o,viewport:s,displacedBy:yu(o.axis,i.displaceBy),last:$l,index:m})}({previousPageBorderBoxCenter:r,destination:u,draggable:n,draggables:a,moveRelativeTo:d,insideDestination:c,viewport:s,afterCritical:l});if(!p)return null;var f=lu({impact:p,draggable:n,droppable:u,draggables:a,afterCritical:l});return{clientSelection:du({pageBorderBoxCenter:f,draggable:n,viewport:s}),impact:p,scrollJumpRequest:null}}({isMovingForward:u,previousPageBorderBoxCenter:d,draggable:c,isOver:o,draggables:f,droppables:m,viewport:t.viewport,afterCritical:t.afterCritical})};function _u(e){return"DRAGGING"===e.phase||"COLLECTING"===e.phase}function Su(e){var t=Xl(e.top,e.bottom),r=Xl(e.left,e.right);return function(e){return t(e.y)&&r(e.x)}}var Eu=function(e,t){return Fs(Sl(e,t))};function xu(e){var t=e.displaced,r=e.id;return Boolean(t.visible[r]||t.invisible[r])}var Tu=function(e){var t=e.pageOffset,r=e.draggable,n=e.draggables,i=e.droppables,a=e.previousImpact,o=e.viewport,s=e.afterCritical,l=Eu(r.page.borderBox,t),u=function(e){var t=e.pageBorderBox,r=e.draggable,n=e.droppables,i=Dl(n).filter((function(e){if(!e.isEnabled)return!1;var r,n,i=e.subject.active;if(!i)return!1;if(n=i,!((r=t).left<n.right&&r.right>n.left&&r.top<n.bottom&&r.bottom>n.top))return!1;if(Su(i)(t.center))return!0;var a=e.axis,o=i.center[a.crossAxisLine],s=t[a.crossAxisStart],l=t[a.crossAxisEnd],u=Xl(i[a.crossAxisStart],i[a.crossAxisEnd]),c=u(s),d=u(l);return!c&&!d||(c?s<o:l>o)}));return i.length?1===i.length?i[0].descriptor.id:function(e){var t=e.pageBorderBox,r=e.candidates,n=e.draggable.page.borderBox.center,i=r.map((function(e){var r=e.axis,i=bl(e.axis.line,t.center[r.line],e.page.borderBox.center[r.crossAxisLine]);return{id:e.descriptor.id,distance:Ol(n,i)}})).sort((function(e,t){return t.distance-e.distance}));return i[0]?i[0].id:null}({pageBorderBox:t,draggable:r,candidates:i}):null}({pageBorderBox:l,draggable:r,droppables:i});if(!u)return Vl;var c=i[u],d=Ll(c.descriptor.id,n),p=function(e,t){var r=e.frame;return r?Eu(t,r.scroll.diff.value):t}(c,l);return function(e){var t=e.draggable,r=e.pageBorderBoxWithDroppableScroll,n=e.previousImpact,i=e.destination,a=e.insideDestination,o=e.afterCritical;if(!i.isCombineEnabled)return null;var s=i.axis,l=yu(i.axis,t.displaceBy),u=l.value,c=r[s.start],d=r[s.end],p=Cl(Fl(t,a),(function(e){var t=e.descriptor.id,r=e.page.borderBox,i=r[s.size]/4,a=ru(t,o),l=xu({displaced:n.displaced,id:t});return a?l?d>r[s.start]+i&&d<r[s.end]-i:c>r[s.start]-u+i&&c<r[s.end]-u-i:l?d>r[s.start]+u+i&&d<r[s.end]+u-i:c>r[s.start]+i&&c<r[s.end]-i}));return p?{displacedBy:l,displaced:n.displaced,at:{type:"COMBINE",combine:{draggableId:p.descriptor.id,droppableId:i.descriptor.id}}}:null}({pageBorderBoxWithDroppableScroll:p,draggable:r,previousImpact:a,destination:c,insideDestination:d,afterCritical:s})||function(e){var t=e.pageBorderBoxWithDroppableScroll,r=e.draggable,n=e.destination,i=e.insideDestination,a=e.last,o=e.viewport,s=e.afterCritical,l=n.axis,u=yu(n.axis,r.displaceBy),c=u.value,d=t[l.start],p=t[l.end],f=function(e){var t=e.draggable,r=e.closest;return r?e.inHomeList&&r.descriptor.index>t.descriptor.index?r.descriptor.index-1:r.descriptor.index:null}({draggable:r,closest:Cl(Fl(r,i),(function(e){var t=e.descriptor.id,r=e.page.borderBox.center[l.line],n=ru(t,s),i=xu({displaced:a,id:t});return n?i?p<=r:d<r-c:i?p<=r+c:d<r})),inHomeList:Bl(r,n)});return tu({draggable:r,insideDestination:i,destination:n,viewport:o,last:a,displacedBy:u,index:f})}({pageBorderBoxWithDroppableScroll:p,draggable:r,destination:c,insideDestination:d,last:a.displaced,viewport:o,afterCritical:s})},Pu=function(e,t){var r;return Ds({},e,((r={})[t.descriptor.id]=t,r))},ku=function(e){var t=e.state,r=e.clientSelection,n=e.dimensions,i=e.viewport,a=e.impact,o=e.scrollJumpRequest,s=i||t.viewport,l=n||t.dimensions,u=r||t.current.client.selection,c=gl(u,t.initial.client.selection),d={offset:c,selection:u,borderBoxCenter:hl(t.initial.client.borderBoxCenter,c)},p={selection:hl(d.selection,s.scroll.current),borderBoxCenter:hl(d.borderBoxCenter,s.scroll.current),offset:hl(d.offset,s.scroll.diff.value)},f={client:d,page:p};if("COLLECTING"===t.phase)return Ds({phase:"COLLECTING"},t,{dimensions:l,viewport:s,current:f});var m=l.draggables[t.critical.draggable.id],h=a||Tu({pageOffset:p.offset,draggable:m,draggables:l.draggables,droppables:l.droppables,previousImpact:t.impact,viewport:s,afterCritical:t.afterCritical}),g=function(e){var t=e.draggable,r=e.draggables,n=e.droppables,i=e.impact,a=function(e){var t=e.previousImpact,r=e.impact,n=e.droppables,i=Ou(t),a=Ou(r);if(!i)return n;if(i===a)return n;var o=n[i];if(!o.subject.withPlaceholder)return n;var s=function(e){var t=e.subject.withPlaceholder;t||sl(!1);var r=e.frame;if(!r)return Ds({},e,{subject:Tl({page:e.subject.page,axis:e.axis,frame:null,withPlaceholder:null})});var n=t.oldFrameMaxScroll;n||sl(!1);var i=vu(r,n);return Ds({},e,{subject:Tl({page:e.subject.page,axis:e.axis,frame:i,withPlaceholder:null}),frame:i})}(o);return Pu(n,s)}({previousImpact:e.previousImpact,impact:i,droppables:n}),o=Ou(i);if(!o)return a;var s=n[o];if(Bl(t,s))return a;if(s.subject.withPlaceholder)return a;var l=bu(s,t,r);return Pu(a,l)}({draggable:m,impact:h,previousImpact:t.impact,draggables:l.draggables,droppables:l.droppables});return Ds({},t,{current:f,dimensions:{draggables:l.draggables,droppables:g},impact:h,viewport:s,scrollJumpRequest:o||null,forceShouldAnimate:!o&&null})},Iu=function(e){var t=e.impact,r=e.viewport,n=e.draggables,i=e.destination,a=e.forceShouldAnimate,o=t.displaced,s=function(e,t){return e.map((function(e){return t[e]}))}(o.all,n);return Ds({},t,{displaced:Jl({afterDragging:s,destination:i,displacedBy:t.displacedBy,viewport:r.frame,forceShouldAnimate:a,last:o})})},Cu=function(e){var t=e.impact,r=e.draggable,n=e.droppable,i=e.draggables,a=e.viewport,o=e.afterCritical,s=lu({impact:t,draggable:r,draggables:i,droppable:n,afterCritical:o});return du({pageBorderBoxCenter:s,draggable:r,viewport:a})},Au=function(e){var t=e.state,r=e.dimensions,n=e.viewport;"SNAP"!==t.movementMode&&sl(!1);var i=t.impact,a=n||t.viewport,o=r||t.dimensions,s=o.draggables,l=o.droppables,u=s[t.critical.draggable.id],c=Ou(i);c||sl(!1);var d=l[c],p=Iu({impact:i,viewport:a,destination:d,draggables:s}),f=Cu({impact:p,draggable:u,droppable:d,draggables:s,viewport:a,afterCritical:t.afterCritical});return ku({impact:p,clientSelection:f,state:t,dimensions:o,viewport:a})},qu=function(e){var t=e.draggable,r=e.home,n=e.draggables,i=e.viewport,a=yu(r.axis,t.displaceBy),o=Ll(r.descriptor.id,n),s=o.indexOf(t);-1===s&&sl(!1);var l,u=o.slice(s+1),c=u.reduce((function(e,t){return e[t.descriptor.id]=!0,e}),{}),d={inVirtualList:"virtual"===r.descriptor.mode,displacedBy:a,effected:c};return{impact:{displaced:Jl({afterDragging:u,destination:r,displacedBy:a,last:null,viewport:i.frame,forceShouldAnimate:!1}),displacedBy:a,at:{type:"REORDER",destination:(l=t.descriptor,{index:l.index,droppableId:l.droppableId})}},afterCritical:d}},Ru=function(e){return"SNAP"===e.movementMode},Du=function(e,t,r){var n=function(e,t){return{draggables:e.draggables,droppables:Pu(e.droppables,t)}}(e.dimensions,t);return!Ru(e)||r?ku({state:e,dimensions:n}):Au({state:e,dimensions:n})};function Nu(e){return e.isDragging&&"SNAP"===e.movementMode?Ds({phase:"DRAGGING"},e,{scrollJumpRequest:null}):e}var Lu={phase:"IDLE",completed:null,shouldFlush:!1},ju=function(e,t){if(void 0===e&&(e=Lu),"FLUSH"===t.type)return Ds({},Lu,{shouldFlush:!0});if("INITIAL_PUBLISH"===t.type){"IDLE"!==e.phase&&sl(!1);var r=t.payload,n=r.critical,i=r.clientSelection,a=r.viewport,o=r.dimensions,s=r.movementMode,l=o.draggables[n.draggable.id],u=o.droppables[n.droppable.id],c={selection:i,borderBoxCenter:l.client.borderBox.center,offset:ml},d={client:c,page:{selection:hl(c.selection,a.scroll.initial),borderBoxCenter:hl(c.selection,a.scroll.initial),offset:hl(c.selection,a.scroll.diff.value)}},p=Dl(o.droppables).every((function(e){return!e.isFixedOnPage})),f=qu({draggable:l,home:u,draggables:o.draggables,viewport:a}),m=f.impact;return{phase:"DRAGGING",isDragging:!0,critical:n,movementMode:s,dimensions:o,initial:d,current:d,isWindowScrollAllowed:p,impact:m,afterCritical:f.afterCritical,onLiftImpact:m,viewport:a,scrollJumpRequest:null,forceShouldAnimate:null}}if("COLLECTION_STARTING"===t.type)return"COLLECTING"===e.phase||"DROP_PENDING"===e.phase?e:("DRAGGING"!==e.phase&&sl(!1),Ds({phase:"COLLECTING"},e,{phase:"COLLECTING"}));if("PUBLISH_WHILE_DRAGGING"===t.type)return"COLLECTING"!==e.phase&&"DROP_PENDING"!==e.phase&&sl(!1),function(e){var t=e.state,r=e.published,n=r.modified.map((function(e){var r=t.dimensions.droppables[e.droppableId];return Pl(r,e.scroll)})),i=Ds({},t.dimensions.droppables,{},ql(n)),a=Rl(function(e){var t=e.additions,r=e.updatedDroppables,n=e.viewport,i=n.scroll.diff.value;return t.map((function(e){var t=e.descriptor.droppableId,a=function(e){var t=e.frame;return t||sl(!1),t}(r[t]),o=a.scroll.diff.value,s=function(e){var t=e.draggable,r=e.offset,n=e.initialWindowScroll,i=Gs(t.client,r),a=Us(i,n);return Ds({},t,{placeholder:Ds({},t.placeholder,{client:i}),client:i,page:a})}({draggable:e,offset:hl(i,o),initialWindowScroll:n.scroll.initial});return s}))}({additions:r.additions,updatedDroppables:i,viewport:t.viewport})),o=Ds({},t.dimensions.draggables,{},a);r.removals.forEach((function(e){delete o[e]}));var s={droppables:i,draggables:o},l=Ou(t.impact),u=l?s.droppables[l]:null,c=s.draggables[t.critical.draggable.id],d=s.droppables[t.critical.droppable.id],p=qu({draggable:c,home:d,draggables:o,viewport:t.viewport}),f=p.impact,m=p.afterCritical,h=u&&u.isCombineEnabled?t.impact:f,g=Tu({pageOffset:t.current.page.offset,draggable:s.draggables[t.critical.draggable.id],draggables:s.draggables,droppables:s.droppables,previousImpact:h,viewport:t.viewport,afterCritical:m}),y=Ds({phase:"DRAGGING"},t,{phase:"DRAGGING",impact:g,onLiftImpact:f,dimensions:s,afterCritical:m,forceShouldAnimate:!1});return"COLLECTING"===t.phase?y:Ds({phase:"DROP_PENDING"},y,{phase:"DROP_PENDING",reason:t.reason,isWaiting:!1})}({state:e,published:t.payload});if("MOVE"===t.type){if("DROP_PENDING"===e.phase)return e;_u(e)||sl(!1);var h=t.payload.client;return yl(h,e.current.client.selection)?e:ku({state:e,clientSelection:h,impact:Ru(e)?e.impact:null})}if("UPDATE_DROPPABLE_SCROLL"===t.type){if("DROP_PENDING"===e.phase)return Nu(e);if("COLLECTING"===e.phase)return Nu(e);_u(e)||sl(!1);var g=t.payload,y=g.id,v=g.newScroll,b=e.dimensions.droppables[y];if(!b)return e;var O=Pl(b,v);return Du(e,O,!1)}if("UPDATE_DROPPABLE_IS_ENABLED"===t.type){if("DROP_PENDING"===e.phase)return e;_u(e)||sl(!1);var w=t.payload,_=w.id,S=w.isEnabled,E=e.dimensions.droppables[_];E||sl(!1),E.isEnabled===S&&sl(!1);var x=Ds({},E,{isEnabled:S});return Du(e,x,!0)}if("UPDATE_DROPPABLE_IS_COMBINE_ENABLED"===t.type){if("DROP_PENDING"===e.phase)return e;_u(e)||sl(!1);var T=t.payload,P=T.id,k=T.isCombineEnabled,I=e.dimensions.droppables[P];I||sl(!1),I.isCombineEnabled===k&&sl(!1);var C=Ds({},I,{isCombineEnabled:k});return Du(e,C,!0)}if("MOVE_BY_WINDOW_SCROLL"===t.type){if("DROP_PENDING"===e.phase||"DROP_ANIMATING"===e.phase)return e;_u(e)||sl(!1),e.isWindowScrollAllowed||sl(!1);var A=t.payload.newScroll;if(yl(e.viewport.scroll.current,A))return Nu(e);var q=uu(e.viewport,A);return Ru(e)?Au({state:e,viewport:q}):ku({state:e,viewport:q})}if("UPDATE_VIEWPORT_MAX_SCROLL"===t.type){if(!_u(e))return e;var R=t.payload.maxScroll;if(yl(R,e.viewport.scroll.max))return e;var D=Ds({},e.viewport,{scroll:Ds({},e.viewport.scroll,{max:R})});return Ds({phase:"DRAGGING"},e,{viewport:D})}if("MOVE_UP"===t.type||"MOVE_DOWN"===t.type||"MOVE_LEFT"===t.type||"MOVE_RIGHT"===t.type){if("COLLECTING"===e.phase||"DROP_PENDING"===e.phase)return e;"DRAGGING"!==e.phase&&sl(!1);var N=wu({state:e,type:t.type});return N?ku({state:e,impact:N.impact,clientSelection:N.clientSelection,scrollJumpRequest:N.scrollJumpRequest}):e}if("DROP_PENDING"===t.type){var L=t.payload.reason;return"COLLECTING"!==e.phase&&sl(!1),Ds({phase:"DROP_PENDING"},e,{phase:"DROP_PENDING",isWaiting:!0,reason:L})}if("DROP_ANIMATE"===t.type){var j=t.payload,M=j.completed,F=j.dropDuration,B=j.newHomeClientOffset;return"DRAGGING"!==e.phase&&"DROP_PENDING"!==e.phase&&sl(!1),{phase:"DROP_ANIMATING",completed:M,dropDuration:F,newHomeClientOffset:B,dimensions:e.dimensions}}return"DROP_COMPLETE"===t.type?{phase:"IDLE",completed:t.payload.completed,shouldFlush:!1}:e},Mu=function(e){return{type:"LIFT",payload:e}},Fu=function(e){return{type:"PUBLISH_WHILE_DRAGGING",payload:e}},Bu=function(){return{type:"COLLECTION_STARTING",payload:null}},Qu=function(e){return{type:"UPDATE_DROPPABLE_SCROLL",payload:e}},$u=function(e){return{type:"UPDATE_DROPPABLE_IS_ENABLED",payload:e}},Vu=function(e){return{type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:e}},Xu=function(e){return{type:"MOVE",payload:e}},Gu=function(){return{type:"MOVE_UP",payload:null}},Uu=function(){return{type:"MOVE_DOWN",payload:null}},zu=function(){return{type:"MOVE_RIGHT",payload:null}},Wu=function(){return{type:"MOVE_LEFT",payload:null}},Ku=function(){return{type:"FLUSH",payload:null}},Hu=function(e){return{type:"DROP_COMPLETE",payload:e}},Yu=function(e){return{type:"DROP",payload:e}},Zu="cubic-bezier(.2,1,.1,1)",Ju=0,ec=.7,tc=.75,rc="0.2s cubic-bezier(0.2, 0, 0, 1)",nc={fluid:"opacity "+rc,snap:"transform "+rc+", opacity "+rc,drop:function(e){var t=e+"s "+Zu;return"transform "+t+", opacity "+t},outOfTheWay:"transform "+rc,placeholder:"height "+rc+", width "+rc+", margin "+rc},ic=function(e){return yl(e,ml)?null:"translate("+e.x+"px, "+e.y+"px)"},ac=ic,oc=function(e,t){var r=ic(e);return r?t?r+" scale("+tc+")":r:null},sc=.33,lc=function(e){var t=e.getState,r=e.dispatch;return function(e){return function(n){if("DROP"===n.type){var i=t(),a=n.payload.reason;if("COLLECTING"!==i.phase){if("IDLE"!==i.phase){"DROP_PENDING"===i.phase&&i.isWaiting&&sl(!1),"DRAGGING"!==i.phase&&"DROP_PENDING"!==i.phase&&sl(!1);var o=i.critical,s=i.dimensions,l=s.draggables[i.critical.draggable.id],u=function(e){var t=e.draggables,r=e.reason,n=e.lastImpact,i=e.home,a=e.viewport,o=e.onLiftImpact;return n.at&&"DROP"===r?"REORDER"===n.at.type?{impact:n,didDropInsideDroppable:!0}:{impact:Ds({},n,{displaced:$l}),didDropInsideDroppable:!0}:{impact:Iu({draggables:t,impact:o,destination:i,viewport:a,forceShouldAnimate:!0}),didDropInsideDroppable:!1}}({reason:a,lastImpact:i.impact,afterCritical:i.afterCritical,onLiftImpact:i.onLiftImpact,home:i.dimensions.droppables[i.critical.droppable.id],viewport:i.viewport,draggables:i.dimensions.draggables}),c=u.impact,d=u.didDropInsideDroppable,p=d?jl(c):null,f=d?Ml(c):null,m={index:o.draggable.index,droppableId:o.droppable.id},h={draggableId:l.descriptor.id,type:l.descriptor.type,source:m,reason:a,mode:i.movementMode,destination:p,combine:f},g=function(e){var t=e.impact,r=e.draggable,n=e.dimensions,i=e.viewport,a=e.afterCritical,o=n.draggables,s=n.droppables,l=Ou(t),u=l?s[l]:null,c=s[r.descriptor.droppableId],d=Cu({impact:t,draggable:r,draggables:o,afterCritical:a,droppable:u||c,viewport:i});return gl(d,r.client.borderBox.center)}({impact:c,draggable:l,dimensions:s,viewport:i.viewport,afterCritical:i.afterCritical}),y={critical:i.critical,afterCritical:i.afterCritical,result:h,impact:c};if(!yl(i.current.client.offset,g)||Boolean(h.combine)){var v=function(e){var t=e.reason,r=Ol(e.current,e.destination);if(r<=0)return sc;if(r>=1500)return.55;var n=sc+r/1500*.22000000000000003;return Number(("CANCEL"===t?.6*n:n).toFixed(2))}({current:i.current.client.offset,destination:g,reason:a});r({type:"DROP_ANIMATE",payload:{newHomeClientOffset:g,dropDuration:v,completed:y}})}else r(Hu({completed:y}))}}else r(function(e){return{type:"DROP_PENDING",payload:e}}({reason:a}))}else e(n)}}},uc=function(){return{x:window.pageXOffset,y:window.pageYOffset}};var cc=function(e){var t=function(e){var t=e.onWindowScroll,r=Zs((function(){t(uc())})),n=function(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(t){t.target!==window&&t.target!==window.document||e()}}}(r),i=rl;function a(){return i!==rl}return{start:function(){a()&&sl(!1),i=nl(window,[n])},stop:function(){a()||sl(!1),r.cancel(),i(),i=rl},isActive:a}}({onWindowScroll:function(t){e.dispatch({type:"MOVE_BY_WINDOW_SCROLL",payload:{newScroll:t}})}});return function(e){return function(r){t.isActive()||"INITIAL_PUBLISH"!==r.type||t.start(),t.isActive()&&function(e){return"DROP_COMPLETE"===e.type||"DROP_ANIMATE"===e.type||"FLUSH"===e.type}(r)&&t.stop(),e(r)}}},dc=function(e,t){t()},pc=function(e,t){return{draggableId:e.draggable.id,type:e.droppable.type,source:{droppableId:e.droppable.id,index:e.draggable.index},mode:t}},fc=function(e,t,r,n){if(e){var i=function(e){var t=!1,r=!1,n=setTimeout((function(){r=!0})),i=function(i){t||r||(t=!0,e(i),clearTimeout(n))};return i.wasCalled=function(){return t},i}(r);e(t,{announce:i}),i.wasCalled()||r(n(t))}else r(n(t))},mc=function(e,t){var r=function(e,t){var r,n=(r=[],{add:function(e){var t=setTimeout((function(){return function(e){var t=Il(r,(function(t){return t.timerId===e}));-1===t&&sl(!1),r.splice(t,1)[0].callback()}(t)})),n={timerId:t,callback:e};r.push(n)},flush:function(){if(r.length){var e=[].concat(r);r.length=0,e.forEach((function(e){clearTimeout(e.timerId),e.callback()}))}}}),i=null,a=function(r){i||sl(!1),i=null,dc(0,(function(){return fc(e().onDragEnd,r,t,fl.onDragEnd)}))};return{beforeCapture:function(t,r){i&&sl(!1),dc(0,(function(){var n=e().onBeforeCapture;n&&n({draggableId:t,mode:r})}))},beforeStart:function(t,r){i&&sl(!1),dc(0,(function(){var n=e().onBeforeDragStart;n&&n(pc(t,r))}))},start:function(r,a){i&&sl(!1);var o=pc(r,a);i={mode:a,lastCritical:r,lastLocation:o.source,lastCombine:null},n.add((function(){dc(0,(function(){return fc(e().onDragStart,o,t,fl.onDragStart)}))}))},update:function(r,a){var o=jl(a),s=Ml(a);i||sl(!1);var l=!function(e,t){if(e===t)return!0;var r=e.draggable.id===t.draggable.id&&e.draggable.droppableId===t.draggable.droppableId&&e.draggable.type===t.draggable.type&&e.draggable.index===t.draggable.index,n=e.droppable.id===t.droppable.id&&e.droppable.type===t.droppable.type;return r&&n}(r,i.lastCritical);l&&(i.lastCritical=r);var u,c,d=(c=o,!(null==(u=i.lastLocation)&&null==c||null!=u&&null!=c&&u.droppableId===c.droppableId&&u.index===c.index));d&&(i.lastLocation=o);var p=!function(e,t){return null==e&&null==t||null!=e&&null!=t&&e.draggableId===t.draggableId&&e.droppableId===t.droppableId}(i.lastCombine,s);if(p&&(i.lastCombine=s),l||d||p){var f=Ds({},pc(r,i.mode),{combine:s,destination:o});n.add((function(){dc(0,(function(){return fc(e().onDragUpdate,f,t,fl.onDragUpdate)}))}))}},flush:function(){i||sl(!1),n.flush()},drop:a,abort:function(){if(i){var e=Ds({},pc(i.lastCritical,i.mode),{combine:null,destination:null,reason:"CANCEL"});a(e)}}}}(e,t);return function(e){return function(t){return function(n){if("BEFORE_INITIAL_CAPTURE"!==n.type){if("INITIAL_PUBLISH"===n.type){var i=n.payload.critical;return r.beforeStart(i,n.payload.movementMode),t(n),void r.start(i,n.payload.movementMode)}if("DROP_COMPLETE"===n.type){var a=n.payload.completed.result;return r.flush(),t(n),void r.drop(a)}if(t(n),"FLUSH"!==n.type){var o=e.getState();"DRAGGING"===o.phase&&r.update(o.critical,o.impact)}else r.abort()}else r.beforeCapture(n.payload.draggableId,n.payload.movementMode)}}}},hc=function(e){return function(t){return function(r){if("DROP_ANIMATION_FINISHED"===r.type){var n=e.getState();"DROP_ANIMATING"!==n.phase&&sl(!1),e.dispatch(Hu({completed:n.completed}))}else t(r)}}},gc=function(e){var t=null,r=null;return function(n){return function(i){if("FLUSH"!==i.type&&"DROP_COMPLETE"!==i.type&&"DROP_ANIMATION_FINISHED"!==i.type||(r&&(cancelAnimationFrame(r),r=null),t&&(t(),t=null)),n(i),"DROP_ANIMATE"===i.type){var a={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){"DROP_ANIMATING"===e.getState().phase&&e.dispatch({type:"DROP_ANIMATION_FINISHED",payload:null})}};r=requestAnimationFrame((function(){r=null,t=nl(window,[a])}))}}}},yc=function(e){return function(t){return function(r){if(t(r),"PUBLISH_WHILE_DRAGGING"===r.type){var n=e.getState();"DROP_PENDING"===n.phase&&(n.isWaiting||e.dispatch(Yu({reason:n.reason})))}}}},vc=ts.compose,bc=function(e){var t,r=e.dimensionMarshal,n=e.focusMarshal,i=e.styleMarshal,a=e.getResponders,o=e.announce,s=e.autoScroller;return(0,ts.createStore)(ju,vc((0,ts.applyMiddleware)((t=i,function(){return function(e){return function(r){"INITIAL_PUBLISH"===r.type&&t.dragging(),"DROP_ANIMATE"===r.type&&t.dropping(r.payload.completed.result.reason),"FLUSH"!==r.type&&"DROP_COMPLETE"!==r.type||t.resting(),e(r)}}}),function(e){return function(){return function(t){return function(r){"DROP_COMPLETE"!==r.type&&"FLUSH"!==r.type&&"DROP_ANIMATE"!==r.type||e.stopPublishing(),t(r)}}}}(r),function(e){return function(t){var r=t.getState,n=t.dispatch;return function(t){return function(i){if("LIFT"===i.type){var a=i.payload,o=a.id,s=a.clientSelection,l=a.movementMode,u=r();"DROP_ANIMATING"===u.phase&&n(Hu({completed:u.completed})),"IDLE"!==r().phase&&sl(!1),n(Ku()),n({type:"BEFORE_INITIAL_CAPTURE",payload:{draggableId:o,movementMode:l}});var c={draggableId:o,scrollOptions:{shouldPublishImmediately:"SNAP"===l}},d=e.startPublishing(c),p=d.critical,f=d.dimensions,m=d.viewport;n({type:"INITIAL_PUBLISH",payload:{critical:p,dimensions:f,clientSelection:s,movementMode:l,viewport:m}})}else t(i)}}}}(r),lc,hc,gc,yc,function(e){return function(t){return function(r){return function(n){if(function(e){return"DROP_COMPLETE"===e.type||"DROP_ANIMATE"===e.type||"FLUSH"===e.type}(n))return e.stop(),void r(n);if("INITIAL_PUBLISH"===n.type){r(n);var i=t.getState();return"DRAGGING"!==i.phase&&sl(!1),void e.start(i)}r(n),e.scroll(t.getState())}}}}(s),cc,function(e){var t=!1;return function(){return function(r){return function(n){if("INITIAL_PUBLISH"===n.type)return t=!0,e.tryRecordFocus(n.payload.critical.draggable.id),r(n),void e.tryRestoreFocusRecorded();if(r(n),t){if("FLUSH"===n.type)return t=!1,void e.tryRestoreFocusRecorded();if("DROP_COMPLETE"===n.type){t=!1;var i=n.payload.completed.result;i.combine&&e.tryShiftRecord(i.draggableId,i.combine.draggableId),e.tryRestoreFocusRecorded()}}}}}}(n),mc(a,o))))},Oc=function(e){var t=e.scrollHeight,r=e.scrollWidth,n=e.height,i=e.width,a=gl({x:r,y:t},{x:i,y:n});return{x:Math.max(0,a.x),y:Math.max(0,a.y)}},wc=function(){var e=document.documentElement;return e||sl(!1),e},_c=function(){var e=wc();return Oc({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight})};function Sc(e,t,r){return r.descriptor.id!==t.id&&r.descriptor.type===t.type&&"virtual"===e.droppable.getById(r.descriptor.droppableId).descriptor.mode}var Ec,xc,Tc=function(e,t){var r=null,n=function(e){var t=e.registry,r=e.callbacks,n={additions:{},removals:{},modified:{}},i=null,a=function(){i||(r.collectionStarting(),i=requestAnimationFrame((function(){i=null;var e=n,a=e.additions,o=e.removals,s=e.modified,l=Object.keys(a).map((function(e){return t.draggable.getById(e).getDimension(ml)})).sort((function(e,t){return e.descriptor.index-t.descriptor.index})),u=Object.keys(s).map((function(e){return{droppableId:e,scroll:t.droppable.getById(e).callbacks.getScrollWhileDragging()}})),c={additions:l,removals:Object.keys(o),modified:u};n={additions:{},removals:{},modified:{}},r.publish(c)})))};return{add:function(e){var t=e.descriptor.id;n.additions[t]=e,n.modified[e.descriptor.droppableId]=!0,n.removals[t]&&delete n.removals[t],a()},remove:function(e){var t=e.descriptor;n.removals[t.id]=!0,n.modified[t.droppableId]=!0,n.additions[t.id]&&delete n.additions[t.id],a()},stop:function(){i&&(cancelAnimationFrame(i),i=null,n={additions:{},removals:{},modified:{}})}}}({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),i=function(t){r||sl(!1);var i=r.critical.draggable;"ADDITION"===t.type&&Sc(e,i,t.value)&&n.add(t.value),"REMOVAL"===t.type&&Sc(e,i,t.value)&&n.remove(t.value)},a={updateDroppableIsEnabled:function(n,i){e.droppable.exists(n)||sl(!1),r&&t.updateDroppableIsEnabled({id:n,isEnabled:i})},updateDroppableIsCombineEnabled:function(n,i){r&&(e.droppable.exists(n)||sl(!1),t.updateDroppableIsCombineEnabled({id:n,isCombineEnabled:i}))},scrollDroppable:function(t,n){r&&e.droppable.getById(t).callbacks.scroll(n)},updateDroppableScroll:function(n,i){r&&(e.droppable.exists(n)||sl(!1),t.updateDroppableScroll({id:n,newScroll:i}))},startPublishing:function(t){r&&sl(!1);var n=e.draggable.getById(t.draggableId),a=e.droppable.getById(n.descriptor.droppableId),o={draggable:n.descriptor,droppable:a.descriptor},s=e.subscribe(i);return r={critical:o,unsubscribe:s},function(e){var t=e.critical,r=e.scrollOptions,n=e.registry,i=function(){var e=uc(),t=_c(),r=e.y,n=e.x,i=wc(),a=i.clientWidth,o=i.clientHeight;return{frame:Fs({top:r,left:n,right:n+a,bottom:r+o}),scroll:{initial:e,current:e,max:t,diff:{value:ml,displacement:ml}}}}(),a=i.scroll.current,o=t.droppable,s=n.droppable.getAllByType(o.type).map((function(e){return e.callbacks.getDimensionAndWatchScroll(a,r)})),l=n.draggable.getAllByType(t.draggable.type).map((function(e){return e.getDimension(a)}));return{dimensions:{draggables:Rl(l),droppables:ql(s)},critical:t,viewport:i}}({critical:o,registry:e,scrollOptions:t.scrollOptions})},stopPublishing:function(){if(r){n.stop();var t=r.critical.droppable;e.droppable.getAllByType(t.type).forEach((function(e){return e.callbacks.dragStopped()})),r.unsubscribe(),r=null}}};return a},Pc=function(e,t){return"IDLE"===e.phase||"DROP_ANIMATING"===e.phase&&e.completed.result.draggableId!==t&&"DROP"===e.completed.result.reason},kc=function(e){window.scrollBy(e.x,e.y)},Ic=Ys((function(e){return Dl(e).filter((function(e){return!!e.isEnabled&&!!e.frame}))})),Cc=function(e){return Math.pow(e,2)},Ac=function(e){var t=e.startOfRange,r=e.endOfRange,n=e.current,i=r-t;return 0===i?0:(n-t)/i},qc=360,Rc=1200,Dc=function(e){var t=e.distanceToEdge,r=e.thresholds,n=e.dragStartTime,i=e.shouldUseTimeDampening,a=function(e,t){if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return 28;if(e===t.startScrollingFrom)return 1;var r=Ac({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),n=28*Cc(1-r);return Math.ceil(n)}(t,r);return 0===a?0:i?Math.max(function(e,t){var r=t,n=Rc,i=Date.now()-r;if(i>=Rc)return e;if(i<qc)return 1;var a=Ac({startOfRange:qc,endOfRange:n,current:i}),o=e*Cc(a);return Math.ceil(o)}(a,n),1):a},Nc=function(e){var t=e.container,r=e.distanceToEdges,n=e.dragStartTime,i=e.axis,a=e.shouldUseTimeDampening,o=function(e,t){return{startScrollingFrom:.25*e[t.size],maxScrollValueAt:.05*e[t.size]}}(t,i);return r[i.end]<r[i.start]?Dc({distanceToEdge:r[i.end],thresholds:o,dragStartTime:n,shouldUseTimeDampening:a}):-1*Dc({distanceToEdge:r[i.start],thresholds:o,dragStartTime:n,shouldUseTimeDampening:a})},Lc=_l((function(e){return 0===e?0:e})),jc=function(e){var t=e.dragStartTime,r=e.container,n=e.subject,i=e.center,a=e.shouldUseTimeDampening,o={top:i.y-r.top,right:r.right-i.x,bottom:r.bottom-i.y,left:i.x-r.left},s=Nc({container:r,distanceToEdges:o,dragStartTime:t,axis:zl,shouldUseTimeDampening:a}),l=Nc({container:r,distanceToEdges:o,dragStartTime:t,axis:Wl,shouldUseTimeDampening:a}),u=Lc({x:l,y:s});if(yl(u,ml))return null;var c=function(e){var t=e.container,r=e.subject,n=e.proposedScroll,i=r.height>t.height,a=r.width>t.width;return a||i?a&&i?null:{x:a?0:n.x,y:i?0:n.y}:n}({container:r,subject:n,proposedScroll:u});return c?yl(c,ml)?null:c:null},Mc=_l((function(e){return 0===e?0:e>0?1:-1})),Fc=(Ec=function(e,t){return e<0?e:e>t?e-t:0},function(e){var t=e.current,r=e.max,n=e.change,i=hl(t,n),a={x:Ec(i.x,r.x),y:Ec(i.y,r.y)};return yl(a,ml)?null:a}),Bc=function(e){var t=e.max,r=e.current,n=e.change,i={x:Math.max(r.x,t.x),y:Math.max(r.y,t.y)},a=Mc(n),o=Fc({max:i,current:r,change:a});return!o||0!==a.x&&0===o.x||0!==a.y&&0===o.y},Qc=function(e,t){return Bc({current:e.scroll.current,max:e.scroll.max,change:t})},$c=function(e,t){var r=e.frame;return!!r&&Bc({current:r.scroll.current,max:r.scroll.max,change:t})},Vc=function(e){var t=e.state,r=e.dragStartTime,n=e.shouldUseTimeDampening,i=e.scrollWindow,a=e.scrollDroppable,o=t.current.page.borderBoxCenter,s=t.dimensions.draggables[t.critical.draggable.id].page.marginBox;if(t.isWindowScrollAllowed){var l=function(e){var t=e.viewport,r=e.subject,n=e.center,i=e.shouldUseTimeDampening,a=jc({dragStartTime:e.dragStartTime,container:t.frame,subject:r,center:n,shouldUseTimeDampening:i});return a&&Qc(t,a)?a:null}({dragStartTime:r,viewport:t.viewport,subject:s,center:o,shouldUseTimeDampening:n});if(l)return void i(l)}var u=function(e){var t=e.center,r=e.destination,n=e.droppables;if(r){var i=n[r];return i.frame?i:null}var a=function(e,t){var r=Cl(Ic(t),(function(t){return t.frame||sl(!1),Su(t.frame.pageMarginBox)(e)}));return r}(t,n);return a}({center:o,destination:Ou(t.impact),droppables:t.dimensions.droppables});if(u){var c=function(e){var t=e.droppable,r=e.subject,n=e.center,i=e.dragStartTime,a=e.shouldUseTimeDampening,o=t.frame;if(!o)return null;var s=jc({dragStartTime:i,container:o.pageMarginBox,subject:r,center:n,shouldUseTimeDampening:a});return s&&$c(t,s)?s:null}({dragStartTime:r,droppable:u,subject:s,center:o,shouldUseTimeDampening:n});c&&a(u.descriptor.id,c)}},Xc=function(e){var t=e.move,r=e.scrollDroppable,n=e.scrollWindow;return function(e){var i=e.scrollJumpRequest;if(i){var a=Ou(e.impact);a||sl(!1);var o=function(e,t){if(!$c(e,t))return t;var n=function(e,t){var r=e.frame;return r&&$c(e,t)?Fc({current:r.scroll.current,max:r.scroll.max,change:t}):null}(e,t);if(!n)return r(e.descriptor.id,t),null;var i=gl(t,n);return r(e.descriptor.id,i),gl(t,i)}(e.dimensions.droppables[a],i);if(o){var s=e.viewport,l=function(e,t,r){if(!e)return r;if(!Qc(t,r))return r;var i=function(e,t){if(!Qc(e,t))return null;var r=e.scroll.max,n=e.scroll.current;return Fc({current:n,max:r,change:t})}(t,r);if(!i)return n(r),null;var a=gl(r,i);return n(a),gl(r,a)}(e.isWindowScrollAllowed,s,o);l&&function(e,r){var n=hl(e.current.client.selection,r);t({client:n})}(e,l)}}}},Gc=function(e){var t=e.scrollDroppable,r=e.scrollWindow,n=e.move,i=function(e){var t=e.scrollDroppable,r=Zs(e.scrollWindow),n=Zs(t),i=null,a=function(e){i||sl(!1);var t=i,a=t.shouldUseTimeDampening,o=t.dragStartTime;Vc({state:e,scrollWindow:r,scrollDroppable:n,dragStartTime:o,shouldUseTimeDampening:a})};return{start:function(e){i&&sl(!1);var t=Date.now(),r=!1,n=function(){r=!0};Vc({state:e,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:n,scrollDroppable:n}),i={dragStartTime:t,shouldUseTimeDampening:r},r&&a(e)},stop:function(){i&&(r.cancel(),n.cancel(),i=null)},scroll:a}}({scrollWindow:r,scrollDroppable:t}),a=Xc({move:n,scrollWindow:r,scrollDroppable:t});return{scroll:function(e){"DRAGGING"===e.phase&&("FLUID"!==e.movementMode?e.scrollJumpRequest&&a(e):i.scroll(e))},start:i.start,stop:i.stop}},Uc="data-rbd",zc={base:xc=Uc+"-drag-handle",draggableId:xc+"-draggable-id",contextId:xc+"-context-id"},Wc=function(){var e=Uc+"-draggable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),Kc=function(){var e=Uc+"-droppable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),Hc={contextId:Uc+"-scroll-container-context-id"},Yc=function(e,t){return e.map((function(e){var r=e.styles[t];return r?e.selector+" { "+r+" }":""})).join(" ")},Zc=function(e){var t,r,n=function(e){return function(t){return"["+t+'="'+e+'"]'}}(e),i=(t="\n      cursor: -webkit-grab;\n      cursor: grab;\n    ",{selector:n(zc.contextId),styles:{always:"\n          -webkit-touch-callout: none;\n          -webkit-tap-highlight-color: rgba(0,0,0,0);\n          touch-action: manipulation;\n        ",resting:t,dragging:"pointer-events: none;",dropAnimating:t}}),a=[(r="\n      transition: "+nc.outOfTheWay+";\n    ",{selector:n(Wc.contextId),styles:{dragging:r,dropAnimating:r,userCancel:r}}),i,{selector:n(Kc.contextId),styles:{always:"overflow-anchor: none;"}},{selector:"body",styles:{dragging:"\n        cursor: grabbing;\n        cursor: -webkit-grabbing;\n        user-select: none;\n        -webkit-user-select: none;\n        -moz-user-select: none;\n        -ms-user-select: none;\n        overflow-anchor: none;\n      "}}];return{always:Yc(a,"always"),resting:Yc(a,"resting"),dragging:Yc(a,"dragging"),dropAnimating:Yc(a,"dropAnimating"),userCancel:Yc(a,"userCancel")}},Jc="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?r.useLayoutEffect:r.useEffect,ed=function(){var e=document.querySelector("head");return e||sl(!1),e},td=function(e){var t=document.createElement("style");return e&&t.setAttribute("nonce",e),t.type="text/css",t},rd=function(e){return e&&e.ownerDocument?e.ownerDocument.defaultView:window};function nd(e){return e instanceof rd(e).HTMLElement}function id(){var e={draggables:{},droppables:{}},t=[];function r(e){t.length&&t.forEach((function(t){return t(e)}))}function n(t){return e.draggables[t]||null}function i(t){return e.droppables[t]||null}return{draggable:{register:function(t){e.draggables[t.descriptor.id]=t,r({type:"ADDITION",value:t})},update:function(t,r){var n=e.draggables[r.descriptor.id];n&&n.uniqueId===t.uniqueId&&(delete e.draggables[r.descriptor.id],e.draggables[t.descriptor.id]=t)},unregister:function(t){var i=t.descriptor.id,a=n(i);a&&t.uniqueId===a.uniqueId&&(delete e.draggables[i],r({type:"REMOVAL",value:t}))},getById:function(e){var t=n(e);return t||sl(!1),t},findById:n,exists:function(e){return Boolean(n(e))},getAllByType:function(t){return kl(e.draggables).filter((function(e){return e.descriptor.type===t}))}},droppable:{register:function(t){e.droppables[t.descriptor.id]=t},unregister:function(t){var r=i(t.descriptor.id);r&&t.uniqueId===r.uniqueId&&delete e.droppables[t.descriptor.id]},getById:function(e){var t=i(e);return t||sl(!1),t},findById:i,exists:function(e){return Boolean(i(e))},getAllByType:function(t){return kl(e.droppables).filter((function(e){return e.descriptor.type===t}))}},subscribe:function(e){return t.push(e),function(){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},clean:function(){e.draggables={},e.droppables={},t.length=0}}}var ad=n().createContext(null),od=function(){var e=document.body;return e||sl(!1),e},sd={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},ld=function(e){return"rbd-announcement-"+e},ud=0,cd={separator:"::"};function dd(e,t){return void 0===t&&(t=cd),js((function(){return""+e+t.separator+ud++}),[t.separator,e])}var pd=n().createContext(null);function fd(e){var t=(0,r.useRef)(e);return(0,r.useEffect)((function(){t.current=e})),t}var md,hd,gd=((md={})[13]=!0,md[9]=!0,md),yd=function(e){gd[e.keyCode]&&e.preventDefault()},vd=function(){var e="visibilitychange";return"undefined"==typeof document?e:Cl([e,"ms"+e,"webkit"+e,"moz"+e,"o"+e],(function(e){return"on"+e in document}))||e}(),bd={type:"IDLE"};function Od(){}var wd=((hd={})[34]=!0,hd[33]=!0,hd[36]=!0,hd[35]=!0,hd);var _d={type:"IDLE"},Sd={input:!0,button:!0,textarea:!0,select:!0,option:!0,optgroup:!0,video:!0,audio:!0};function Ed(e,t){if(null==t)return!1;if(Boolean(Sd[t.tagName.toLowerCase()]))return!0;var r=t.getAttribute("contenteditable");return"true"===r||""===r||t!==e&&Ed(e,t.parentElement)}function xd(e,t){var r=t.target;return!!nd(r)&&Ed(e,r)}var Td=function(e){return Fs(e.getBoundingClientRect()).center},Pd=function(){var e="matches";return"undefined"==typeof document?e:Cl([e,"msMatchesSelector","webkitMatchesSelector"],(function(e){return e in Element.prototype}))||e}();function kd(e,t){return null==e?null:e[Pd](t)?e:kd(e.parentElement,t)}function Id(e,t){return e.closest?e.closest(t):kd(e,t)}function Cd(e){e.preventDefault()}function Ad(e){var t=e.expected,r=e.phase,n=e.isLockActive;return e.shouldWarn,!!n()&&t===r}function qd(e){var t=e.lockAPI,r=e.store,n=e.registry,i=e.draggableId;if(t.isClaimed())return!1;var a=n.draggable.findById(i);return!!a&&!!a.options.isEnabled&&!!Pc(r.getState(),i)}var Rd=[function(e){var t=(0,r.useRef)(bd),n=(0,r.useRef)(rl),i=js((function(){return{eventName:"mousedown",fn:function(t){if(!t.defaultPrevented&&0===t.button&&!(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)){var r=e.findClosestDraggableId(t);if(r){var i=e.tryGetLock(r,s,{sourceEvent:t});if(i){t.preventDefault();var a={x:t.clientX,y:t.clientY};n.current(),c(i,a)}}}}}}),[e]),a=js((function(){return{eventName:"webkitmouseforcewillbegin",fn:function(t){if(!t.defaultPrevented){var r=e.findClosestDraggableId(t);if(r){var n=e.findOptionsForDraggable(r);n&&(n.shouldRespectForcePress||e.canGetLock(r)&&t.preventDefault())}}}}}),[e]),o=Ms((function(){n.current=nl(window,[a,i],{passive:!1,capture:!0})}),[a,i]),s=Ms((function(){"IDLE"!==t.current.type&&(t.current=bd,n.current(),o())}),[o]),l=Ms((function(){var e=t.current;s(),"DRAGGING"===e.type&&e.actions.cancel({shouldBlockNextClick:!0}),"PENDING"===e.type&&e.actions.abort()}),[s]),u=Ms((function(){var e=function(e){var t=e.cancel,r=e.completed,n=e.getPhase,i=e.setPhase;return[{eventName:"mousemove",fn:function(e){var t,r,a=e.button,o=e.clientX,s=e.clientY;if(0===a){var l={x:o,y:s},u=n();if("DRAGGING"===u.type)return e.preventDefault(),void u.actions.move(l);if("PENDING"!==u.type&&sl(!1),t=u.point,r=l,Math.abs(r.x-t.x)>=5||Math.abs(r.y-t.y)>=5){e.preventDefault();var c=u.actions.fluidLift(l);i({type:"DRAGGING",actions:c})}}}},{eventName:"mouseup",fn:function(e){var i=n();"DRAGGING"===i.type?(e.preventDefault(),i.actions.drop({shouldBlockNextClick:!0}),r()):t()}},{eventName:"mousedown",fn:function(e){"DRAGGING"===n().type&&e.preventDefault(),t()}},{eventName:"keydown",fn:function(e){if("PENDING"!==n().type)return 27===e.keyCode?(e.preventDefault(),void t()):void yd(e);t()}},{eventName:"resize",fn:t},{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(){"PENDING"===n().type&&t()}},{eventName:"webkitmouseforcedown",fn:function(e){var r=n();"IDLE"===r.type&&sl(!1),r.actions.shouldRespectForcePress()?t():e.preventDefault()}},{eventName:vd,fn:t}]}({cancel:l,completed:s,getPhase:function(){return t.current},setPhase:function(e){t.current=e}});n.current=nl(window,e,{capture:!0,passive:!1})}),[l,s]),c=Ms((function(e,r){"IDLE"!==t.current.type&&sl(!1),t.current={type:"PENDING",point:r,actions:e},u()}),[u]);Jc((function(){return o(),function(){n.current()}}),[o])},function(e){var t=(0,r.useRef)(Od),n=js((function(){return{eventName:"keydown",fn:function(r){if(!r.defaultPrevented&&32===r.keyCode){var n=e.findClosestDraggableId(r);if(n){var a=e.tryGetLock(n,l,{sourceEvent:r});if(a){r.preventDefault();var o=!0,s=a.snapLift();t.current(),t.current=nl(window,function(e,t){function r(){t(),e.cancel()}return[{eventName:"keydown",fn:function(n){return 27===n.keyCode?(n.preventDefault(),void r()):32===n.keyCode?(n.preventDefault(),t(),void e.drop()):40===n.keyCode?(n.preventDefault(),void e.moveDown()):38===n.keyCode?(n.preventDefault(),void e.moveUp()):39===n.keyCode?(n.preventDefault(),void e.moveRight()):37===n.keyCode?(n.preventDefault(),void e.moveLeft()):void(wd[n.keyCode]?n.preventDefault():yd(n))}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:vd,fn:r}]}(s,l),{capture:!0,passive:!1})}}}function l(){o||sl(!1),o=!1,t.current(),i()}}}}),[e]),i=Ms((function(){t.current=nl(window,[n],{passive:!1,capture:!0})}),[n]);Jc((function(){return i(),function(){t.current()}}),[i])},function(e){var t=(0,r.useRef)(_d),n=(0,r.useRef)(rl),i=Ms((function(){return t.current}),[]),a=Ms((function(e){t.current=e}),[]),o=js((function(){return{eventName:"touchstart",fn:function(t){if(!t.defaultPrevented){var r=e.findClosestDraggableId(t);if(r){var i=e.tryGetLock(r,l,{sourceEvent:t});if(i){var a=t.touches[0],o={x:a.clientX,y:a.clientY};n.current(),p(i,o)}}}}}}),[e]),s=Ms((function(){n.current=nl(window,[o],{capture:!0,passive:!1})}),[o]),l=Ms((function(){var e=t.current;"IDLE"!==e.type&&("PENDING"===e.type&&clearTimeout(e.longPressTimerId),a(_d),n.current(),s())}),[s,a]),u=Ms((function(){var e=t.current;l(),"DRAGGING"===e.type&&e.actions.cancel({shouldBlockNextClick:!0}),"PENDING"===e.type&&e.actions.abort()}),[l]),c=Ms((function(){var e={capture:!0,passive:!1},t={cancel:u,completed:l,getPhase:i},r=nl(window,function(e){var t=e.cancel,r=e.completed,n=e.getPhase;return[{eventName:"touchmove",options:{capture:!1},fn:function(e){var r=n();if("DRAGGING"===r.type){r.hasMoved=!0;var i=e.touches[0],a={x:i.clientX,y:i.clientY};e.preventDefault(),r.actions.move(a)}else t()}},{eventName:"touchend",fn:function(e){var i=n();"DRAGGING"===i.type?(e.preventDefault(),i.actions.drop({shouldBlockNextClick:!0}),r()):t()}},{eventName:"touchcancel",fn:function(e){"DRAGGING"===n().type?(e.preventDefault(),t()):t()}},{eventName:"touchforcechange",fn:function(e){var r=n();"IDLE"===r.type&&sl(!1);var i=e.touches[0];if(i&&i.force>=.15){var a=r.actions.shouldRespectForcePress();if("PENDING"!==r.type)return a?r.hasMoved?void e.preventDefault():void t():void e.preventDefault();a&&t()}}},{eventName:vd,fn:t}]}(t),e),a=nl(window,function(e){var t=e.cancel,r=e.getPhase;return[{eventName:"orientationchange",fn:t},{eventName:"resize",fn:t},{eventName:"contextmenu",fn:function(e){e.preventDefault()}},{eventName:"keydown",fn:function(e){"DRAGGING"===r().type?(27===e.keyCode&&e.preventDefault(),t()):t()}},{eventName:vd,fn:t}]}(t),e);n.current=function(){r(),a()}}),[u,i,l]),d=Ms((function(){var e=i();"PENDING"!==e.type&&sl(!1);var t=e.actions.fluidLift(e.point);a({type:"DRAGGING",actions:t,hasMoved:!1})}),[i,a]),p=Ms((function(e,t){"IDLE"!==i().type&&sl(!1);var r=setTimeout(d,120);a({type:"PENDING",point:t,actions:e,longPressTimerId:r}),c()}),[c,i,a,d]);Jc((function(){return s(),function(){n.current();var e=i();"PENDING"===e.type&&(clearTimeout(e.longPressTimerId),a(_d))}}),[i,s,a]),Jc((function(){return nl(window,[{eventName:"touchmove",fn:function(){},options:{capture:!1,passive:!1}}])}),[])}];function Dd(e){var t=e.contextId,n=e.store,i=e.registry,a=e.customSensors,o=e.enableDefaultSensors,s=[].concat(o?Rd:[],a||[]),l=(0,r.useState)((function(){return function(){var e=null;function t(){e||sl(!1),e=null}return{isClaimed:function(){return Boolean(e)},isActive:function(t){return t===e},claim:function(t){e&&sl(!1);var r={abandon:t};return e=r,r},release:t,tryAbandon:function(){e&&(e.abandon(),t())}}}()}))[0],u=Ms((function(e,t){e.isDragging&&!t.isDragging&&l.tryAbandon()}),[l]);Jc((function(){var e=n.getState();return n.subscribe((function(){var t=n.getState();u(e,t),e=t}))}),[l,n,u]),Jc((function(){return l.tryAbandon}),[l.tryAbandon]);for(var c=Ms((function(e){return qd({lockAPI:l,registry:i,store:n,draggableId:e})}),[l,i,n]),d=Ms((function(e,r,a){return function(e){var t=e.lockAPI,r=e.contextId,n=e.store,i=e.registry,a=e.draggableId,o=e.forceSensorStop,s=e.sourceEvent;if(!qd({lockAPI:t,store:n,registry:i,draggableId:a}))return null;var l=i.draggable.getById(a),u=function(e,t){var r="["+Wc.contextId+'="'+e+'"]',n=Cl(Al(document.querySelectorAll(r)),(function(e){return e.getAttribute(Wc.id)===t}));return n&&nd(n)?n:null}(r,l.descriptor.id);if(!u)return null;if(s&&!l.options.canDragInteractiveElements&&xd(u,s))return null;var c=t.claim(o||rl),d="PRE_DRAG";function p(){return l.options.shouldRespectForcePress}function f(){return t.isActive(c)}var m=function(e,t){Ad({expected:e,phase:d,isLockActive:f,shouldWarn:!0})&&n.dispatch(t())}.bind(null,"DRAGGING");function h(e){function r(){t.release(),d="COMPLETED"}function i(t,i){if(void 0===i&&(i={shouldBlockNextClick:!1}),e.cleanup(),i.shouldBlockNextClick){var a=nl(window,[{eventName:"click",fn:Cd,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(a)}r(),n.dispatch(Yu({reason:t}))}return"PRE_DRAG"!==d&&(r(),"PRE_DRAG"!==d&&sl(!1)),n.dispatch(Mu(e.liftActionArgs)),d="DRAGGING",Ds({isActive:function(){return Ad({expected:"DRAGGING",phase:d,isLockActive:f,shouldWarn:!1})},shouldRespectForcePress:p,drop:function(e){return i("DROP",e)},cancel:function(e){return i("CANCEL",e)}},e.actions)}return{isActive:function(){return Ad({expected:"PRE_DRAG",phase:d,isLockActive:f,shouldWarn:!1})},shouldRespectForcePress:p,fluidLift:function(e){var t=Zs((function(e){m((function(){return Xu({client:e})}))}));return Ds({},h({liftActionArgs:{id:a,clientSelection:e,movementMode:"FLUID"},cleanup:function(){return t.cancel()},actions:{move:t}}),{move:t})},snapLift:function(){var e={moveUp:function(){return m(Gu)},moveRight:function(){return m(zu)},moveDown:function(){return m(Uu)},moveLeft:function(){return m(Wu)}};return h({liftActionArgs:{id:a,clientSelection:Td(u),movementMode:"SNAP"},cleanup:rl,actions:e})},abort:function(){Ad({expected:"PRE_DRAG",phase:d,isLockActive:f,shouldWarn:!0})&&t.release()}}}({lockAPI:l,registry:i,contextId:t,store:n,draggableId:e,forceSensorStop:r,sourceEvent:a&&a.sourceEvent?a.sourceEvent:null})}),[t,l,i,n]),p=Ms((function(e){return function(e,t){var r=function(e,t){var r,n=t.target;if(!((r=n)instanceof rd(r).Element))return null;var i=function(e){return"["+zc.contextId+'="'+e+'"]'}(e),a=Id(n,i);return a&&nd(a)?a:null}(e,t);return r?r.getAttribute(zc.draggableId):null}(t,e)}),[t]),f=Ms((function(e){var t=i.draggable.findById(e);return t?t.options:null}),[i.draggable]),m=Ms((function(){l.isClaimed()&&(l.tryAbandon(),"IDLE"!==n.getState().phase&&n.dispatch(Ku()))}),[l,n]),h=Ms(l.isClaimed,[l]),g=js((function(){return{canGetLock:c,tryGetLock:d,findClosestDraggableId:p,findOptionsForDraggable:f,tryReleaseLock:m,isLockClaimed:h}}),[c,d,p,f,m,h]),y=0;y<s.length;y++)s[y](g)}var Nd=function(e){return{onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDragUpdate:e.onDragUpdate}};function Ld(e){return e.current||sl(!1),e.current}function jd(e){var t=e.contextId,i=e.setCallbacks,a=e.sensors,o=e.nonce,s=e.dragHandleUsageInstructions,l=(0,r.useRef)(null),u=fd(e),c=Ms((function(){return Nd(u.current)}),[u]),d=function(e){var t=js((function(){return ld(e)}),[e]),n=(0,r.useRef)(null);return(0,r.useEffect)((function(){var e=document.createElement("div");return n.current=e,e.id=t,e.setAttribute("aria-live","assertive"),e.setAttribute("aria-atomic","true"),Ds(e.style,sd),od().appendChild(e),function(){setTimeout((function(){var t=od();t.contains(e)&&t.removeChild(e),e===n.current&&(n.current=null)}))}}),[t]),Ms((function(e){var t=n.current;t&&(t.textContent=e)}),[])}(t),p=function(e){var t=e.contextId,n=e.text,i=dd("hidden-text",{separator:"-"}),a=js((function(){return function(e){return"rbd-hidden-text-"+e.contextId+"-"+e.uniqueId}({contextId:t,uniqueId:i})}),[i,t]);return(0,r.useEffect)((function(){var e=document.createElement("div");return e.id=a,e.textContent=n,e.style.display="none",od().appendChild(e),function(){var t=od();t.contains(e)&&t.removeChild(e)}}),[a,n]),a}({contextId:t,text:s}),f=function(e,t){var n=js((function(){return Zc(e)}),[e]),i=(0,r.useRef)(null),a=(0,r.useRef)(null),o=Ms(Ys((function(e){var t=a.current;t||sl(!1),t.textContent=e})),[]),s=Ms((function(e){var t=i.current;t||sl(!1),t.textContent=e}),[]);Jc((function(){(i.current||a.current)&&sl(!1);var r=td(t),l=td(t);return i.current=r,a.current=l,r.setAttribute(Uc+"-always",e),l.setAttribute(Uc+"-dynamic",e),ed().appendChild(r),ed().appendChild(l),s(n.always),o(n.resting),function(){var e=function(e){var t=e.current;t||sl(!1),ed().removeChild(t),e.current=null};e(i),e(a)}}),[t,s,o,n.always,n.resting,e]);var l=Ms((function(){return o(n.dragging)}),[o,n.dragging]),u=Ms((function(e){o("DROP"!==e?n.userCancel:n.dropAnimating)}),[o,n.dropAnimating,n.userCancel]),c=Ms((function(){a.current&&o(n.resting)}),[o,n.resting]);return js((function(){return{dragging:l,dropping:u,resting:c}}),[l,u,c])}(t,o),m=Ms((function(e){Ld(l).dispatch(e)}),[]),h=js((function(){return(0,ts.bindActionCreators)({publishWhileDragging:Fu,updateDroppableScroll:Qu,updateDroppableIsEnabled:$u,updateDroppableIsCombineEnabled:Vu,collectionStarting:Bu},m)}),[m]),g=function(){var e=js(id,[]);return(0,r.useEffect)((function(){return function(){requestAnimationFrame(e.clean)}}),[e]),e}(),y=js((function(){return Tc(g,h)}),[g,h]),v=js((function(){return Gc(Ds({scrollWindow:kc,scrollDroppable:y.scrollDroppable},(0,ts.bindActionCreators)({move:Xu},m)))}),[y.scrollDroppable,m]),b=function(e){var t=(0,r.useRef)({}),n=(0,r.useRef)(null),i=(0,r.useRef)(null),a=(0,r.useRef)(!1),o=Ms((function(e,r){var n={id:e,focus:r};return t.current[e]=n,function(){var r=t.current;r[e]!==n&&delete r[e]}}),[]),s=Ms((function(t){var r=function(e,t){var r="["+zc.contextId+'="'+e+'"]',n=Al(document.querySelectorAll(r));if(!n.length)return null;var i=Cl(n,(function(e){return e.getAttribute(zc.draggableId)===t}));return i&&nd(i)?i:null}(e,t);r&&r!==document.activeElement&&r.focus()}),[e]),l=Ms((function(e,t){n.current===e&&(n.current=t)}),[]),u=Ms((function(){i.current||a.current&&(i.current=requestAnimationFrame((function(){i.current=null;var e=n.current;e&&s(e)})))}),[s]),c=Ms((function(e){n.current=null;var t=document.activeElement;t&&t.getAttribute(zc.draggableId)===e&&(n.current=e)}),[]);return Jc((function(){return a.current=!0,function(){a.current=!1;var e=i.current;e&&cancelAnimationFrame(e)}}),[]),js((function(){return{register:o,tryRecordFocus:c,tryRestoreFocusRecorded:u,tryShiftRecord:l}}),[o,c,u,l])}(t),O=js((function(){return bc({announce:d,autoScroller:v,dimensionMarshal:y,focusMarshal:b,getResponders:c,styleMarshal:f})}),[d,v,y,b,c,f]);l.current=O;var w=Ms((function(){var e=Ld(l);"IDLE"!==e.getState().phase&&e.dispatch(Ku())}),[]),_=Ms((function(){var e=Ld(l).getState();return e.isDragging||"DROP_ANIMATING"===e.phase}),[]);i(js((function(){return{isDragging:_,tryAbort:w}}),[_,w]));var S=Ms((function(e){return Pc(Ld(l).getState(),e)}),[]),E=Ms((function(){return _u(Ld(l).getState())}),[]),x=js((function(){return{marshal:y,focus:b,contextId:t,canLift:S,isMovementAllowed:E,dragHandleUsageInstructionsId:p,registry:g}}),[t,y,p,b,S,E,g]);return Dd({contextId:t,store:O,registry:g,customSensors:a,enableDefaultSensors:!1!==e.enableDefaultSensors}),(0,r.useEffect)((function(){return w}),[w]),n().createElement(pd.Provider,{value:x},n().createElement(Ns.Provider,{context:ad,store:O},e.children))}var Md=0;function Fd(e){var t=js((function(){return""+Md++}),[]),r=e.dragHandleUsageInstructions||fl.dragHandleUsageInstructions;return n().createElement(ll,null,(function(i){return n().createElement(jd,{nonce:e.nonce,contextId:t,setCallbacks:i,dragHandleUsageInstructions:r,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd},e.children)}))}var Bd=function(e){return function(t){return e===t}},Qd=Bd("scroll"),$d=Bd("auto"),Vd=(Bd("visible"),function(e,t){return t(e.overflowX)||t(e.overflowY)}),Xd=function e(t){return null==t||t===document.body||t===document.documentElement?null:function(e){var t=window.getComputedStyle(e),r={overflowX:t.overflowX,overflowY:t.overflowY};return Vd(r,Qd)||Vd(r,$d)}(t)?t:e(t.parentElement)},Gd=function(e){return{x:e.scrollLeft,y:e.scrollTop}},Ud=function e(t){return!!t&&("fixed"===window.getComputedStyle(t).position||e(t.parentElement))},zd={passive:!1},Wd={passive:!0},Kd=function(e){return e.shouldPublishImmediately?zd:Wd};function Hd(e){var t=(0,r.useContext)(e);return t||sl(!1),t}var Yd=function(e){return e&&e.env.closestScrollable||null};function Zd(){}var Jd={width:0,height:0,margin:{top:0,right:0,bottom:0,left:0}},ep=n().memo((function(e){var t=(0,r.useRef)(null),i=Ms((function(){t.current&&(clearTimeout(t.current),t.current=null)}),[]),a=e.animate,o=e.onTransitionEnd,s=e.onClose,l=e.contextId,u=(0,r.useState)("open"===e.animate),c=u[0],d=u[1];(0,r.useEffect)((function(){return c?"open"!==a?(i(),d(!1),Zd):t.current?Zd:(t.current=setTimeout((function(){t.current=null,d(!1)})),i):Zd}),[a,c,i]);var p=Ms((function(e){"height"===e.propertyName&&(o(),"close"===a&&s())}),[a,s,o]),f=function(e){var t=e.isAnimatingOpenOnMount,r=e.placeholder,n=e.animate,i=function(e){var t=e.placeholder;return e.isAnimatingOpenOnMount||"close"===e.animate?Jd:{height:t.client.borderBox.height,width:t.client.borderBox.width,margin:t.client.margin}}({isAnimatingOpenOnMount:t,placeholder:r,animate:n});return{display:r.display,boxSizing:"border-box",width:i.width,height:i.height,marginTop:i.margin.top,marginRight:i.margin.right,marginBottom:i.margin.bottom,marginLeft:i.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:"none"!==n?nc.placeholder:null}}({isAnimatingOpenOnMount:c,animate:e.animate,placeholder:e.placeholder});return n().createElement(e.placeholder.tagName,{style:f,"data-rbd-placeholder-context-id":l,onTransitionEnd:p,ref:e.innerRef})})),tp=n().createContext(null),rp=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=e.call.apply(e,[this].concat(n))||this).state={isVisible:Boolean(t.props.on),data:t.props.on,animate:t.props.shouldAnimate&&t.props.on?"open":"none"},t.onClose=function(){"close"===t.state.animate&&t.setState({isVisible:!1})},t}return Rs(t,e),t.getDerivedStateFromProps=function(e,t){return e.shouldAnimate?e.on?{isVisible:!0,data:e.on,animate:"open"}:t.isVisible?{isVisible:!0,data:t.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:Boolean(e.on),data:e.on,animate:"none"}},t.prototype.render=function(){if(!this.state.isVisible)return null;var e={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(e)},t}(n().PureComponent),np=5e3,ip=4500,ap=function(e,t){return t?nc.drop(t.duration):e?nc.snap:nc.fluid},op=function(e,t){return e?t?Ju:ec:null};function sp(e){e.preventDefault()}var lp=function(e,t){return e===t},up=function(e){var t=e.combine,r=e.destination;return r?r.droppableId:t?t.droppableId:null};function cp(e){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}var dp={mapped:{type:"SECONDARY",offset:ml,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:cp(null)}},pp={dropAnimationFinished:function(){return{type:"DROP_ANIMATION_FINISHED",payload:null}}},fp=(0,Ns.connect)((function(){var e,t,r,n=(e=Ys((function(e,t){return{x:e,y:t}})),t=Ys((function(e,t,r,n,i){return{isDragging:!0,isClone:t,isDropAnimating:Boolean(i),dropAnimation:i,mode:e,draggingOver:r,combineWith:n,combineTargetFor:null}})),r=Ys((function(e,r,n,i,a,o,s){return{mapped:{type:"DRAGGING",dropping:null,draggingOver:a,combineWith:o,mode:r,offset:e,dimension:n,forceShouldAnimate:s,snapshot:t(r,i,a,o,null)}}})),function(n,i){if(n.isDragging){if(n.critical.draggable.id!==i.draggableId)return null;var a=n.current.client.offset,o=n.dimensions.draggables[i.draggableId],s=Ou(n.impact),l=(c=n.impact).at&&"COMBINE"===c.at.type?c.at.combine.draggableId:null,u=n.forceShouldAnimate;return r(e(a.x,a.y),n.movementMode,o,i.isClone,s,l,u)}var c;if("DROP_ANIMATING"===n.phase){var d=n.completed;if(d.result.draggableId!==i.draggableId)return null;var p=i.isClone,f=n.dimensions.draggables[i.draggableId],m=d.result,h=m.mode,g=up(m),y=function(e){return e.combine?e.combine.draggableId:null}(m),v={duration:n.dropDuration,curve:Zu,moveTo:n.newHomeClientOffset,opacity:y?Ju:null,scale:y?tc:null};return{mapped:{type:"DRAGGING",offset:n.newHomeClientOffset,dimension:f,dropping:v,draggingOver:g,combineWith:y,mode:h,forceShouldAnimate:null,snapshot:t(h,p,g,y,v)}}}return null}),i=function(){var e=Ys((function(e,t){return{x:e,y:t}})),t=Ys(cp),r=Ys((function(e,r,n){return void 0===r&&(r=null),{mapped:{type:"SECONDARY",offset:e,combineTargetFor:r,shouldAnimateDisplacement:n,snapshot:t(r)}}})),n=function(e){return e?r(ml,e,!0):null},i=function(t,i,a,o){var s=a.displaced.visible[t],l=Boolean(o.inVirtualList&&o.effected[t]),u=Ml(a),c=u&&u.draggableId===t?i:null;if(!s){if(!l)return n(c);if(a.displaced.invisible[t])return null;var d=vl(o.displacedBy.point),p=e(d.x,d.y);return r(p,c,!0)}if(l)return n(c);var f=a.displacedBy.point,m=e(f.x,f.y);return r(m,c,s.shouldAnimate)};return function(e,t){if(e.isDragging)return e.critical.draggable.id===t.draggableId?null:i(t.draggableId,e.critical.draggable.id,e.impact,e.afterCritical);if("DROP_ANIMATING"===e.phase){var r=e.completed;return r.result.draggableId===t.draggableId?null:i(t.draggableId,r.result.draggableId,r.impact,r.afterCritical)}return null}}();return function(e,t){return n(e,t)||i(e,t)||dp}}),pp,null,{context:ad,pure:!0,areStatePropsEqual:lp})((function(e){var t=(0,r.useRef)(null),n=Ms((function(e){t.current=e}),[]),i=Ms((function(){return t.current}),[]),a=Hd(pd),o=a.contextId,s=a.dragHandleUsageInstructionsId,l=a.registry,u=Hd(tp),c=u.type,d=u.droppableId,p=js((function(){return{id:e.draggableId,index:e.index,type:c,droppableId:d}}),[e.draggableId,e.index,c,d]),f=e.children,m=e.draggableId,h=e.isEnabled,g=e.shouldRespectForcePress,y=e.canDragInteractiveElements,v=e.isClone,b=e.mapped,O=e.dropAnimationFinished;v||function(e){var t=dd("draggable"),n=e.descriptor,i=e.registry,a=e.getDraggableRef,o=e.canDragInteractiveElements,s=e.shouldRespectForcePress,l=e.isEnabled,u=js((function(){return{canDragInteractiveElements:o,shouldRespectForcePress:s,isEnabled:l}}),[o,l,s]),c=Ms((function(e){var t=a();return t||sl(!1),function(e,t,r){void 0===r&&(r=ml);var n=window.getComputedStyle(t),i=t.getBoundingClientRect(),a=zs(i,n),o=Us(a,r);return{descriptor:e,placeholder:{client:a,tagName:t.tagName.toLowerCase(),display:n.display},displaceBy:{x:a.marginBox.width,y:a.marginBox.height},client:a,page:o}}(n,t,e)}),[n,a]),d=js((function(){return{uniqueId:t,descriptor:n,options:u,getDimension:c}}),[n,c,u,t]),p=(0,r.useRef)(d),f=(0,r.useRef)(!0);Jc((function(){return i.draggable.register(p.current),function(){return i.draggable.unregister(p.current)}}),[i.draggable]),Jc((function(){if(f.current)f.current=!1;else{var e=p.current;p.current=d,i.draggable.update(d,e)}}),[d,i.draggable])}(js((function(){return{descriptor:p,registry:l,getDraggableRef:i,canDragInteractiveElements:y,shouldRespectForcePress:g,isEnabled:h}}),[p,l,i,y,g,h]));var w=js((function(){return h?{tabIndex:0,role:"button","aria-describedby":s,"data-rbd-drag-handle-draggable-id":m,"data-rbd-drag-handle-context-id":o,draggable:!1,onDragStart:sp}:null}),[o,s,m,h]),_=Ms((function(e){"DRAGGING"===b.type&&b.dropping&&"transform"===e.propertyName&&O()}),[O,b]),S=js((function(){var e=function(e){return"DRAGGING"===e.type?function(e){var t=e.dimension.client,r=e.offset,n=e.combineWith,i=e.dropping,a=Boolean(n),o=function(e){return null!=e.forceShouldAnimate?e.forceShouldAnimate:"SNAP"===e.mode}(e),s=Boolean(i),l=s?oc(r,a):ac(r);return{position:"fixed",top:t.marginBox.top,left:t.marginBox.left,boxSizing:"border-box",width:t.borderBox.width,height:t.borderBox.height,transition:ap(o,i),transform:l,opacity:op(a,s),zIndex:s?ip:np,pointerEvents:"none"}}(e):{transform:ac((t=e).offset),transition:t.shouldAnimateDisplacement?null:"none"};var t}(b),t="DRAGGING"===b.type&&b.dropping?_:null;return{innerRef:n,draggableProps:{"data-rbd-draggable-context-id":o,"data-rbd-draggable-id":m,style:e,onTransitionEnd:t},dragHandleProps:w}}),[o,w,m,b,_,n]),E=js((function(){return{draggableId:p.id,type:p.type,source:{index:p.index,droppableId:p.droppableId}}}),[p.droppableId,p.id,p.index,p.type]);return f(S,b.snapshot,E)}));function mp(e){return Hd(tp).isUsingCloneFor!==e.draggableId||e.isClone?n().createElement(fp,e):null}function hp(e){var t="boolean"!=typeof e.isDragDisabled||!e.isDragDisabled,r=Boolean(e.disableInteractiveElementBlocking),i=Boolean(e.shouldRespectForcePress);return n().createElement(mp,Ds({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:r,shouldRespectForcePress:i}))}var gp=function(e,t){return e===t.droppable.type},yp=function(e,t){return t.draggables[e.draggable.id]},vp={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:function(){return document.body||sl(!1),document.body}},bp=(0,Ns.connect)((function(){var e={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},t=Ds({},e,{shouldAnimatePlaceholder:!1}),r=Ys((function(e){return{draggableId:e.id,type:e.type,source:{index:e.index,droppableId:e.droppableId}}})),n=Ys((function(n,i,a,o,s,l){var u=s.descriptor.id;if(s.descriptor.droppableId===n){var c=l?{render:l,dragging:r(s.descriptor)}:null,d={isDraggingOver:a,draggingOverWith:a?u:null,draggingFromThisWith:u,isUsingPlaceholder:!0};return{placeholder:s.placeholder,shouldAnimatePlaceholder:!1,snapshot:d,useClone:c}}if(!i)return t;if(!o)return e;var p={isDraggingOver:a,draggingOverWith:u,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:s.placeholder,shouldAnimatePlaceholder:!0,snapshot:p,useClone:null}}));return function(r,i){var a=i.droppableId,o=i.type,s=!i.isDropDisabled,l=i.renderClone;if(r.isDragging){var u=r.critical;if(!gp(o,u))return t;var c=yp(u,r.dimensions),d=Ou(r.impact)===a;return n(a,s,d,d,c,l)}if("DROP_ANIMATING"===r.phase){var p=r.completed;if(!gp(o,p.critical))return t;var f=yp(p.critical,r.dimensions);return n(a,s,up(p.result)===a,Ou(p.impact)===a,f,l)}if("IDLE"===r.phase&&r.completed&&!r.shouldFlush){var m=r.completed;if(!gp(o,m.critical))return t;var h=Ou(m.impact)===a,g=Boolean(m.impact.at&&"COMBINE"===m.impact.at.type),y=m.critical.droppable.id===a;return h?g?e:t:y?e:t}return t}}),{updateViewportMaxScroll:function(e){return{type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:e}}},null,{context:ad,pure:!0,areStatePropsEqual:lp})((function(e){var t=(0,r.useContext)(pd);t||sl(!1);var i=t.contextId,a=t.isMovementAllowed,o=(0,r.useRef)(null),s=(0,r.useRef)(null),l=e.children,u=e.droppableId,c=e.type,d=e.mode,p=e.direction,f=e.ignoreContainerClipping,m=e.isDropDisabled,h=e.isCombineEnabled,g=e.snapshot,y=e.useClone,v=e.updateViewportMaxScroll,b=e.getContainerForClone,O=Ms((function(){return o.current}),[]),w=Ms((function(e){o.current=e}),[]),_=(Ms((function(){return s.current}),[]),Ms((function(e){s.current=e}),[])),S=Ms((function(){a()&&v({maxScroll:_c()})}),[a,v]);!function(e){var t=(0,r.useRef)(null),n=Hd(pd),i=dd("droppable"),a=n.registry,o=n.marshal,s=fd(e),l=js((function(){return{id:e.droppableId,type:e.type,mode:e.mode}}),[e.droppableId,e.mode,e.type]),u=(0,r.useRef)(l),c=js((function(){return Ys((function(e,r){t.current||sl(!1);var n={x:e,y:r};o.updateDroppableScroll(l.id,n)}))}),[l.id,o]),d=Ms((function(){var e=t.current;return e&&e.env.closestScrollable?Gd(e.env.closestScrollable):ml}),[]),p=Ms((function(){var e=d();c(e.x,e.y)}),[d,c]),f=js((function(){return Zs(p)}),[p]),m=Ms((function(){var e=t.current,r=Yd(e);e&&r||sl(!1),e.scrollOptions.shouldPublishImmediately?p():f()}),[f,p]),h=Ms((function(e,r){t.current&&sl(!1);var i=s.current,a=i.getDroppableRef();a||sl(!1);var o=function(e){return{closestScrollable:Xd(e),isFixedOnPage:Ud(e)}}(a),u={ref:a,descriptor:l,env:o,scrollOptions:r};t.current=u;var c=function(e){var t=e.ref,r=e.descriptor,n=e.env,i=e.windowScroll,a=e.direction,o=e.isDropDisabled,s=e.isCombineEnabled,l=e.shouldClipSubject,u=n.closestScrollable,c=function(e,t){var r=Ws(e);if(!t)return r;if(e!==t)return r;var n=r.paddingBox.top-t.scrollTop,i=r.paddingBox.left-t.scrollLeft,a=n+t.scrollHeight,o=i+t.scrollWidth,s=Bs({top:n,right:o,bottom:a,left:i},r.border);return Vs({borderBox:s,margin:r.margin,border:r.border,padding:r.padding})}(t,u),d=Us(c,i),p=function(){if(!u)return null;var e=Ws(u),t={scrollHeight:u.scrollHeight,scrollWidth:u.scrollWidth};return{client:e,page:Us(e,i),scroll:Gd(u),scrollSize:t,shouldClipSubject:l}}(),f=function(e){var t=e.descriptor,r=e.isEnabled,n=e.isCombineEnabled,i=e.isFixedOnPage,a=e.direction,o=e.client,s=e.page,l=e.closest,u=function(){if(!l)return null;var e=l.scrollSize,t=l.client,r=Oc({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,height:t.paddingBox.height,width:t.paddingBox.width});return{pageMarginBox:l.page.marginBox,frameClient:t,scrollSize:e,shouldClipSubject:l.shouldClipSubject,scroll:{initial:l.scroll,current:l.scroll,max:r,diff:{value:ml,displacement:ml}}}}(),c="vertical"===a?zl:Wl;return{descriptor:t,isCombineEnabled:n,isFixedOnPage:i,axis:c,isEnabled:r,client:o,page:s,frame:u,subject:Tl({page:s,withPlaceholder:null,axis:c,frame:u})}}({descriptor:r,isEnabled:!o,isCombineEnabled:s,isFixedOnPage:n.isFixedOnPage,direction:a,client:c,page:d,closest:p});return f}({ref:a,descriptor:l,env:o,windowScroll:e,direction:i.direction,isDropDisabled:i.isDropDisabled,isCombineEnabled:i.isCombineEnabled,shouldClipSubject:!i.ignoreContainerClipping}),d=o.closestScrollable;return d&&(d.setAttribute(Hc.contextId,n.contextId),d.addEventListener("scroll",m,Kd(u.scrollOptions))),c}),[n.contextId,l,m,s]),g=Ms((function(){var e=t.current,r=Yd(e);return e&&r||sl(!1),Gd(r)}),[]),y=Ms((function(){var e=t.current;e||sl(!1);var r=Yd(e);t.current=null,r&&(f.cancel(),r.removeAttribute(Hc.contextId),r.removeEventListener("scroll",m,Kd(e.scrollOptions)))}),[m,f]),v=Ms((function(e){var r=t.current;r||sl(!1);var n=Yd(r);n||sl(!1),n.scrollTop+=e.y,n.scrollLeft+=e.x}),[]),b=js((function(){return{getDimensionAndWatchScroll:h,getScrollWhileDragging:g,dragStopped:y,scroll:v}}),[y,h,g,v]),O=js((function(){return{uniqueId:i,descriptor:l,callbacks:b}}),[b,l,i]);Jc((function(){return u.current=O.descriptor,a.droppable.register(O),function(){t.current&&y(),a.droppable.unregister(O)}}),[b,l,y,O,o,a.droppable]),Jc((function(){t.current&&o.updateDroppableIsEnabled(u.current.id,!e.isDropDisabled)}),[e.isDropDisabled,o]),Jc((function(){t.current&&o.updateDroppableIsCombineEnabled(u.current.id,e.isCombineEnabled)}),[e.isCombineEnabled,o])}({droppableId:u,type:c,mode:d,direction:p,isDropDisabled:m,isCombineEnabled:h,ignoreContainerClipping:f,getDroppableRef:O});var E=n().createElement(rp,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},(function(e){var t=e.onClose,r=e.data,a=e.animate;return n().createElement(ep,{placeholder:r,onClose:t,innerRef:_,animate:a,contextId:i,onTransitionEnd:S})})),x=js((function(){return{innerRef:w,placeholder:E,droppableProps:{"data-rbd-droppable-id":u,"data-rbd-droppable-context-id":i}}}),[i,u,E,w]),T=y?y.dragging.draggableId:null,P=js((function(){return{droppableId:u,type:c,isUsingCloneFor:T}}),[u,T,c]);return n().createElement(tp.Provider,{value:P},l(x,g),function(){if(!y)return null;var e=y.dragging,t=y.render,r=n().createElement(mp,{draggableId:e.draggableId,index:e.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(function(r,n){return t(r,n,e)}));return el().createPortal(r,b())}())}));function Op(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function wp(e){return e instanceof Op(e).Element||e instanceof Element}function _p(e){return e instanceof Op(e).HTMLElement||e instanceof HTMLElement}function Sp(e){return"undefined"!=typeof ShadowRoot&&(e instanceof Op(e).ShadowRoot||e instanceof ShadowRoot)}bp.defaultProps=vp;var Ep=Math.max,xp=Math.min,Tp=Math.round;function Pp(){var e=navigator.userAgentData;return null!=e&&e.brands?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function kp(){return!/^((?!chrome|android).)*safari/i.test(Pp())}function Ip(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!1);var n=e.getBoundingClientRect(),i=1,a=1;t&&_p(e)&&(i=e.offsetWidth>0&&Tp(n.width)/e.offsetWidth||1,a=e.offsetHeight>0&&Tp(n.height)/e.offsetHeight||1);var o=(wp(e)?Op(e):window).visualViewport,s=!kp()&&r,l=(n.left+(s&&o?o.offsetLeft:0))/i,u=(n.top+(s&&o?o.offsetTop:0))/a,c=n.width/i,d=n.height/a;return{width:c,height:d,top:u,right:l+c,bottom:u+d,left:l,x:l,y:u}}function Cp(e){var t=Op(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Ap(e){return e?(e.nodeName||"").toLowerCase():null}function qp(e){return((wp(e)?e.ownerDocument:e.document)||window.document).documentElement}function Rp(e){return Ip(qp(e)).left+Cp(e).scrollLeft}function Dp(e){return Op(e).getComputedStyle(e)}function Np(e){var t=Dp(e),r=t.overflow,n=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function Lp(e,t,r){void 0===r&&(r=!1);var n,i,a=_p(t),o=_p(t)&&function(e){var t=e.getBoundingClientRect(),r=Tp(t.width)/e.offsetWidth||1,n=Tp(t.height)/e.offsetHeight||1;return 1!==r||1!==n}(t),s=qp(t),l=Ip(e,o,r),u={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(a||!a&&!r)&&(("body"!==Ap(t)||Np(s))&&(u=(n=t)!==Op(n)&&_p(n)?{scrollLeft:(i=n).scrollLeft,scrollTop:i.scrollTop}:Cp(n)),_p(t)?((c=Ip(t,!0)).x+=t.clientLeft,c.y+=t.clientTop):s&&(c.x=Rp(s))),{x:l.left+u.scrollLeft-c.x,y:l.top+u.scrollTop-c.y,width:l.width,height:l.height}}function jp(e){var t=Ip(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function Mp(e){return"html"===Ap(e)?e:e.assignedSlot||e.parentNode||(Sp(e)?e.host:null)||qp(e)}function Fp(e){return["html","body","#document"].indexOf(Ap(e))>=0?e.ownerDocument.body:_p(e)&&Np(e)?e:Fp(Mp(e))}function Bp(e,t){var r;void 0===t&&(t=[]);var n=Fp(e),i=n===(null==(r=e.ownerDocument)?void 0:r.body),a=Op(n),o=i?[a].concat(a.visualViewport||[],Np(n)?n:[]):n,s=t.concat(o);return i?s:s.concat(Bp(Mp(o)))}function Qp(e){return["table","td","th"].indexOf(Ap(e))>=0}function $p(e){return _p(e)&&"fixed"!==Dp(e).position?e.offsetParent:null}function Vp(e){for(var t=Op(e),r=$p(e);r&&Qp(r)&&"static"===Dp(r).position;)r=$p(r);return r&&("html"===Ap(r)||"body"===Ap(r)&&"static"===Dp(r).position)?t:r||function(e){var t=/firefox/i.test(Pp());if(/Trident/i.test(Pp())&&_p(e)&&"fixed"===Dp(e).position)return null;var r=Mp(e);for(Sp(r)&&(r=r.host);_p(r)&&["html","body"].indexOf(Ap(r))<0;){var n=Dp(r);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||t&&"filter"===n.willChange||t&&n.filter&&"none"!==n.filter)return r;r=r.parentNode}return null}(e)||t}var Xp="top",Gp="bottom",Up="right",zp="left",Wp="auto",Kp=[Xp,Gp,Up,zp],Hp="start",Yp="end",Zp="viewport",Jp="popper",ef=Kp.reduce((function(e,t){return e.concat([t+"-"+Hp,t+"-"+Yp])}),[]),tf=[].concat(Kp,[Wp]).reduce((function(e,t){return e.concat([t,t+"-"+Hp,t+"-"+Yp])}),[]),rf=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function nf(e){var t=new Map,r=new Set,n=[];function i(e){r.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!r.has(e)){var n=t.get(e);n&&i(n)}})),n.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){r.has(e.name)||i(e)})),n}function af(e){var t;return function(){return t||(t=new Promise((function(r){Promise.resolve().then((function(){t=void 0,r(e())}))}))),t}}var of={placement:"bottom",modifiers:[],strategy:"absolute"};function sf(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function lf(e){void 0===e&&(e={});var t=e,r=t.defaultModifiers,n=void 0===r?[]:r,i=t.defaultOptions,a=void 0===i?of:i;return function(e,t,r){void 0===r&&(r=a);var i={placement:"bottom",orderedModifiers:[],options:Object.assign({},of,a),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},o=[],s=!1,l={state:i,setOptions:function(r){var s="function"==typeof r?r(i.options):r;u(),i.options=Object.assign({},a,i.options,s),i.scrollParents={reference:wp(e)?Bp(e):e.contextElement?Bp(e.contextElement):[],popper:Bp(t)};var c,d,p=function(e){var t=nf(e);return rf.reduce((function(e,r){return e.concat(t.filter((function(e){return e.phase===r})))}),[])}((c=[].concat(n,i.options.modifiers),d=c.reduce((function(e,t){var r=e[t.name];return e[t.name]=r?Object.assign({},r,t,{options:Object.assign({},r.options,t.options),data:Object.assign({},r.data,t.data)}):t,e}),{}),Object.keys(d).map((function(e){return d[e]}))));return i.orderedModifiers=p.filter((function(e){return e.enabled})),i.orderedModifiers.forEach((function(e){var t=e.name,r=e.options,n=void 0===r?{}:r,a=e.effect;if("function"==typeof a){var s=a({state:i,name:t,instance:l,options:n});o.push(s||function(){})}})),l.update()},forceUpdate:function(){if(!s){var e=i.elements,t=e.reference,r=e.popper;if(sf(t,r)){i.rects={reference:Lp(t,Vp(r),"fixed"===i.options.strategy),popper:jp(r)},i.reset=!1,i.placement=i.options.placement,i.orderedModifiers.forEach((function(e){return i.modifiersData[e.name]=Object.assign({},e.data)}));for(var n=0;n<i.orderedModifiers.length;n++)if(!0!==i.reset){var a=i.orderedModifiers[n],o=a.fn,u=a.options,c=void 0===u?{}:u,d=a.name;"function"==typeof o&&(i=o({state:i,options:c,name:d,instance:l})||i)}else i.reset=!1,n=-1}}},update:af((function(){return new Promise((function(e){l.forceUpdate(),e(i)}))})),destroy:function(){u(),s=!0}};if(!sf(e,t))return l;function u(){o.forEach((function(e){return e()})),o=[]}return l.setOptions(r).then((function(e){!s&&r.onFirstUpdate&&r.onFirstUpdate(e)})),l}}var uf={passive:!0};const cf={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,r=e.instance,n=e.options,i=n.scroll,a=void 0===i||i,o=n.resize,s=void 0===o||o,l=Op(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&u.forEach((function(e){e.addEventListener("scroll",r.update,uf)})),s&&l.addEventListener("resize",r.update,uf),function(){a&&u.forEach((function(e){e.removeEventListener("scroll",r.update,uf)})),s&&l.removeEventListener("resize",r.update,uf)}},data:{}};function df(e){return e.split("-")[0]}function pf(e){return e.split("-")[1]}function ff(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function mf(e){var t,r=e.reference,n=e.element,i=e.placement,a=i?df(i):null,o=i?pf(i):null,s=r.x+r.width/2-n.width/2,l=r.y+r.height/2-n.height/2;switch(a){case Xp:t={x:s,y:r.y-n.height};break;case Gp:t={x:s,y:r.y+r.height};break;case Up:t={x:r.x+r.width,y:l};break;case zp:t={x:r.x-n.width,y:l};break;default:t={x:r.x,y:r.y}}var u=a?ff(a):null;if(null!=u){var c="y"===u?"height":"width";switch(o){case Hp:t[u]=t[u]-(r[c]/2-n[c]/2);break;case Yp:t[u]=t[u]+(r[c]/2-n[c]/2)}}return t}const hf={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,r=e.name;t.modifiersData[r]=mf({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}};var gf={top:"auto",right:"auto",bottom:"auto",left:"auto"};function yf(e){var t,r=e.popper,n=e.popperRect,i=e.placement,a=e.variation,o=e.offsets,s=e.position,l=e.gpuAcceleration,u=e.adaptive,c=e.roundOffsets,d=e.isFixed,p=o.x,f=void 0===p?0:p,m=o.y,h=void 0===m?0:m,g="function"==typeof c?c({x:f,y:h}):{x:f,y:h};f=g.x,h=g.y;var y=o.hasOwnProperty("x"),v=o.hasOwnProperty("y"),b=zp,O=Xp,w=window;if(u){var _=Vp(r),S="clientHeight",E="clientWidth";_===Op(r)&&"static"!==Dp(_=qp(r)).position&&"absolute"===s&&(S="scrollHeight",E="scrollWidth"),(i===Xp||(i===zp||i===Up)&&a===Yp)&&(O=Gp,h-=(d&&_===w&&w.visualViewport?w.visualViewport.height:_[S])-n.height,h*=l?1:-1),i!==zp&&(i!==Xp&&i!==Gp||a!==Yp)||(b=Up,f-=(d&&_===w&&w.visualViewport?w.visualViewport.width:_[E])-n.width,f*=l?1:-1)}var x,T=Object.assign({position:s},u&&gf),P=!0===c?function(e){var t=e.x,r=e.y,n=window.devicePixelRatio||1;return{x:Tp(t*n)/n||0,y:Tp(r*n)/n||0}}({x:f,y:h}):{x:f,y:h};return f=P.x,h=P.y,l?Object.assign({},T,((x={})[O]=v?"0":"",x[b]=y?"0":"",x.transform=(w.devicePixelRatio||1)<=1?"translate("+f+"px, "+h+"px)":"translate3d("+f+"px, "+h+"px, 0)",x)):Object.assign({},T,((t={})[O]=v?h+"px":"",t[b]=y?f+"px":"",t.transform="",t))}const vf={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,r=e.options,n=r.gpuAcceleration,i=void 0===n||n,a=r.adaptive,o=void 0===a||a,s=r.roundOffsets,l=void 0===s||s,u={placement:df(t.placement),variation:pf(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,yf(Object.assign({},u,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,yf(Object.assign({},u,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},bf={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var r=t.styles[e]||{},n=t.attributes[e]||{},i=t.elements[e];_p(i)&&Ap(i)&&(Object.assign(i.style,r),Object.keys(n).forEach((function(e){var t=n[e];!1===t?i.removeAttribute(e):i.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach((function(e){var n=t.elements[e],i=t.attributes[e]||{},a=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:r[e]).reduce((function(e,t){return e[t]="",e}),{});_p(n)&&Ap(n)&&(Object.assign(n.style,a),Object.keys(i).forEach((function(e){n.removeAttribute(e)})))}))}},requires:["computeStyles"]},Of={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,r=e.options,n=e.name,i=r.offset,a=void 0===i?[0,0]:i,o=tf.reduce((function(e,r){return e[r]=function(e,t,r){var n=df(e),i=[zp,Xp].indexOf(n)>=0?-1:1,a="function"==typeof r?r(Object.assign({},t,{placement:e})):r,o=a[0],s=a[1];return o=o||0,s=(s||0)*i,[zp,Up].indexOf(n)>=0?{x:s,y:o}:{x:o,y:s}}(r,t.rects,a),e}),{}),s=o[t.placement],l=s.x,u=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=u),t.modifiersData[n]=o}};var wf={left:"right",right:"left",bottom:"top",top:"bottom"};function _f(e){return e.replace(/left|right|bottom|top/g,(function(e){return wf[e]}))}var Sf={start:"end",end:"start"};function Ef(e){return e.replace(/start|end/g,(function(e){return Sf[e]}))}function xf(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&Sp(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Tf(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Pf(e,t,r){return t===Zp?Tf(function(e,t){var r=Op(e),n=qp(e),i=r.visualViewport,a=n.clientWidth,o=n.clientHeight,s=0,l=0;if(i){a=i.width,o=i.height;var u=kp();(u||!u&&"fixed"===t)&&(s=i.offsetLeft,l=i.offsetTop)}return{width:a,height:o,x:s+Rp(e),y:l}}(e,r)):wp(t)?function(e,t){var r=Ip(e,!1,"fixed"===t);return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}(t,r):Tf(function(e){var t,r=qp(e),n=Cp(e),i=null==(t=e.ownerDocument)?void 0:t.body,a=Ep(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),o=Ep(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),s=-n.scrollLeft+Rp(e),l=-n.scrollTop;return"rtl"===Dp(i||r).direction&&(s+=Ep(r.clientWidth,i?i.clientWidth:0)-a),{width:a,height:o,x:s,y:l}}(qp(e)))}function kf(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function If(e,t){return t.reduce((function(t,r){return t[r]=e,t}),{})}function Cf(e,t){void 0===t&&(t={});var r=t,n=r.placement,i=void 0===n?e.placement:n,a=r.strategy,o=void 0===a?e.strategy:a,s=r.boundary,l=void 0===s?"clippingParents":s,u=r.rootBoundary,c=void 0===u?Zp:u,d=r.elementContext,p=void 0===d?Jp:d,f=r.altBoundary,m=void 0!==f&&f,h=r.padding,g=void 0===h?0:h,y=kf("number"!=typeof g?g:If(g,Kp)),v=p===Jp?"reference":Jp,b=e.rects.popper,O=e.elements[m?v:p],w=function(e,t,r,n){var i="clippingParents"===t?function(e){var t=Bp(Mp(e)),r=["absolute","fixed"].indexOf(Dp(e).position)>=0&&_p(e)?Vp(e):e;return wp(r)?t.filter((function(e){return wp(e)&&xf(e,r)&&"body"!==Ap(e)})):[]}(e):[].concat(t),a=[].concat(i,[r]),o=a[0],s=a.reduce((function(t,r){var i=Pf(e,r,n);return t.top=Ep(i.top,t.top),t.right=xp(i.right,t.right),t.bottom=xp(i.bottom,t.bottom),t.left=Ep(i.left,t.left),t}),Pf(e,o,n));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}(wp(O)?O:O.contextElement||qp(e.elements.popper),l,c,o),_=Ip(e.elements.reference),S=mf({reference:_,element:b,strategy:"absolute",placement:i}),E=Tf(Object.assign({},b,S)),x=p===Jp?E:_,T={top:w.top-x.top+y.top,bottom:x.bottom-w.bottom+y.bottom,left:w.left-x.left+y.left,right:x.right-w.right+y.right},P=e.modifiersData.offset;if(p===Jp&&P){var k=P[i];Object.keys(T).forEach((function(e){var t=[Up,Gp].indexOf(e)>=0?1:-1,r=[Xp,Gp].indexOf(e)>=0?"y":"x";T[e]+=k[r]*t}))}return T}const Af={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var i=r.mainAxis,a=void 0===i||i,o=r.altAxis,s=void 0===o||o,l=r.fallbackPlacements,u=r.padding,c=r.boundary,d=r.rootBoundary,p=r.altBoundary,f=r.flipVariations,m=void 0===f||f,h=r.allowedAutoPlacements,g=t.options.placement,y=df(g),v=l||(y!==g&&m?function(e){if(df(e)===Wp)return[];var t=_f(e);return[Ef(e),t,Ef(t)]}(g):[_f(g)]),b=[g].concat(v).reduce((function(e,r){return e.concat(df(r)===Wp?function(e,t){void 0===t&&(t={});var r=t,n=r.placement,i=r.boundary,a=r.rootBoundary,o=r.padding,s=r.flipVariations,l=r.allowedAutoPlacements,u=void 0===l?tf:l,c=pf(n),d=c?s?ef:ef.filter((function(e){return pf(e)===c})):Kp,p=d.filter((function(e){return u.indexOf(e)>=0}));0===p.length&&(p=d);var f=p.reduce((function(t,r){return t[r]=Cf(e,{placement:r,boundary:i,rootBoundary:a,padding:o})[df(r)],t}),{});return Object.keys(f).sort((function(e,t){return f[e]-f[t]}))}(t,{placement:r,boundary:c,rootBoundary:d,padding:u,flipVariations:m,allowedAutoPlacements:h}):r)}),[]),O=t.rects.reference,w=t.rects.popper,_=new Map,S=!0,E=b[0],x=0;x<b.length;x++){var T=b[x],P=df(T),k=pf(T)===Hp,I=[Xp,Gp].indexOf(P)>=0,C=I?"width":"height",A=Cf(t,{placement:T,boundary:c,rootBoundary:d,altBoundary:p,padding:u}),q=I?k?Up:zp:k?Gp:Xp;O[C]>w[C]&&(q=_f(q));var R=_f(q),D=[];if(a&&D.push(A[P]<=0),s&&D.push(A[q]<=0,A[R]<=0),D.every((function(e){return e}))){E=T,S=!1;break}_.set(T,D)}if(S)for(var N=function(e){var t=b.find((function(t){var r=_.get(t);if(r)return r.slice(0,e).every((function(e){return e}))}));if(t)return E=t,"break"},L=m?3:1;L>0&&"break"!==N(L);L--);t.placement!==E&&(t.modifiersData[n]._skip=!0,t.placement=E,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function qf(e,t,r){return Ep(e,xp(t,r))}const Rf={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,r=e.options,n=e.name,i=r.mainAxis,a=void 0===i||i,o=r.altAxis,s=void 0!==o&&o,l=r.boundary,u=r.rootBoundary,c=r.altBoundary,d=r.padding,p=r.tether,f=void 0===p||p,m=r.tetherOffset,h=void 0===m?0:m,g=Cf(t,{boundary:l,rootBoundary:u,padding:d,altBoundary:c}),y=df(t.placement),v=pf(t.placement),b=!v,O=ff(y),w="x"===O?"y":"x",_=t.modifiersData.popperOffsets,S=t.rects.reference,E=t.rects.popper,x="function"==typeof h?h(Object.assign({},t.rects,{placement:t.placement})):h,T="number"==typeof x?{mainAxis:x,altAxis:x}:Object.assign({mainAxis:0,altAxis:0},x),P=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,k={x:0,y:0};if(_){if(a){var I,C="y"===O?Xp:zp,A="y"===O?Gp:Up,q="y"===O?"height":"width",R=_[O],D=R+g[C],N=R-g[A],L=f?-E[q]/2:0,j=v===Hp?S[q]:E[q],M=v===Hp?-E[q]:-S[q],F=t.elements.arrow,B=f&&F?jp(F):{width:0,height:0},Q=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},$=Q[C],V=Q[A],X=qf(0,S[q],B[q]),G=b?S[q]/2-L-X-$-T.mainAxis:j-X-$-T.mainAxis,U=b?-S[q]/2+L+X+V+T.mainAxis:M+X+V+T.mainAxis,z=t.elements.arrow&&Vp(t.elements.arrow),W=z?"y"===O?z.clientTop||0:z.clientLeft||0:0,K=null!=(I=null==P?void 0:P[O])?I:0,H=R+U-K,Y=qf(f?xp(D,R+G-K-W):D,R,f?Ep(N,H):N);_[O]=Y,k[O]=Y-R}if(s){var Z,J="x"===O?Xp:zp,ee="x"===O?Gp:Up,te=_[w],re="y"===w?"height":"width",ne=te+g[J],ie=te-g[ee],ae=-1!==[Xp,zp].indexOf(y),oe=null!=(Z=null==P?void 0:P[w])?Z:0,se=ae?ne:te-S[re]-E[re]-oe+T.altAxis,le=ae?te+S[re]+E[re]-oe-T.altAxis:ie,ue=f&&ae?function(e,t,r){var n=qf(e,t,r);return n>r?r:n}(se,te,le):qf(f?se:ne,te,f?le:ie);_[w]=ue,k[w]=ue-te}t.modifiersData[n]=k}},requiresIfExists:["offset"]},Df={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,r=e.state,n=e.name,i=e.options,a=r.elements.arrow,o=r.modifiersData.popperOffsets,s=df(r.placement),l=ff(s),u=[zp,Up].indexOf(s)>=0?"height":"width";if(a&&o){var c=function(e,t){return kf("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:If(e,Kp))}(i.padding,r),d=jp(a),p="y"===l?Xp:zp,f="y"===l?Gp:Up,m=r.rects.reference[u]+r.rects.reference[l]-o[l]-r.rects.popper[u],h=o[l]-r.rects.reference[l],g=Vp(a),y=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,v=m/2-h/2,b=c[p],O=y-d[u]-c[f],w=y/2-d[u]/2+v,_=qf(b,w,O),S=l;r.modifiersData[n]=((t={})[S]=_,t.centerOffset=_-w,t)}},effect:function(e){var t=e.state,r=e.options.element,n=void 0===r?"[data-popper-arrow]":r;null!=n&&("string"!=typeof n||(n=t.elements.popper.querySelector(n)))&&xf(t.elements.popper,n)&&(t.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Nf(e,t,r){return void 0===r&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function Lf(e){return[Xp,Up,Gp,zp].some((function(t){return e[t]>=0}))}const jf={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,r=e.name,n=t.rects.reference,i=t.rects.popper,a=t.modifiersData.preventOverflow,o=Cf(t,{elementContext:"reference"}),s=Cf(t,{altBoundary:!0}),l=Nf(o,n),u=Nf(s,i,a),c=Lf(l),d=Lf(u);t.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:c,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":d})}};var Mf=lf({defaultModifiers:[cf,hf,vf,bf,Of,Af,Rf,Df,jf]}),Ff=m(4335),Bf=m.n(Ff),Qf=function(e){return e.reduce((function(e,t){var r=t[0],n=t[1];return e[r]=n,e}),{})},$f="undefined"!=typeof window&&window.document&&window.document.createElement?r.useLayoutEffect:r.useEffect,Vf=[];function Xf(e){var t=r.useRef(e);return t.current=e,r.useCallback((function(){return t.current}),[])}var Gf=function(){};function Uf(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),function(){return{width:0,height:0,top:t,right:e,bottom:t,left:e,x:0,y:0,toJSON:function(){return null}}}}var zf=["styles","attributes"],Wf={getBoundingClientRect:Uf()},Kf={closeOnOutsideClick:!0,closeOnTriggerHidden:!1,defaultVisible:!1,delayHide:0,delayShow:0,followCursor:!1,interactive:!1,mutationObserverOptions:{attributes:!0,childList:!0,subtree:!0},offset:[0,6],trigger:"hover"};function Hf(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Yf=n().memo((({def:e,operation:t})=>{const i=(0,a.useStyles2)(Zf),[o,s]=(0,r.useState)(!1),{getTooltipProps:l,setTooltipRef:u,setTriggerRef:c,visible:d}=function(e,t){var n,i,a;void 0===e&&(e={}),void 0===t&&(t={});var o=Object.keys(Kf).reduce((function(e,t){var r;return Ds({},e,((r={})[t]=void 0!==e[t]?e[t]:Kf[t],r))}),e),s=r.useMemo((function(){return[{name:"offset",options:{offset:o.offset}}]}),Array.isArray(o.offset)?o.offset:[]),l=Ds({},t,{placement:t.placement||o.placement,modifiers:t.modifiers||s}),u=r.useState(null),c=u[0],d=u[1],p=r.useState(null),f=p[0],m=p[1],h=function(e){var t=e.initial,n=e.value,i=e.onChange,a=void 0===i?Gf:i;if(void 0===t&&void 0===n)throw new TypeError('Either "value" or "initial" variable must be set. Now both are undefined');var o=r.useState(t),s=o[0],l=o[1],u=Xf(s),c=r.useCallback((function(e){var t=u(),r="function"==typeof e?e(t):e;"function"==typeof r.persist&&r.persist(),l(r),"function"==typeof a&&a(r)}),[u,a]),d=void 0!==n;return[d?n:s,d?a:c]}({initial:o.defaultVisible,value:o.visible,onChange:o.onVisibleChange}),g=h[0],y=h[1],v=r.useRef();r.useEffect((function(){return function(){return clearTimeout(v.current)}}),[]);var b=function(e,t,n){void 0===n&&(n={});var i=r.useRef(null),a={onFirstUpdate:n.onFirstUpdate,placement:n.placement||"bottom",strategy:n.strategy||"absolute",modifiers:n.modifiers||Vf},o=r.useState({styles:{popper:{position:a.strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),s=o[0],l=o[1],u=r.useMemo((function(){return{name:"updateState",enabled:!0,phase:"write",fn:function(e){var t=e.state,r=Object.keys(t.elements);Js.flushSync((function(){l({styles:Qf(r.map((function(e){return[e,t.styles[e]||{}]}))),attributes:Qf(r.map((function(e){return[e,t.attributes[e]]})))})}))},requires:["computeStyles"]}}),[]),c=r.useMemo((function(){var e={onFirstUpdate:a.onFirstUpdate,placement:a.placement,strategy:a.strategy,modifiers:[].concat(a.modifiers,[u,{name:"applyStyles",enabled:!1}])};return Bf()(i.current,e)?i.current||e:(i.current=e,e)}),[a.onFirstUpdate,a.placement,a.strategy,a.modifiers,u]),d=r.useRef();return $f((function(){d.current&&d.current.setOptions(c)}),[c]),$f((function(){if(null!=e&&null!=t){var r=(n.createPopper||Mf)(e,t,c);return d.current=r,function(){r.destroy(),d.current=null}}}),[e,t,n.createPopper]),{state:d.current?d.current.state:null,styles:s.styles,attributes:s.attributes,update:d.current?d.current.update:null,forceUpdate:d.current?d.current.forceUpdate:null}}(o.followCursor?Wf:c,f,l),O=b.styles,w=b.attributes,_=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(b,zf),S=_.update,E=Xf({visible:g,triggerRef:c,tooltipRef:f,finalConfig:o}),x=r.useCallback((function(e){return Array.isArray(o.trigger)?o.trigger.includes(e):o.trigger===e}),Array.isArray(o.trigger)?o.trigger:[o.trigger]),T=r.useCallback((function(){clearTimeout(v.current),v.current=window.setTimeout((function(){return y(!1)}),o.delayHide)}),[o.delayHide,y]),P=r.useCallback((function(){clearTimeout(v.current),v.current=window.setTimeout((function(){return y(!0)}),o.delayShow)}),[o.delayShow,y]),k=r.useCallback((function(){E().visible?T():P()}),[E,T,P]);r.useEffect((function(){if(E().finalConfig.closeOnOutsideClick){var e=function(e){var t,r=E(),n=r.tooltipRef,i=r.triggerRef,a=(null==e.composedPath||null==(t=e.composedPath())?void 0:t[0])||e.target;a instanceof Node&&(null==n||null==i||n.contains(a)||i.contains(a)||T())};return document.addEventListener("mousedown",e),function(){return document.removeEventListener("mousedown",e)}}}),[E,T]),r.useEffect((function(){if(null!=c&&x("click"))return c.addEventListener("click",k),function(){return c.removeEventListener("click",k)}}),[c,x,k]),r.useEffect((function(){if(null!=c&&x("double-click"))return c.addEventListener("dblclick",k),function(){return c.removeEventListener("dblclick",k)}}),[c,x,k]),r.useEffect((function(){if(null!=c&&x("right-click")){var e=function(e){e.preventDefault(),k()};return c.addEventListener("contextmenu",e),function(){return c.removeEventListener("contextmenu",e)}}}),[c,x,k]),r.useEffect((function(){if(null!=c&&x("focus"))return c.addEventListener("focus",P),c.addEventListener("blur",T),function(){c.removeEventListener("focus",P),c.removeEventListener("blur",T)}}),[c,x,P,T]),r.useEffect((function(){if(null!=c&&x("hover"))return c.addEventListener("mouseenter",P),c.addEventListener("mouseleave",T),function(){c.removeEventListener("mouseenter",P),c.removeEventListener("mouseleave",T)}}),[c,x,P,T]),r.useEffect((function(){if(null!=f&&x("hover")&&E().finalConfig.interactive)return f.addEventListener("mouseenter",P),f.addEventListener("mouseleave",T),function(){f.removeEventListener("mouseenter",P),f.removeEventListener("mouseleave",T)}}),[f,x,P,T,E]);var I=null==_||null==(n=_.state)||null==(i=n.modifiersData)||null==(a=i.hide)?void 0:a.isReferenceHidden;return r.useEffect((function(){o.closeOnTriggerHidden&&I&&T()}),[o.closeOnTriggerHidden,T,I]),r.useEffect((function(){if(o.followCursor&&null!=c)return c.addEventListener("mousemove",e),function(){return c.removeEventListener("mousemove",e)};function e(e){var t=e.clientX,r=e.clientY;Wf.getBoundingClientRect=Uf(t,r),null==S||S()}}),[o.followCursor,c,S]),r.useEffect((function(){if(null!=f&&null!=S&&null!=o.mutationObserverOptions){var e=new MutationObserver(S);return e.observe(f,o.mutationObserverOptions),function(){return e.disconnect()}}}),[o.mutationObserverOptions,f,S]),Ds({getArrowProps:function(e){return void 0===e&&(e={}),Ds({},e,w.arrow,{style:Ds({},e.style,O.arrow),"data-popper-arrow":!0})},getTooltipProps:function(e){return void 0===e&&(e={}),Ds({},e,{style:Ds({},e.style,O.popper)},w.popper,{"data-popper-interactive":o.interactive})},setTooltipRef:m,setTriggerRef:d,tooltipRef:f,triggerRef:c,visible:g},_)}({placement:"top",visible:o,offset:[0,16],onVisibleChange:s,interactive:!0,trigger:["click"]});return n().createElement(n().Fragment,null,n().createElement(a.Button,{title:"Click to show description",ref:c,icon:"info-circle",size:"sm",variant:"secondary",fill:"text"}),d&&n().createElement(a.Portal,null,n().createElement("div",(p=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Hf(e,t,r[t])}))}return e}({ref:u},l()),f=null!=(f={className:i.docBox})?f:{},Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(f)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(f)).forEach((function(e){Object.defineProperty(p,e,Object.getOwnPropertyDescriptor(f,e))})),p),n().createElement("div",{className:i.docBoxHeader},n().createElement("span",null,e.renderer(t,e,"<expr>")),n().createElement(q,{grow:1}),n().createElement(a.Button,{icon:"times",onClick:()=>s(!1),fill:"text",variant:"secondary",title:"Remove operation"})),n().createElement("div",{className:i.docBoxBody,dangerouslySetInnerHTML:{__html:Jf(e,t)}}))));var p,f}));Yf.displayName="OperationDocs";const Zf=e=>({docBox:(0,c.css)({overflow:"hidden",background:e.colors.background.primary,border:`1px solid ${e.colors.border.strong}`,boxShadow:e.shadows.z3,maxWidth:"600px",padding:e.spacing(1),borderRadius:e.shape.borderRadius(),zIndex:e.zIndex.tooltip}),docBoxHeader:(0,c.css)({fontSize:e.typography.h5.fontSize,fontFamily:e.typography.fontFamilyMonospace,paddingBottom:e.spacing(1),display:"flex",alignItems:"center"}),docBoxBody:(0,c.css)({marginBottom:e.spacing(-1),color:e.colors.text.secondary}),signature:(0,c.css)({fontSize:e.typography.bodySmall.fontSize,fontFamily:e.typography.fontFamilyMonospace}),dropdown:(0,c.css)({opacity:0,color:e.colors.text.secondary})});function Jf(e,r){var n;return(0,t.renderMarkdown)(e.explainHandler?e.explainHandler(r,e):null!==(n=e.documentation)&&void 0!==n?n:"no docs")}function em(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tm(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){em(e,t,r[t])}))}return e}function rm(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const nm=n().memo((({operation:e,def:t,index:i,onChange:o,onRemove:s,queryModeller:l,dragHandleProps:u})=>{const c=(0,a.useStyles2)(im),[d,p]=(0,r.useState)({}),f=()=>{if(d.isOpen)p(rm(tm({},d),{isOpen:!1}));else{const e=l.getAlternativeOperations(t.alternativesKey).map((e=>({label:e.name,value:e})));p({isOpen:!0,alternatives:e})}};var m;return n().createElement("div",{className:c.header},!d.isOpen&&n().createElement(n().Fragment,null,n().createElement("div",u,null!==(m=t.name)&&void 0!==m?m:t.id),n().createElement(q,{grow:1}),n().createElement("div",{className:`${c.operationHeaderButtons} operation-header-show-on-hover`},n().createElement(a.Button,{icon:"angle-down",size:"sm",onClick:f,fill:"text",variant:"secondary",title:"Click to view alternative operations"}),n().createElement(Yf,{def:t,operation:e}),n().createElement(a.Button,{icon:"times",size:"sm",onClick:()=>s(i),fill:"text",variant:"secondary",title:"Remove operation"}))),d.isOpen&&n().createElement("div",{className:c.selectWrapper},n().createElement(a.Select,{autoFocus:!0,openMenuOnFocus:!0,placeholder:"Replace with",options:d.alternatives,isOpen:!0,onCloseMenu:f,onChange:r=>{if(r.value){const n=l.getOperationDef(r.value.id),a=[...n.defaultParams];for(let r=0;r<Math.min(e.params.length,a.length);r++)n.params[r].type===t.params[r].type&&(a[r]=e.params[r]);const s=rm(tm({},e),{params:a,id:r.value.id});o(i,t.changeTypeHandler?t.changeTypeHandler(s,n):s)}}})))}));nm.displayName="OperationHeader";const im=e=>({header:(0,c.css)({borderBottom:`1px solid ${e.colors.border.medium}`,padding:e.spacing(.5,.5,.5,1),display:"flex",alignItems:"center","&:hover .operation-header-show-on-hover":(0,c.css)({opacity:1})}),operationHeaderButtons:(0,c.css)({opacity:0,transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short})}),selectWrapper:(0,c.css)({paddingRight:e.spacing(2)})});function am(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const om=n().forwardRef(((e,t)=>{const{defaultValue:i="",minWidth:o=10,maxWidth:s,onCommitChange:l,onKeyDown:u,onBlur:c}=e,d=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["defaultValue","minWidth","maxWidth","onCommitChange","onKeyDown","onBlur"]),[p,f]=n().useState(i),[m,h]=n().useState(o);return(0,r.useEffect)((()=>{h(function(e,t,r){if(!e)return t;const n=(0,a.measureText)(e.toString(),14).width/8+3;return t&&n<t?t:n}(p.toString(),o))}),[p,s,o]),n().createElement(a.Input,(g=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){am(e,t,r[t])}))}return e}({},d),y=null!=(y={ref:t,value:p.toString(),onChange:e=>{f(e.currentTarget.value)},width:m,onBlur:e=>{c?c(e):l&&l(e)},onKeyDown:e=>{u?u(e):"Enter"===e.key&&l&&l(e)},"data-testid":"autosize-input"})?y:{},Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(y)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(y)).forEach((function(e){Object.defineProperty(g,e,Object.getOwnPropertyDescriptor(y,e))})),g));var g,y}));function sm(e){return e.editor?e.editor:e.options?cm:"boolean"===e.type?um:lm}function lm(e){var t;return n().createElement(om,{id:jr(e.operationIndex,e.index),defaultValue:null===(t=e.value)||void 0===t?void 0:t.toString(),minWidth:e.paramDef.minWidth,placeholder:e.paramDef.placeholder,title:e.paramDef.description,onCommitChange:t=>{e.onChange(e.index,t.currentTarget.value),e.paramDef.runQueryOnEnter&&"keydown"===t.type&&e.onRunQuery()}})}function um(e){return n().createElement(a.Checkbox,{id:jr(e.operationIndex,e.index),value:e.value,onChange:t=>e.onChange(e.index,t.currentTarget.checked)})}function cm({paramDef:e,value:r,index:i,operationIndex:o,onChange:s}){var l;const u=(0,a.useStyles2)(dm);let c=e.options;var d;(null===(l=c[0])||void 0===l?void 0:l.label)||(c=e.options.map((e=>({label:e.toString(),value:e}))));let p=null!==(d=c.find((e=>e.value===r)))&&void 0!==d?d:(0,t.toOption)(r);return!r&&e.optional?n().createElement("div",{className:u.optionalParam},n().createElement(a.Button,{size:"sm",variant:"secondary",title:`Add ${e.name}`,icon:"plus",onClick:()=>s(i,c[0].value)},e.name)):n().createElement(g,{gap:.5,direction:"row",alignItems:"center",wrap:!1},n().createElement(a.Select,{id:jr(o,i),value:p,options:c,placeholder:e.placeholder,allowCustomValue:!0,onChange:e=>s(i,e.value)}),e.optional&&n().createElement(a.Button,{"data-testid":`operations.${i}.remove-param`,size:"sm",fill:"text",icon:"times",variant:"secondary",title:`Remove ${e.name}`,onClick:()=>s(i,"")}))}om.displayName="AutoSizeInput";const dm=e=>({optionalParam:(0,c.css)({marginTop:e.spacing(1)})}),pm=function(e,t,r,n,i){e.paramChangedHandler?i(r,e.paramChangedHandler(n,t,e)):i(r,t)},fm=function(e,t,r,i,o){const s=e.map((e=>e.name)).join(" & ");return n().createElement("div",{className:o.restParam,key:`${i}-2`},n().createElement(a.Button,{size:"sm",icon:"plus",title:`Add ${s}`,variant:"secondary",onClick:t,"data-testid":`operations.${r}.add-rest-param`},s))},mm=e=>({card:(0,c.css)({background:e.colors.background.primary,border:`1px solid ${e.colors.border.medium}`,display:"flex",flexDirection:"column",cursor:"grab",borderRadius:e.shape.borderRadius(1),marginBottom:e.spacing(1),position:"relative",transition:"all 0.5s ease-in 0s"}),cardHighlight:(0,c.css)({boxShadow:`0px 0px 4px 0px ${e.colors.primary.border}`,border:`1px solid ${e.colors.primary.border}`}),infoIcon:(0,c.css)({marginLeft:e.spacing(.5),color:e.colors.text.secondary,":hover":{color:e.colors.text.primary}}),body:(0,c.css)({margin:e.spacing(1,1,1,1),display:"grid",gap:e.spacing(.5)}),paramRow:(0,c.css)({label:"paramRow",display:"table-row",verticalAlign:"middle"}),paramName:(0,c.css)({display:"table-cell",padding:e.spacing(0,1,0,0),fontSize:e.typography.bodySmall.fontSize,fontWeight:e.typography.fontWeightMedium,verticalAlign:"middle",height:"32px"}),paramValue:(0,c.css)({label:"paramValue",display:"table-cell",verticalAlign:"middle"}),restParam:(0,c.css)({padding:e.spacing(0,1,1,1)}),arrow:(0,c.css)({position:"absolute",top:"0",right:"-18px",display:"flex"}),arrowLine:(0,c.css)({height:"2px",width:"8px",backgroundColor:e.colors.border.strong,position:"relative",top:"14px"}),arrowArrow:(0,c.css)({width:0,height:0,borderTop:"5px solid transparent",borderBottom:"5px solid transparent",borderLeft:`7px solid ${e.colors.border.strong}`,position:"relative",top:"10px"})}),hm=function(e){const[t,n]=(0,r.useState)(!0);return(0,r.useEffect)((()=>{let t;return e?t=setTimeout((()=>{n(!1)}),1e3):n(!0),()=>clearTimeout(t)}),[e]),t&&e};function gm(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ym(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){gm(e,t,r[t])}))}return e}function vm(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function bm({operation:e,index:t,onRemove:r,onChange:i,onRunQuery:o,queryModeller:s,query:l,datasource:u,flash:d,highlight:p}){const f=(0,a.useStyles2)(mm),m=s.getOperationDef(e.id),h=hm(d);if(!m)return n().createElement("span",null,"Operation ",e.id," not found");const y=(r,n)=>{const a=vm(ym({},e),{params:[...e.params]});a.params[r]=n,pm(m,a,t,r,i)},v=()=>{const r=m.params.filter((e=>e.restParam)).map((()=>"")),n=vm(ym({},e),{params:[...e.params,...r]});pm(m,n,t,e.params.length,i)},b=r=>{const n=vm(ym({},e),{params:[...e.params.slice(0,r),...e.params.slice(r+1)]});pm(m,n,t,r,i)},O=[];for(let r=0;r<e.params.length;r++){const i=m.params.filter((e=>e.restParam)).length,s=m.params.length;let c;c=r<s-i?r:s-i+(r-(s-i))%i;const d=m.params[c],p=sm(d);O.push(n().createElement("div",{className:f.paramRow,key:`${r}-1`},!d.hideName&&n().createElement("div",{className:f.paramName},n().createElement("label",{htmlFor:jr(t,r)},d.name),d.description&&n().createElement(a.Tooltip,{placement:"top",content:d.description,theme:"info"},n().createElement(a.Icon,{name:"info-circle",size:"sm",className:f.infoIcon}))),n().createElement("div",{className:f.paramValue},n().createElement(g,{gap:.5,direction:"row",alignItems:"center",wrap:!1},n().createElement(p,{index:r,paramDef:d,value:e.params[r],operation:e,operationIndex:t,onChange:y,onRunQuery:o,query:l,datasource:u}),d.restParam&&(e.params.length>m.params.length||d.optional)&&n().createElement(a.Button,{"data-testid":`operations.${t}.remove-rest-param`,size:"sm",fill:"text",icon:"times",variant:"secondary",title:`Remove ${d.name}`,onClick:()=>b(r)})))))}let w;if(m.params.length>0){const r=m.params.filter((e=>e.restParam));r.length&&(w=fm(r,v,t,e.params.length,f))}return n().createElement(hp,{draggableId:`operation-${t}`,index:t},(a=>n().createElement("div",vm(ym({className:(0,c.cx)(f.card,(h||p)&&f.cardHighlight),ref:a.innerRef},a.draggableProps),{"data-testid":`operations.${t}.wrapper`}),n().createElement(nm,{operation:e,dragHandleProps:a.dragHandleProps,def:m,index:t,onChange:i,onRemove:r,queryModeller:s}),n().createElement("div",{className:f.body},O),w,t<l.operations.length-1&&n().createElement("div",{className:f.arrow},n().createElement("div",{className:f.arrowLine}),n().createElement("div",{className:f.arrowArrow})))))}function Om(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wm(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Om(e,t,r[t])}))}return e}function _m(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Sm({query:e,datasource:t,queryModeller:i,onChange:o,onRunQuery:s,highlightedOp:l}){const u=(0,a.useStyles2)(Em),{operations:c}=e,d=function(e){const t=(o=(0,r.useRef)(!1),s=(0,r.useCallback)((function(){return o.current}),[]),(0,r.useEffect)((function(){return o.current=!0,function(){o.current=!1}}),[]),s),n=(i=e,a=(0,r.useRef)(),(0,r.useEffect)((function(){a.current=i})),a.current);var i,a,o,s;if(!t())return e.map((()=>!1));if(!n)return e.map((()=>!0));let l=[];if(n.length-1===e.length&&e.every((e=>n.includes(e))))return e.map((()=>!1));if(n.length+1===e.length&&n.every((t=>e.includes(t)))){const t=e.find((e=>!n.includes(e)));l=e.map((e=>e===t))}else l=e.map(((e,t)=>{var r,i,a;return!((i=e.id)===(a=null===(r=n[t])||void 0===r?void 0:r.id)||`__${i}_by`===a||i===`__${a}_by`)}));return l}(c),[p,f]=(0,r.useState)(!1),m=(t,r)=>{const n=[...c];n.splice(t,1,r),o(_m(wm({},e),{operations:n}))},h=t=>{const r=[...c.slice(0,t),...c.slice(t+1)];o(_m(wm({},e),{operations:r}))},y=i.getCategories().map((e=>({value:e,label:e,items:i.getOperationsForCategory(e).map((e=>({value:e.id,label:e.name,isLeaf:!0})))})));return n().createElement(g,{gap:1,direction:"column"},n().createElement(g,{gap:1},c.length>0&&n().createElement(Fd,{onDragEnd:t=>{if(!t.destination)return;const r=[...c],n=r[t.source.index];r.splice(t.source.index,1),r.splice(t.destination.index,0,n),o(_m(wm({},e),{operations:r}))}},n().createElement(bp,{droppableId:"sortable-field-mappings",direction:"horizontal"},(r=>n().createElement("div",wm({className:u.operationList,ref:r.innerRef},r.droppableProps),c.map(((r,a)=>n().createElement(bm,{key:r.id+JSON.stringify(r.params)+a,queryModeller:i,index:a,operation:r,query:e,datasource:t,onChange:m,onRemove:h,onRunQuery:s,flash:d[a],highlight:l===r}))),r.placeholder)))),n().createElement("div",{className:u.addButton},p?n().createElement(a.Cascader,{options:y,onSelect:t=>{const r=i.getOperationDef(t);r&&(o(r.addOperationHandler(r,e,i)),f(!1))},onBlur:()=>{f(!1)},autoFocus:!0,alwaysOpen:!0,hideActiveLevelLabel:!0,placeholder:"Search"}):n().createElement(a.Button,{icon:"plus",variant:"secondary",onClick:()=>f(!0),title:"Add operation"},"Operations"))))}const Em=e=>({heading:(0,c.css)({label:"heading",fontSize:12,fontWeight:e.typography.fontWeightMedium,marginBottom:0}),operationList:(0,c.css)({label:"operationList",display:"flex",flexWrap:"wrap",gap:e.spacing(2)}),addButton:(0,c.css)({label:"addButton",width:126,paddingBottom:e.spacing(1)})});function xm({query:e,lang:t}){const r=(0,a.useTheme2)(),i=Tm(r),o=ce().highlight(e,t.grammar,t.name);return n().createElement("div",{className:(0,c.cx)(i.editorField,"prism-syntax-highlight"),"aria-label":"selector",dangerouslySetInnerHTML:{__html:o}})}const Tm=e=>({editorField:(0,c.css)({fontFamily:e.typography.fontFamilyMonospace,fontSize:e.typography.bodySmall.fontSize})});function Pm({query:e,queryModeller:t,stepNumber:r,lang:i,onMouseEnter:a,onMouseLeave:o}){return n().createElement(n().Fragment,null,e.operations.map(((e,s)=>{const l=t.getOperationDef(e.id);if(!l)return`Operation ${e.id} not found`;const u=l.renderer(e,l,"<expr>");var c;const d=l.explainHandler?l.explainHandler(e,l):null!==(c=l.documentation)&&void 0!==c?c:"no docs";return n().createElement("div",{key:s,onMouseEnter:()=>null==a?void 0:a(e,s),onMouseLeave:()=>null==o?void 0:o(e,s)},n().createElement(Cs,{stepNumber:s+r,title:n().createElement(xm,{query:u,lang:i}),markdown:d}))})))}function km({children:e}){const t=(0,a.useStyles2)(Im);return n().createElement("div",{className:t.root},n().createElement(g,{gap:1},e))}const Im=e=>({root:(0,c.css)({padding:e.spacing(1,1,0,1),backgroundColor:e.colors.background.secondary,borderRadius:e.shape.borderRadius(1)})}),Cm=({datasource:e,query:t,onChange:i,data:o,queryModeller:s,buildVisualQueryFromString:l})=>{const[u,c]=(0,r.useState)([]),d=(0,a.useStyles2)(Am);return(0,r.useEffect)((()=>{const r={expr:s.renderQuery(t),refId:""},n=e.getQueryHints(r,(null==o?void 0:o.series)||[]).filter((e=>{var t;return null===(t=e.fix)||void 0===t?void 0:t.action}));c(n)}),[e,t,o,s]),n().createElement(n().Fragment,null,u.length>0&&n().createElement("div",{className:d.container},u.map((r=>{var o,u,c;return n().createElement(a.Tooltip,{content:`${r.label} ${null===(o=r.fix)||void 0===o?void 0:o.label}`,key:r.type},n().createElement(a.Button,{onClick:()=>{var n;if(null==r||null===(n=r.fix)||void 0===n?void 0:n.action){const n={expr:s.renderQuery(t),refId:""},a=e.modifyQuery(n,r.fix.action),o=l(a.expr);return i(o.query)}},fill:"outline",size:"sm",className:d.hint},"hint: "+(null===(c=r.fix)||void 0===c||null===(u=c.action)||void 0===u?void 0:u.type.toLowerCase().replace("_"," "))+"()"))}))))};Cm.displayName="QueryBuilderHints";const Am=e=>({container:c.css`
      display: flex;
      align-items: start;
    `,hint:c.css`
      margin-right: ${e.spacing(1)};
    `});var qm=m(5464),Rm=m.n(qm);function Dm(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function Nm(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Lm=" ";function jm({query:e,onChange:i,onGetMetrics:o,variableEditor:s}){const l=(0,a.useStyles2)(Mm),[u,c]=(0,r.useState)({}),d=(0,r.useCallback)(((e,t)=>{var r;const n=null!==(r=e.label)&&void 0!==r?r:e.value;return!!n&&(!n.toLowerCase||t.split(Lm).reduce(((e,t)=>e&&n.toLowerCase().includes(t.toLowerCase())),!0))}),[]),p=(0,r.useCallback)(((e,t)=>{return e.__isNew__?e.label:n().createElement(Rm(),{searchWords:t.inputValue.split(Lm),textToHighlight:null!==(r=e.label)&&void 0!==r?r:"",highlightClassName:l.highlight});var r}),[l.highlight]),f=function(){var e=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){Dm(a,n,i,o,s,"next",e)}function s(e){Dm(a,n,i,o,s,"throw",e)}o(void 0)}))}}((function*(){c({isLoading:!0});const e=yield o();c({metrics:e,isLoading:void 0})}));return function(){return e.apply(this,arguments)}}(),m=({value:t})=>{var r,n;t&&i((r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Nm(e,t,r[t])}))}return e}({},e),n=null!=(n={metric:Jn(t)})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))})),r))},h=()=>n().createElement(a.Select,{inputId:"vm-metric-select",className:l.select,value:e.metric?(0,t.toOption)(e.metric):void 0,placeholder:"Select metric",allowCustomValue:!0,formatOptionLabel:p,filterOption:d,onOpenMenu:f,isLoading:u.isLoading,options:u.metrics,onChange:m});return s?n().createElement(a.InlineFieldRow,null,n().createElement(a.InlineField,{label:"Metric",labelWidth:20,tooltip:n().createElement("div",null,"Optional: returns a list of label values for the label name in the specified metric.")},h())):n().createElement(v,null,n().createElement(E,{label:"Metric"},h()))}const Mm=e=>({select:c.css`
    min-width: 125px;
  `,highlight:c.css`
    label: select__match-highlight;
    background: inherit;
    padding: inherit;
    color: ${e.colors.warning.contrastText};
    background-color: ${e.colors.warning.main};
  `});function Fm(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bm(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Fm(e,t,r[t])}))}return e}function Qm(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const $m=n().memo((e=>{const{nestedQuery:r,index:i,datasource:o,onChange:s,onRemove:l,onRunQuery:u,showExplain:c}=e,d=(0,a.useStyles2)(Xm);return n().createElement("div",{className:d.card},n().createElement("div",{className:d.header},n().createElement("div",{className:d.name},"Operator"),n().createElement(a.Select,{width:"auto",options:Vm,value:(0,t.toOption)(r.operator),onChange:e=>{s(i,Qm(Bm({},r),{operator:e.value}))}}),n().createElement("div",{className:d.name},"Vector matches"),n().createElement("div",{className:d.vectorMatchWrapper},n().createElement(a.Select,{width:"auto",value:r.vectorMatchesType||"on",allowCustomValue:!0,options:[{value:"on",label:"on"},{value:"ignoring",label:"ignoring"}],onChange:e=>{s(i,Qm(Bm({},r),{vectorMatchesType:e.value}))}}),n().createElement(om,{className:d.vectorMatchInput,minWidth:20,defaultValue:r.vectorMatches,onCommitChange:e=>{s(i,Qm(Bm({},r),{vectorMatches:e.currentTarget.value,vectorMatchesType:r.vectorMatchesType||"on"}))}})),n().createElement(q,{grow:1}),n().createElement(a.IconButton,{"aria-label":"",name:"times",size:"sm",onClick:()=>l(i)})),n().createElement("div",{className:d.body},n().createElement(I,null,n().createElement(eh,{showExplain:c,query:r.query,datasource:o,onRunQuery:u,onChange:e=>{s(i,Qm(Bm({},r),{query:e}))}}))))})),Vm=Gr.map((e=>({label:e.sign,value:e.sign})));$m.displayName="NestedQuery";const Xm=e=>({card:(0,c.css)({label:"card",display:"flex",flexDirection:"column",gap:e.spacing(.5)}),header:(0,c.css)({label:"header",padding:e.spacing(.5,.5,.5,1),gap:e.spacing(1),display:"flex",alignItems:"center"}),name:(0,c.css)({label:"name",whiteSpace:"nowrap"}),body:(0,c.css)({label:"body",paddingLeft:e.spacing(2)}),vectorMatchInput:(0,c.css)({label:"vectorMatchInput",marginLeft:-1}),vectorMatchWrapper:(0,c.css)({label:"vectorMatchWrapper",display:"flex"})});function Gm(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Um(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Gm(e,t,r[t])}))}return e}function zm(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Wm(e){const{query:t,datasource:r,onChange:i,onRunQuery:a,showExplain:o}=e;var s;const l=null!==(s=t.binaryQueries)&&void 0!==s?s:[],u=(e,r)=>{const n=[...l];n.splice(e,1,r),i(zm(Um({},t),{binaryQueries:n}))},c=e=>{const r=[...l.slice(0,e),...l.slice(e+1)];i(zm(Um({},t),{binaryQueries:r}))};return n().createElement(g,{direction:"column",gap:1},l.map(((e,t)=>n().createElement($m,{key:t.toString(),nestedQuery:e,index:t,onChange:u,datasource:r,onRemove:c,onRunQuery:a,showExplain:o}))))}const Km="Fetch all series matching metric name and label filters.",Hm=n().memo((({query:e})=>{const t=Nn(e||"").query,r={grammar:mr,name:"promql"};return n().createElement(g,{gap:.5,direction:"column"},n().createElement(Cs,{stepNumber:1,title:n().createElement(xm,{query:`${t.metric} ${Tn.renderLabels(t.labels)}`,lang:r})},Km),n().createElement(Pm,{stepNumber:2,queryModeller:Tn,query:t,lang:r}))}));function Ym(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function Zm(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){Ym(a,n,i,o,s,"next",e)}function s(e){Ym(a,n,i,o,s,"throw",e)}o(void 0)}))}}function Jm(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Hm.displayName="PromQueryBuilderExplained";const eh=n().memo((e=>{const{datasource:t,query:i,onChange:a,onRunQuery:o,data:s,showExplain:l}=e,[u,c]=(0,r.useState)(),d=(0,r.useCallback)(function(){var e=Zm((function*(e){const r=t.getVariables(),n=yield e;return[...r.map((e=>({label:e,value:e}))),...n.map((e=>({label:e.value,value:e.value,title:e.description})))]}));return function(t){return e.apply(this,arguments)}}(),[t]),p=function(){var e=Zm((function*(e){if(!i.metric)return yield t.languageProvider.fetchLabels(),t.languageProvider.getLabelKeys().map((e=>({value:e})));const r=i.labels.filter((t=>t!==e));r.push({label:"__name__",op:"=",value:i.metric});const n=Tn.renderLabels(r),a=yield t.languageProvider.fetchSeriesLabels(n);return Object.keys(a).filter((e=>!r.find((t=>t.label===e)))).map((e=>({value:e})))}));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Zm((function*(e){if(!e.label)return[];if(!i.metric)return(yield t.languageProvider.getLabelValues(e.label)).map((e=>({value:e})));const r=i.labels.filter((t=>t!==e));r.push({label:"__name__",op:"=",value:i.metric});const n=Tn.renderLabels(r);var a;return null!==(a=(yield t.languageProvider.fetchSeriesLabels(n))[t.interpolateString(e.label)].map((e=>({value:e}))))&&void 0!==a?a:[]}));return function(t){return e.apply(this,arguments)}}(),m=(0,r.useCallback)((()=>d(function(e,t){return th.apply(this,arguments)}(t,i))),[t,i,d]),h={grammar:mr,name:"promql"};return n().createElement(n().Fragment,null,n().createElement(T,null,n().createElement(jm,{query:i,onChange:a,onGetMetrics:m}),n().createElement(Is,{labelsFilters:i.labels,onChange:e=>{var t,r;a((t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Jm(e,t,r[t])}))}return e}({},i),r=null!=(r={labels:e})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})),t))},onGetLabelNames:e=>d(p(e)),onGetLabelValues:e=>d(f(e))})),l&&n().createElement(Cs,{stepNumber:1,title:n().createElement(xm,{query:`${i.metric} ${Tn.renderLabels(i.labels)}`,lang:h})},Km),n().createElement(km,null,n().createElement(Sm,{queryModeller:Tn,datasource:t,query:i,onChange:a,onRunQuery:o,highlightedOp:u}),n().createElement(Cm,{datasource:t,query:i,onChange:a,data:s,queryModeller:Tn,buildVisualQueryFromString:Nn})),l&&n().createElement(Pm,{lang:h,query:i,stepNumber:2,queryModeller:Tn,onMouseEnter:e=>c(e),onMouseLeave:()=>c(void 0)}),i.binaryQueries&&i.binaryQueries.length>0&&n().createElement(Wm,{query:i,datasource:t,onChange:a,onRunQuery:o,showExplain:l}))}));function th(){return th=Zm((function*(e,t){let r;if(e.languageProvider.metricsMetadata||(yield e.languageProvider.loadMetricsMetadata()),e.languageProvider.metricsMetadata||(e.languageProvider.metricsMetadata={}),t.labels.length>0){const i=Tn.renderLabels(t.labels);var n;r=null!==(n=(yield e.languageProvider.getSeries(i,!0)).__name__)&&void 0!==n?n:[]}else{var i;r=null!==(i=yield e.languageProvider.getLabelValues("__name__"))&&void 0!==i?i:[]}return r.map((t=>({value:t,description:gi(t,e.languageProvider.metricsMetadata)})))})),th.apply(this,arguments)}function rh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nh(e){const{query:t,onChange:i,onRunQuery:a,datasource:o,data:s,showExplain:l}=e,[u,c]=(0,r.useReducer)(ih.reducer,{expr:t.expr});return(0,r.useEffect)((()=>{c(oh(t.expr))}),[t.expr]),u.visQuery?n().createElement(n().Fragment,null,n().createElement(eh,{query:u.visQuery,datasource:o,onChange:t=>{const r=Tn.renderQuery(t);var n,a;c(ah({visQuery:t,expr:r})),i((n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){rh(e,t,r[t])}))}return e}({},e.query),a=null!=(a={expr:r})?a:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(a)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(a,e))})),n))},onRunQuery:a,data:s,showExplain:l})):null}eh.displayName="PromQueryBuilder";const ih=function(e){var t=e.name;if(!t)throw new Error("`name` is a required option for createSlice");var r,n="function"==typeof e.initialState?e.initialState:ms(e.initialState),i=e.reducers||{},a=Object.keys(i),o={},s={},l={};function u(){var t="function"==typeof e.extraReducers?hs(e.extraReducers):[e.extraReducers],r=t[0],i=void 0===r?{}:r,a=t[1],o=void 0===a?[]:a,l=t[2],u=void 0===l?void 0:l,c=ds(ds({},i),s);return function(e,t,r,n){void 0===r&&(r=[]);var i,a=hs(t),o=a[0],s=a[1],l=a[2];if(function(e){return"function"==typeof e}(e))i=function(){return ms(e())};else{var u=ms(e);i=function(){return u}}function c(e,t){void 0===e&&(e=i());var r=ns([o[t.type]],s.filter((function(e){return(0,e.matcher)(t)})).map((function(e){return e.reducer})));return 0===r.filter((function(e){return!!e})).length&&(r=[l]),r.reduce((function(e,r){if(r){var n;if(ro(e))return void 0===(n=r(e,t))?e:n;if(no(e))return Jo(e,(function(e){return r(e,t)}));if(void 0===(n=r(e,t))){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return n}return e}),e)}return c.getInitialState=i,c}(n,(function(e){for(var t in c)e.addCase(t,c[t]);for(var r=0,n=o;r<n.length;r++){var i=n[r];e.addMatcher(i.matcher,i.reducer)}u&&e.addDefaultCase(u)}))}return a.forEach((function(e){var r,n,a=i[e],u=t+"/"+e;"reducer"in a?(r=a.reducer,n=a.prepare):r=a,o[e]=r,s[u]=r,l[e]=n?fs(u,n):fs(u)})),{name:t,reducer:function(e,t){return r||(r=u()),r(e,t)},actions:l,caseReducers:o,getInitialState:function(){return r||(r=u()),r.getInitialState()}}}({name:"prom-builder-container",initialState:{expr:""},reducers:{visualQueryChange:(e,t)=>{e.expr=t.payload.expr,e.visQuery=t.payload.visQuery},exprChanged:(e,t)=>{if(!e.visQuery||e.expr!==t.payload){e.expr=t.payload;const r=Nn(t.payload);e.visQuery=r.query}}}}),{visualQueryChange:ah,exprChanged:oh}=ih.actions;function sh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){sh(e,t,r[t])}))}return e}function uh(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function ch(e){const t=[{value:"range",label:"Range",description:"Run query over a range of time"},{value:"instant",label:"Instant",description:'Run query against a single point in time. For this query, the "To" time is used'}];return e&&t.push({value:"both",label:"Both",description:"Run an Instant query and a Range query"}),t}function dh(e,t){return r=>{t(uh(lh({},e),"instant"===r?{instant:!0,range:!1,exemplar:!1}:"range"===r?{instant:!1,range:!0}:{instant:!0,range:!0}))}}(0,r.memo)((({query:e,onChange:t,onRunQuery:r})=>{const i=ch(!0),o=dh(e,t);var s;return n().createElement("div",{"aria-label":"Prometheus extra field",className:"gf-form-inline","data-testid":ph.extraFieldEditor},n().createElement("div",{"data-testid":ph.queryTypeField,className:(0,c.cx)("gf-form explore-input-margin",c.css`
              flex-wrap: nowrap;
            `),"aria-label":"Query type field"},n().createElement(a.InlineFormLabel,{width:"auto"},"Query type"),n().createElement(a.RadioButtonGroup,{options:i,value:e.range&&e.instant?"both":e.instant?"instant":"range",onChange:o})),n().createElement("div",{"data-testid":ph.stepField,className:(0,c.cx)("gf-form",c.css`
              flex-wrap: nowrap;
            `),"aria-label":"Step field"},n().createElement(a.InlineFormLabel,{width:6,tooltip:"Time units and built-in variables can be used here, for example: $__interval, $__rate_interval, 5s, 1m, 3h, 1d, 1y (Default if no unit is specified: s)"},"Min step"),n().createElement("input",{type:"text",className:"gf-form-input width-4",placeholder:"auto",onChange:function(r){var n;r.currentTarget.value!==e.interval&&(n=r.currentTarget.value,t(uh(lh({},e),{interval:n})))},onKeyDown:function(e){"Enter"===e.key&&e.shiftKey&&r()},value:null!==(s=e.interval)&&void 0!==s?s:""})))})).displayName="PromExploreExtraField";const ph={extraFieldEditor:"prom-editor-extra-field",stepField:"prom-editor-extra-field-step",queryTypeField:"prom-editor-extra-field-query-type"};var fh=function(e,t){return"boolean"==typeof t?t:!e};function mh({title:e,children:t,collapsedInfo:i}){const[o,s]=(u=!1,(0,r.useReducer)(fh,u)),l=(0,a.useStyles2)(hh);var u;return n().createElement(g,{gap:0,direction:"column"},n().createElement("div",{className:l.header,onClick:s,title:"Click to edit options"},n().createElement("div",{className:l.toggle},n().createElement(a.Icon,{name:o?"angle-down":"angle-right"})),n().createElement("h6",{className:l.title},e),!o&&n().createElement("div",{className:l.description},i.map(((e,t)=>n().createElement("span",{key:t},e))))),o&&n().createElement("div",{className:l.body},t))}const hh=e=>({switchLabel:(0,c.css)({color:e.colors.text.secondary,cursor:"pointer",fontSize:e.typography.bodySmall.fontSize,"&:hover":{color:e.colors.text.primary}}),header:(0,c.css)({display:"flex",cursor:"pointer",alignItems:"baseline",color:e.colors.text.primary,"&:hover":{background:e.colors.emphasize(e.colors.background.primary,.03)}}),title:(0,c.css)({flexGrow:1,overflow:"hidden",fontSize:e.typography.bodySmall.fontSize,fontWeight:e.typography.fontWeightMedium,margin:0}),description:(0,c.css)({color:e.colors.text.secondary,fontSize:e.typography.bodySmall.fontSize,paddingLeft:e.spacing(2),gap:e.spacing(2),display:"flex"}),body:(0,c.css)({display:"flex",paddingTop:e.spacing(2),gap:e.spacing(2),flexWrap:"wrap"}),toggle:(0,c.css)({color:e.colors.text.secondary,marginRight:`${e.spacing(1)}`})}),gh=[{label:"Auto",value:Ua.Auto,description:"Only includes unique labels"},{label:"Verbose",value:Ua.Verbose,description:"All label names and values"},{label:"Custom",value:Ua.Custom,description:"Provide a naming template"}],yh=n().memo((({legendFormat:e,onChange:t,onRunQuery:i})=>{const o=vh(e),s=(0,r.useRef)(null);return n().createElement(E,{label:"Legend",tooltip:"Series name override or template. Ex. {{hostname}} will be replaced with label value for hostname."},n().createElement(n().Fragment,null,o===Ua.Custom&&n().createElement(om,{id:"legendFormat",minWidth:22,placeholder:"auto",defaultValue:e,onCommitChange:r=>{let n=r.currentTarget.value;0===n.length&&(n=Ua.Auto),n!==e&&(t(n),i())},ref:s}),o!==Ua.Custom&&n().createElement(a.Select,{inputId:"legend.mode",isSearchable:!1,placeholder:"Select legend mode",options:gh,width:22,onChange:e=>{switch(e.value){case Ua.Auto:t(Ua.Auto);break;case Ua.Custom:t("{{label_name}}"),setTimeout((()=>{var e,t;null===(e=s.current)||void 0===e||e.focus(),null===(t=s.current)||void 0===t||t.setSelectionRange(2,12,"forward")}),10);break;case Ua.Verbose:t("")}i()},value:gh.find((e=>e.value===o))})))}));function vh(e){return e===Ua.Auto?Ua.Auto:null==e||""===e?Ua.Verbose:Ua.Custom}function bh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Oh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){bh(e,t,r[t])}))}return e}function wh(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}yh.displayName="PromQueryLegendEditor";const _h=n().memo((({query:e,app:r,onChange:i,onRunQuery:o})=>{const s=ch(r===t.CoreApp.Explore||r===t.CoreApp.PanelEditor),l=dh(e,i),u=vr.find((t=>t.value===e.format))||vr[0],c=function(e,t){return e.range&&e.instant&&t.includes("both")?"both":!e.range&&e.instant&&t.includes("instant")?"instant":t.includes("range")?"range":t[0]}(e,s.map((e=>e.value))),d=s.find((e=>e.value===c))||s[0];return n().createElement(T,null,n().createElement(mh,{title:"Options",collapsedInfo:Sh(e,u.label,d.label)},n().createElement(yh,{legendFormat:e.legendFormat,onChange:t=>i(wh(Oh({},e),{legendFormat:t})),onRunQuery:o}),n().createElement(E,{label:"Min step",tooltip:n().createElement(n().Fragment,null,"An additional lower limit for the step parameter of the Prometheus query and for the"," ",n().createElement("code",null,"$__interval")," and ",n().createElement("code",null,"$__rate_interval")," variables.")},n().createElement(om,{type:"text","aria-label":"Set lower limit for the step parameter",placeholder:"auto",minWidth:10,onCommitChange:t=>{i(wh(Oh({},e),{interval:t.currentTarget.value})),o()},defaultValue:e.interval})),n().createElement(E,{label:"Format"},n().createElement(a.Select,{value:u,allowCustomValue:!0,onChange:t=>{i(wh(Oh({},e),{format:t.value})),o()},options:vr})),n().createElement(E,{label:"Type"},n().createElement(a.RadioButtonGroup,{options:s,value:c,onChange:l})),e.intervalFactor&&e.intervalFactor>1&&n().createElement(E,{label:"Resolution"},n().createElement(a.Select,{"aria-label":"Select resolution",isSearchable:!1,options:br,onChange:t=>{i(wh(Oh({},e),{intervalFactor:t.value})),o()},value:br.find((t=>t.value===e.intervalFactor))}))))}));function Sh(e,t,r){const n=[];var i;return n.push(`Legend: ${function(e){const t=vh(e);var r;return t!==Ua.Custom?null===(r=gh.find((e=>e.value===t)))||void 0===r?void 0:r.label:e}(e.legendFormat)}`),n.push(`Format: ${t}`),n.push(`Step: ${null!==(i=e.interval)&&void 0!==i?i:"auto"}`),n.push(`Type: ${r}`),n}function Eh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}_h.displayName="PromQueryBuilderOptions";class xh extends r.PureComponent{render(){const{children:e}=this.props,{value:t}=this.state;return n().createElement(n().Fragment,null,e(t,this.onSaveToStore,this.onDeleteFromStore))}constructor(e){super(e),Eh(this,"onSaveToStore",(e=>{const{storageKey:t}=this.props;try{Xa.setObject(t,e)}catch(e){console.error(e)}this.setState({value:e})})),Eh(this,"onDeleteFromStore",(()=>{const{storageKey:e,defaultValue:t}=this.props;try{Xa.delete(e)}catch(e){console.log(e)}this.setState({value:t})}));const{storageKey:t,defaultValue:r}=e;this.state={value:Xa.getObject(t,r)}}}function Th(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Ph="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()};function kh(e){cancelAnimationFrame(e.id)}var Ih=-1;function Ch(e){if(void 0===e&&(e=!1),-1===Ih||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",document.body.appendChild(t),Ih=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return Ih}var Ah=null;function qh(e){if(void 0===e&&(e=!1),null===Ah||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";var n=document.createElement("div"),i=n.style;return i.width="100px",i.height="100px",t.appendChild(n),document.body.appendChild(t),t.scrollLeft>0?Ah="positive-descending":(t.scrollLeft=1,Ah=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t),Ah}return Ah}var Rh=function(e,t){return e};function Dh(e){var t,n=e.getItemOffset,i=e.getEstimatedTotalSize,a=e.getItemSize,o=e.getOffsetForIndexAndAlignment,s=e.getStartIndexForOffset,l=e.getStopIndexForStartIndex,u=e.initInstanceProps,c=e.shouldResetStyleCacheOnItemSizeChange,d=e.validateProps;return t=function(e){function t(t){var r;return(r=e.call(this,t)||this)._instanceProps=u(r.props,Th(r)),r._outerRef=void 0,r._resetIsScrollingTimeoutId=null,r.state={instance:Th(r),isScrolling:!1,scrollDirection:"forward",scrollOffset:"number"==typeof r.props.initialScrollOffset?r.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},r._callOnItemsRendered=void 0,r._callOnItemsRendered=Ys((function(e,t,n,i){return r.props.onItemsRendered({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:n,visibleStopIndex:i})})),r._callOnScroll=void 0,r._callOnScroll=Ys((function(e,t,n){return r.props.onScroll({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:n})})),r._getItemStyle=void 0,r._getItemStyle=function(e){var t,i=r.props,o=i.direction,s=i.itemSize,l=i.layout,u=r._getItemStyleCache(c&&s,c&&l,c&&o);if(u.hasOwnProperty(e))t=u[e];else{var d=n(r.props,e,r._instanceProps),p=a(r.props,e,r._instanceProps),f="horizontal"===o||"horizontal"===l,m="rtl"===o,h=f?d:0;u[e]=t={position:"absolute",left:m?void 0:h,right:m?h:void 0,top:f?0:d,height:f?"100%":p,width:f?p:"100%"}}return t},r._getItemStyleCache=void 0,r._getItemStyleCache=Ys((function(e,t,r){return{}})),r._onScrollHorizontal=function(e){var t=e.currentTarget,n=t.clientWidth,i=t.scrollLeft,a=t.scrollWidth;r.setState((function(e){if(e.scrollOffset===i)return null;var t=r.props.direction,o=i;if("rtl"===t)switch(qh()){case"negative":o=-i;break;case"positive-descending":o=a-n-i}return o=Math.max(0,Math.min(o,a-n)),{isScrolling:!0,scrollDirection:e.scrollOffset<i?"forward":"backward",scrollOffset:o,scrollUpdateWasRequested:!1}}),r._resetIsScrollingDebounced)},r._onScrollVertical=function(e){var t=e.currentTarget,n=t.clientHeight,i=t.scrollHeight,a=t.scrollTop;r.setState((function(e){if(e.scrollOffset===a)return null;var t=Math.max(0,Math.min(a,i-n));return{isScrolling:!0,scrollDirection:e.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!1}}),r._resetIsScrollingDebounced)},r._outerRefSetter=function(e){var t=r.props.outerRef;r._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},r._resetIsScrollingDebounced=function(){null!==r._resetIsScrollingTimeoutId&&kh(r._resetIsScrollingTimeoutId),r._resetIsScrollingTimeoutId=function(e,t){var r=Ph(),n={id:requestAnimationFrame((function i(){Ph()-r>=t?e.call(null):n.id=requestAnimationFrame(i)}))};return n}(r._resetIsScrolling,150)},r._resetIsScrolling=function(){r._resetIsScrollingTimeoutId=null,r.setState({isScrolling:!1},(function(){r._getItemStyleCache(-1,null)}))},r}Rs(t,e),t.getDerivedStateFromProps=function(e,t){return Nh(e,t),d(e),null};var p=t.prototype;return p.scrollTo=function(e){e=Math.max(0,e),this.setState((function(t){return t.scrollOffset===e?null:{scrollDirection:t.scrollOffset<e?"forward":"backward",scrollOffset:e,scrollUpdateWasRequested:!0}}),this._resetIsScrollingDebounced)},p.scrollToItem=function(e,t){void 0===t&&(t="auto");var r=this.props,n=r.itemCount,i=r.layout,a=this.state.scrollOffset;e=Math.max(0,Math.min(e,n-1));var s=0;if(this._outerRef){var l=this._outerRef;s="vertical"===i?l.scrollWidth>l.clientWidth?Ch():0:l.scrollHeight>l.clientHeight?Ch():0}this.scrollTo(o(this.props,e,t,a,this._instanceProps,s))},p.componentDidMount=function(){var e=this.props,t=e.direction,r=e.initialScrollOffset,n=e.layout;if("number"==typeof r&&null!=this._outerRef){var i=this._outerRef;"horizontal"===t||"horizontal"===n?i.scrollLeft=r:i.scrollTop=r}this._callPropsCallbacks()},p.componentDidUpdate=function(){var e=this.props,t=e.direction,r=e.layout,n=this.state,i=n.scrollOffset;if(n.scrollUpdateWasRequested&&null!=this._outerRef){var a=this._outerRef;if("horizontal"===t||"horizontal"===r)if("rtl"===t)switch(qh()){case"negative":a.scrollLeft=-i;break;case"positive-ascending":a.scrollLeft=i;break;default:var o=a.clientWidth,s=a.scrollWidth;a.scrollLeft=s-o-i}else a.scrollLeft=i;else a.scrollTop=i}this._callPropsCallbacks()},p.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&kh(this._resetIsScrollingTimeoutId)},p.render=function(){var e=this.props,t=e.children,n=e.className,a=e.direction,o=e.height,s=e.innerRef,l=e.innerElementType,u=e.innerTagName,c=e.itemCount,d=e.itemData,p=e.itemKey,f=void 0===p?Rh:p,m=e.layout,h=e.outerElementType,g=e.outerTagName,y=e.style,v=e.useIsScrolling,b=e.width,O=this.state.isScrolling,w="horizontal"===a||"horizontal"===m,_=w?this._onScrollHorizontal:this._onScrollVertical,S=this._getRangeToRender(),E=S[0],x=S[1],T=[];if(c>0)for(var P=E;P<=x;P++)T.push((0,r.createElement)(t,{data:d,key:f(P,d),index:P,isScrolling:v?O:void 0,style:this._getItemStyle(P)}));var k=i(this.props,this._instanceProps);return(0,r.createElement)(h||g||"div",{className:n,onScroll:_,ref:this._outerRefSetter,style:Ds({position:"relative",height:o,width:b,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:a},y)},(0,r.createElement)(l||u||"div",{children:T,ref:s,style:{height:w?"100%":k,pointerEvents:O?"none":void 0,width:w?k:"100%"}}))},p._callPropsCallbacks=function(){if("function"==typeof this.props.onItemsRendered&&this.props.itemCount>0){var e=this._getRangeToRender(),t=e[0],r=e[1],n=e[2],i=e[3];this._callOnItemsRendered(t,r,n,i)}if("function"==typeof this.props.onScroll){var a=this.state,o=a.scrollDirection,s=a.scrollOffset,l=a.scrollUpdateWasRequested;this._callOnScroll(o,s,l)}},p._getRangeToRender=function(){var e=this.props,t=e.itemCount,r=e.overscanCount,n=this.state,i=n.isScrolling,a=n.scrollDirection,o=n.scrollOffset;if(0===t)return[0,0,0,0];var u=s(this.props,o,this._instanceProps),c=l(this.props,u,o,this._instanceProps),d=i&&"backward"!==a?1:Math.max(1,r),p=i&&"forward"!==a?1:Math.max(1,r);return[Math.max(0,u-d),Math.max(0,Math.min(t-1,c+p)),u,c]},t}(r.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var Nh=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},Lh=Dh({getItemOffset:function(e,t){return t*e.itemSize},getItemSize:function(e,t){return e.itemSize},getEstimatedTotalSize:function(e){var t=e.itemCount;return e.itemSize*t},getOffsetForIndexAndAlignment:function(e,t,r,n,i,a){var o=e.direction,s=e.height,l=e.itemCount,u=e.itemSize,c=e.layout,d=e.width,p="horizontal"===o||"horizontal"===c?d:s,f=Math.max(0,l*u-p),m=Math.min(f,t*u),h=Math.max(0,t*u-p+u+a);switch("smart"===r&&(r=n>=h-p&&n<=m+p?"auto":"center"),r){case"start":return m;case"end":return h;case"center":var g=Math.round(h+(m-h)/2);return g<Math.ceil(p/2)?0:g>f+Math.floor(p/2)?f:g;default:return n>=h&&n<=m?n:n<h?h:m}},getStartIndexForOffset:function(e,t){var r=e.itemCount,n=e.itemSize;return Math.max(0,Math.min(r-1,Math.floor(t/n)))},getStopIndexForStartIndex:function(e,t,r){var n=e.direction,i=e.height,a=e.itemCount,o=e.itemSize,s=e.layout,l=e.width,u=t*o,c="horizontal"===n||"horizontal"===s?l:i,d=Math.ceil((c+r-u)/o);return Math.max(0,Math.min(a-1,t+d-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});function jh(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function Mh(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){jh(a,n,i,o,s,"next",e)}function s(e){jh(a,n,i,o,s,"throw",e)}o(void 0)}))}}function Fh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Fh(e,t,r[t])}))}return e}function Qh(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const $h="{}",Vh="__name__";function Xh(e){let t="";const r=[];for(const n of e)if((n.name===Vh||n.selected)&&n.values&&n.values.length>0){const e=n.values.filter((e=>e.selected)).map((e=>e.name));e.length>1?r.push(`${n.name}=~"${e.map(Zn).join("|")}"`):1===e.length&&(n.name===Vh?t=e[0]:r.push(`${n.name}="${Yn(e[0])}"`))}return[t,"{",r.join(","),"}"].join("")}const Gh=(0,a.stylesFactory)((e=>({wrapper:c.css`
    background-color: ${e.colors.bg2};
    padding: ${e.spacing.sm};
    width: 100%;
  `,list:c.css`
    margin-top: ${e.spacing.sm};
    display: flex;
    flex-wrap: wrap;
    max-height: 200px;
    overflow: auto;
    align-content: flex-start;
  `,section:c.css`
    & + & {
      margin: ${e.spacing.md} 0;
    }
    position: relative;
  `,selector:c.css`
    font-family: ${e.typography.fontFamily.monospace};
    margin-bottom: ${e.spacing.sm};
  `,status:c.css`
    padding: ${e.spacing.xs};
    color: ${e.colors.textSemiWeak};
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    /* using absolute positioning because flex interferes with ellipsis */
    position: absolute;
    width: 50%;
    right: 0;
    text-align: right;
    transition: opacity 100ms linear;
    opacity: 0;
  `,statusShowing:c.css`
    opacity: 1;
  `,error:c.css`
    color: ${e.palette.brandDanger};
  `,valueList:c.css`
    margin-right: ${e.spacing.sm};
    resize: horizontal;
  `,valueListWrapper:c.css`
    border-left: 1px solid ${e.colors.border2};
    margin: ${e.spacing.sm} 0;
    padding: ${e.spacing.sm} 0 ${e.spacing.sm} ${e.spacing.sm};
  `,valueListArea:c.css`
    display: flex;
    flex-wrap: wrap;
    margin-top: ${e.spacing.sm};
  `,valueTitle:c.css`
    margin-left: -${e.spacing.xs};
    margin-bottom: ${e.spacing.sm};
  `,validationStatus:c.css`
    padding: ${e.spacing.xs};
    margin-bottom: ${e.spacing.sm};
    color: ${e.colors.textStrong};
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  `})));class Uh extends n().Component{updateLabelState(e,t,r="",n){this.setState((n=>{const i=n.labels.map((r=>r.name===e?Bh({},r,t):r)),a=r?"":n.error;return{labels:i,status:r,error:a,validationStatus:""}}),n)}componentDidMount(){const{languageProvider:e,lastUsedLabels:t}=this.props;if(e){const r=t;e.start().then((()=>{let t=e.getLabelKeys();this.fetchValues(Vh,$h);const n=t.map((e=>({name:e,selected:r.includes(e),loading:!1})));this.setState({labels:n},(()=>{this.state.labels.forEach((e=>{e.selected&&this.fetchValues(e.name,$h)}))}))}))}}doFacettingForLabel(e){const t=this.state.labels.find((t=>t.name===e));if(!t)return;const r=this.state.labels.filter((e=>e.selected)).map((e=>e.name));this.props.storeLastUsedLabels(r),t.selected?t.values||this.fetchValues(e,Xh(this.state.labels)):this.doFacetting()}fetchValues(e,t){var r=this;return Mh((function*(){const{languageProvider:n}=r.props;r.updateLabelState(e,{loading:!0},`Fetching values for ${e}`);try{let i=yield n.getLabelValues(e);if(t!==Xh(r.state.labels))return void r.updateLabelState(e,{loading:!1});const a=[],{metricsMetadata:o}=n;for(const t of i){const r={name:t};if(e===Vh&&o){const e=o[t];e&&(r.details=`(${e.type}) ${e.help}`)}a.push(r)}r.updateLabelState(e,{values:a,loading:!1})}catch(e){console.error(e)}}))()}fetchSeries(e,t){var r=this;return Mh((function*(){const{languageProvider:n}=r.props;t&&r.updateLabelState(t,{loading:!0},`Facetting labels for ${e}`);try{const i=yield n.fetchSeriesLabels(e,!0);if(e!==Xh(r.state.labels))return void(t&&r.updateLabelState(t,{loading:!1}));if(0===Object.keys(i).length)return void r.setState({error:`Empty results, no matching label for ${e}`});const a=function(e,t,r){return e.map((e=>{const n=t[e.name];if(n){let t;if(e.name===r&&e.values)t=e.values;else{var i;const r=new Set((null===(i=e.values)||void 0===i?void 0:i.filter((e=>e.selected)).map((e=>e.name)))||[]);t=n.map((e=>({name:e,selected:r.has(e)})))}return Qh(Bh({},e),{loading:!1,values:t,hidden:!n,facets:t.length})}return Qh(Bh({},e),{loading:!1,hidden:!n,values:void 0,facets:0})}))}(r.state.labels,i,t);r.setState({labels:a,error:""}),t&&r.updateLabelState(t,{loading:!1})}catch(e){console.error(e)}}))()}validateSelector(e){var t=this;return Mh((function*(){const{languageProvider:r}=t.props;t.setState({validationStatus:`Validating selector ${e}`,error:""});const n=yield r.fetchSeries(e);t.setState({validationStatus:`Selector is valid (${n.length} series found)`})}))()}render(){var e;const{theme:t}=this.props,{labels:r,labelSearchTerm:i,metricSearchTerm:o,status:s,error:l,validationStatus:u,valueSearchTerm:d}=this.state,p=Gh(t);if(0===r.length)return n().createElement("div",{className:p.wrapper},n().createElement(a.LoadingPlaceholder,{text:"Loading labels..."}));let f=r.find((e=>e.name===Vh));var m;f&&o&&(f=Qh(Bh({},f),{values:null===(m=f.values)||void 0===m?void 0:m.filter((e=>e.selected||e.name.includes(o)))}));let h=r.filter((e=>!e.hidden&&e.name!==Vh));i&&(h=h.filter((e=>e.selected||e.name.includes(i))));let g=h.filter((e=>e.selected&&e.values));d&&(g=g.map((e=>{var t;return Qh(Bh({},e),{values:null===(t=e.values)||void 0===t?void 0:t.filter((e=>e.selected||e.name.includes(d)))})})));const y=Xh(this.state.labels),v=y===$h,b=(null==f||null===(e=f.values)||void 0===e?void 0:e.length)||0;return n().createElement("div",{className:p.wrapper},n().createElement(a.HorizontalGroup,{align:"flex-start",spacing:"lg"},n().createElement("div",null,n().createElement("div",{className:p.section},n().createElement(a.Label,{description:"Once a metric is selected only possible labels are shown."},"1. Select a metric"),n().createElement("div",null,n().createElement(a.Input,{onChange:this.onChangeMetricSearch,"aria-label":"Filter expression for metric",value:o})),n().createElement("div",{role:"list",className:p.valueListWrapper},n().createElement(Lh,{height:Math.min(450,25*b),itemCount:b,itemSize:25,itemKey:e=>f.values[e].name,width:300,className:p.valueList},(({index:e,style:t})=>{var r;const i=null==f||null===(r=f.values)||void 0===r?void 0:r[e];return i?n().createElement("div",{style:t},n().createElement(a.BrowserLabel,{name:f.name,value:null==i?void 0:i.name,title:i.details,active:null==i?void 0:i.selected,onClick:this.onClickMetric,searchTerm:o})):null}))))),n().createElement("div",null,n().createElement("div",{className:p.section},n().createElement(a.Label,{description:"Once label values are selected, only possible label combinations are shown."},"2. Select labels to search in"),n().createElement("div",null,n().createElement(a.Input,{onChange:this.onChangeLabelSearch,"aria-label":"Filter expression for label",value:i})),n().createElement("div",{className:p.list,style:{height:120}},h.map((e=>n().createElement(a.BrowserLabel,{key:e.name,name:e.name,loading:e.loading,active:e.selected,hidden:e.hidden,facets:e.facets,onClick:this.onClickLabel,searchTerm:i}))))),n().createElement("div",{className:p.section},n().createElement(a.Label,{description:"Use the search field to find values across selected labels."},"3. Select (multiple) values for your labels"),n().createElement("div",null,n().createElement(a.Input,{onChange:this.onChangeValueSearch,"aria-label":"Filter expression for label values",value:d})),n().createElement("div",{className:p.valueListArea,ref:this.valueListsRef},g.map((e=>{var t,r,i;return n().createElement("div",{role:"list",key:e.name,"aria-label":`Values for ${e.name}`,className:p.valueListWrapper},n().createElement("div",{className:p.valueTitle},n().createElement(a.BrowserLabel,{name:e.name,loading:e.loading,active:e.selected,hidden:e.hidden,facets:e.facets||(null===(t=e.values)||void 0===t?void 0:t.length),onClick:this.onClickLabel})),n().createElement(Lh,{height:Math.min(200,25*((null===(r=e.values)||void 0===r?void 0:r.length)||0)),itemCount:(null===(i=e.values)||void 0===i?void 0:i.length)||0,itemSize:28,itemKey:t=>e.values[t].name,width:200,className:p.valueList},(({index:t,style:r})=>{var i;const o=null===(i=e.values)||void 0===i?void 0:i[t];return o?n().createElement("div",{style:r},n().createElement(a.BrowserLabel,{name:e.name,value:null==o?void 0:o.name,active:null==o?void 0:o.selected,onClick:this.onClickValue,searchTerm:d})):null})))})))))),n().createElement("div",{className:p.section},n().createElement(a.Label,null,"4. Resulting selector"),n().createElement("div",{"aria-label":"selector",className:p.selector},y),u&&n().createElement("div",{className:p.validationStatus},u),n().createElement(a.HorizontalGroup,null,n().createElement(a.Button,{"aria-label":"Use selector for query button",disabled:v,onClick:this.onClickRunQuery},"Use query"),n().createElement(a.Button,{"aria-label":"Use selector as metrics button",variant:"secondary",disabled:v,onClick:this.onClickRunRateQuery},"Use as rate query"),n().createElement(a.Button,{"aria-label":"Validate submit button",variant:"secondary",disabled:v,onClick:this.onClickValidate},"Validate selector"),n().createElement(a.Button,{"aria-label":"Selector clear button",variant:"secondary",onClick:this.onClickClear},"Clear"),n().createElement("div",{className:(0,c.cx)(p.status,(s||l)&&p.statusShowing)},n().createElement("span",{className:l?p.error:""},l||s)))))}constructor(...e){super(...e),Fh(this,"valueListsRef",n().createRef()),Fh(this,"state",{labels:[],labelSearchTerm:"",metricSearchTerm:"",status:"Ready",error:"",validationStatus:"",valueSearchTerm:""}),Fh(this,"onChangeLabelSearch",(e=>{this.setState({labelSearchTerm:e.target.value})})),Fh(this,"onChangeMetricSearch",(e=>{this.setState({metricSearchTerm:e.target.value})})),Fh(this,"onChangeValueSearch",(e=>{this.setState({valueSearchTerm:e.target.value})})),Fh(this,"onClickRunQuery",(()=>{const e=Xh(this.state.labels);this.props.onChange(e)})),Fh(this,"onClickRunRateQuery",(()=>{const e=`rate(${Xh(this.state.labels)}[$__interval])`;this.props.onChange(e)})),Fh(this,"onClickClear",(()=>{this.setState((e=>({labels:e.labels.map((e=>Qh(Bh({},e),{values:void 0,selected:!1,loading:!1,hidden:!1,facets:void 0}))),labelSearchTerm:"",metricSearchTerm:"",status:"",error:"",validationStatus:"",valueSearchTerm:""}))),this.props.deleteLastUsedLabels(),this.fetchValues(Vh,$h)})),Fh(this,"onClickLabel",(e=>{const t=this.state.labels.find((t=>t.name===e));if(!t)return;const r=!t.selected;let n={selected:r};if(t.values&&!r){const e=t.values.map((e=>Qh(Bh({},e),{selected:!1})));n=Qh(Bh({},n),{facets:0,values:e})}this.setState({labelSearchTerm:""}),this.updateLabelState(e,n,"",(()=>this.doFacettingForLabel(e)))})),Fh(this,"onClickValue",((e,t)=>{const r=this.state.labels.find((t=>t.name===e));if(!r||!r.values)return;this.setState({labelSearchTerm:""});const n=r.values.map((e=>Qh(Bh({},e),{selected:e.name===t?!e.selected:e.selected})));this.updateLabelState(e,{values:n},"",(()=>this.doFacetting(e)))})),Fh(this,"onClickMetric",((e,t)=>{const r=this.state.labels.find((t=>t.name===e));if(!r||!r.values)return;this.setState({metricSearchTerm:""});const n=r.values.map((e=>Qh(Bh({},e),{selected:e.name===t||e.selected?!e.selected:e.selected}))),i=n.some((e=>e.selected));this.updateLabelState(e,{selected:i,values:n},"",(()=>this.doFacetting(e)))})),Fh(this,"onClickValidate",(()=>{const e=Xh(this.state.labels);this.validateSelector(e)})),Fh(this,"doFacetting",(e=>{const t=Xh(this.state.labels);if(t===$h){const e=this.state.labels.map((e=>Qh(Bh({},e),{facets:0,values:void 0,hidden:!1})));this.setState({labels:e},(()=>{this.state.labels.forEach((e=>(e.selected||e.name===Vh)&&this.fetchValues(e.name,t)))}))}else this.fetchSeries(t,e)}))}}const zh=(0,a.withTheme)(Uh);function Wh(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function Kh(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){Wh(a,n,i,o,s,"next",e)}function s(e){Wh(a,n,i,o,s,"throw",e)}o(void 0)}))}}function Hh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Hh(e,t,r[t])}))}return e}function Zh(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}class Jh extends n().PureComponent{componentDidMount(){this.props.datasource.languageProvider&&this.refreshMetrics(),this.refreshHint()}componentWillUnmount(){this.languageProviderInitializationPromise&&this.languageProviderInitializationPromise.cancel()}componentDidUpdate(e){const{data:t,datasource:{languageProvider:r},range:n}=this.props;r!==e.datasource.languageProvider&&this.setState({syntaxLoaded:!1});const i=this.rangeChangedToRefresh(n,e.range);(r!==e.datasource.languageProvider||i)&&this.refreshMetrics(),t&&e.data&&e.data.series!==t.series&&this.refreshHint()}rangeChangedToRefresh(e,t){if(e&&t){const r=Un(e.from.valueOf())===Un(t.from.valueOf()),n=Un(e.to.valueOf())===Un(t.to.valueOf());return!(r&&n)}return!1}render(){const{datasource:e,query:t,ExtraFieldElement:r,history:i=[]}=this.props,{labelBrowserVisible:o,syntaxLoaded:s,hint:l,hasMetrics:u}=this.state,c=function(e,t,r){return e?"(Disabled)":t?r?"Metrics browser":"(No metrics found)":"Loading metrics..."}(e.lookupsDisabled,s,u),d=!(s&&u);return n().createElement(xh,{storageKey:"grafana.datasources.prometheus.browser.labels",defaultValue:[]},((s,u,p)=>{var f;return n().createElement(n().Fragment,null,n().createElement("div",{className:"gf-form-inline gf-form-inline--xs-view-flex-column flex-grow-1","data-testid":this.props["data-testid"]},n().createElement("button",{className:"gf-form-label query-keyword pointer",onClick:this.onClickChooserButton,disabled:d,type:"button"},c,n().createElement(a.Icon,{name:o?"angle-down":"angle-right"})),n().createElement("div",{className:"gf-form gf-form--grow flex-shrink-1 min-width-15"},n().createElement(da,{runQueryOnBlur:!1,languageProvider:e.languageProvider,history:i,onChange:this.onChangeQuery,onRunQuery:this.props.onRunQuery,initialValue:null!==(f=t.expr)&&void 0!==f?f:"",placeholder:"Enter a MetricsQL query…"}))),o&&n().createElement("div",{className:"gf-form"},n().createElement(zh,{languageProvider:e.languageProvider,onChange:this.onChangeLabelBrowser,lastUsedLabels:s||[],storeLastUsedLabels:u,deleteLastUsedLabels:p})),r,l?n().createElement("div",{className:"query-row-break"},n().createElement("div",{className:"prom-query-field-info text-warning"},l.label," ",l.fix?n().createElement("a",{className:"text-link muted",onClick:this.onClickHintFix},l.fix.label):null)):null)}))}constructor(e,r){super(e,r),Hh(this,"plugins",void 0),Hh(this,"refreshHint",(()=>{const{datasource:e,query:r,data:n}=this.props,i=e.getInitHints(),a=i.length>0?i[0]:null;if(!n||0===n.series.length)return void this.setState({hint:a});const o=(0,t.isDataFrame)(n.series[0])?n.series.map(t.toLegacyResponseData):n.series,s=e.getQueryHints(r,o);let l=s.length>0?s[0]:null;this.setState({hint:null!=l?l:a})}));var n=this;Hh(this,"refreshMetrics",Kh((function*(){const{datasource:{languageProvider:e}}=n.props;n.languageProviderInitializationPromise=(e=>{let t=!1;return{promise:new Promise(((r,n)=>{const i={isCanceled:!0};e.then((e=>t?n(i):r(e))),e.catch((e=>n(t?i:e)))})),cancel(){t=!0}}})(e.start());try{const t=yield n.languageProviderInitializationPromise.promise;yield Promise.all(t),n.onUpdateLanguage(e)}catch(e){if(!function(e){return"object"==typeof e&&null!==e&&"isCanceled"in e}(e)||!e.isCanceled)throw e}}))),Hh(this,"onChangeLabelBrowser",(e=>{this.onChangeQuery(e,!0),this.setState({labelBrowserVisible:!1})})),Hh(this,"onChangeQuery",((e,t)=>{const{query:r,onChange:n,onRunQuery:i}=this.props;n&&(n(Zh(Yh({},r),{expr:e})),t&&i&&i())})),Hh(this,"onClickChooserButton",(()=>{this.setState((e=>({labelBrowserVisible:!e.labelBrowserVisible})))})),Hh(this,"onClickHintFix",(()=>{var e;const{datasource:t,query:r,onChange:n,onRunQuery:i}=this.props,{hint:a}=this.state;(null==a||null===(e=a.fix)||void 0===e?void 0:e.action)&&n(t.modifyQuery(r,a.fix.action)),i()})),Hh(this,"onUpdateLanguage",(e=>{const{metrics:t}=e;t&&this.setState({syntaxLoaded:!0,hasMetrics:t.length>0})})),this.plugins=[(0,a.BracesPlugin)(),(0,a.SlatePrism)({onlyIn:e=>"code_block"===e.type,getSyntax:()=>"promql"},Zh(Yh({},ue.languages),{promql:this.props.datasource.languageProvider.syntax}))],this.state={labelBrowserVisible:!1,syntaxLoaded:!1,hint:null,hasMetrics:!1}}}const eg=Jh;function tg(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rg(e){var{query:t,showExplain:r}=e,i=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["query","showExplain"]);const o=(0,a.useStyles2)(ng);return n().createElement("div",{className:o.wrapper},n().createElement(eg,(s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){tg(e,t,r[t])}))}return e}({},i),l=null!=(l={query:t,history:[],"data-testid":"prom-editor"})?l:{},Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(l)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(l)).forEach((function(e){Object.defineProperty(s,e,Object.getOwnPropertyDescriptor(l,e))})),s)),r&&n().createElement(Hm,{query:t.expr}));var s,l}const ng=()=>({wrapper:c.css`
      .gf-form {
        margin-bottom: 0;
      }
    `});function ig({query:e,withTemplate:t}){return n().createElement(T,null,n().createElement(v,null,n().createElement(E,{label:"Raw query"},n().createElement(xm,{query:ja(e,t),lang:{grammar:mr,name:"promql"}}))))}const ag=e=>({wrapper:(0,c.css)({paddingLeft:e.spacing(2),background:e.colors.background.secondary,borderRadius:e.shape.borderRadius(),border:`1px solid ${e.colors.border.weak}`,position:"relative",cursor:"pointer"}),content:c.css`
    display: grid;
    gap: ${e.spacing(1)};
    padding: ${e.spacing(2)};
    border-radius: ${e.shape.borderRadius()},
  `,topRow:c.css`
    display: grid;
    grid-template-columns: auto 1fr;
    align-items: center;
    justify-content: space-between;
    gap: 2px;
  `,arrow:c.css`
    display: flex;
    align-items: center;
    justify-content: center;
  `,progressWrapper:c.css`
    position: relative;
    display: grid;
    align-items: center;  
    width: calc(100% - 40px);
    height: 16px;
    background: ${e.colors.background.secondary};
    box-shadow: inset 0 0 0 1px ${e.colors.border.weak};
    border-radius: 4px;
  `,progressLine:c.css`
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    background: ${e.colors.primary.main};
    border-radius: 4px;
    z-index: 1;
  `,progressNum:c.css`
    position: absolute;
    top: 0;
    right: -40px;
    color: ${e.colors.text.secondary};
    font-size: ${e.typography.bodySmall.fontSize};
    z-index: 2;
  `,message:c.css`
    color: ${e.colors.text.primary};
    font-size: ${e.typography.bodySmall.fontSize};
  `,duration:c.css`
    color: ${e.colors.text.secondary};
    font-size: ${e.typography.bodySmall.fontSize};
  `});function og(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const sg=({trace:e,totalMsec:t})=>{const[i,o]=(0,r.useState)({}),s=(0,a.useStyles2)(ag),l=e.children&&!!e.children.length,u=Math.round(e.duration/t*100);return n().createElement("div",{className:s.wrapper},n().createElement("div",{className:s.content,onClick:(c=e.idValue,()=>{o((e=>{return t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){og(e,t,r[t])}))}return e}({},e),r=null!=(r={[c]:!e[c]})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})),t;var t,r}))})},n().createElement("div",{className:s.topRow},n().createElement("div",{className:s.arrow},l&&n().createElement(a.IconButton,{"aria-label":"",name:i[e.idValue]?"angle-up":"angle-down"})),n().createElement("div",{className:s.progressWrapper},n().createElement("div",{className:s.progressLine,style:{width:`${u}%`}}),n().createElement("div",{className:s.progressNum},`${u}%`))),n().createElement("div",{className:s.message},e.message),n().createElement("div",{className:s.duration},`duration: ${e.duration} ms`)),i[e.idValue]&&l&&e.children.map((e=>n().createElement(sg,{key:e.duration,trace:e,totalMsec:t}))));var c},lg=sg;function ug(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let cg=0;class dg{get queryValue(){return this.query}get idValue(){return this.id}get children(){return this.tracingChildren}get message(){return this.tracing.message}get duration(){return this.tracing.duration_msec}get JSON(){return JSON.stringify(this.tracing,null,2)}get originalJSON(){return JSON.stringify(this.originalTracing,null,2)}setTracing(e){this.tracing=e;const t=e.children||[];this.tracingChildren=t.map((e=>new dg(e,this.query)))}setQuery(e){this.query=e}resetTracing(){this.tracing=this.originalTracing}constructor(e,t){ug(this,"tracing",void 0),ug(this,"query",void 0),ug(this,"tracingChildren",void 0),ug(this,"originalTracing",void 0),ug(this,"id",void 0),this.tracing=e,this.originalTracing=JSON.parse(JSON.stringify(e)),this.query=t,this.id=cg++;const r=e.children||[];this.tracingChildren=r.map((e=>new dg(e,t)))}}const pg=e=>({header:(0,c.css)({display:"grid",gridTemplateColumns:"1fr auto",alignItems:"center",background:e.colors.background.secondary,borderRadius:e.shape.borderRadius(),marginTop:e.spacing(2),padding:`${e.spacing(1)} ${e.spacing(2)}`}),json:(0,c.css)({maxHeight:"50vh",overflow:"auto"}),error:(0,c.css)({display:"flex",alignItems:"center",color:e.colors.error.text,gap:e.spacing(1)})});function fg(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}const mg=n().memo((({query:e,data:t,datasource:i})=>{const[o,s]=(0,r.useState)(null),[l,u]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!1),[p,f]=(0,r.useState)(""),m=(0,a.useStyles2)(pg);return(0,r.useEffect)((()=>{let e=null;return c&&(e=setTimeout((()=>{d(!1)}),2e3)),()=>{e&&clearInterval(e)}}),[c]),(0,r.useEffect)((()=>{const r=function(){var r=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){fg(a,n,i,o,s,"next",e)}function s(e){fg(a,n,i,o,s,"throw",e)}o(void 0)}))}}((function*(){(null==t?void 0:t.request)?i.query(t.request).subscribe((t=>{var r;const n=null==t||null===(r=t.data)||void 0===r?void 0:r.findIndex((t=>t.refId===e.refId)),i=((null==t?void 0:t.trace)||[])[n];s(i&&-1!==n?new dg(i,e.expr):null)})):s(null)}));return function(){return r.apply(this,arguments)}}();r()}),[t,i,e]),o?n().createElement(g,{gap:0,direction:"column"},n().createElement("div",{className:m.header},n().createElement("span",null,"Trace for ",n().createElement("b",null,e.expr)),n().createElement(a.Button,{variant:"secondary",size:"sm",onClick:()=>{u(!0)}},"Show JSON")),n().createElement("nav",null,n().createElement(lg,{trace:o,totalMsec:o.duration})),n().createElement(a.Modal,{title:`Trace for ${e.expr}`,isOpen:l,closeOnEscape:!0,onDismiss:()=>{u(!1)}},n().createElement("div",null,n().createElement("pre",{className:m.json},n().createElement("code",{lang:"json"},o.JSON)),n().createElement(a.Modal.ButtonRow,null,p&&n().createElement("div",{className:m.error},n().createElement(a.Icon,{name:"exclamation-triangle",size:"sm"}),n().createElement("span",null,p)),n().createElement(a.Button,{variant:c?"success":"primary",size:"sm",onClick:()=>{if(o&&!c)try{navigator.clipboard.writeText(o.JSON),d(!0)}catch(e){console.error("Failed to copy: ",e),e instanceof Error&&f(e.message)}},icon:c?"check":"copy"},c?"Copied":"Copy JSON"))))):null}));function hg(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){hg(e,t,r[t])}))}return e}function yg(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}mg.displayName="TraceView";const vg=n().memo((e=>{var o;const{onChange:s,onRunQuery:l,data:c,app:d,datasource:p}=e,[f,m]=(0,r.useState)(!1),[h,g]=(0,r.useState)(!1),[y,v]=(0,r.useState)(!1),{flag:O,setFlag:_}=function(e,t=!1){const[n,i]=(0,r.useState)(function(e,t=!1){const r=Xa.get(e);return void 0===r?t:Boolean(parseInt(r,10))}(e,t));return{flag:n,setFlag:(0,r.useCallback)((t=>{!function(e,t){Xa.set(e,t?"1":"0")}(e,t),i(t)}),[e])}}("PrometheusQueryEditorExplainDefault"),S=(null===(o=null==c?void 0:c.request)||void 0===o?void 0:o.dashboardUID)||"",[E,x]=(0,r.useState)(),T=function(e,r){let n=e;return e.editorMode||(n=Ya(Ha({},e),{editorMode:eo(e.expr)})),null==e.expr&&(n=Ya(Ha({},n),{expr:"",legendFormat:Ua.Auto})),null==e.range&&null==e.instant&&(n=Ya(Ha({},n),{range:!0}),r===t.CoreApp.Explore&&(n.instant=!0)),n}(e.query,d),P=T.editorMode,k=(0,r.useCallback)((e=>{var t;(0,i.reportInteraction)("user_grafana_prometheus_editor_mode_clicked",{newEditor:e,previousEditor:null!==(t=T.editorMode)&&void 0!==t?t:"",newQuery:!T.expr,app:null!=d?d:""}),e===Ma.Builder&&Nn(T.expr||"").errors.length?m(!0):Ja(T,e,s)}),[s,T,d]);return(0,r.useEffect)((()=>{const e=La(E);p.languageProvider=new yi(p,{withTemplates:e}),p.languageProvider.start(),d!==t.CoreApp.UnifiedAlerting&&l()}),[l,p,E,d]),n().createElement(n().Fragment,null,n().createElement(a.ConfirmModal,{isOpen:f,title:"Query parsing",body:"There were errors while trying to parse the query. Continuing to visual builder may lose some parts of the query.",confirmText:"Continue",onConfirm:()=>{Ja(T,Ma.Builder,s),m(!1)},onDismiss:()=>m(!1)}),n().createElement(b,null,n().createElement(L,{value:null,placeholder:"Query patterns",allowCustomValue:!0,onChange:({value:e})=>{const t=Nn(T.expr||"");t.query.operations=null==e?void 0:e.operations,s(yg(gg({},T),{expr:Tn.renderQuery(t.query)}))},options:Tn.getQueryPatterns().map((e=>({label:e.name,value:e})))}),n().createElement($a,{label:"Explain",value:O,onChange:e=>{_(e.currentTarget.checked)}}),n().createElement($a,{label:"Trace",value:h,onChange:e=>{g(e.currentTarget.checked),s(yg(gg({},T),{trace:e.currentTarget.checked?1:void 0})),l()}}),n().createElement($a,{label:"Raw",value:y,onChange:e=>{v(e.currentTarget.checked)}}),n().createElement(q,{grow:1}),n().createElement(Na,{app:d,template:E,setTemplate:x,dashboardUID:S,datasource:p}),n().createElement(u,{query:T,datasource:p,onChange:s}),n().createElement(H,{query:T,datasource:p,panelData:c,dashboardUID:S}),d!==t.CoreApp.Explore&&n().createElement(a.IconButton,{key:"run",name:(null==c?void 0:c.state)===t.LoadingState.Loading?"fa fa-spinner":"play",tooltip:"Run queries",onClick:l}),n().createElement(Ba,{mode:P,onChange:k})),n().createElement(w,{v:.5}),n().createElement(I,null,P===Ma.Code&&n().createElement(n().Fragment,null,n().createElement(rg,yg(gg({},e),{key:null==E?void 0:E.expr,query:T,showExplain:O})),y&&n().createElement(ig,{query:T.expr,withTemplate:E})),P===Ma.Builder&&n().createElement(nh,{query:T,datasource:e.datasource,onChange:e=>{s(e)},onRunQuery:e.onRunQuery,data:c,showExplain:O}),h&&n().createElement(mg,{query:T,datasource:p,data:c}),n().createElement(_h,{query:T,app:e.app,onChange:s,onRunQuery:l})))}));function bg(e){const{datasource:t,query:r,range:i,data:a,onChange:o,onRunQuery:s}=e;return n().createElement(eg,{datasource:t,query:r,onRunQuery:s,onChange:o,history:[],range:i,data:a,"data-testid":Og.editor})}vg.displayName="PromQueryEditorSelector";const Og={editor:"prom-editor-cloud-alerting"};function wg(e){const{app:r}=e;return r===t.CoreApp.CloudAlerting?n().createElement(bg,e):n().createElement(vg,e)}const _g=(0,r.memo)(wg);var Sg,Eg=m(5569);!function(e){e.Public="AzureCloud",e.China="AzureChinaCloud",e.USGovernment="AzureUSGovernment",e.Germany="AzureGermanCloud"}(Sg||(Sg={}));const xg=[{value:"AzureCloud",label:"Azure"},{value:"AzureChinaCloud",label:"Azure China"},{value:"AzureUSGovernment",label:"Azure US Government"},{value:"AzureGermanCloud",label:"Azure Germany"}];function Tg(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Tg(e,t,r[t])}))}return e}function kg(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const Ig=Symbol("Concealed client secret");function Cg(){return i.config.azure.cloud||Sg.Public}function Ag(e){if(e.secureJsonFields.azureClientSecret)return Ig;{var t;const r=null===(t=e.secureJsonData)||void 0===t?void 0:t.azureClientSecret;return"string"==typeof r&&r.length>0?r:void 0}}function qg(){return i.config.azure.managedIdentityEnabled?{authType:"msi"}:{authType:"clientsecret",azureCloud:Cg()}}function Rg(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Rg(e,t,r[t])}))}return e}function Ng(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const Lg=[{value:"msi",label:"Managed Identity"},{value:"clientsecret",label:"App Registration"}],jg=e=>{const{credentials:t,azureCloudOptions:i,onCredentialsChange:o,getSubscriptions:s,disabled:l}=e,u=function(e){switch(e.authType){case"msi":return!0;case"clientsecret":return!!(e.azureCloud&&e.tenantId&&e.clientId&&e.clientSecret)}}(t),[c,d]=(0,r.useState)([]),[p,f]=(0,r.useReducer)((e=>e+1),0);(0,r.useEffect)((()=>{if(!s||!u)return void m([]);let e=!1;return s().then((t=>{e||m(t,p)})),()=>{e=!0}}),[p]);const m=(e,r=!1)=>{d(e),s&&(r&&!t.defaultSubscriptionId&&e.length>0?h(e[0]):t.defaultSubscriptionId&&(e.find((e=>e.value===t.defaultSubscriptionId))||h(void 0)))},h=e=>{if(o){const r=Ng(Dg({},t),{defaultSubscriptionId:null==e?void 0:e.value});o(r)}};return n().createElement("div",{className:"gf-form-group"},e.managedIdentityEnabled&&n().createElement("div",{className:"gf-form-inline"},n().createElement("div",{className:"gf-form"},n().createElement(a.InlineFormLabel,{className:"width-12",tooltip:"Choose the type of authentication to Azure services"},"Authentication"),n().createElement(a.Select,{className:"width-15",value:Lg.find((e=>e.value===t.authType)),options:Lg,onChange:e=>{if(o){d([]);const r=Ng(Dg({},t),{authType:e.value||"msi",defaultSubscriptionId:void 0});o(r)}},isDisabled:l}))),"clientsecret"===t.authType&&n().createElement(n().Fragment,null,i&&n().createElement("div",{className:"gf-form-inline"},n().createElement("div",{className:"gf-form"},n().createElement(a.InlineFormLabel,{className:"width-12",tooltip:"Choose an Azure Cloud"},"Azure Cloud"),n().createElement(a.Select,{className:"width-15",value:i.find((e=>e.value===t.azureCloud)),options:i,onChange:e=>{if(o&&"clientsecret"===t.authType){d([]);const r=Ng(Dg({},t),{azureCloud:e.value,defaultSubscriptionId:void 0});o(r)}},isDisabled:l}))),n().createElement("div",{className:"gf-form-inline"},n().createElement("div",{className:"gf-form"},n().createElement(a.InlineFormLabel,{className:"width-12"},"Directory (tenant) ID"),n().createElement("div",{className:"width-15"},n().createElement(a.Input,{className:"width-30",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",value:t.tenantId||"",onChange:e=>{if(o&&"clientsecret"===t.authType){d([]);const r=Ng(Dg({},t),{tenantId:e.target.value,defaultSubscriptionId:void 0});o(r)}},disabled:l})))),n().createElement("div",{className:"gf-form-inline"},n().createElement("div",{className:"gf-form"},n().createElement(a.InlineFormLabel,{className:"width-12"},"Application (client) ID"),n().createElement("div",{className:"width-15"},n().createElement(a.Input,{className:"width-30",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",value:t.clientId||"",onChange:e=>{if(o&&"clientsecret"===t.authType){d([]);const r=Ng(Dg({},t),{clientId:e.target.value,defaultSubscriptionId:void 0});o(r)}},disabled:l})))),"symbol"==typeof t.clientSecret?n().createElement("div",{className:"gf-form-inline"},n().createElement("div",{className:"gf-form"},n().createElement(a.InlineFormLabel,{htmlFor:"azure-client-secret",className:"width-12"},"Client Secret"),n().createElement(a.Input,{id:"azure-client-secret",className:"width-25",placeholder:"configured",disabled:!0})),!l&&n().createElement("div",{className:"gf-form"},n().createElement("div",{className:"max-width-30 gf-form-inline"},n().createElement(a.Button,{variant:"secondary",type:"button",onClick:()=>{if(o&&"clientsecret"===t.authType){d([]);const e=Ng(Dg({},t),{clientSecret:"",defaultSubscriptionId:void 0});o(e)}}},"reset")))):n().createElement("div",{className:"gf-form-inline"},n().createElement("div",{className:"gf-form"},n().createElement(a.InlineFormLabel,{className:"width-12"},"Client Secret"),n().createElement("div",{className:"width-15"},n().createElement(a.Input,{className:"width-30",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",value:t.clientSecret||"",onChange:e=>{if(o&&"clientsecret"===t.authType){d([]);const r=Ng(Dg({},t),{clientSecret:e.target.value,defaultSubscriptionId:void 0});o(r)}},disabled:l}))))),s&&n().createElement(n().Fragment,null,n().createElement("div",{className:"gf-form-inline"},n().createElement("div",{className:"gf-form"},n().createElement(a.InlineFormLabel,{className:"width-12"},"Default Subscription"),n().createElement("div",{className:"width-25"},n().createElement(a.Select,{value:t.defaultSubscriptionId?c.find((e=>e.value===t.defaultSubscriptionId)):void 0,options:c,onChange:h,isDisabled:l})))),n().createElement("div",{className:"gf-form-inline"},n().createElement("div",{className:"gf-form"},n().createElement("div",{className:"max-width-30 gf-form-inline"},n().createElement(a.Button,{variant:"secondary",size:"sm",type:"button",onClick:f,disabled:!u},"Load Subscriptions"))))))};function Mg(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Mg(e,t,r[t])}))}return e}function Bg(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const Qg=e=>{const{dataSourceConfig:t,onChange:o}=e,[s,l]=(0,r.useState)(!!t.jsonData.azureEndpointResourceId),u=(0,r.useMemo)((()=>function(e){const t=e.jsonData.azureCredentials;if(!t)return qg();switch(t.authType){case"msi":return i.config.azure.managedIdentityEnabled?{authType:"msi"}:{authType:"clientsecret",azureCloud:Cg()};case"clientsecret":return{authType:"clientsecret",azureCloud:t.azureCloud||Cg(),tenantId:t.tenantId,clientId:t.clientId,clientSecret:Ag(e)}}}(t)),[t]),d=i.config.featureToggles.prometheusConfigOverhaulAuth,p=d?24:26;return n().createElement(n().Fragment,null,n().createElement("h6",null,"Azure authentication"),n().createElement(jg,{managedIdentityEnabled:i.config.azure.managedIdentityEnabled,credentials:u,azureCloudOptions:xg,onCredentialsChange:e=>{o(function(e,t){switch(t.authType){case"msi":if(!i.config.azure.managedIdentityEnabled)throw new Error("Managed Identity authentication is not enabled in Grafana config.");return kg(Pg({},e),{jsonData:kg(Pg({},e.jsonData),{azureCredentials:{authType:"msi"}})});case"clientsecret":return kg(Pg({},e),{jsonData:kg(Pg({},e.jsonData),{azureCredentials:{authType:"clientsecret",azureCloud:t.azureCloud||Cg(),tenantId:t.tenantId,clientId:t.clientId}}),secureJsonData:kg(Pg({},e.secureJsonData),{azureClientSecret:"string"==typeof t.clientSecret&&t.clientSecret.length>0?t.clientSecret:void 0}),secureJsonFields:kg(Pg({},e.secureJsonFields),{azureClientSecret:"symbol"==typeof t.clientSecret})})}}(t,e))},disabled:t.readOnly}),n().createElement("h6",null,"Azure configuration"),n().createElement("div",{className:"gf-form-group"},n().createElement(a.InlineFieldRow,null,n().createElement(a.InlineField,{labelWidth:p,label:"Override AAD audience",disabled:t.readOnly},n().createElement(a.InlineSwitch,{value:s,onChange:e=>{l(e.currentTarget.checked),e.currentTarget.checked||o(Bg(Fg({},t),{jsonData:Bg(Fg({},t.jsonData),{azureEndpointResourceId:void 0})}))}}))),s&&n().createElement(a.InlineFieldRow,null,n().createElement(a.InlineField,{labelWidth:p,label:"Resource ID",disabled:t.readOnly},n().createElement(a.Input,{className:(0,c.cx)(d?"width-20":"width-30"),value:t.jsonData.azureEndpointResourceId||"",onChange:e=>{s&&o(Bg(Fg({},t),{jsonData:Bg(Fg({},t.jsonData),{azureEndpointResourceId:e.currentTarget.value})}))}})))))},$g=[{title:"Datasource",url:"https://github.com/VictoriaMetrics/grafana-datasource#victoriametrics-data-source-for-grafana"},{title:"Cluster VM",url:"https://docs.victoriametrics.com/Cluster-VictoriaMetrics.html#url-format"},{title:"Grafana setup",url:"https://docs.victoriametrics.com/Single-server-VictoriaMetrics.html#grafana-setup"},{title:"MetricsQL",url:"https://docs.victoriametrics.com/MetricsQL.html"},{title:"VictoriaMetrics",url:"https://victoriametrics.com/"}],Vg=()=>n().createElement(n().Fragment,null,n().createElement("h3",{className:"page-heading"},"Helpful links"),n().createElement("div",{className:"gf-form-group gf-form-inline markdown-html"},$g.map((e=>n().createElement("a",{key:e.url,className:"gf-form-label gf-form-label--dashlink",href:e.url,target:"_blank",rel:"docs noreferrer"},e.title)))));function Xg(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Xg(e,t,r[t])}))}return e}function Ug(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const{Input:zg,FormField:Wg}=a.LegacyForms,Kg=[{value:"POST",label:"POST"},{value:"GET",label:"GET"}],Hg=e=>{const{options:r,onOptionsChange:i}=e;var o;return r.jsonData.httpMethod||(r.jsonData.httpMethod="POST"),n().createElement(n().Fragment,null,n().createElement("div",{className:"gf-form-group"},n().createElement("div",{className:"gf-form-inline"},n().createElement("div",{className:"gf-form"},n().createElement(Wg,{label:"Scrape interval",labelWidth:13,inputEl:n().createElement(zg,{className:"width-7",value:r.jsonData.timeInterval,spellCheck:!1,placeholder:"15s",onChange:Jg("timeInterval",r,i),validationEvents:Yg}),tooltip:"Set this to the typical scrape and evaluation interval configured in Prometheus. Defaults to 15s."}))),n().createElement("div",{className:"gf-form-inline"},n().createElement("div",{className:"gf-form"},n().createElement(Wg,{label:"Query timeout",labelWidth:13,inputEl:n().createElement(zg,{className:"width-7",value:r.jsonData.queryTimeout,onChange:Jg("queryTimeout",r,i),spellCheck:!1,placeholder:"60s",validationEvents:Yg}),tooltip:"Set the Prometheus query timeout."}))),n().createElement("div",{className:"gf-form"},n().createElement(a.InlineFormLabel,{width:13,tooltip:"You can use either POST or GET HTTP method to query your Prometheus data source. POST is the recommended method as it allows bigger queries. Change this to GET if you have a Prometheus version older than 2.1 or if POST requests are restricted in your network."},"HTTP Method"),n().createElement(a.Select,{"aria-label":"Select HTTP method",options:Kg,value:Kg.find((e=>e.value===r.jsonData.httpMethod)),onChange:Jg("httpMethod",r,i),width:14}))),n().createElement("h3",{className:"page-heading"},"Misc"),n().createElement("div",{className:"gf-form-group"},n().createElement("div",{className:"gf-form"},n().createElement(a.InlineField,{labelWidth:28,label:"Disable metrics lookup",tooltip:"Checking this option will disable the metrics chooser and metric/label support in the query field's autocomplete. This helps if you have performance issues with bigger Prometheus instances."},n().createElement(a.InlineSwitch,{value:null!==(o=r.jsonData.disableMetricsLookup)&&void 0!==o&&o,onChange:(0,t.onUpdateDatasourceJsonDataOptionChecked)(e,"disableMetricsLookup")}))),n().createElement("div",{className:"gf-form-inline"},n().createElement("div",{className:"gf-form max-width-30"},n().createElement(Wg,{label:"Custom query parameters",labelWidth:14,tooltip:"Add Custom parameters to all queries.",inputEl:n().createElement(zg,{className:"width-25",value:r.jsonData.customQueryParameters,onChange:Jg("customQueryParameters",r,i),spellCheck:!1,placeholder:"Example: max_source_resolution=5m&timeout=10"})}))),n().createElement("div",{className:"gf-form-inline"},n().createElement("div",{className:"gf-form max-width-30"},n().createElement(Wg,{label:"Link on vmui",labelWidth:14,tooltip:n().createElement(n().Fragment,null,"The link you want to use when clicking the ",n().createElement("code",null,"Run in vmui")," button"),inputEl:n().createElement(zg,{className:"width-25",value:r.jsonData.vmuiUrl,onChange:Jg("vmuiUrl",r,i),spellCheck:!1,placeholder:z(r.url)})})))))},Yg={[a.EventsWithValidation.onBlur]:[(0,a.regexValidation)(/^$|^\d+(ms|[Mwdhmsy])$/,"Value is not valid, you can use number with time unit specifier: y, M, w, d, h, m, s")]},Zg=e=>e?e.hasOwnProperty("currentTarget")?e.currentTarget.value:e.value:"",Jg=(e,t,r)=>n=>{r(Ug(Gg({},t),{jsonData:Ug(Gg({},t.jsonData),{[e]:Zg(n)})}))};function ey(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ty(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ey(e,t,r[t])}))}return e}function ry(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const{Input:ny}=a.LegacyForms,iy={[a.EventsWithValidation.onBlur]:[(0,a.regexValidation)(/^$|^\d+$/,"Value is not valid, you can use number")]},ay=[{label:"Max series",tooltip:n().createElement(n().Fragment,null,n().createElement("code",null,"-search.maxSeries")," limits the number of time series, which may be returned from ",n().createElement("a",{href:"https://prometheus.io/docs/prometheus/latest/querying/api/#finding-series-by-label-matchers",target:"_blank",rel:"noreferrer"},"/api/v1/series"),". This endpoint is used mostly by Grafana for auto-completion of metric names, label names and label values. Queries to this endpoint may take big amounts of CPU time and memory when the database contains big number of unique time series because of ",n().createElement("a",{href:"https://docs.victoriametrics.com/FAQ.html#what-is-high-churn-rate",target:"_blank",rel:"noreferrer"},"high churn rate"),". In this case it might be useful to set the ",n().createElement("code",null,"Max series")," to quite low value in order limit CPU and memory usage of the datasource."),placeholder:"",key:"maxSeries"},{label:"Max tag values",tooltip:n().createElement(n().Fragment,null,n().createElement("code",null,"-search.maxTagValues")," limits the number of items, which may be returned from ",n().createElement("a",{href:"https://prometheus.io/docs/prometheus/latest/querying/api/#querying-label-values",target:"_blank",rel:"noreferrer"},"/api/v1/label/.../values"),". This endpoint is used mostly by Grafana for auto-completion of label values. Queries to this endpoint may take big amounts of CPU time and memory when the database contains big number of unique time series because of ",n().createElement("a",{href:"https://docs.victoriametrics.com/FAQ.html#what-is-high-churn-rate",target:"_blank",rel:"noreferrer"},"high churn rate"),". In this case, it might be useful to set the ",n().createElement("code",null,"Max tag values")," to quite low value in order to limit CPU and memory usage of the datasource."),placeholder:"",key:"maxTagValues"},{label:"Max tag keys",tooltip:n().createElement(n().Fragment,null,n().createElement("code",null,"-search.maxTagKeys")," limits the number of items, which may be returned from ",n().createElement("a",{href:"https://prometheus.io/docs/prometheus/latest/querying/api/#getting-label-names",target:"_blank",rel:"noreferrer"},"/api/v1/labels"),". This endpoint is used mostly by Grafana for auto-completion of label names. Queries to this endpoint may take big amounts of CPU time and memory when the database contains big number of unique time series because of ",n().createElement("a",{href:"https://docs.victoriametrics.com/FAQ.html#what-is-high-churn-rate",target:"_blank",rel:"noreferrer"},"high churn rate"),". In this case it might be useful to set the ",n().createElement("code",null,"Max tag keys")," to quite low value in order to limit CPU and memory usage of the datasource."),placeholder:"",key:"maxTagKeys"}],oy=e=>{const{options:t,onOptionsChange:r}=e;return n().createElement(n().Fragment,null,n().createElement("h3",{className:"page-heading"},"Limits"),n().createElement("p",{className:"text-help"},"Leave the field blank or set the value to ",n().createElement("code",null,"0")," to remove the limit"),n().createElement("div",{className:"gf-form-group"},ay.map((e=>{var i,o;return n().createElement("div",{className:"gf-form",key:e.key},n().createElement(a.InlineField,{label:e.label,labelWidth:28,tooltip:e.tooltip,interactive:!0},n().createElement(ny,{className:"width-6",value:`${(null===(o=t.jsonData)||void 0===o||null===(i=o.limitMetrics)||void 0===i?void 0:i[e.key])||""}`,onChange:sy(e.key,t,r),spellCheck:!1,placeholder:e.placeholder,validationEvents:iy})))})),n().createElement("a",{className:"text-link",target:"_blank",href:"https://docs.victoriametrics.com/#prometheus-querying-api-enhancements",rel:"noreferrer"},n().createElement(a.Button,{variant:"secondary",fill:"text",icon:"book",size:"sm"},"API Limits Docs"))))},sy=(e,t,r)=>n=>{r(ry(ty({},t),{jsonData:ry(ty({},t.jsonData),{limitMetrics:ry(ty({},t.jsonData.limitMetrics),{[e]:Zg(n)})})}))};function ly(e){return"function"==typeof e}function uy(e){return function(t){if(function(e){return ly(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}var cy,dy,py=m(5556),fy=(cy=function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}},(dy=cy((function(e){Error.call(e),e.stack=(new Error).stack}))).prototype=Object.create(Error.prototype),dy.prototype.constructor=dy,dy);function my(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var hy=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,r,n,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=(0,py.__values)(a),s=o.next();!s.done;s=o.next())s.value.remove(this)}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else a.remove(this);var l=this.initialTeardown;if(ly(l))try{l()}catch(e){i=e instanceof fy?e.errors:[e]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var c=(0,py.__values)(u),d=c.next();!d.done;d=c.next()){var p=d.value;try{yy(p)}catch(e){i=null!=i?i:[],e instanceof fy?i=(0,py.__spreadArray)((0,py.__spreadArray)([],(0,py.__read)(i)),(0,py.__read)(e.errors)):i.push(e)}}}catch(e){r={error:e}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}}if(i)throw new fy(i)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)yy(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&my(t,e)},e.prototype.remove=function(t){var r=this._finalizers;r&&my(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}();function gy(e){return e instanceof hy||e&&"closed"in e&&ly(e.remove)&&ly(e.add)&&ly(e.unsubscribe)}function yy(e){ly(e)?e():e.unsubscribe()}hy.EMPTY;var vy={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},by={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=by.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,(0,py.__spreadArray)([e,t],(0,py.__read)(r))):setTimeout.apply(void 0,(0,py.__spreadArray)([e,t],(0,py.__read)(r)))},clearTimeout:function(e){var t=by.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function Oy(e){by.setTimeout((function(){var t=vy.onUnhandledError;if(!t)throw e;t(e)}))}function wy(){}var _y=Sy("C",void 0,void 0);function Sy(e,t,r){return{kind:e,value:t,error:r}}var Ey=null,xy=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,gy(t)&&t.add(r)):r.destination=qy,r}return(0,py.__extends)(t,e),t.create=function(e,t,r){return new Iy(e,t,r)},t.prototype.next=function(e){this.isStopped?Ay(function(e){return Sy("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?Ay(Sy("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?Ay(_y,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(hy),Ty=Function.prototype.bind;function Py(e,t){return Ty.call(e,t)}var ky=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){Cy(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){Cy(e)}else Cy(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){Cy(e)}},e}(),Iy=function(e){function t(t,r,n){var i,a,o=e.call(this)||this;return ly(t)||!t?i={next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:o&&vy.useDeprecatedNextContext?((a=Object.create(t)).unsubscribe=function(){return o.unsubscribe()},i={next:t.next&&Py(t.next,a),error:t.error&&Py(t.error,a),complete:t.complete&&Py(t.complete,a)}):i=t,o.destination=new ky(i),o}return(0,py.__extends)(t,e),t}(xy);function Cy(e){var t;vy.useDeprecatedSynchronousErrorHandling?(t=e,vy.useDeprecatedSynchronousErrorHandling&&Ey&&(Ey.errorThrown=!0,Ey.error=t)):Oy(e)}function Ay(e,t){var r=vy.onStoppedNotification;r&&by.setTimeout((function(){return r(e,t)}))}var qy={closed:!0,next:wy,error:function(e){throw e},complete:wy};function Ry(e,t,r,n,i){return new Dy(e,t,r,n,i)}var Dy=function(e){function t(t,r,n,i,a,o){var s=e.call(this,t)||this;return s.onFinalize=a,s.shouldUnsubscribe=o,s._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,s._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return(0,py.__extends)(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(xy);function Ny(e,t){return uy((function(r,n){var i=0;r.subscribe(Ry(n,(function(r){n.next(e.call(t,r,i++))})))}))}function Ly(e){return e}function jy(e,t){return uy((function(r,n){var i=0;r.subscribe(Ry(n,(function(r){return e.call(t,r,i++)&&n.next(r)})))}))}var My=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e},Fy="function"==typeof Symbol&&Symbol.observable||"@@observable";var By=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n,i=this,a=(n=e)&&n instanceof xy||function(e){return e&&ly(e.next)&&ly(e.error)&&ly(e.complete)}(n)&&gy(n)?e:new Iy(e,t,r);return function(e){if(vy.useDeprecatedSynchronousErrorHandling){var t=!Ey;if(t&&(Ey={errorThrown:!1,error:null}),e(),t){var r=Ey,n=r.errorThrown,i=r.error;if(Ey=null,n)throw i}}else e()}((function(){var e=i,t=e.operator,r=e.source;a.add(t?t.call(a,r):r?i._subscribe(a):i._trySubscribe(a))})),a},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=Qy(t))((function(t,n){var i=new Iy({next:function(t){try{e(t)}catch(e){n(e),i.unsubscribe()}},error:n,complete:t});r.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[Fy]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===(r=e).length?Ly:1===r.length?r[0]:function(e){return r.reduce((function(e,t){return t(e)}),e)})(this);var r},e.prototype.toPromise=function(e){var t=this;return new(e=Qy(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function Qy(e){var t;return null!==(t=null!=e?e:vy.Promise)&&void 0!==t?t:Promise}var $y="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Vy(e){return new By((function(t){(function(e,t){var r,n,i,a;return(0,py.__awaiter)(this,void 0,void 0,(function(){var o,s;return(0,py.__generator)(this,(function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),r=(0,py.__asyncValues)(e),l.label=1;case 1:return[4,r.next()];case 2:if((n=l.sent()).done)return[3,4];if(o=n.value,t.next(o),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=l.sent(),i={error:s},[3,11];case 6:return l.trys.push([6,,9,10]),n&&!n.done&&(a=r.return)?[4,a.call(r)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function Xy(e){return uy((function(t,r){var n,i=null,a=!1;i=t.subscribe(Ry(r,void 0,void 0,(function(o){n=function(e){if(e instanceof By)return e;if(null!=e){if(function(e){return ly(e[Fy])}(e))return i=e,new By((function(e){var t=i[Fy]();if(ly(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(My(e))return n=e,new By((function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()}));if(ly(null==(r=e)?void 0:r.then))return function(e){return new By((function(t){e.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,Oy)}))}(e);if(function(e){return Symbol.asyncIterator&&ly(null==e?void 0:e[Symbol.asyncIterator])}(e))return Vy(e);if(function(e){return ly(null==e?void 0:e[$y])}(e))return t=e,new By((function(e){var r,n;try{for(var i=(0,py.__values)(t),a=i.next();!a.done;a=i.next()){var o=a.value;if(e.next(o),e.closed)return}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}e.complete()}));if(function(e){return ly(null==e?void 0:e.getReader)}(e))return Vy(function(e){return(0,py.__asyncGenerator)(this,arguments,(function(){var t,r,n;return(0,py.__generator)(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,(0,py.__await)(t.read())];case 3:return r=i.sent(),n=r.value,r.done?[4,(0,py.__await)(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,(0,py.__await)(n)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}(e))}var t,r,n,i;throw function(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}(e)}(e(o,Xy(e)(t))),i?(i.unsubscribe(),i=null,n.subscribe(r)):a=!0}))),a&&(i.unsubscribe(),i=null,n.subscribe(r))}))}function Gy(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uy(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Gy(e,t,r[t])}))}return e}function zy(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const{Input:Wy}=a.LegacyForms;function Ky(e){const t=e.annotation,r=e.onAnnotationChange,i={expr:t.expr,refId:t.name,interval:t.step},o=(e,n)=>{r(zy(Uy({},t),{[n]:e}))};return n().createElement(n().Fragment,null,n().createElement(I,null,n().createElement(rg,zy(Uy({},e),{query:i,showExplain:!1,onChange:e=>o(e.expr,"expr")}))),n().createElement(w,{v:.5}),n().createElement(T,null,n().createElement(E,{label:"Min step",tooltip:n().createElement(n().Fragment,null,"An additional lower limit for the step parameter of the Prometheus query and for the"," ",n().createElement("code",null,"$__interval")," and ",n().createElement("code",null,"$__rate_interval")," variables.")},n().createElement(a.AutoSizeInput,{type:"text","aria-label":"Set lower limit for the step parameter",placeholder:"auto",minWidth:10,defaultValue:i.interval,onCommitChange:e=>o(e.currentTarget.value,"step")})),n().createElement(E,{label:"Title",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance."},n().createElement(Wy,{type:"text",placeholder:"{{alertname}}",value:t.titleFormat,onChange:e=>o(e.currentTarget.value,"titleFormat")})),n().createElement(E,{label:"Tags"},n().createElement(Wy,{type:"text",placeholder:"label1,label2",value:t.tagKeys,onChange:e=>o(e.currentTarget.value,"tagKeys")})),n().createElement(E,{label:"Text",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance."},n().createElement(Wy,{type:"text",placeholder:"{{instance}}",value:t.textFormat,onChange:e=>o(e.currentTarget.value,"textFormat")})),n().createElement(E,{label:"Series value as timestamp",tooltip:"The unit of timestamp is milliseconds. If the unit of the series value is seconds, multiply its range vector by 1000."},n().createElement(C,{checked:t.useValueForTime,onChange:e=>o(e.currentTarget.value,"useValueForTime")}))))}function Hy(e,t){return e.replace(/\{\{\s*([^{}]+?)\s*}}/g,((e,r)=>t[r]||""))}function Yy(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zy(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Yy(e,t,r[t])}))}return e}function Jy(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const ev=/^label_names\(\)\s*$/,tv=/^label_values\((?:(.+),\s*)?([a-zA-Z_$][a-zA-Z0-9_]*)\)\s*$/,rv=/^metrics\((.+)\)\s*$/,nv=/^query_result\((.+)\)\s*$/,iv=/^label_names\((.+)\)\s*$/;function av(e){if("string"!=typeof e)return e;const t={refId:"PrometheusDatasource-VariableQuery",qryType:za.LabelNames},r=e.match(iv);if(r)return Jy(Zy({},t),{qryType:za.LabelNames,match:r[1]});const n=e.match(ev);if(n)return Jy(Zy({},t),{qryType:za.LabelNames});const i=e.match(/^label_values\(/);if(i){const r=e.match(tv),n=r?r[2]:"",i=r?r[1]:"";if(i){const e=Nn(i);return Jy(Zy({},t),{qryType:za.LabelValues,label:n,metric:e.query.metric,labelFilters:e.query.labels})}return Jy(Zy({},t),{qryType:za.LabelValues,label:n})}const a=e.match(/^metrics\(/);if(a){const r=e.match(rv),n=r?r[1]:"";return Jy(Zy({},t),{qryType:za.MetricNames,metric:n})}const o=e.match(/^query_result\(/);if(o){const r=e.match(nv),n=r?r[1]:"";return Jy(Zy({},t),{qryType:za.VarQueryResult,varQuery:n})}return n||i||a||o?t:Jy(Zy({},t),{qryType:za.SeriesQuery,seriesQuery:e})}function ov(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class sv{process(e){this.range=e;const t=ev,r=iv,n=rv,i=nv,a=this.query.match(t),o=this.query.match(r);if(o){const e=`{__name__=~".*${o[1]}.*"}`;return this.datasource.languageProvider.getSeriesLabels(e,[]).then((e=>e.map((e=>({text:e})))))}if(a)return this.datasource.getTagKeys({filters:[],timeRange:e});const s=this.query.match(/^label_values\((?:(.+),\s*)?([a-zA-Z_][a-zA-Z0-9_]*)\)\s*$/);if(s){const e=s[1],t=s[2];return function(e){return e&&"{}"!==e.split(" ").join("")}(e)?this.labelValuesQuery(t,e):this.labelValuesQuery(t)}const l=this.query.match(n);if(l)return this.metricNameQuery(l[1]);const u=this.query.match(i);return u?this.queryResultQuery(u[1]):["label_values()","metrics()","query_result()"].includes(this.query)?Promise.resolve([]):this.metricNameAndLabelsQuery(this.query)}labelValuesQuery(e,t){const r=ai(this.range.from,!1),n=ai(this.range.to,!0),i=(o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ov(e,t,r[t])}))}return e}({},t&&{"match[]":t}),s=null!=(s={start:r.toString(),end:n.toString()})?s:{},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(s)).forEach((function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(s,e))})),o),a=`/api/v1/label/${e}/values`;var o,s;return this.datasource.metadataRequest(a,i).then((e=>(0,$.map)(e.data.data,(e=>({text:e})))))}metricNameQuery(e){const t=ai(this.range.from,!1),r=ai(this.range.to,!0),n={start:t.toString(),end:r.toString()};return this.datasource.metadataRequest("/api/v1/label/__name__/values",n).then((t=>(0,$.chain)(t.data.data).filter((t=>new RegExp(e).test(t))).map((e=>({text:e,expandable:!0}))).value()))}queryResultQuery(e){const t={query:e,time:ai(this.range.to,!0).toString()};return this.datasource.metadataRequest("/api/v1/query",t).then((e=>{switch(e.data.data.resultType){case"scalar":case"string":return[{text:e.data.data.result[1]||"",expandable:!1}];case"vector":return(0,$.map)(e.data.data.result,(e=>{let t=e.metric.__name__||"";return delete e.metric.__name__,t+="{"+(0,$.map)(e.metric,((e,t)=>t+'="'+e+'"')).join(",")+"}",t+=" "+e.value[1]+" "+1e3*e.value[0],{text:t,expandable:!0}}));default:throw Error(`Unknown/Unhandled result type: [${e.data.data.resultType}]`)}}))}metricNameAndLabelsQuery(e){const t=ai(this.range.from,!1),r=ai(this.range.to,!0),n={"match[]":e,start:t.toString(),end:r.toString()},i=this;return this.datasource.metadataRequest("/api/v1/series",n).then((e=>(0,$.map)(e.data.data,(e=>({text:i.datasource.getOriginalMetricName(e),expandable:!0})))))}constructor(e,r){ov(this,"datasource",void 0),ov(this,"query",void 0),ov(this,"range",void 0),this.datasource=e,this.query=r,this.datasource=e,this.query=r,this.range=(0,t.getDefaultTimeRange)()}}function lv(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uv(e,t,r){const n=[];if(e.trim().match(/^\w+_bucket$|^\w+_bucket{.*}$/)){const t="Selected metric has buckets.";n.push({type:"HISTOGRAM_QUANTILE",label:t,fix:{label:"Consider calculating aggregated quantile by adding histogram_quantile().",action:{type:"ADD_HISTOGRAM_QUANTILE",query:e}}})}if(-1===e.indexOf("rate(")&&-1===e.indexOf("increase(")){var i;const t=e.match(/\b(\w+_(total|sum|count))\b/);let o=t?t[1]:"";const s=null==r||null===(i=r.languageProvider)||void 0===i?void 0:i.metricsMetadata;let l=!1;var a;if(s)o=null!==(a=Array.from(e.matchAll(/\$?[a-zA-Z_:][a-zA-Z0-9_:]*/g)).map((([e])=>e)).filter((e=>!e.startsWith("$"))).flatMap((e=>e.split(":"))).find((e=>{const t=s[e];return!(!t||"counter"!==t.type.toLowerCase()||(l=!0,0))})))&&void 0!==a?a:"";if(o){const t=e.trim().match(/^\w+$|^\w+{.*}$/);let r,i=`Selected metric ${l?"is":"looks like"} a counter.`;t?r={label:"Consider calculating rate of counter by adding rate().",action:{type:"ADD_RATE",query:e}}:i=`${i} Consider calculating rate of counter by adding rate().`,n.push({type:"APPLY_RATE",label:i,fix:r})}}if(r&&r.ruleMappings){const t=r.ruleMappings,i=Object.keys(t).reduce(((r,n)=>{return e.search(n)>-1?(i=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){lv(e,t,r[t])}))}return e}({},r),a=null!=(a={[n]:t[n]})?a:{},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(a)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(a)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(a,e))})),i):r;var i,a}),{});if((0,$.size)(i)>0){const t="Query contains recording rules.";n.push({type:"EXPAND_RULES",label:t,fix:{label:"Expand rules",action:{type:"EXPAND_RULES",query:e,options:i}}})}}return t&&t.length>=20&&e.trim().match(/^\w+$/)&&n.push({type:"ADD_SUM",label:"Many time series results returned.",fix:{label:"Consider aggregating with sum().",action:{type:"ADD_SUM",query:e,preventSubmit:!0}}}),n}function cv(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dv(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){cv(e,t,r[t])}))}return e}function pv(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function fv(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}const mv=/^[+-]?inf(?:inity)?$/i;const hv="le";function gv(e,r){var n;const a={format:r.target.format,step:r.query.step,legendFormat:r.target.legendFormat,start:r.query.start,end:r.query.end,query:r.query.expr,responseListLength:r.responseListLength,scopedVars:r.scopedVars,refId:r.target.refId,valueWithRefId:r.target.valueWithRefId,meta:{preferredVisualisationType:r.query.instant?"table":"graph"}},o=e.data.data,s=null===(n=e.data)||void 0===n?void 0:n.trace;if(e.data.isPartial){const e={severity:"warning",text:"The shown results are marked as PARTIAL. The result is marked as partial if one or more vmstorage nodes failed to respond to the query."};Array.isArray(a.meta.notices)?a.meta.notices.push(e):a.meta.notices=[e]}if(null!=(l=o)&&Array.isArray(l)&&l.length&&"exemplars"in l[0])return{dataFrame:[],traceResult:s};var l;if(!(null==o?void 0:o.result))return{dataFrame:[],traceResult:s};if("scalar"===o.resultType)return{dataFrame:[{meta:a.meta,refId:a.refId,length:1,fields:[bv([o.result]),Ov({data:[o.result]})]}],traceResult:s};if("table"===a.format){const e=function(e,r){if(!e||0===e.length)return{meta:r.meta,refId:r.refId,length:0,fields:[]};const n=r.responseListLength>1||r.valueWithRefId?`Value #${r.refId}`:"Value",i=bv([]),a=Object.keys(e.reduce(((e,t)=>dv({},e,t.metric)),{})).sort().map((e=>({name:e,config:{filterable:!0},type:e===hv?t.FieldType.number:t.FieldType.string,values:new t.ArrayVector}))),o=Ov({data:[],valueName:n});return e.forEach((e=>{Wa(e)?e.values.forEach((t=>{i.values.add(1e3*t[0]),a.forEach((t=>t.values.add(vv(e.metric,t.name)))),o.values.add(Ev(t[1]))})):(i.values.add(1e3*e.value[0]),a.forEach((t=>t.values.add(vv(e.metric,t.name)))),o.values.add(Ev(e.value[1])))})),{meta:r.meta,refId:r.refId,length:i.values.length,fields:[i,...a,o]}}(o.result,a);return{dataFrame:[e],traceResult:s}}const u=[];return o.result.forEach((e=>u.push(function(e,r){const{name:n,labels:a}=function(e,r){const n=null==r?void 0:r.legendFormat;if(n&&n!==Ua.Auto)return{name:Hy((0,i.getTemplateSrv)().replace(n,null==r?void 0:r.scopedVars),e),labels:e};if(n===Ua.Auto&&1===Object.keys(e).length)return{name:Object.values(e)[0],labels:e};const{__name__:a}=e,o=fv(e,["__name__"]);return{name:`${null!=a?a:""}${(0,t.formatLabels)(o)}`||r.query,labels:o}}(e.metric,r),o=[];if(Wa(e)){const t=r.step?1e3*r.step:NaN;let i=1e3*r.start;const s=[];for(const r of e.values){let e=Ev(r[1]);isNaN(e)&&(e=null);const n=1e3*r[0];for(let e=i;e<n;e+=t)s.push([e,null]);i=n+t,s.push([n,e])}const l=1e3*r.end;for(let e=i;e<=l;e+=t)s.push([e,null]);o.push(bv(s,!0)),o.push(Ov({data:s,parseValue:!1,labels:a,displayNameFromDS:n}))}else o.push(bv([e.value])),o.push(Ov({data:[e.value],labels:a,displayNameFromDS:n}));return{meta:r.meta,refId:r.refId,length:o[0].values.length,fields:o,name:n}}(e,a)))),"heatmap"===a.format?{dataFrame:wv(_v(u.sort(Sv))),traceResult:s}:{dataFrame:u,traceResult:s}}function yv(e){const t=[];if(e.datasourceUid){const n=(0,i.getDataSourceSrv)().getInstanceSettings(e.datasourceUid);var r;n&&t.push({title:e.urlDisplayLabel||`Query with ${null==n?void 0:n.name}`,url:"",internal:{query:{query:"${__value.raw}",queryType:"traceId"},datasourceUid:e.datasourceUid,datasourceName:null!==(r=null==n?void 0:n.name)&&void 0!==r?r:"Data source not found"}})}return e.url&&t.push({title:e.urlDisplayLabel||`Go to ${e.url}`,url:e.url,targetBlank:!0}),t}function vv(e,t){return e.hasOwnProperty(t)?t===hv?Ev(e[t]):e[t]:""}function bv(e,r=!1){return{name:t.TIME_SERIES_TIME_FIELD_NAME,type:t.FieldType.time,config:{},values:new t.ArrayVector(e.map((e=>r?e[0]:1e3*e[0])))}}function Ov({data:e,valueName:r=t.TIME_SERIES_VALUE_FIELD_NAME,parseValue:n=!0,labels:i,displayNameFromDS:a}){return{name:r,type:t.FieldType.number,display:(0,t.getDisplayProcessor)(),config:{displayNameFromDS:a},labels:i,values:new t.ArrayVector(e.map((e=>n?Ev(e[1]):e[1])))}}function wv(e){if(0===e.length)return[];const r=e[0].fields.find((e=>e.type===t.FieldType.time)),n=e.map((e=>{let r=e.fields.find((e=>e.type===t.FieldType.number));return pv(dv({},r),{name:r.config.displayNameFromDS})}));return[pv(dv({},e[0]),{meta:pv(dv({},e[0].meta),{type:t.DataFrameType.HeatmapRows}),fields:[r,...n]})]}function _v(e){for(let r=e.length-1;r>0;r--){const n=e[r].fields.find((e=>e.name===t.TIME_SERIES_VALUE_FIELD_NAME)),i=e[r-1].fields.find((e=>e.name===t.TIME_SERIES_VALUE_FIELD_NAME));if(!n||!i)throw new Error("Prometheus heatmap transform error: data should be a time series");for(let e=0;e<n.values.length;e++){const t=i.values.get(e)||[0];n.values.toArray()[e]-=t}}return e}function Sv(e,t){let r,n;try{var i,a;r=Ev(null!==(i=e.name)&&void 0!==i?i:""),n=Ev(null!==(a=t.name)&&void 0!==a?a:"")}catch(e){return console.error(e),0}return r>n?1:r<n?-1:0}function Ev(e){return mv.test(e)?"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:parseFloat(e)}function xv(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Tv extends t.BusEventWithPayload{}var Pv;xv(Tv,"type","zoom-out"),function(e){e[e.Left=-1]="Left",e[e.Right=1]="Right"}(Pv||(Pv={}));class kv extends t.BusEventWithPayload{}xv(kv,"type","shift-time");class Iv extends t.BusEventBase{}xv(Iv,"type","absolute-time");const Cv=new t.EventBusSrv;function Av(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class qv{constructor(){Av(this,"isSignedIn",void 0),Av(this,"id",void 0),Av(this,"login",void 0),Av(this,"email",void 0),Av(this,"name",void 0),Av(this,"externalUserId",void 0),Av(this,"theme",void 0),Av(this,"orgCount",void 0),Av(this,"orgId",void 0),Av(this,"orgName",void 0),Av(this,"orgRole",void 0),Av(this,"isGrafanaAdmin",void 0),Av(this,"gravatarUrl",void 0),Av(this,"timezone",void 0),Av(this,"weekStart",void 0),Av(this,"locale",void 0),Av(this,"language",void 0),Av(this,"helpFlags1",void 0),Av(this,"hasEditPermissionInFolders",void 0),Av(this,"permissions",void 0),Av(this,"analytics",void 0),Av(this,"fiscalYearStartMonth",void 0),Av(this,"authenticatedBy",void 0),this.id=0,this.isGrafanaAdmin=!1,this.isSignedIn=!1,this.orgRole="",this.orgId=0,this.orgName="",this.login="",this.externalUserId="",this.orgCount=0,this.timezone="",this.fiscalYearStartMonth=0,this.helpFlags1=0,this.theme="dark",this.hasEditPermissionInFolders=!1,this.email="",this.name="",this.locale="",this.language="",this.weekStart="",this.gravatarUrl="",this.analytics={identifier:""},this.authenticatedBy="",i.config.bootData.user&&(0,$.extend)(this,i.config.bootData.user)}}let Rv=new class{hasRole(e){return"ServerAdmin"===e?this.isGrafanaAdmin:this.user.orgRole===e}accessControlEnabled(){return i.config.rbacEnabled}hasPermissionInMetadata(e,t){var r;return!this.accessControlEnabled()||!!(null===(r=t.accessControl)||void 0===r?void 0:r[e])}hasPermission(e){var t;return!this.accessControlEnabled()||!!(null===(t=this.user.permissions)||void 0===t?void 0:t[e])}isGrafanaVisible(){return void 0===document.visibilityState||"visible"===document.visibilityState}isAllowedInterval(e){return!i.config.minRefreshInterval||t.rangeUtil.intervalToMs(e)>=t.rangeUtil.intervalToMs(i.config.minRefreshInterval)}getValidInterval(e){return this.isAllowedInterval(e)?e:i.config.minRefreshInterval}constructor(){Av(this,"version",void 0),Av(this,"user",void 0),Av(this,"isSignedIn",void 0),Av(this,"isGrafanaAdmin",void 0),Av(this,"isEditor",void 0),Av(this,"hasEditPermissionInFolders",void 0),Av(this,"minRefreshInterval",void 0),i.config.bootData||(i.config.bootData={user:{},settings:{}}),this.user=new qv,this.isSignedIn=this.user.isSignedIn,this.isGrafanaAdmin=this.user.isGrafanaAdmin,this.isEditor=this.hasRole("Editor")||this.hasRole("Admin"),this.hasEditPermissionInFolders=this.user.hasEditPermissionInFolders,this.minRefreshInterval=i.config.minRefreshInterval}};function Dv(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Nv=(e,r)=>{const n={from:(0,t.isDateTime)(e.from)?(0,t.dateTime)(e.from):e.from,to:(0,t.isDateTime)(e.to)?(0,t.dateTime)(e.to):e.to},i=r?r.getTimezone():void 0;return{from:t.dateMath.parse(n.from,!1,i,null==r?void 0:r.fiscalYearStartMonth),to:t.dateMath.parse(n.to,!0,i,null==r?void 0:r.fiscalYearStartMonth),raw:n}},Lv=()=>{var e,r;return(null===(r=(0,i.getTemplateSrv)())||void 0===r||null===(e=r.timeRange)||void 0===e?void 0:e.raw)||(0,t.getDefaultTimeRange)().raw};class jv{init(e){var r,n;this.timeModel=e,this.time=e.time,this.refresh=e.refresh,this.initTimeFromUrl(),this.parseTime(),this.timeAtLoad=(0,$.cloneDeep)(this.time);const i=t.rangeUtil.convertRawToRange(this.time,null===(r=this.timeModel)||void 0===r?void 0:r.getTimezone(),null===(n=this.timeModel)||void 0===n?void 0:n.fiscalYearStartMonth);i.to.isBefore(i.from)&&this.setTime({from:i.raw.to,to:i.raw.from},!1),this.refresh&&this.setAutoRefresh(this.refresh)}getValidIntervals(e){return this.contextSrv.minRefreshInterval?e.filter((e=>""!==e)).filter(this.contextSrv.isAllowedInterval):e}parseTime(){(0,$.isString)(this.time.from)&&this.time.from.indexOf("Z")>=0&&(this.time.from=(0,t.dateTime)(this.time.from).utc()),(0,$.isString)(this.time.to)&&this.time.to.indexOf("Z")>=0&&(this.time.to=(0,t.dateTime)(this.time.to).utc())}parseUrlParam(e){if(-1!==e.indexOf("now"))return e;if(8===e.length){const r=(0,t.toUtc)(e,"YYYYMMDD");if(r.isValid())return r}else if(15===e.length){const r=(0,t.toUtc)(e,"YYYYMMDDTHHmmss");if(r.isValid())return r}if(!isNaN(e)){const r=parseInt(e,10);return(0,t.toUtc)(r)}return null}getTimeWindow(e,r){const n=parseInt(e,10);let i;return i=r.match(/^\d+$/)&&parseInt(r,10)?parseInt(r,10):t.rangeUtil.intervalToMs(r),{from:(0,t.toUtc)(n-i/2),to:(0,t.toUtc)(n+i/2)}}initTimeFromUrl(){var e,t,r,n;if(i.config.isPublicDashboardView)return;const o=i.locationService.getSearch();o.get("time")&&o.get("time.window")&&(this.time=this.getTimeWindow(o.get("time"),o.get("time.window"))),o.get("from")&&(this.time.from=this.parseUrlParam(o.get("from"))||this.time.from),o.get("to")&&(this.time.to=this.parseUrlParam(o.get("to"))||this.time.to),o.get("to")&&-1===o.get("to").indexOf("now")&&(this.refresh=!1,this.timeModel&&(this.timeModel.refresh=!1)),this.refresh=function({urlRefresh:e,currentRefresh:t,isAllowedIntervalFn:r,minRefreshInterval:n,refreshIntervals:i=a.defaultIntervals}){if(!e)return t;const o=r(e),s=i.find((t=>t===e));if(!o||!s){const e=n?i.find((e=>e===n)):void 0,r=(null==i?void 0:i.length)?i[0]:void 0;var l;return null!==(l=null!=e?e:r)&&void 0!==l?l:t}return e||t}({urlRefresh:o.get("refresh"),currentRefresh:this.refresh,refreshIntervals:Array.isArray(null===(t=this.timeModel)||void 0===t||null===(e=t.timepicker)||void 0===e?void 0:e.refresh_intervals)?null===(n=this.timeModel)||void 0===n||null===(r=n.timepicker)||void 0===r?void 0:r.refresh_intervals:void 0,isAllowedIntervalFn:this.contextSrv.isAllowedInterval,minRefreshInterval:i.config.minRefreshInterval})}updateTimeRangeFromUrl(){const e=i.locationService.getSearch();if(e.get("left"))return;const t=this.timeRangeForUrl(),r=e.get("from"),n=e.get("to");r&&n?r===t.from&&n===t.to||(this.initTimeFromUrl(),this.setTime(this.time,!1)):this.timeHasChangedSinceLoad()&&this.setTime(this.timeAtLoad,!0)}timeHasChangedSinceLoad(){return this.timeAtLoad&&(this.timeAtLoad.from!==this.time.from||this.timeAtLoad.to!==this.time.to)}setAutoRefresh(e){this.timeModel&&(this.timeModel.refresh=e),this.stopAutoRefresh();const r=i.locationService.getSearchObject();if(!e)return void(r.refresh&&i.locationService.partial({refresh:null},!0));const n=this.contextSrv.getValidInterval(e),a=t.rangeUtil.intervalToMs(n);this.refreshTimer=setTimeout((()=>{this.startNextRefreshTimer(a),!this.autoRefreshPaused&&this.refreshTimeModel()}),a);const o=this.contextSrv.getValidInterval(e);r.refresh!==o&&i.locationService.partial({refresh:o},!0)}refreshTimeModel(){var e;null===(e=this.timeModel)||void 0===e||e.timeRangeUpdated(this.timeRange())}startNextRefreshTimer(e){this.refreshTimer=setTimeout((()=>{this.startNextRefreshTimer(e),this.contextSrv.isGrafanaVisible()?!this.autoRefreshPaused&&this.refreshTimeModel():this.autoRefreshBlocked=!0}),e)}stopAutoRefresh(){clearTimeout(this.refreshTimer)}pauseAutoRefresh(){this.autoRefreshPaused=!0}resumeAutoRefresh(){this.autoRefreshPaused=!1,this.refreshTimeModel()}setTime(e,r=!0){var n;if(!i.config.isPublicDashboardView){var a;if((0,$.extend)(this.time,e),(0,t.isDateTime)(e.to)?(this.oldRefresh=(null===(a=this.timeModel)||void 0===a?void 0:a.refresh)||this.oldRefresh,this.setAutoRefresh(!1)):this.oldRefresh&&this.oldRefresh!==(null===(n=this.timeModel)||void 0===n?void 0:n.refresh)&&(this.setAutoRefresh(this.oldRefresh),this.oldRefresh=null),r){const e=this.timeRangeForUrl(),t=i.locationService.getSearchObject();if(t.from===e.from.toString()&&t.to===e.to.toString())return;t.from=e.from.toString(),t.to=e.to.toString(),i.locationService.partial(t)}this.refreshTimeModel()}}timeRange(){return Nv(Lv(),this.timeModel)}zoomOut(e,r=!0){const n=this.timeRange(),{from:i,to:a}=((e,t)=>{const r=e.to.valueOf()-e.from.valueOf(),n=e.to.valueOf()-r/2,i=0===r?3e4:r*t;return{from:n-i/2,to:n+i/2}})(n,e);this.setTime({from:(0,t.toUtc)(i),to:(0,t.toUtc)(a)},r)}shiftTime(e,r=!0){const n=this.timeRange(),{from:i,to:a}=((e,r)=>{const n={from:(0,t.toUtc)(r.from),to:(0,t.toUtc)(r.to)},i=(n.to.valueOf()-n.from.valueOf())/2;let a,o;return-1===e?(a=n.to.valueOf()-i,o=n.from.valueOf()-i):1===e?(a=n.to.valueOf()+i,o=n.from.valueOf()+i,a>Date.now()&&n.to.valueOf()<Date.now()&&(a=Date.now(),o=n.from.valueOf())):(a=n.to.valueOf(),o=n.from.valueOf()),{from:o,to:a}})(e,n);this.setTime({from:(0,t.toUtc)(i),to:(0,t.toUtc)(a)},r)}makeAbsoluteTime(){if(i.locationService.getSearch().get("left"))return;const{from:e,to:t}=this.timeRange();this.setTime({from:e,to:t},!0)}isRefreshOutsideThreshold(e,r=.05){const n=this.timeRange();if(t.dateMath.isMathString(n.raw.from)){const t=n.to.diff(n.from);return Date.now()-e>=t*r}return!1}constructor(e){Dv(this,"contextSrv",void 0),Dv(this,"time",void 0),Dv(this,"refreshTimer",void 0),Dv(this,"refresh",void 0),Dv(this,"autoRefreshPaused",void 0),Dv(this,"oldRefresh",void 0),Dv(this,"timeModel",void 0),Dv(this,"timeAtLoad",void 0),Dv(this,"autoRefreshBlocked",void 0),Dv(this,"timeRangeForUrl",void 0),this.contextSrv=e,this.autoRefreshPaused=!1,this.timeRangeForUrl=()=>{const e=Nv(this.time,this.timeModel).raw;return(0,t.isDateTime)(e.from)&&(e.from=e.from.valueOf().toString()),(0,t.isDateTime)(e.to)&&(e.to=e.to.valueOf().toString()),e},this.time=Lv(),this.refreshTimeModel=this.refreshTimeModel.bind(this),Cv.subscribe(Tv,(e=>{this.zoomOut(e.payload.scale,e.payload.updateUrl)})),Cv.subscribe(kv,(e=>{this.shiftTime(e.payload.direction,e.payload.updateUrl)})),Cv.subscribe(Iv,(()=>{this.makeAbsoluteTime()})),document.addEventListener("visibilitychange",(()=>{this.autoRefreshBlocked&&"visible"===document.visibilityState&&(this.autoRefreshBlocked=!1,this.refreshTimeModel())}))}}let Mv;const Fv=e=>e.split(" ").map((e=>`${e}.*`)).join("");var Bv=m(1988),Qv=m(7504),$v=m.n(Qv);function Vv(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function Xv(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){Vv(a,n,i,o,s,"next",e)}function s(e){Vv(a,n,i,o,s,"throw",e)}o(void 0)}))}}function Gv(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uv(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Gv(e,t,r[t])}))}return e}function zv(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Wv({item:e,defaultOp:i,onChange:o,onDelete:s,onGetLabelNames:l,onGetLabelValues:u,invalidLabel:c,invalidValue:d,getLabelValuesAutofillSuggestions:p,debounceDuration:f}){const[m,h]=(0,r.useState)({}),[g,y]=(0,r.useState)(!1),[v,b]=(0,r.useState)(!1),O=(t=e.op)=>{var r;return null===(r=Kv.find((e=>e.label===t)))||void 0===r?void 0:r.isMultiValue},w=e=>{if(e){const t=/\(([^)]+)\)/,r=null==e?void 0:e.match(t);return r&&r[0].indexOf("|")>0?[e]:e.indexOf("|")>0?e.split("|"):[e]}return[]},_=$v()((t=>p(t,e.label)),f);var S;const E=null!==(S=null==e?void 0:e.value)&&void 0!==S?S:"";var x,T;return n().createElement("div",{key:E,"data-testid":"prometheus-dimensions-filter-item"},n().createElement(Bv.InputGroup,null,n().createElement(a.Select,{placeholder:"Select label","data-testid":wi.components.QueryBuilder.labelSelect,inputId:"prometheus-dimensions-filter-item-key",width:"auto",value:e.label?(0,t.toOption)(e.label):null,allowCustomValue:!0,onOpenMenu:Xv((function*(){h({isLoadingLabelNames:!0});const t=yield l(e);y(!0),h({labelNames:t,isLoadingLabelNames:void 0})})),onCloseMenu:()=>{y(!1)},isOpen:g,isLoading:null!==(x=m.isLoadingLabelNames)&&void 0!==x&&x,options:m.labelNames,onChange:t=>{var r;t.label&&o(zv(Uv({},e),{op:null!==(r=e.op)&&void 0!==r?r:i,label:t.label}))},invalid:c}),n().createElement(a.Select,{"data-testid":wi.components.QueryBuilder.matchOperatorSelect,className:"query-segment-operator",value:(0,t.toOption)(null!==(T=e.op)&&void 0!==T?T:i),options:Kv,width:"auto",onChange:t=>{null!=t.value&&o(zv(Uv({},e),{op:t.value,value:O(t.value)?e.value:w(null==e?void 0:e.value)[0]}))}}),n().createElement(a.AsyncSelect,{placeholder:"Select value","data-testid":wi.components.QueryBuilder.valueSelect,inputId:"prometheus-dimensions-filter-item-value",width:"auto",value:O()?w(E).map(t.toOption):w(E).map(t.toOption)[0],allowCustomValue:!0,onOpenMenu:Xv((function*(){h({isLoadingLabelValues:!0});const t=yield u(e);oi(t),b(!0),h(zv(Uv({},m),{labelValues:t,isLoadingLabelValues:void 0}))})),onCloseMenu:()=>{b(!1)},isOpen:v,defaultOptions:m.labelValues,isMulti:O(),isLoading:m.isLoadingLabelValues,loadOptions:_,onChange:t=>{if(t.value){var r;o(zv(Uv({},e),{value:t.value,op:null!==(r=e.op)&&void 0!==r?r:i}))}else{const r=t.map((e=>e.label)).join("|");var n;o(zv(Uv({},e),{value:r,op:null!==(n=e.op)&&void 0!==n?n:i}))}},invalid:d}),n().createElement(Bv.AccessoryButton,{"aria-label":`remove-${e.label}`,icon:"times",variant:"secondary",onClick:s})))}const Kv=[{label:"=",value:"=",isMultiValue:!1},{label:"!=",value:"!=",isMultiValue:!1},{label:"=~",value:"=~",isMultiValue:!0},{label:"!~",value:"!~",isMultiValue:!0}],Hv="Select at least 1 label filter (label and value)";function Yv({labelsFilters:e,onChange:t,onGetLabelNames:i,onGetLabelValues:o,labelFilterRequired:s,getLabelValuesAutofillSuggestions:l,debounceDuration:u,variableEditor:d}){const[p,f]=(0,r.useState)([{op:"="}]);(0,r.useEffect)((()=>{e.length>0?f(e):f([{op:"="}])}),[e]);const m=r=>{f(r);const n=r.filter((e=>null!=e.label&&null!=e.value));(0,$.isEqual)(n,e)||t(n)},h=p.some((e=>e.label&&e.value)),g=()=>n().createElement(Bv.EditorList,{items:p,onChange:m,renderItem:(e,t,r)=>n().createElement(Wv,{debounceDuration:u,item:e,defaultOp:"=",onChange:t,onDelete:r,onGetLabelNames:i,onGetLabelValues:o,invalidLabel:s&&!e.label,invalidValue:s&&!e.value,getLabelValuesAutofillSuggestions:l})});return n().createElement(n().Fragment,null,d?n().createElement(a.InlineFieldRow,null,n().createElement("div",{className:(0,c.cx)(c.css`
              display: flex;
            `)},n().createElement(a.InlineLabel,{width:20,tooltip:n().createElement("div",null,"Optional: used to filter the metric select for this query type.")},"Label filters"),g())):n().createElement(Bv.EditorFieldGroup,null,n().createElement(Bv.EditorField,{label:"Label filters",error:Hv,invalid:s&&!h},g())))}function Zv(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function Jv(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){Zv(a,n,i,o,s,"next",e)}function s(e){Zv(a,n,i,o,s,"throw",e)}o(void 0)}))}}function eb(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tb(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){eb(e,t,r[t])}))}return e}function rb(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function nb({datasource:e,query:t,onChange:i,onBlur:a,variableEditor:o}){const s=(0,r.useCallback)(function(){var t=Jv((function*(t){const r=e.getVariables(),n=yield t;return[...r.map((e=>({label:e,value:e}))),...n.map((e=>({label:e.value,value:e.value,title:e.description})))]}));return function(e){return t.apply(this,arguments)}}(),[e]),l=function(){var r=Jv((function*(r){if(!t.metric)return yield e.languageProvider.fetchLabels(),e.languageProvider.getLabelKeys().map((e=>({value:e})));const n=t.labels.filter((e=>e!==r));n.push({label:"__name__",op:"=",value:t.metric});const i=Tn.renderLabels(n);return(yield e.languageProvider.fetchSeriesLabelsMatch(i)).filter((e=>!n.find((t=>t.label===e)))).map((e=>({value:e})))}));return function(e){return r.apply(this,arguments)}}(),u=(t,r)=>t.label?e.languageProvider.fetchSeriesValuesWithMatch(t.label,r).then((e=>e.map((e=>({value:e,label:e}))))):Promise.resolve([]),c=function(){var r=Jv((function*(r){if(!r.label)return[];if(!t.metric)return(yield e.languageProvider.getLabelValues(r.label)).map((e=>({value:e})));const n=t.labels.filter((e=>e!==r));n.push({label:"__name__",op:"=",value:t.metric});const i=n.map((t=>rb(tb({},t),{label:e.interpolateString(t.label),value:e.interpolateString(t.value)}))),a=Tn.renderLabels(i);return u(r,a)}));return function(e){return r.apply(this,arguments)}}(),d=(0,r.useCallback)((()=>s(function(e,t){return ib.apply(this,arguments)}(e,t))),[e,t,s]);return n().createElement(n().Fragment,null,n().createElement(jm,{query:t,onChange:i,onGetMetrics:d,variableEditor:o}),n().createElement(Yv,{debounceDuration:350,getLabelValuesAutofillSuggestions:(r,n)=>{const i={label:null!=n?n:"__name__",op:"=~",value:Fv(`.*${r}`)},a=t.labels.filter((e=>e.label!==i.label));a.push(i),t.metric&&a.push({label:"__name__",op:"=",value:t.metric});const o=a.map((t=>rb(tb({},t),{label:e.interpolateString(t.label),value:e.interpolateString(t.value)}))),s=Tn.renderLabels(o);return u(i,s).then((e=>(oi(e),e)))},labelsFilters:t.labels,onChange:e=>{i(rb(tb({},t),{labels:e}))},onGetLabelNames:e=>s(l(e)),onGetLabelValues:e=>s(c(e)),variableEditor:o}))}function ib(){return ib=Jv((function*(e,t){let r;if(e.languageProvider.metricsMetadata||(yield e.languageProvider.loadMetricsMetadata()),e.languageProvider.metricsMetadata||(e.languageProvider.metricsMetadata={}),t.labels.length>0){const i=Tn.renderLabels(t.labels);var n;r=null!==(n=(yield e.languageProvider.getSeries(i,!0)).__name__)&&void 0!==n?n:[]}else{var i;r=null!==(i=yield e.languageProvider.getLabelValues("__name__"))&&void 0!==i?i:[]}return r.map((t=>({value:t,description:gi(t,e.languageProvider.metricsMetadata)})))})),ib.apply(this,arguments)}function ab(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const ob=[{label:"Label names",value:za.LabelNames},{label:"Label values",value:za.LabelValues},{label:"Metrics",value:za.MetricNames},{label:"Query result",value:za.VarQueryResult},{label:"Series query",value:za.SeriesQuery},{label:"Classic query",value:za.ClassicQuery}],sb="VariableQueryEditor-VariableQuery",lb=({onChange:e,query:t,datasource:i,range:o})=>{const[s,l]=(0,r.useState)(void 0),[u,c]=(0,r.useState)(""),[d,p]=(0,r.useState)(""),[f,m]=(0,r.useState)(""),[h,g]=(0,r.useState)(""),[y,v]=(0,r.useState)(""),[b,O]=(0,r.useState)(""),[w,_]=(0,r.useState)([]),[S,E]=(0,r.useState)([]);(0,r.useEffect)((()=>{i.languageProvider.start(o)}),[]),(0,r.useEffect)((()=>{if(t)if(t.qryType===za.ClassicQuery){var e;l(t.qryType),O(null!==(e=t.query)&&void 0!==e?e:"")}else{const e=function(e){return"string"==typeof e?av(e):e.query?av(e.query):e}(t);var r,n,i,a,o,s,u;p(null!==(r=e.match)&&void 0!==r?r:""),l(e.qryType),c(null!==(n=e.label)&&void 0!==n?n:""),m(null!==(i=e.metric)&&void 0!==i?i:""),E(null!==(a=e.labelFilters)&&void 0!==a?a:[]),g(null!==(o=e.varQuery)&&void 0!==o?o:""),v(null!==(s=e.seriesQuery)&&void 0!==s?s:""),O(null!==(u=e.classicQuery)&&void 0!==u?u:"")}}),[t]),(0,r.useEffect)((()=>{if(s!==za.LabelValues)return;const e=i.getVariables().map((e=>({label:e,value:e})));if(f){const t=[{label:"__name__",op:"=",value:f}],r=Tn.renderLabels(t);i.languageProvider.fetchSeriesLabelsMatch(r).then((t=>{const r=t.map((e=>({label:e,value:e})));_([...e,...r])}))}else i.getTagKeys({filters:[]}).then((t=>{const r=t.map((({text:e})=>({label:e,value:e})));_([...e,...r])}))}),[i,s,f]);const x=(t,r)=>{const n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ab(e,t,r[t])}))}return e}({},{qryType:s,label:u,metric:f,match:d,varQuery:h,seriesQuery:y,classicQuery:b,refId:sb},t,r?{labelFilters:r}:{labelFilters:S}),i=function(e){switch(e.qryType){case za.LabelNames:return e.match?`label_names(${e.match})`:"label_names()";case za.LabelValues:if(e.metric||e.labelFilters&&0!==e.labelFilters.length){var t;const r={metric:e.metric,labels:null!==(t=e.labelFilters)&&void 0!==t?t:[],operations:[]};return`label_values(${Tn.renderQuery(r)},${e.label})`}return`label_values(${e.label})`;case za.MetricNames:return`metrics(${e.metric})`;case za.VarQueryResult:return`query_result(${(i=e.varQuery)?i.replace(/[\r\n]+/gm,""):""})`;case za.SeriesQuery:var r;return null!==(r=e.seriesQuery)&&void 0!==r?r:"";case za.ClassicQuery:var n;return null!==(n=e.classicQuery)&&void 0!==n?n:""}var i;return""}(n);e({query:i,qryType:n.qryType,refId:sb})},T=(0,r.useCallback)((()=>({metric:f,labels:S,operations:[]})),[f,S]);return n().createElement(n().Fragment,null,n().createElement(a.InlineFieldRow,null,n().createElement(a.InlineField,{label:"Query type",labelWidth:20,tooltip:n().createElement("div",null,"The Prometheus data source plugin provides the following query types for template variables.")},n().createElement(a.Select,{placeholder:"Select query type","aria-label":"Query type",onChange:e=>{var t;l(e.value),e.value!==za.SeriesQuery&&x({qryType:null!==(t=e.value)&&void 0!==t?t:0})},value:s,options:ob,width:25}))),s===za.LabelValues&&n().createElement(n().Fragment,null,n().createElement(a.InlineFieldRow,null,n().createElement(a.InlineField,{label:"Label",labelWidth:20,required:!0,"aria-labelledby":"label-select",tooltip:n().createElement("div",null,"Returns a list of label values for the label name in all metrics unless the metric is specified.")},n().createElement(a.Select,{"aria-label":"label-select",onChange:e=>{const t=e&&e.value?e.value:"";c(t),s===za.LabelValues&&t&&x({label:t})},value:u,options:w,width:25,allowCustomValue:!0,isClearable:!0}))),n().createElement(nb,{query:T(),datasource:i,onChange:e=>{m(e.metric),E(e.labels);const t=e.metric;var r;const n=null!==(r=e.labels)&&void 0!==r?r:[];s===za.LabelValues&&u&&(t||n)&&x({qryType:s,metric:t},n)},variableEditor:!0})),s===za.LabelNames&&n().createElement(a.InlineFieldRow,null,n().createElement(a.InlineField,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric regex",tooltip:n().createElement("div",null,"Returns a list of label names, optionally filtering by specified metric regex.")},n().createElement(a.Input,{type:"text","aria-label":"Metric regex",placeholder:"Metric regex",value:d,onBlur:e=>{var t;p(e.currentTarget.value),t=e.currentTarget.value,s===za.LabelNames&&x({qryType:s,match:t})},onChange:e=>{p(e.currentTarget.value)},width:25}))),s===za.MetricNames&&n().createElement(a.InlineFieldRow,null,n().createElement(a.InlineField,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric selector",tooltip:n().createElement("div",null,"Returns a list of metrics matching the specified metric regex.")},n().createElement(a.Input,{type:"text","aria-label":"Metric selector",placeholder:"Metric regex",value:f,onChange:e=>{m(e.currentTarget.value)},onBlur:e=>{var t;m(e.currentTarget.value),t=e.currentTarget.value,s===za.MetricNames&&t&&x({metric:t})},width:25}))),s===za.VarQueryResult&&n().createElement(a.InlineFieldRow,null,n().createElement(a.InlineField,{label:"Query",labelWidth:20,tooltip:n().createElement("div",null,"Returns a list of Prometheus query results for the query. This can include Prometheus functions, i.e. sum(go_goroutines).")},n().createElement(a.TextArea,{type:"text","aria-label":"Prometheus Query",placeholder:"Prometheus Query",value:h,onChange:e=>{g(e.currentTarget.value)},onBlur:()=>{s===za.VarQueryResult&&h&&x({qryType:s})},cols:100}))),s===za.SeriesQuery&&n().createElement(a.InlineFieldRow,null,n().createElement(a.InlineField,{label:"Series Query",labelWidth:20,tooltip:n().createElement("div",null,'Enter enter a metric with labels, only a metric or only labels, i.e. go_goroutines{instance="localhost:9090"}, go_goroutines, or {instance="localhost:9090"}. Returns a list of time series associated with the entered data.')},n().createElement(a.Input,{type:"text","aria-label":"Series Query",placeholder:"Series Query",value:y,onChange:e=>{v(e.currentTarget.value)},onBlur:()=>{s===za.SeriesQuery&&y&&x({qryType:s})},width:100}))),s===za.ClassicQuery&&n().createElement(a.InlineFieldRow,null,n().createElement(a.InlineField,{label:"Classic Query",labelWidth:20,tooltip:n().createElement("div",null,"The original implemetation of the Prometheus variable query editor. Enter a string with the correct query type and parameters as described in these docs. For example, label_values(label, metric).")},n().createElement(a.Input,{type:"text","aria-label":"Classic Query",placeholder:"Classic Query",value:b,onChange:e=>{O(e.currentTarget.value)},onBlur:()=>{s===za.ClassicQuery&&b&&x({qryType:s})},width:100}))))};function ub(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cb(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ub(e,t,r[t])}))}return e}class db extends t.CustomVariableSupport{constructor(e,r=(0,i.getTemplateSrv)()){super(),ub(this,"datasource",void 0),ub(this,"templateSrv",void 0),ub(this,"editor",void 0),ub(this,"query",void 0),this.datasource=e,this.templateSrv=r,this.editor=lb,this.query=e=>{let r;if(r="string"==typeof e.targets[0]?e.targets[0]:e.targets[0].query,!r)return(0,fa.of)({data:[]});const n=cb((o=cb({},e.scopedVars),s=null!=(s={__interval:{text:this.datasource.interval,value:this.datasource.interval},__interval_ms:{text:t.rangeUtil.intervalToMs(this.datasource.interval),value:t.rangeUtil.intervalToMs(this.datasource.interval)}})?s:{},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(s)).forEach((function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(s,e))})),o),this.datasource.getRangeScopedVars(e.range)),i=this.templateSrv.replace(r,n,this.datasource.interpolateQueryExpr),a=new sv(this.datasource,i);var o,s;return(0,fa.from)(a.process(e.range)).pipe(Ny((e=>({data:e}))))}}}function pb(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function fb(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){pb(a,n,i,o,s,"next",e)}function s(e){pb(a,n,i,o,s,"throw",e)}o(void 0)}))}}function mb(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hb(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){mb(e,t,r[t])}))}return e}function gb(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}var yb;!function(e){e.VictoriaMetrics="VictoriaMetrics"}(yb||(yb={}));const vb=["api/v1/query","api/v1/query_range","api/v1/series","api/v1/labels"];class bb extends i.DataSourceWithBackend{getQueryDisplayText(e){return e.expr}_addTracingHeaders(e,t){e.headers={},!this.url.match(/^http/)&&(e.headers["X-Dashboard-UID"]=t.dashboardUID||"",e.headers["X-Panel-Id"]=t.panelId)}_request(e,t,r={}){t=t||{};for(const[e,r]of this.customQueryParameters)null==t[e]&&(t[e]=r);let n=this.url+e;e.startsWith(`/api/datasources/proxy/${this.id}`)&&(n=e);const a=(0,$.defaults)(r,{url:n,method:this.httpMethod,headers:{}});return"GET"===a.method?t&&Object.keys(t).length&&(a.url=a.url+(a.url.search(/\?/)>=0?"&":"?")+Object.entries(t).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&")):(a.headers["Content-Type"]="application/x-www-form-urlencoded",a.data=t),(this.basicAuth||this.withCredentials)&&(a.withCredentials=!0),this.basicAuth&&(a.headers.Authorization=this.basicAuth),(0,i.getBackendSrv)().fetch(a)}importFromAbstractQueries(e){var t=this;return fb((function*(){return e.map((e=>t.languageProvider.importFromAbstractQuery(e)))}))()}exportToAbstractQueries(e){var t=this;return fb((function*(){return e.map((e=>t.languageProvider.exportToAbstractQuery(e)))}))()}metadataRequest(e,t={},r){var n=this;return fb((function*(){if(vb.some((t=>e.includes(t))))try{return yield(0,fa.lastValueFrom)(n._request(`/api/datasources/proxy/${n.id}${e}`,t,hb({method:n.httpMethod,hideFromInspector:!0,showErrorAlert:!1},r)))}catch(e){if("POST"!==n.httpMethod||!(0,i.isFetchError)(e)||405!==e.status&&400!==e.status)throw e;console.warn("Couldn't use configured POST HTTP method for this request. Trying to use GET method instead.")}return yield(0,fa.lastValueFrom)(n._request(`/api/datasources/proxy/${n.id}${e}`,t,hb({method:"GET",hideFromInspector:!0},r)))}))()}prettifyRequest(e){var t=this;return fb((function*(){try{return yield(0,fa.lastValueFrom)(t._request(`/api/datasources/proxy/${t.id}/prettify-query`,{query:e},{method:"GET",hideFromInspector:!0,showErrorAlert:!1}))}catch(e){throw e}}))()}interpolateQueryExpr(e=[],t){if(!t.multi&&!t.includeAll)return Ob(e);if("string"==typeof e)return wb(e);const r=e.map((e=>wb(e)));return 1===r.length?r[0]:"("+r.join("|")+")"}targetContainsTemplate(e){return this.templateSrv.containsTemplate(e.expr)}processTargetV2(e,t){return gb(hb({},e),{queryType:Ga.timeSeriesQuery,requestId:t.panelId+e.refId,utcOffsetSec:60*this.timeSrv.timeRange().to.utcOffset()})}query(e){if("proxy"===this.access){const r=e.targets.map((t=>this.processTargetV2(t,e)));return super.query(gb(hb({},e),{targets:r})).pipe(Ny((r=>function(e,r,n){const[i,a]=(0,$.partition)(e.data,(e=>((e,r)=>{var n,i,a,o;if(r.app===t.CoreApp.Explore&&("vector"===(null===(i=e.meta)||void 0===i||null===(n=i.custom)||void 0===n?void 0:n.resultType)||"scalar"===(null===(o=e.meta)||void 0===o||null===(a=o.custom)||void 0===a?void 0:a.resultType)))return!0;const s=r.targets.find((t=>t.refId===e.refId));return"table"===(null==s?void 0:s.format)})(e,r))),o=function(e){if(0===e.length||1===e.length&&0===e[0].length)return e;const r=(0,$.groupBy)(e,"refId"),n=Object.keys(r);return n.map((i=>{const a=function(e,t=""){return e>1?`Value #${t}`:"Value"}(n.length,i),o=Ov({data:[],valueName:a}),s=bv([]),l=[];return r[i].forEach((e=>{var r;const n=null!==(r=e.fields[1].labels)&&void 0!==r?r:{};Object.keys(n).sort().forEach((e=>{if(!l.some((t=>t.name===e))){const r=e===hv;l.push({name:e,config:{filterable:!0},type:r?t.FieldType.number:t.FieldType.string,values:new t.ArrayVector})}}))})),r[i].forEach((e=>{e.fields[0].values.toArray().forEach((e=>s.values.add(e))),e.fields[1].values.toArray().forEach((t=>{var r;o.values.add(Ev(t));const n=null!==(r=e.fields[1].labels)&&void 0!==r?r:{};l.forEach((e=>e.values.add(vv(n,e.name))))}))})),{refId:i,fields:[s,...l,o],meta:pv(dv({},e[0].meta),{preferredVisualisationType:"table"}),length:s.values.length}}))}(i),[s,l]=(0,$.partition)(a,(e=>{var t,r;return"exemplar"===(null===(r=e.meta)||void 0===r||null===(t=r.custom)||void 0===t?void 0:t.resultType)})),{exemplarTraceIdDestinations:u}=n,c=s.map((e=>{if(null==u?void 0:u.length)for(const t of u){const n=e.fields.find((e=>e.name===t.name));if(n){var r;const e=yv(t);n.config.links=(null===(r=n.config.links)||void 0===r?void 0:r.length)?[...n.config.links,...e]:e}}return pv(dv({},e),{meta:pv(dv({},e.meta),{dataTopic:t.DataTopic.Annotations})})})),[d,p]=(0,$.partition)(l,(e=>((e,t)=>{const r=t.targets.find((t=>t.refId===e.refId));return"heatmap"===(null==r?void 0:r.format)})(e,r))),f=(0,$.groupBy)(d,(e=>e.refId));let m=[];for(const e in f){const r=f[e],n=(0,$.groupBy)(r,(e=>{const r=e.fields.find((e=>e.name===t.TIME_SERIES_VALUE_FIELD_NAME));if((null==r?void 0:r.labels)&&hv in r.labels){const e=null==r?void 0:r.labels,{le:t}=e,n=fv(e,["le"]);return Object.values(n).join()}var n;return Object.values(null!==(n=null==r?void 0:r.labels)&&void 0!==n?n:[]).join()}));(0,$.forOwn)(n,(e=>{const t=e.sort(Sv);m.push(wv(_v(t)))}))}const h=p.map((e=>pv(dv({},e),{meta:pv(dv({},e.meta),{preferredVisualisationType:"graph"})}))),g=(0,$.flatten)(m);return pv(dv({},e),{data:[...h,...o,...g,...c]})}(r,e,{}))))}{const r=this.getPrometheusTime(e.range.from,!1),n=this.getPrometheusTime(e.range.to,!0),{queries:i,activeTargets:a}=this.prepareTargets(e,r,n);if(e.targets.every((e=>"Anno"===e.refId))){const t=gb(hb({},e.targets[0]),{expr:i[0].expr});return this.performAnnotationQuery(gb(hb({},t),{start:r,end:n}))}return i&&i.length?e.app===t.CoreApp.Explore?this.exploreQuery(i,a,n):this.panelsQuery(i,a,n,e.requestId,e.scopedVars):(0,fa.of)({data:[],state:t.LoadingState.Done})}}exploreQuery(e,r,n){let i=e.length;const a=e.map(((a,o)=>{const s=r[o],l=(0,fa.pipe)((p=ly(u=()=>i--)?{next:u,error:c,complete:d}:u)?uy((function(e,t){var r;null===(r=p.subscribe)||void 0===r||r.call(p);var n=!0;e.subscribe(Ry(t,(function(e){var r;null===(r=p.next)||void 0===r||r.call(p,e),t.next(e)}),(function(){var e;n=!1,null===(e=p.complete)||void 0===e||e.call(p),t.complete()}),(function(e){var r;n=!1,null===(r=p.error)||void 0===r||r.call(p,e),t.error(e)}),(function(){var e,t;n&&(null===(e=p.unsubscribe)||void 0===e||e.call(p)),null===(t=p.finalize)||void 0===t||t.call(p)})))})):Ly,jy((e=>!e.cancelled)),Ny((r=>{const n=gv(r,{query:a,target:s,responseListLength:e.length});return{data:n.dataFrame,trace:n.traceResult?[n.traceResult]:[],key:a.requestId,state:0===i?t.LoadingState.Done:t.LoadingState.Loading}})));var u,c,d,p;return this.runQuery(a,n,l)}));return(0,fa.merge)(...a)}panelsQuery(e,r,n,i,a){const o=e.map(((t,i)=>{const o=r[i],s=(0,fa.pipe)(jy((e=>!e.cancelled)),Ny((r=>gv(r,{query:t,target:o,responseListLength:e.length,scopedVars:a}))));return this.runQuery(t,n,s)}));return(0,fa.forkJoin)(o).pipe(Ny((e=>{const r=e.map((e=>e.dataFrame)).reduce(((e,t)=>[...e,...t]),[]);return{data:r,trace:e.map((e=>e.traceResult)).filter((e=>e)),key:i,state:t.LoadingState.Done}})))}runQuery(e,t,r){return e.instant?this.performInstantQuery(e,t).pipe(r):this.performTimeSeriesQuery(e,e.start,e.end).pipe(r)}createQuery(e,r,n,i){const a={hinting:e.hinting,instant:e.instant,exemplar:e.exemplar,step:0,expr:"",requestId:e.requestId,refId:e.refId,start:0,end:0},o=Math.ceil(i-n);let s=t.rangeUtil.intervalToSeconds(r.interval);const l=t.rangeUtil.intervalToSeconds(this.templateSrv.replace(e.interval||r.interval,r.scopedVars)),u=e.interval?t.rangeUtil.intervalToSeconds(this.templateSrv.replace(e.interval,r.scopedVars)):t.rangeUtil.intervalToSeconds(this.interval),c=e.intervalFactor||1,d=this.adjustInterval(s,l,o,c);let p=hb({},r.scopedVars,this.getRangeScopedVars(r.range),this.getRateIntervalScopedVariable(d,u));s!==d&&(s=d,p=Object.assign({},r.scopedVars,hb({__interval:{text:s+"s",value:s+"s"},__interval_ms:{text:1e3*s,value:1e3*s}},this.getRateIntervalScopedVariable(s,u),this.getRangeScopedVars(r.range)))),a.step=s;let f=e.expr;f=this.enhanceExprWithAdHocFilters(f);const m=r.dashboardUID||r.app||"";f=ja(f,this.withTemplates.find((e=>e.uid===m))),a.expr=this.templateSrv.replace(f,p,this.interpolateQueryExpr);const h=function(e,t,r,n){return{end:Math.floor((t+n)/r)*r-n,start:Math.floor((e+n)/r)*r-n}}(n,i,a.step,60*this.timeSrv.timeRange().to.utcOffset());return a.start=h.start,a.end=h.end,this._addTracingHeaders(a,r),a.trace=e.trace,a}getRateIntervalScopedVariable(e,t){0===t&&(t=15);const r=Math.max(e+t,4*t);return{__rate_interval:{text:r+"s",value:r+"s"}}}adjustInterval(e,t,r,n){let i=r/11e3;return i>1&&(i=Math.ceil(i)),Math.max(e*n,t,i)}performTimeSeriesQuery(e,t,r){if(t>r)throw{message:"Invalid time range"};const n={query:e.expr,start:t,end:r,step:e.step};return e.trace&&(n.trace="1"),this.queryTimeout&&(n.timeout=this.queryTimeout),this._request("/api/v1/query_range",n,{requestId:e.requestId,headers:e.headers}).pipe(Xy((t=>t.cancelled?(0,fa.of)(t):(0,fa.throwError)(this.handleErrors(t,e)))))}performInstantQuery(e,t){const r={query:e.expr,time:t};return e.trace&&(r.trace="1"),this.queryTimeout&&(r.timeout=this.queryTimeout),this._request("/api/v1/query",r,{requestId:e.requestId,headers:e.headers}).pipe(Xy((t=>t.cancelled?(0,fa.of)(t):(0,fa.throwError)(this.handleErrors(t,e)))))}metricFindQuery(e,r){if(!e)return Promise.resolve([]);var n;const i=null!==(n=null==r?void 0:r.range)&&void 0!==n?n:(0,t.getDefaultTimeRange)(),a=hb({__interval:{text:this.interval,value:this.interval},__interval_ms:{text:t.rangeUtil.intervalToMs(this.interval),value:t.rangeUtil.intervalToMs(this.interval)}},this.getRangeScopedVars(i)),o=this.templateSrv.replace(e,a,this.interpolateQueryExpr);return new sv(this,o).process(i)}getRangeScopedVars(e=this.timeSrv.timeRange()){const t=e.to.diff(e.from),r=Math.round(t/1e3);return{__range_ms:{text:t,value:t},__range_s:{text:r,value:r},__range:{text:r+"s",value:r+"s"}}}getTagKeys(e){var t=this;return fb((function*(){if(null==e?void 0:e.series){const r=yield Promise.all(e.series.map((e=>t.languageProvider.fetchSeriesLabels(e))));let n=[];return r.map((e=>n=n.concat(Object.keys(e)))),[...new Set(n)].map((e=>({text:e})))}{var r,n;const e=t.getLimitMetrics("maxTagKeys"),a=yield t.metadataRequest("/api/v1/labels",{limit:e});var i;return null!==(i=null==a||null===(n=a.data)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.map((e=>({text:e}))))&&void 0!==i?i:[]}}))()}getTagValues(e={}){var t=this;return fb((function*(){var r,n;const i=t.getLimitMetrics("maxTagValues"),a=yield t.metadataRequest(`/api/v1/label/${e.key}/values`,{limit:i});var o;return null!==(o=null==a||null===(n=a.data)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.map((e=>({text:e}))))&&void 0!==o?o:[]}))()}testDatasource(){var e=this;return fb((function*(){const r=(new Date).getTime(),n={targets:[{refId:"test",expr:"1+1",instant:!0}],requestId:`${e.id}-health`,scopedVars:{},dashboardId:0,panelId:0,interval:"1m",intervalMs:6e4,maxDataPoints:1,timezone:"",app:yr,startTime:0,range:{from:(0,t.dateTime)(r-1e3),to:(0,t.dateTime)(r),raw:{from:"now-1s",to:"now"}}};return(0,fa.lastValueFrom)(e.query(n)).then((e=>{return e&&e.data&&e.state===t.LoadingState.Done?{status:"success",message:"Data source is working"}:{status:"error",message:`Error reading Prometheus: ${null==e||null===(r=e.error)||void 0===r?void 0:r.message}`};var r})).catch((e=>(console.error("VictoriaMetrics Error",e),{status:"error",message:e.message})))}))()}interpolateVariablesInQueries(e,t){let r=e;return e&&e.length&&(r=e.map((e=>gb(hb({},e),{datasource:this.getRef(),expr:this.templateSrv.replace(e.expr,t,this.interpolateQueryExpr),interval:this.templateSrv.replace(e.interval,t)})))),r}getQueryHints(e,t){var r;return uv(null!==(r=e.expr)&&void 0!==r?r:"",t,this)}getInitHints(){return function(e){const t=[];return e.directUrl.includes("/loki")&&!e.languageProvider.metrics.length&&t.push({label:"Using Loki as a Prometheus data source is no longer supported. You must use the Loki data source for your Loki instance.",type:"INFO"}),e.lookupsDisabled&&t.push({label:"Labels and metrics lookup was disabled in data source settings.",type:"INFO"}),t}(this)}loadRules(){var e=this;return fb((function*(){try{var t,r;const n=null===(r=(yield e.metadataRequest("/api/v1/rules",{},{showErrorAlert:!1})).data)||void 0===r||null===(t=r.data)||void 0===t?void 0:t.groups;n&&(e.ruleMappings=function(e){return e.reduce(((e,t)=>t.rules.filter((e=>"recording"===e.type)).reduce(((e,t)=>gb(hb({},e),{[t.name]:t.query})),e)),{})}(n))}catch(e){console.log("Rules API is experimental. Ignore next error."),console.error(e)}}))()}modifyQuery(e,t){var r;let n=null!==(r=e.expr)&&void 0!==r?r:"";switch(t.type){case"ADD_FILTER":{var i;const{key:e,value:r}=null!==(i=t.options)&&void 0!==i?i:{};e&&r&&(n=Bn(n,e,r));break}case"ADD_FILTER_OUT":{var a;const{key:e,value:r}=null!==(a=t.options)&&void 0!==a?a:{};e&&r&&(n=Bn(n,e,r,"!="));break}case"ADD_HISTOGRAM_QUANTILE":n=`histogram_quantile(0.95, sum(rate(${n}[$__rate_interval])) by (le))`;break;case"ADD_RATE":n=`rate(${n}[$__rate_interval])`;break;case"ADD_SUM":n=`sum(${n.trim()}) by ($1)`;break;case"EXPAND_RULES":t.options&&(n=function(e,t){const r=Object.keys(t),n=new RegExp(`(\\s|^)(${r.join("|")})(\\s|$|\\(|\\[|\\{)`,"ig"),i=e.replace(n,((e,r,n,i)=>`${r}${t[n]}${i}`)).split(/(\+|\-|\*|\/|\%|\^)/),a=/(\)\{|\}\{|\]\{)/,o=i.map((e=>function(e,t){const r=e.match(t);if(!r)return e;var n;const i=null!==(n=r.index)&&void 0!==n?n:0,a=e.slice(0,i+1),o=e.slice(i+1),s=[];o.replace(Xn,((e,t,r,n)=>(s.push({key:t,operator:r,value:n}),"")));let l=a;return s.filter(Boolean).forEach((e=>{const t=e.value.slice(1,-1);l=Bn(l,e.key,t,e.operator)})),l}(e,a)));return o.join("")}(n,t.options))}return gb(hb({},e),{expr:n})}getPrometheusTime(e,r){return"string"==typeof e&&(e=t.dateMath.parse(e,r)),Math.ceil(e.valueOf()/1e3)}getTimeRangeParams(){const e=this.timeSrv.timeRange();return{start:this.getPrometheusTime(e.from,!1).toString(),end:this.getPrometheusTime(e.to,!0).toString()}}getLimitMetrics(e){return this.limitMetrics[e]||0}getOriginalMetricName(e){return function(e){const t=e.__name__||"";return delete e.__name__,`${t}{${Object.entries(e).map((e=>`${e[0]}="${e[1]}"`)).join(",")}}`}(e)}enhanceExprWithAdHocFilters(e){return this.templateSrv.getAdhocFilters(this.name).reduce(((e,t)=>{const{key:r,operator:n}=t;let{value:i}=t;return"=~"!==n&&"!~"!==n||(i=Ob(i)),Bn(e,r,i,n)}),e)}filterQuery(e){return!(e.hide||!e.expr)}applyTemplateVariables(e,t){const r=(0,$.cloneDeep)(t);delete r.__interval,delete r.__interval_ms;const n=this.enhanceExprWithAdHocFilters(e.expr);return gb(hb({},e),{legendFormat:this.templateSrv.replace(e.legendFormat,r),expr:this.templateSrv.replace(n,r,this.interpolateQueryExpr),interval:this.templateSrv.replace(e.interval,r)})}getVariables(){return this.templateSrv.getVariables().map((e=>`$${e.name}`))}interpolateString(e){const t=e.includes("__name__")?ei:Jn;return this.templateSrv.replace(t(e),void 0,this.interpolateQueryExpr)}withTemplatesUpdate(e){this.withTemplates=null!=e?e:[]}getAdjustedInterval(e){return{start:ai(e.from,!1).toString(),end:ai(e.to,!0).toString()}}constructor(e,r=(0,i.getTemplateSrv)(),n=function(){return Mv||(Mv=new jv(Rv)),Mv}(),a){super(e),mb(this,"templateSrv",void 0),mb(this,"timeSrv",void 0),mb(this,"type",void 0),mb(this,"ruleMappings",void 0),mb(this,"url",void 0),mb(this,"id",void 0),mb(this,"directUrl",void 0),mb(this,"vmuiUrl",void 0),mb(this,"access",void 0),mb(this,"basicAuth",void 0),mb(this,"withCredentials",void 0),mb(this,"interval",void 0),mb(this,"queryTimeout",void 0),mb(this,"httpMethod",void 0),mb(this,"languageProvider",void 0),mb(this,"exemplarTraceIdDestinations",void 0),mb(this,"lookupsDisabled",void 0),mb(this,"customQueryParameters",void 0),mb(this,"exemplarsAvailable",void 0),mb(this,"subType",void 0),mb(this,"rulerEnabled",void 0),mb(this,"withTemplates",void 0),mb(this,"limitMetrics",void 0),mb(this,"init",void 0),mb(this,"prepareTargets",void 0),mb(this,"handleErrors",void 0),mb(this,"prepareQuery",void 0),mb(this,"performAnnotationQuery",void 0),mb(this,"processEvents",void 0),this.templateSrv=r,this.timeSrv=n;var o,s,l,u,c=this;this.init=fb((function*(){yield c.loadRules()})),this.prepareTargets=(e,r,n)=>{const i=[],a=[],o=(0,$.cloneDeep)(e.targets);for(const s of o)if(s.expr&&!s.hide)if(s.requestId=e.panelId+s.refId,e.app===t.CoreApp.Explore&&s.range===s.instant){const t=(0,$.cloneDeep)(s);t.format="table",t.instant=!0,t.range=!1,t.valueWithRefId=!0,delete t.maxDataPoints,t.requestId+="_instant";const o=(0,$.cloneDeep)(s);o.format="time_series",o.instant=!1,t.range=!0,a.push(t,o),i.push(this.createQuery(t,e,r,n),this.createQuery(o,e,r,n))}else if(s.instant&&e.app===t.CoreApp.Explore){const t=(0,$.cloneDeep)(s);t.format="table",i.push(this.createQuery(t,e,r,n)),a.push(t)}else i.push(this.createQuery(s,e,r,n)),a.push(s);return{queries:i,activeTargets:a}},this.handleErrors=(e,t)=>{const r={message:e&&e.statusText||"Unknown error during query transaction. Please check JS console logs.",refId:t.refId};return e.data?"string"==typeof e.data?r.message=e.data:e.data.error&&(r.message=((e,t)=>{if(!e)return"";try{return JSON.stringify(e,null,void 0)}catch(e){console.error(e)}return""})(e.data.error)):e.message?r.message=e.message:"string"==typeof e&&(r.message=e),r.status=e.status,r.statusText=e.statusText,r},this.prepareQuery=e=>{const{expr:t="",datasource:r,step:n,legendFormat:i}=e;if(t)return{expr:t,range:!0,instant:!1,exemplar:!1,interval:n||"60s",refId:"X",datasource:r,legendFormat:null!=i?i:""}},this.performAnnotationQuery=e=>{const t={uid:this.templateSrv.replace(e.datasource.uid,{}),type:e.datasource.type};return(0,i.getBackendSrv)().fetch({url:"/api/ds/query",method:"POST",data:{from:(1e3*e.start).toString(),to:(1e3*e.end).toString(),queries:[gb(hb({},e),{datasource:t,refId:"X"})]},requestId:e.requestId}).pipe(Ny((e=>(0,i.toDataQueryResponse)({data:e.data}))))},this.processEvents=(e,r)=>{if(!r||!r.length)return(0,fa.of)([]);const{tagKeys:n="",titleFormat:i="",textFormat:a="",useValueForTime:o}=e,s=1e3*t.rangeUtil.intervalToSeconds(e.step||"60s"),l=n.split(","),u=[];for(const t of r){if(0===t.fields.length)continue;const r=t.fields[0],n=t.fields[1],d=(null==n?void 0:n.labels)||{},p=Object.keys(d).filter((e=>l.includes(e))).map((e=>d[e])),f=[];let m=0;n.values.toArray().forEach((e=>{let t,n;const i=r.values.get(m);o?(t=Math.floor(parseFloat(e)),n=1):(t=Math.floor(parseFloat(i)),n=parseFloat(e)),m++,f.push([t,n])}));const h=f.filter((e=>e[1]>=1)).map((e=>e[0]));let g=null;for(const t of h){var c;g&&(null!==(c=g.timeEnd)&&void 0!==c?c:0)+s>=t?g.timeEnd=t:(g&&u.push(g),g={time:t,timeEnd:t,annotation:e,title:Hy(i,d),tags:p,text:Hy(a,d)})}g&&(g.timeEnd=h[h.length-1],u.push(g))}return(0,fa.of)(u)},this.type=yr,this.subType="VictoriaMetrics",this.rulerEnabled=!1,this.id=e.id,this.url=e.url,this.access="direct",this.basicAuth=e.basicAuth,this.withCredentials=e.withCredentials,this.interval=e.jsonData.timeInterval||"15s",this.queryTimeout=e.jsonData.queryTimeout,this.httpMethod=e.jsonData.httpMethod||"GET",this.directUrl=null!==(o=e.jsonData.directUrl)&&void 0!==o?o:this.url,this.vmuiUrl=e.jsonData.vmuiUrl||z(this.url),this.exemplarTraceIdDestinations=e.jsonData.exemplarTraceIdDestinations,this.ruleMappings={},this.languageProvider=null!=a?a:new yi(this),this.lookupsDisabled=null!==(s=e.jsonData.disableMetricsLookup)&&void 0!==s&&s,this.customQueryParameters=new URLSearchParams(e.jsonData.customQueryParameters),this.variables=new db(this,this.templateSrv),this.exemplarsAvailable=!1,this.withTemplates=null!==(l=e.jsonData.withTemplates)&&void 0!==l?l:[],this.limitMetrics=null!==(u=e.jsonData.limitMetrics)&&void 0!==u?u:{},this.annotations={QueryEditor:Ky,processEvents:this.processEvents,prepareQuery:this.prepareQuery}}}function Ob(e){return"string"==typeof e?e.replace(/\\/g,"\\\\").replace(/'/g,"\\\\'"):e}function wb(e){return"string"==typeof e?e.replace(/\\/g,"\\\\\\\\").replace(/[$^*{}\[\]'+?.()|]/g,"\\\\$&"):e}const _b=new t.DataSourcePlugin(bb).setQueryEditor(_g).setConfigEditor((e=>{const{options:t,onOptionsChange:o}=e,s=(0,r.useRef)("direct"===e.options.access),l={azureAuthSupported:i.config.azureAuthEnabled,getAzureAuthEnabled:e=>function(e){return!!e.jsonData.azureCredentials}(e),setAzureAuthEnabled:(e,t)=>t?function(e){return{jsonData:kg(Pg({},e.jsonData),{azureCredentials:qg()})}}(e):function(e){return{jsonData:kg(Pg({},e.jsonData),{azureAuth:void 0,azureCredentials:void 0,azureEndpointResourceId:void 0})}}(e),azureSettingsUI:Qg};return n().createElement(n().Fragment,null,n().createElement(Vg,null),n().createElement(a.DataSourceHttpSettings,{defaultUrl:"http://localhost:8428",dataSourceConfig:t,showAccessOptions:s.current,onChange:o,sigV4AuthToggleEnabled:i.config.sigV4AuthEnabled,azureAuthSettings:l,renderSigV4Editor:n().createElement(Eg.IW,e)}),n().createElement(a.AlertingSettings,e),n().createElement(Hg,e),n().createElement(oy,e))}))})(),h})()));
//# sourceMappingURL=module.js.map